instance SQ225_ANDERASWAY_FINISH(CUTSCENE) {
    ONSTART = FUNCTION(92903);
}

func void SQ225_ANDERASWAY_FINISH_WAIT() {
    AI_WAITTILLEND(VLK_3014_GERHARD_VINEYARDFIGHT, HERO);
    AI_WAITTILLEND(VLK_3014_GERHARD_VINEYARDFIGHT, BAU_11182_FARMER);
    AI_WAITTILLEND(VLK_3014_GERHARD_VINEYARDFIGHT, BAU_2265_FARMER);
    AI_WAITTILLEND(VLK_3014_GERHARD_VINEYARDFIGHT, BAU_2267_FARMER);
    AI_WAITTILLEND(BAU_11182_FARMER, HERO);
    AI_WAITTILLEND(BAU_11182_FARMER, VLK_3014_GERHARD_VINEYARDFIGHT);
    AI_WAITTILLEND(BAU_11182_FARMER, BAU_2265_FARMER);
    AI_WAITTILLEND(BAU_11182_FARMER, BAU_2267_FARMER);
    AI_WAITTILLEND(BAU_2267_FARMER, HERO);
    AI_WAITTILLEND(BAU_2267_FARMER, VLK_3014_GERHARD_VINEYARDFIGHT);
    AI_WAITTILLEND(BAU_2267_FARMER, BAU_2265_FARMER);
    AI_WAITTILLEND(BAU_2267_FARMER, BAU_11182_FARMER);
    AI_WAITTILLEND(BAU_2265_FARMER, HERO);
    AI_WAITTILLEND(BAU_2265_FARMER, VLK_3014_GERHARD_VINEYARDFIGHT);
    AI_WAITTILLEND(BAU_2265_FARMER, BAU_2267_FARMER);
    AI_WAITTILLEND(BAU_2265_FARMER, BAU_11182_FARMER);
    AI_WAITTILLEND(HERO, VLK_3014_GERHARD_VINEYARDFIGHT);
    AI_WAITTILLEND(HERO, BAU_11182_FARMER);
    AI_WAITTILLEND(HERO, BAU_2265_FARMER);
    AI_WAITTILLEND(HERO, BAU_2267_FARMER);
}

func void SQ225_ANDERASWAY_FINISH_START() {
    WLD_SENDTRIGGER("KM_SQ225_ANDERASFINISH_01");
    TELEPORTNPCTOWP(1819, "PART9_SQ225_CUTSCENE_HERO");
    TELEPORTNPCTOWP(53415, "PART9_SQ225_CUTSCENE_GERHARD");
    TELEPORTNPCTOWP(57074, BAU_2245_HOLDWIG.WP);
    TELEPORTNPCTOWP(56788, NONE_11214_MERCENARY.WP);
    TELEPORTNPCTOWP(57001, "PART9_SQ225_CUTSCENE_FARMER_01");
    TELEPORTNPCTOWP(57013, "PART9_SQ225_CUTSCENE_FARMER_02");
    TELEPORTNPCTOWP(56877, "PART9_VINEYARD_40");
    NPC_CLEARAIQUEUE(VLK_3014_GERHARD_VINEYARDFIGHT);
    NPC_CLEARAIQUEUE(BAU_11182_FARMER);
    NPC_CLEARAIQUEUE(BAU_2267_FARMER);
    NPC_CLEARAIQUEUE(BAU_2265_FARMER);
    NPC_CLEARAIQUEUE(HERO);
    VLK_3014_GERHARD_VINEYARDFIGHT.AIVAR[92] = TRUE;
    BAU_2265_FARMER.AIVAR[92] = TRUE;
    BAU_2267_FARMER.AIVAR[92] = TRUE;
    BAU_11182_FARMER.AIVAR[92] = TRUE;
    B_TURNTONPC(BAU_2265_FARMER, BAU_2245_HOLDWIG);
    B_TURNTONPC(BAU_2267_FARMER, BAU_2245_HOLDWIG);
    B_TURNTONPC(BAU_11182_FARMER, BAU_2245_HOLDWIG);
    B_TURNTONPC(VLK_3014_GERHARD_VINEYARDFIGHT, BAU_2265_FARMER);
    B_TURNTONPC(HERO, BAU_2267_FARMER);
    SQ225_ANDERASWAY_FINISH_WAIT();
    AI_SETWALKMODE(BAU_11182_FARMER, NPC_RUN);
    AI_GOTOWP(BAU_11182_FARMER, "PART9_VINEYARD_50");
    AI_TURNTONPC(BAU_11182_FARMER, BAU_2245_HOLDWIG);
    AI_STARTFACEANI(BAU_2265_FARMER, S_ANGRY, 1, -(1));
    AI_STARTFACEANI(BAU_2267_FARMER, S_ANGRY, 1, -(1));
    AI_STARTFACEANI(BAU_11182_FARMER, S_ANGRY, 1, -(1));
    AI_OUTPUT(BAU_2265_FARMER, HERO, "DIA_Farmer_AnderasFinish_Cutscene_03_01");
    SQ225_ANDERASWAY_FINISH_WAIT();
    AI_OUTPUT(BAU_2267_FARMER, HERO, "DIA_Farmer_AnderasFinish_Cutscene_03_02");
    SQ225_ANDERASWAY_FINISH_WAIT();
    AI_OUTPUT(BAU_11182_FARMER, HERO, "DIA_Farmer_AnderasFinish_Cutscene_03_03");
    SQ225_ANDERASWAY_FINISH_WAIT();
    AI_FUNCTION(VLK_3014_GERHARD_VINEYARDFIGHT, 92907);
    if ((SQ225_GERHARD_FINISHWAY) == (3)) {
        AI_TURNTONPC(VLK_3014_GERHARD_VINEYARDFIGHT, BAU_2245_HOLDWIG);
        AI_OUTPUT(VLK_3014_GERHARD_VINEYARDFIGHT, HERO, "DIA_Gerhard_AnderasFinish_Cutscene_03_04");
        AI_TURNTONPC(VLK_3014_GERHARD_VINEYARDFIGHT, BAU_11182_FARMER);
        AI_OUTPUT(VLK_3014_GERHARD_VINEYARDFIGHT, HERO, "DIA_Gerhard_AnderasFinish_Cutscene_03_05");
        AI_OUTPUT(VLK_3014_GERHARD_VINEYARDFIGHT, HERO, "DIA_Gerhard_AnderasFinish_Cutscene_03_06");
    };
    AI_TURNTONPC(VLK_3014_GERHARD_VINEYARDFIGHT, BAU_11182_FARMER);
    AI_OUTPUT(VLK_3014_GERHARD_VINEYARDFIGHT, HERO, "DIA_Gerhard_AnderasFinish_Cutscene_03_07");
    AI_FUNCTION(VLK_3014_GERHARD_VINEYARDFIGHT, 92904);
    SQ225_ANDERASWAY_FINISH_WAIT();
    AI_FUNCTION(VLK_3014_GERHARD_VINEYARDFIGHT, 92908);
    AI_TURNTONPC(VLK_3014_GERHARD_VINEYARDFIGHT, HERO);
    AI_OUTPUT(VLK_3014_GERHARD_VINEYARDFIGHT, HERO, "DIA_Gerhard_AnderasFinish_Cutscene_03_08");
    AI_WAITTILLEND(HERO, VLK_3014_GERHARD_VINEYARDFIGHT);
    AI_FUNCTION(HERO, 92905);
    AI_SETWALKMODE(VLK_3014_GERHARD_VINEYARDFIGHT, NPC_WALK);
    AI_GOTOWP(VLK_3014_GERHARD_VINEYARDFIGHT, "PART9_DENNIS");
}

func void SQ225_ANDERASWAY_FINISH_WATCHFIGHT() {
    AI_STARTFACEANI(BAU_2265_FARMER, S_SMILE, 1, -(1));
    AI_STARTFACEANI(BAU_2267_FARMER, S_SMILE, 1, -(1));
    AI_STARTFACEANI(BAU_11182_FARMER, S_SMILE, 1, -(1));
    AI_WAIT(BAU_2265_FARMER, 1036831949);
    AI_PLAYANI(BAU_2265_FARMER, "T_WATCHFIGHT_YEAH_02");
    AI_WAIT(BAU_2267_FARMER, 1045220557);
    AI_PLAYANI(BAU_2267_FARMER, "T_WATCHFIGHT_YEAH_03");
    AI_PLAYANI(BAU_11182_FARMER, "T_WATCHFIGHT_YEAH_03");
}

func void SQ225_ANDERASWAY_FINISH_END() {
    FADESCREENTOBLACKF(2, 92906, 1000);
}

func void SQ225_ANDERASWAY_FINISH_END_FADESCREEN() {
    SQ225_DONTCHECKDISABLEMUSIC = TRUE;
    MUSIC_DISABLEOVERRIDE();
    WLD_SENDUNTRIGGER("KM_SQ225_ANDERASFINISH_01");
    WLD_SENDUNTRIGGER("KM_SQ225_ANDERASFINISH_02");
    WLD_SENDUNTRIGGER("KM_SQ225_ANDERASFINISH_03");
    TELEPORTNPCTOWP(1819, "PART9_VINEYARD_07");
    B_REMOVENPC(53415);
    B_REMOVENPC(56788);
    B_REMOVENPC(57074);
    B_REMOVENPC(57040);
    SQ225_STOPFIGHT();
    FF_APPLYONCEEXTGT(61097, 0, -(1));
    B_PASSTIME(2);
    FADESCREENFROMBLACK(3);
    BAU_2265_FARMER.AIVAR[92] = FALSE;
    BAU_2267_FARMER.AIVAR[92] = FALSE;
    BAU_11182_FARMER.AIVAR[92] = FALSE;
    HERO.AIVAR[4] = FALSE;
    SQ225_REMOVEHOLDWIGPORTALCHECK = FALSE;
    WLD_ASSIGNROOMTOGUILD("9WINERY01", GIL_PUBLIC);
    B_LOGENTRY(TOPIC_SQ225, LOG_SQ225_AFTERGERHARD);
}

func void SQ225_ANDERASWAY_CHANGECAMERA_01() {
    WLD_SENDTRIGGER("KM_SQ225_ANDERASFINISH_02");
    WLD_SENDUNTRIGGER("KM_SQ225_ANDERASFINISH_01");
}

func void SQ225_ANDERASWAY_CHANGECAMERA_02() {
    WLD_SENDTRIGGER("KM_SQ225_ANDERASFINISH_03");
    WLD_SENDUNTRIGGER("KM_SQ225_ANDERASFINISH_02");
}

