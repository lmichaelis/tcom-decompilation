func void SQ419_PREPARENPC() {
    WLD_INSERTNPC(58214, "PART16_SQ419_WOODCUTTER_01");
    WLD_INSERTNPC(58218, "PART16_SQ419_WOODCUTTER_02");
    FF_APPLYONCEEXTGT(63925, 0, -(1));
}

func void SQ419_PREPARENPC_APPLY() {
    var ZCMOVER MOVER1;
    var int MOVPTR1;
    var int SQ419_PREPARENPC_COUNT;
    if ((SQ419_PREPARENPC_COUNT) == (0)) {
        PRINTD("Rozpoczynam - SQ419_PrepareNPC_Apply");
        MOVPTR1 = MEM_SEARCHVOBBYNAME("SQ419_MOVER_CART_01");
        MOVER1 = MEM_PTRTOINST(MOVPTR1);
        CHANGEVOBCOLLISION("SQ419_CART_01", FALSE, FALSE, FALSE, TRUE);
        WLD_SENDTRIGGER("SQ419_MOVER_CART_01");
        SQ419_PREPARENPC_COUNT = 1;
    };
    if (((MOVER1.MOVERSTATE) != (MOVER_STATE_OPENING)) && ((MOVER1.MOVERSTATE) != (MOVER_STATE_CLOSING))) {
        PRINTD("Skoñczy³em - SQ419_PrepareNPC_Apply");
        CHANGEVOBCOLLISION("SQ419_CART_01", TRUE, TRUE, TRUE, TRUE);
        FF_REMOVE(63925);
        SQ419_PREPARENPC_COUNT = 0;
    };
}

func void SQ419_WOODCUTTERSBEGONE() {
    NPC_EXCHANGEROUTINE(NONE_13756_WOODCUTTER, TOT);
    B_STARTOTHERROUTINE(NONE_13757_WOODCUTTER, TOT);
    NPC_REFRESH(NONE_13757_WOODCUTTER);
    HERO.AIVAR[4] = FALSE;
}

func void SQ419_WOODCUTTINGCUTSCENE_STARTDIALOGUE() {
    SQ419_WOODCUTTING = 3;
    DJG_10004_EINAR.AIVAR[92] = FALSE;
    HERO.AIVAR[4] = FALSE;
    AI_STARTSTATE(DJG_10004_EINAR, 61599, 1, "");
    AI_STARTSTATE(HERO, 61599, 1, "");
}

func void SQ419_WOODCUTTINGCUTSCENE_END() {
    FF_APPLYONCEEXT(63932, 75, 4);
}

func void SQ419_WOODCUTTINGCUTSCENE_END_APPLY() {
    var int SQ419_WOODCUTTINGCUTSCENE_END_COUNT;
    SQ419_WOODCUTTINGCUTSCENE_END_COUNT = (SQ419_WOODCUTTINGCUTSCENE_END_COUNT) + (1);
    if ((SQ419_WOODCUTTINGCUTSCENE_END_COUNT) == (4)) {
        WLD_SENDUNTRIGGER("SQ419_WOOD_01");
        WLD_SENDUNTRIGGER("SQ419_WOOD_02");
        WLD_SENDUNTRIGGER("SQ419_WOOD_03");
        WLD_SENDUNTRIGGER("SQ419_WOOD_04");
        WLD_SENDUNTRIGGER("SQ419_WOOD_05");
        WLD_SENDUNTRIGGER("SQ419_WOOD_06");
        WLD_SENDUNTRIGGER("SQ419_WOOD_07");
        DIACAM_ENABLE();
        HERO.AIVAR[4] = FALSE;
    };
}

func void SQ419_TANNINGCUTSCENE_STARTDIALOGUE() {
    SQ419_TANNING = 3;
    DJG_10004_EINAR.AIVAR[92] = FALSE;
    HERO.AIVAR[4] = FALSE;
    AI_STARTSTATE(DJG_10004_EINAR, 61599, 1, "");
    AI_STARTSTATE(HERO, 61599, 1, "");
}

func void SQ419_WOODTANNINGCUTSCENE_END() {
    FF_APPLYONCEEXT(63936, 75, 4);
}

func void SQ419_WOODTANNINGCUTSCENE_END_APPLY() {
    var int SQ419_WOODTANNINGCUTSCENE_END_COUNT;
    SQ419_WOODTANNINGCUTSCENE_END_COUNT = (SQ419_WOODTANNINGCUTSCENE_END_COUNT) + (1);
    if ((SQ419_WOODTANNINGCUTSCENE_END_COUNT) == (4)) {
        WLD_SENDUNTRIGGER("SQ419_TANNING_01");
        WLD_SENDUNTRIGGER("SQ419_TANNING_02");
        WLD_SENDUNTRIGGER("SQ419_TANNING_03");
        WLD_SENDUNTRIGGER("SQ419_TANNING_04");
        WLD_SENDUNTRIGGER("SQ419_TANNING_05");
        WLD_SENDUNTRIGGER("SQ419_TANNING_06");
        WLD_SENDUNTRIGGER("SQ419_TANNING_07");
        DIACAM_ENABLE();
        HERO.AIVAR[4] = FALSE;
    };
}

func void SQ419_FINALCUTSCENE_PREPARE() {
    HERO.AIVAR[4] = TRUE;
    FADESCREENTOBLACKF(1, 63939, 1000);
}

func void SQ419_FINALCUTSCENE_PREPARE_FADESCREEN() {
    WLD_SENDTRIGGER("SQ419_MOVER_WOLFSHEAD");
    FF_APPLYONCEEXT(63940, 75, 4);
}

func void SQ419_FINALCUTSCENE_PREPARE_APPLY() {
    var int SQ419_FINALCUTSCENE_PREPARE_COUNT;
    SQ419_FINALCUTSCENE_PREPARE_COUNT = (SQ419_FINALCUTSCENE_PREPARE_COUNT) + (1);
    if ((SQ419_FINALCUTSCENE_PREPARE_COUNT) == (4)) {
        CUTSCENE_START(92993);
        SQ419_FINALCUTSCENE_PREPARE_COUNT = 0;
    };
}

func void SQ419_FINALCUTSCENE_END() {
    FF_APPLYONCEEXT(63943, 75, 4);
}

func void SQ419_FINALCUTSCENE_END_APPLY() {
    var int SQ419_FINALCUTSCENE_END_COUNT;
    SQ419_FINALCUTSCENE_END_COUNT = (SQ419_FINALCUTSCENE_END_COUNT) + (1);
    if ((SQ419_FINALCUTSCENE_END_COUNT) == (4)) {
        SQ419_FREEUPGRADE = TRUE;
        WLD_SENDUNTRIGGER("SQ419_FINISH_01");
        WLD_SENDUNTRIGGER("SQ419_FINISH_02");
        B_STARTOTHERROUTINE(DJG_10004_EINAR, START);
        NPC_REFRESH(DJG_10004_EINAR);
        B_LOGENTRY(TOPIC_SQ419, LOG_SQ419_FINISH_V2);
        LOG_SETSTATUS(_@(MIS_SQ419), TOPIC_SQ419, LOG_SUCCESS);
        B_GIVEPLAYERXP(XP_SQ419_FINISH);
        SQ419_FINISHCHECK = TRUE;
        SQ419_FINISHCHECK_DAY = WLD_GETDAY();
        HERO.AIVAR[4] = FALSE;
    };
}

func void SQ419_REMOVELASTCART_APPLY() {
    var ZCMOVER MOVER1;
    var int MOVPTR1;
    var int SQ419_REMOVELASTCART_COUNT;
    if ((SQ419_REMOVELASTCART_COUNT) == (0)) {
        PRINTD("Rozpoczynam - SQ419_RemoveLastCart_Apply");
        MOVPTR1 = MEM_SEARCHVOBBYNAME("SQ419_MOVER_CART_02");
        MOVER1 = MEM_PTRTOINST(MOVPTR1);
        CHANGEVOBCOLLISION("SQ419_CART_02", FALSE, FALSE, FALSE, TRUE);
        WLD_SENDTRIGGER("SQ419_MOVER_CART_02");
        SQ419_REMOVELASTCART_COUNT = 1;
    };
    if (((MOVER1.MOVERSTATE) != (MOVER_STATE_OPENING)) && ((MOVER1.MOVERSTATE) != (MOVER_STATE_CLOSING))) {
        PRINTD("Skoñczy³em - SQ419_RemoveLastCart_Apply");
        CHANGEVOBCOLLISION("SQ419_CART_02", TRUE, TRUE, TRUE, TRUE);
        FF_REMOVE(63945);
        SQ419_REMOVELASTCART_COUNT = 0;
    };
}

