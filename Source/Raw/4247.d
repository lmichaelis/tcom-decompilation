instance DIA_BALUEN_EXIT(C_INFO) {
    NPC = 0xe682;
    NR = 999;
    CONDITION = DIA_BALUEN_EXIT_CONDITION;
    INFORMATION = DIA_BALUEN_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_BALUEN_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_BALUEN_EXIT_INFO() {
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_BALUEN_QM203_WHATTHE(C_INFO) {
    NPC = 0xe682;
    NR = 1;
    CONDITION = DIA_BALUEN_QM203_WHATTHE_CONDITION;
    INFORMATION = DIA_BALUEN_QM203_WHATTHE_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_BALUEN_QM203_WHATTHE_CONDITION() {
    if ((LOG_GETSTATUS(MIS_QM203)) == (LOG_RUNNING)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

var int BALUEN_QM203_WHATTHE_WHO = 0;
var int BALUEN_QM203_WHATTHE_HERE = 0;
var int BALUEN_QM203_WHATTHE_FOLLOW = 0;
var int BALUEN_QM203_WHATTHE_GOAL = 0;
var int BALUEN_QM203_WHATTHE_SOMEONE = 0;
var int BALUEN_QM203_WHATTHE_DANGEROUS = 0;
func void DIA_BALUEN_QM203_WHATTHE_DECISION() {
    INFO_CLEARCHOICES(0x15214);
    INFO_ADDCHOICE(0x15214, "Okay, I'll go with you to the workshop.", 0x15227);
    INFO_ADDCHOICE(0x15214, "The guard will take appropriate action against you.", 0x15228);
    if ((((BALUEN_QM203_WHATTHE_DANGEROUS) == (FALSE)) || ((BALUEN_QM203_WHATTHE_SOMEONE) == (FALSE))) || ((BALUEN_QM203_WHATTHE_GOAL) == (FALSE))) {
        INFO_ADDCHOICE(0x15214, "(Ask)", 0x1521d);
    };
}

func void DIA_BALUEN_QM203_WHATTHE_FOLLOW_ASK() {
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
    INFO_CLEARCHOICES(0x15214);
    if ((((BALUEN_QM203_WHATTHE_DANGEROUS) == (FALSE)) || ((BALUEN_QM203_WHATTHE_SOMEONE) == (FALSE))) || ((BALUEN_QM203_WHATTHE_GOAL) == (FALSE))) {
        INFO_ADDCHOICE(0x15214, DIALOG_BACK, 0x1521c);
        if ((BALUEN_QM203_WHATTHE_GOAL) == (FALSE)) {
            INFO_ADDCHOICE(0x15214, "What is the purpose of your research?", 0x1521f);
        };
        if ((BALUEN_QM203_WHATTHE_SOMEONE) == (FALSE)) {
            INFO_ADDCHOICE(0x15214, "Anyone helping you with your research?", 0x15220);
        };
        if ((BALUEN_QM203_WHATTHE_DANGEROUS) == (FALSE)) {
            INFO_ADDCHOICE(0x15214, "Isn't your research dangerous?", 0x15221);
        };
    };
    DIA_BALUEN_QM203_WHATTHE_DECISION();
}

func void DIA_BALUEN_QM203_WHATTHE_NEXT() {
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_WhatThe_Next_03_01");
    if (NPC_HASGUILDARMOREQUIPPED(OTHER, GIL_MIL)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_WhatThe_Next_03_02");
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_WhatThe_Next_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_WhatThe_Next_03_04");
    DIA_BALUEN_QM203_WHATTHE_DECISION();
}

func void DIA_BALUEN_QM203_WHATTHE_FOLLOW_ASK_GOAL() {
    BALUEN_QM203_WHATTHE_GOAL = TRUE;
    AI_STARTFACEANI(OTHER, S_SERIOUS, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_WhatThe_Goal_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_WhatThe_Goal_03_02");
    AI_RESETFACEANI(SELF);
    DIA_BALUEN_QM203_WHATTHE_FOLLOW_ASK();
}

func void DIA_BALUEN_QM203_WHATTHE_FOLLOW_ASK_SOMEONE() {
    BALUEN_QM203_WHATTHE_SOMEONE = TRUE;
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_WhatThe_Someone_15_01");
    AI_STARTFACEANI(SELF, S_TIRED, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_WhatThe_Someone_03_02");
    if (NPC_HASGUILDARMOREQUIPPED(OTHER, GIL_MIL)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_WhatThe_Someone_03_03");
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_WhatThe_Someone_03_04");
    AI_RESETFACEANI(SELF);
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_WhatThe_Someone_03_05");
    DIA_BALUEN_QM203_WHATTHE_FOLLOW_ASK();
}

func void DIA_BALUEN_QM203_WHATTHE_FOLLOW_ASK_DANGEROUS() {
    BALUEN_QM203_WHATTHE_DANGEROUS = TRUE;
    AI_STARTFACEANI(OTHER, S_DOUBT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_WhatThe_Dangerous_15_01");
    AI_RESETFACEANI(OTHER);
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_WhatThe_Dangerous_03_02");
    DIA_BALUEN_QM203_WHATTHE_FOLLOW_ASK();
}

func void DIA_BALUEN_QM203_WHATTHE_CHOICES() {
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
    INFO_CLEARCHOICES(0x15214);
    if ((((BALUEN_QM203_WHATTHE_WHO) == (FALSE)) || ((BALUEN_QM203_WHATTHE_HERE) == (FALSE))) || ((BALUEN_QM203_WHATTHE_FOLLOW) == (FALSE))) {
        if ((BALUEN_QM203_WHATTHE_FOLLOW) == (FALSE)) {
            INFO_ADDCHOICE(0x15214, "You followed me?", 0x15226);
        };
        if ((BALUEN_QM203_WHATTHE_WHO) == (FALSE)) {
            INFO_ADDCHOICE(0x15214, "Who are you?", 0x15224);
        };
        if ((BALUEN_QM203_WHATTHE_HERE) == (FALSE)) {
            INFO_ADDCHOICE(0x15214, "What are you doing here?", 0x15225);
        };
    };
    DIA_BALUEN_QM203_WHATTHE_NEXT();
}

func void DIA_BALUEN_QM203_WHATTHE_INFO() {
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_WhatThe_03_01");
    AI_STARTFACEANI(OTHER, S_SURPRISE, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_WhatThe_15_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_WhatThe_03_03");
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_WhatThe_15_04");
    DIA_BALUEN_QM203_WHATTHE_CHOICES();
}

func void DIA_BALUEN_QM203_WHATTHE_WHO() {
    BALUEN_QM203_WHATTHE_WHO = TRUE;
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_WhatThe_Who_15_01");
    AI_RESETFACEANI(OTHER);
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_WhatThe_Who_03_02");
    AI_STARTFACEANI(OTHER, S_SURPRISE, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_WhatThe_Who_15_03");
    AI_RESETFACEANI(OTHER);
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_WhatThe_Who_03_04");
    DIA_BALUEN_QM203_WHATTHE_CHOICES();
}

func void DIA_BALUEN_QM203_WHATTHE_HERE() {
    BALUEN_QM203_WHATTHE_HERE = TRUE;
    AI_STARTFACEANI(OTHER, S_THINK, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_WhatThe_Here_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_WhatThe_Here_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_WhatThe_Here_15_03");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_WhatThe_Here_03_04");
    DIA_BALUEN_QM203_WHATTHE_CHOICES();
}

func void DIA_BALUEN_QM203_WHATTHE_FOLLOW() {
    BALUEN_QM203_WHATTHE_FOLLOW = TRUE;
    AI_STARTFACEANI(OTHER, S_SURPRISE, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_WhatThe_Follow_15_01");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_WhatThe_Follow_03_02");
    DIA_BALUEN_QM203_WHATTHE_CHOICES();
}

func void DIA_BALUEN_QM203_WHATTHE_FOLLOW_NEXT_YES() {
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_WhatThe_Yes_15_01");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_WhatThe_Yes_03_02");
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
    QM203_OPENSEWERSGATE = 1;
    INFO_CLEARCHOICES(0x15214);
    AI_STOPPROCESSINFOS(SELF);
    SELF.AIVAR[15] = TRUE;
    NPC_EXCHANGEROUTINE(SELF, "GUIDE_BUTTON");
    AI_LOGENTRY(TOPIC_QM203, LOG_QM203_BALUEN_DECISION_V1);
}

func void DIA_BALUEN_QM203_WHATTHE_FOLLOW_NEXT_NO() {
    QM203_BALUENISDEAD = 1;
    SELF.FLAGS = 0;
    SELF.AIVAR[52] = TRUE;
    AI_STARTFACEANI(OTHER, S_ANGRY, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_WhatThe_No_15_01");
    AI_STARTFACEANI(SELF, "S_HOSTILE", 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_WhatThe_No_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_WhatThe_No_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_WhatThe_No_03_04");
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
    INFO_CLEARCHOICES(0x15214);
    AI_STOPPROCESSINFOS(SELF);
    B_ATTACK(SELF, OTHER, AR_KILL, 1);
}

instance DIA_BALUEN_QM203_QUESTIONS(C_INFO) {
    NPC = 0xe682;
    NR = 1;
    CONDITION = DIA_BALUEN_QM203_QUESTIONS_CONDITION;
    INFORMATION = DIA_BALUEN_QM203_QUESTIONS_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_BALUEN_QM203_QUESTIONS_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_QM203)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 0x15214))) && ((NPC_GETDISTTOWP(NONE_13677_BALUEN, "S2_ALCHEMY_READ")) <= (500))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_BALUEN_QM203_QUESTIONS_INFO() {
    QM203_KNOWBALUENWORKSHOPLOCATION = TRUE;
    SELF.AIVAR[15] = FALSE;
    SELF.FLAGS = 2;
    NPC_EXCHANGEROUTINE(SELF, "NORMALDAY");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_Questions_03_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_Questions_15_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_Questions_03_03");
    AI_STARTFACEANI(SELF, S_SERIOUS, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_Questions_03_04");
    AI_STARTFACEANI(SELF, S_THINK, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_Questions_03_05");
    INFO_CLEARCHOICES(0x15229);
    INFO_ADDCHOICE(0x15229, "They ran away when they saw me.", 0x15231);
    INFO_ADDCHOICE(0x15229, "Not particularly.", 0x15230);
    INFO_ADDCHOICE(0x15229, "Yes, they are very bloodthirsty beasts.", 0x1522f);
}

func void DIA_BALUEN_QM203_QUESTIONS_NEXT() {
    AI_STARTFACEANI(SELF, S_THINK, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_Questions_Next_03_01");
    INFO_CLEARCHOICES(0x15229);
    INFO_ADDCHOICE(0x15229, "They behaved the same way.", 0x15234);
    INFO_ADDCHOICE(0x15229, "They tried to scare me away.", 0x15233);
    INFO_ADDCHOICE(0x15229, "They made a formation and attacked together.", 0x15232);
}

func void DIA_BALUEN_QM203_QUESTIONS_NEXT2() {
    AI_STARTFACEANI(SELF, S_THINK, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_Questions_Next2_03_01");
    INFO_CLEARCHOICES(0x15229);
    INFO_ADDCHOICE(0x15229, "It hurts like hell.", 0x15237);
    INFO_ADDCHOICE(0x15229, "I don't actually feel anything.", 0x15236);
    INFO_ADDCHOICE(0x15229, "I don't know, they didn't bite me.", 0x15235);
}

func void DIA_BALUEN_QM203_QUESTIONS_FINISH() {
    B_GIVEPLAYERXP(XP_QM203_BALUENTEST);
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_Questions_Finish_03_01");
    INFO_CLEARCHOICES(0x15229);
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
}

func void DIA_BALUEN_QM203_QUESTIONS_ANSWER1_V1() {
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_Questions_Answer1_V1_15_01");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_Questions_Answer1_V1_03_02");
    DIA_BALUEN_QM203_QUESTIONS_NEXT();
}

func void DIA_BALUEN_QM203_QUESTIONS_ANSWER1_V2() {
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_Questions_Answer1_V2_15_01");
    AI_STARTFACEANI(SELF, S_WHAT, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_Questions_Answer1_V2_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_Questions_Answer1_V2_03_03");
    DIA_BALUEN_QM203_QUESTIONS_NEXT();
}

func void DIA_BALUEN_QM203_QUESTIONS_ANSWER1_V3() {
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_Questions_Answer1_V3_15_01");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_Questions_Answer1_V3_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_Questions_Answer1_V3_15_03");
    DIA_BALUEN_QM203_QUESTIONS_NEXT();
}

func void DIA_BALUEN_QM203_QUESTIONS_ANSWER2_V1() {
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_Questions_Answer2_V1_15_01");
    AI_STARTFACEANI(SELF, S_SURPRISE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_Questions_Answer2_V1_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_Questions_Answer2_V1_15_03");
    DIA_BALUEN_QM203_QUESTIONS_NEXT2();
}

func void DIA_BALUEN_QM203_QUESTIONS_ANSWER2_V2() {
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_Questions_Answer2_V2_15_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_Questions_Answer2_V2_15_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_Questions_Answer2_V2_03_03");
    DIA_BALUEN_QM203_QUESTIONS_NEXT2();
}

func void DIA_BALUEN_QM203_QUESTIONS_ANSWER2_V3() {
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_Questions_Answer2_V3_15_01");
    AI_STARTFACEANI(SELF, S_TIRED, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_Questions_Answer2_V3_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_Questions_Answer2_V3_15_03");
    DIA_BALUEN_QM203_QUESTIONS_NEXT2();
}

func void DIA_BALUEN_QM203_QUESTIONS_ANSWER3_V1() {
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_Questions_Answer3_V1_15_01");
    AI_STARTFACEANI(SELF, S_SAD, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_Questions_Answer3_V1_03_02");
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_Questions_Answer3_V1_15_03");
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_Questions_Answer3_V1_03_04");
    DIA_BALUEN_QM203_QUESTIONS_FINISH();
}

func void DIA_BALUEN_QM203_QUESTIONS_ANSWER3_V2() {
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_Questions_Answer3_V2_15_01");
    AI_STARTFACEANI(SELF, S_WHAT, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_Questions_Answer3_V2_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_Questions_Answer3_V2_15_03");
    AI_STARTFACEANI(SELF, S_THINK, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_Questions_Answer3_V2_03_04");
    DIA_BALUEN_QM203_QUESTIONS_FINISH();
}

func void DIA_BALUEN_QM203_QUESTIONS_ANSWER3_V3() {
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_Questions_Answer3_V3_15_01");
    AI_STARTFACEANI(SELF, S_SURPRISE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_QM203_Questions_Answer3_V3_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_QM203_Questions_Answer3_V3_15_03");
    DIA_BALUEN_QM203_QUESTIONS_FINISH();
}

instance DIA_BALUEN_AFFRAID(C_INFO) {
    NPC = 0xe682;
    NR = 1;
    CONDITION = DIA_BALUEN_AFFRAID_CONDITION;
    INFORMATION = DIA_BALUEN_AFFRAID_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Aren't you afraid the guards will find you?";
}

func int DIA_BALUEN_AFFRAID_CONDITION() {
    if (NPC_KNOWSINFO(OTHER, 0x15229)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_BALUEN_AFFRAID_INFO() {
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Baluen_Affraid_15_01");
    AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
    if (NPC_HASGUILDARMOREQUIPPED(OTHER, GIL_MIL)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Baluen_Affraid_03_02");
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Baluen_Affraid_03_03");
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
}

instance DIA_BALUEN_TRADE(C_INFO) {
    NPC = 0xe682;
    NR = 870;
    CONDITION = DIA_BALUEN_TRADE_CONDITION;
    INFORMATION = DIA_BALUEN_TRADE_INFO;
    PERMANENT = TRUE;
    TRADE = TRUE;
    DESCRIPTION = "Show me your wares.";
}

func int DIA_BALUEN_TRADE_CONDITION() {
    if (NPC_KNOWSINFO(OTHER, 0x15229)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_BALUEN_TRADE_INFO() {
    B_SAY(OTHER, SELF, "$MARVIN_LetsTrade2");
    B_GIVETRADEINV(SELF);
}

instance DIA_BALUEN_AMBIENT(C_INFO) {
    NPC = 0xe682;
    NR = 998;
    CONDITION = DIA_BALUEN_AMBIENT_CONDITION;
    INFORMATION = DIA_BALUEN_AMBIENT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "What's up?";
}

func int DIA_BALUEN_AMBIENT_CONDITION() {
    if (NPC_KNOWSINFO(OTHER, 0x15238)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_BALUEN_AMBIENT_INFO() {
    B_SAY(OTHER, SELF, "$MARVIN_HowAreYou2");
    NPC_INITAMBIENTS(SELF, 3);
    if ((NPC_GETLASTAMBIENT(SELF)) == (1)) {
        if ((NPC_HASGUILDARMOREQUIPPED(OTHER, GIL_MIL)) == (FALSE)) {
            AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
            AI_OUTPUT(SELF, OTHER, "DIA_Baluen_Ambient_03_01");
        } else {
            B_SAY(SELF, OTHER, "$IMBUSY_CALM");
        } else {
            /* set_instance(0) */;
        };
    };
    if ((NPC_GETLASTAMBIENT(SELF)) == (2)) {
        AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
        B_SAY(SELF, OTHER, "$IMBUSY_ANGRY");
    };
    if ((NPC_GETLASTAMBIENT(SELF)) == (3)) {
        AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
        B_SAY(SELF, OTHER, "$NOTNOW");
    };
    AI_RESETFACEANI(SELF);
}

instance DIA_BALUEN_PICKPOCKET(C_INFO) {
    NPC = 0xe682;
    NR = 900;
    CONDITION = DIA_BALUEN_PICKPOCKET_CONDITION;
    INFORMATION = DIA_BALUEN_PICKPOCKET_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = PICKPOCKET_120;
}

func int DIA_BALUEN_PICKPOCKET_CONDITION() {
    if (((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_PICKPOCKET)) >= (1)) && ((SELF.AIVAR[6]) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_BALUEN_PICKPOCKET_INFO() {
    INFO_CLEARCHOICES(0x15241);
    INFO_ADDCHOICE(0x15241, DIALOG_BACK, 0x15245);
    INFO_ADDCHOICE(0x15241, DIALOG_PICKPOCKET, 0x15244);
}

func void DIA_BALUEN_PICKPOCKET_DOIT() {
    if ((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_PICKPOCKET)) >= (3)) {
        B_PICKPOCKET_AMBIENT_TIER_3();
        SELF.AIVAR[6] = TRUE;
        INFO_CLEARCHOICES(0x15241);
    };
    AI_PLAYANI(HERO, T_CANNOTTAKE);
    PRINTSCREEN(PRINT_CANTPICKPOCKETTHISPERSON, -(1), -(1), FONT_SCREEN, 4);
    INFO_CLEARCHOICES(0x15241);
}

func void DIA_BALUEN_PICKPOCKET_BACK() {
    INFO_CLEARCHOICES(0x15241);
}

