instance DIA_13331_BODYGUARD_EXIT(C_INFO) {
    NPC = 0xdabd;
    NR = 999;
    CONDITION = DIA_13331_BODYGUARD_EXIT_CONDITION;
    INFORMATION = DIA_13331_BODYGUARD_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_13331_BODYGUARD_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_13331_BODYGUARD_EXIT_INFO() {
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_13331_BODYGUARD_BADENDING(C_INFO) {
    NPC = 0xdabd;
    NR = 1;
    CONDITION = DIA_13331_BODYGUARD_BADENDING_CONDITION;
    INFORMATION = DIA_13331_BODYGUARD_BADENDING_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_13331_BODYGUARD_BADENDING_CONDITION() {
    if ((TRAP23_BADEND) == (TRUE)) {
        if (((NPC_ISDEAD(BDT_13332_BANDIT)) && (NPC_ISDEAD(BDT_13333_BANDIT))) && (NPC_ISDEAD(BDT_13334_BANDIT))) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_13331_BODYGUARD_BADENDING_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_13331_Bodyguard_BadEnding_03_01");
    AI_OUTPUT(OTHER, SELF, "DIA_13331_Bodyguard_BadEnding_15_02");
    AI_OUTPUT(SELF, OTHER, "DIA_13331_Bodyguard_BadEnding_03_03");
    CREATEINVITEMS(SELF, 0x84c4, 1);
    B_GIVEINVITEMS(SELF, OTHER, 0x84c4, 1);
    NPC_EXCHANGEROUTINE(SELF, "BADEND");
    B_GIVEPLAYERXP(XP_EVENT_SAVEDTRADER_02_BAD);
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_13331_BODYGUARD_AFTEREVENT(C_INFO) {
    NPC = 0xdabd;
    NR = 2;
    CONDITION = DIA_13331_BODYGUARD_AFTEREVENT_CONDITION;
    INFORMATION = DIA_13331_BODYGUARD_AFTEREVENT_INFO;
    PERMANENT = TRUE;
    IMPORTANT = TRUE;
}

func int DIA_13331_BODYGUARD_AFTEREVENT_CONDITION() {
    if (((NPC_ISDEAD(BDT_13332_BANDIT)) && (NPC_ISDEAD(BDT_13333_BANDIT))) && (NPC_ISDEAD(BDT_13334_BANDIT))) {
        if (NPC_ISINSTATE(SELF, 0xf09f)) {
            if ((NPC_KNOWSINFO(OTHER, 0x12f60)) || (NPC_KNOWSINFO(OTHER, 0x12f54))) {
                return TRUE;
            };
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_13331_BODYGUARD_AFTEREVENT_INFO() {
    if ((TRAP23_BADEND) == (TRUE)) {
        AI_OUTPUT(SELF, OTHER, "DIA_13331_Bodyguard_AfterEvent_03_01");
    };
    AI_OUTPUT(SELF, OTHER, "DIA_13331_Bodyguard_AfterEvent_03_02");
    AI_STOPPROCESSINFOS(SELF);
}

