func void FIREPLACE_QA301_FIRE() {
    B_STARTOTHERROUTINE(SLD_11056_GRIZ, "QA301_GUARD_NOIQ");
    NPC_REFRESH(SLD_11056_GRIZ);
    QA301_USEDFIREPLACE = TRUE;
    if ((QA301_LEAVEGUILD_MOVER_05) == (FALSE)) {
        QA301_LEAVEGUILD_MOVER_05 = TRUE;
        WLD_SENDTRIGGER("KM_QA301_FIREPLACE_LIGHT");
    };
    MOB_CHANGEFOCUSNAME("KM_QA301_BONFIRE", "MOBNAME_NOTHING");
    SND_PLAY("TORCH_ENLIGHT");
    if ((QA301_FOREST) == (5)) {
        QA301_FINALCUTSCENE = TRUE;
    };
    if ((QA301_FOREST) == (4)) {
        QA301_BADCUTSCENE = TRUE;
    };
    AI_USEMOB(HERO, NPC_GETDETECTEDMOB(HERO), -(1));
}

func void FIREPLACE_STOP() {
    HERO.AIVAR[4] = FALSE;
    AI_USEMOB(HERO, NPC_GETDETECTEDMOB(HERO), -(1));
}

func void FIREPLACE_S1() {
    HER = HLP_GETNPC(0xc3ab);
    if ((HLP_GETINSTANCEID(SELF)) == (HLP_GETINSTANCEID(HER))) {
        if (HLP_STRCMP(NPC_GETNEARESTWP(HERO), "PART12_QA301_FIREPLACE")) {
            if ((QA301_USEDFIREPLACE) == (FALSE)) {
                FIREPLACE_QA301_FIRE();
            } else {
                FIREPLACE_STOP();
            };
        };
    };
}

instance FIREPLACE_S1.HER(C_NPC)
func void FIREPLACE_S0() {
    HERO.AIVAR[4] = FALSE;
    B_ENDPRODUCTIONDIALOG();
}

