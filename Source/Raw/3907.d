instance DIA_KALEB_EXIT(C_INFO) {
    NPC = 0xd51a;
    NR = 999;
    CONDITION = DIA_KALEB_EXIT_CONDITION;
    INFORMATION = DIA_KALEB_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_KALEB_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_KALEB_EXIT_INFO() {
    AI_STOPPROCESSINFOS(SELF);
    AI_RESETFACEANI(SELF);
}

var int KALEB_HELLO_AVAILABLE = 0;
var int KALEB_AMBIENT = 0;
instance DIA_KALEB_HELLO(C_INFO) {
    NPC = 0xd51a;
    NR = 2;
    CONDITION = DIA_KALEB_HELLO_CONDITION;
    INFORMATION = DIA_KALEB_HELLO_INFO;
    PERMANENT = TRUE;
    IMPORTANT = TRUE;
}

func int DIA_KALEB_HELLO_CONDITION() {
    if ((NPC_ISINSTATE(SELF, 0xf09f)) && ((KALEB_HELLO_AVAILABLE) != (1))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_KALEB_HELLO_INFO() {
    if ((NPC_KNOWSINFO(OTHER, 0x12489)) && ((KQ403_DIALOGUEWITHKALEB) != (2))) {
        AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
        AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_Hello_03_01");
    };
    if ((NPC_HASGUILDARMOREQUIPPED(OTHER, GIL_SLD)) && ((KQ403_KALEBDONE) == (0))) {
        AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
        AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_Hello_03_02");
    };
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_Hello_03_03");
    if ((KALEB_AMBIENT) == (FALSE)) {
        KALEB_AMBIENT = TRUE;
    };
}

instance DIA_KALEB_SQ218_HELLO(C_INFO) {
    NPC = 0xd51a;
    NR = 1;
    CONDITION = DIA_KALEB_SQ218_HELLO_CONDITION;
    INFORMATION = DIA_KALEB_SQ218_HELLO_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "I purchased an apartment in this area.";
}

func int DIA_KALEB_SQ218_HELLO_CONDITION() {
    if ((SQ218_WHEREISHOUSE) == (TRUE)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_KALEB_SQ218_HELLO_INFO() {
    AI_STARTFACEANI(SELF, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_SQ218_hello_15_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_SQ218_hello_15_02");
    B_GIVEINVITEMS(OTHER, SELF, 0x9114, 1);
    B_STANDUP();
    B_USEFAKESCROLL();
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_SQ218_hello_03_03");
    B_GIVEINVITEMS(SELF, OTHER, 0x9114, 1);
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_SQ218_hello_03_04");
    AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_SQ218_hello_03_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_SQ218_hello_03_06");
    KALEB_HELLO_AVAILABLE = 1;
    NPC_EXCHANGEROUTINE(SELF, "GUIDE");
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_KALEB_HELLONEIGHBOR(C_INFO) {
    NPC = 0xd51a;
    NR = 2;
    CONDITION = DIA_KALEB_HELLONEIGHBOR_CONDITION;
    INFORMATION = DIA_KALEB_HELLONEIGHBOR_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_KALEB_HELLONEIGHBOR_CONDITION() {
    if ((NPC_KNOWSINFO(OTHER, 0x12486)) && ((NPC_GETDISTTOWP(SELF, "HARBOUR_BED_01")) <= (500))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_KALEB_HELLONEIGHBOR_INFO() {
    AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_HelloNeighbor_03_01");
    AI_PLAYANI(OTHER, T_SEARCH);
    AI_STARTFACEANI(OTHER, S_SURPRISE, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_HelloNeighbor_15_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_HelloNeighbor_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_HelloNeighbor_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_HelloNeighbor_03_05");
    NPC_EXCHANGEROUTINE(SELF, START);
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
    LOG_SETSTATUS(_@(MIS_SQ218), TOPIC_SQ218, LOG_SUCCESS);
    AI_LOGENTRY(TOPIC_SQ218, LOG_SQ218_MYHOMEEND);
    B_GIVEPLAYERXP(XP_SQ218_FINISH);
    SQ218_DAYOFPAYDAY = WLD_GETDAY();
    AI_STOPPROCESSINFOS(SELF);
    KALEB_HELLO_AVAILABLE = 2;
}

instance DIA_KALEB_SQ225_GERHARD(C_INFO) {
    NPC = 0xd51a;
    NR = 1;
    CONDITION = DIA_KALEB_SQ225_GERHARD_CONDITION;
    INFORMATION = DIA_KALEB_SQ225_GERHARD_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Do you know Gerhard?";
}

func int DIA_KALEB_SQ225_GERHARD_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_SQ225)) == (LOG_RUNNING)) && ((SQ225_HOLDWIGWAY_AGREED) == (TRUE))) && ((SQ225_FOUNDGERHARD) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_KALEB_SQ225_GERHARD_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_SQ225_Gerhard_15_01");
    AI_STARTFACEANI(SELF, S_THINK, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_SQ225_Gerhard_03_02");
    AI_RESETFACEANI(SELF);
    AI_LOGENTRY(TOPIC_SQ225, LOG_SQ225_LOOKINGFORGERHARD_INN);
}

instance DIA_KALEB_KQ403_OFFER(C_INFO) {
    NPC = 0xd51a;
    NR = 1;
    CONDITION = DIA_KALEB_KQ403_OFFER_CONDITION;
    INFORMATION = DIA_KALEB_KQ403_OFFER_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "I have a serious offer for you.";
}

func int DIA_KALEB_KQ403_OFFER_CONDITION() {
    if (((LOG_GETSTATUS(MIS_KQ403)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 0x112d9))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_KALEB_KQ403_OFFER_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_Offer_15_01");
    AI_STARTFACEANI(SELF, S_SERIOUS, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Offer_03_02");
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    B_STANDUP();
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Offer_03_03");
    INFO_CLEARCHOICES(0x1248f);
    INFO_ADDCHOICE(0x1248f, "No means no then! Eat it, you old fart!", 0x12495);
    INFO_ADDCHOICE(0x1248f, "Easy, easy, easy. Why don't you at least listen to me?", 0x12493);
}

var int KQ403_KALEBANIMATION = 0;
func void DIA_KALEB_KQ403_OFFER_CALMDOWN() {
    KQ403_KALEBANIMATION = 1;
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_Offer_CalmDown_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Offer_CalmDown_03_02");
    AI_PLAYANI(SELF, T_STAND_2_LGUARD);
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Offer_CalmDown_03_03");
    INFO_ADDCHOICE(0x1248f, "Why do you hate the Merchant's Guild so much?", 0x12496);
}

func void KALEB_KQ403_REMOVEANIMATIONS() {
    if ((KQ403_KALEBANIMATION) == (1)) {
        KQ403_KALEBANIMATION = 0;
        AI_PLAYANI(SELF, T_LGUARD_2_STAND);
    };
}

func void DIA_KALEB_KQ403_OFFER_LEAVE() {
    KQ403_DIALOGUEWITHKALEB = 2;
    AI_STARTFACEANI(OTHER, S_ANGRY, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_Offer_Leave_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Offer_Leave_03_02");
    KALEB_KQ403_REMOVEANIMATIONS();
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Offer_Leave_03_03");
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
    INFO_CLEARCHOICES(0x1248f);
    AI_STOPPROCESSINFOS(SELF);
    AI_LOGENTRY(TOPIC_KQ403, LOG_KQ403_KALEB_GOAWAY);
    NPC_EXCHANGEROUTINE(SELF, START);
}

func void DIA_KALEB_KQ403_OFFER_CALMDOWN_WHY() {
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_Offer_Why_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Offer_Why_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Offer_Why_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Offer_Why_03_06");
    INFO_ADDCHOICE(0x1248f, "What specifically happened?", 0x12497);
}

func void DIA_KALEB_KQ403_OFFER_CALMDOWN_WHY_WHAT() {
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_Offer_What_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Offer_What_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Offer_What_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Offer_What_03_05");
    INFO_ADDCHOICE(0x1248f, "Are you left penniless?", 0x12498);
}

func void DIA_KALEB_KQ403_OFFER_CALMDOWN_WHY_WHAT_NOMONEY() {
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_Offer_NoMoney_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Offer_NoMoney_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_Offer_NoMoney_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Offer_NoMoney_03_04");
    INFO_ADDCHOICE(0x1248f, "I can talk to Lorenzo, maybe something can be done about your case.", 0x12499);
    INFO_ADDCHOICE(0x1248f, "The Guild will suffer! The Royal Envoy wants to seize our barracks.", 0x1249a);
}

func void DIA_KALEB_KQ403_OFFER_CALMDOWN_WHY_WHAT_NOMONEY_TALK() {
    KQ403_DIALOGUEWITHKALEB = 2;
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_Offer_Talk_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Offer_Talk_03_02");
    KALEB_KQ403_REMOVEANIMATIONS();
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Offer_Talk_03_03");
    INFO_CLEARCHOICES(0x1248f);
    AI_STOPPROCESSINFOS(SELF);
    AI_LOGENTRY(TOPIC_KQ403, LOG_KQ403_KALEB_GOAWAY);
    NPC_EXCHANGEROUTINE(SELF, START);
}

func void DIA_KALEB_KQ403_OFFER_CALMDOWN_WHY_WHAT_NOMONEY_GUILD() {
    KQ403_DIALOGUEWITHKALEB = 1;
    AI_STARTFACEANI(OTHER, S_ANGRY, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_Offer_Guild_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Offer_Guild_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_Offer_Guild_15_03");
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_Offer_Guild_15_04");
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_Offer_Guild_15_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Offer_Guild_03_06");
    KALEB_KQ403_REMOVEANIMATIONS();
    AI_RESETFACEANI(SELF);
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Offer_Guild_03_07");
    AI_RESETFACEANI(OTHER);
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_Offer_Guild_15_08");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Offer_Guild_03_09");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Offer_Guild_03_10");
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_Offer_Guild_15_11");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Offer_Guild_03_12");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Offer_Guild_03_13");
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_Offer_Guild_15_14");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Offer_Guild_03_15");
    INFO_CLEARCHOICES(0x1248f);
    AI_STOPPROCESSINFOS(SELF);
    AI_LOGENTRY(TOPIC_KQ403, LOG_KQ403_KALEB_OKAY);
    NPC_EXCHANGEROUTINE(SELF, START);
}

instance DIA_KALEB_KQ403_CASE(C_INFO) {
    NPC = 0xd51a;
    NR = 1;
    CONDITION = DIA_KALEB_KQ403_CASE_CONDITION;
    INFORMATION = DIA_KALEB_KQ403_CASE_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "As for your demands...";
}

func int DIA_KALEB_KQ403_CASE_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_KQ403)) == (LOG_RUNNING)) && ((KQ403_DIALOGUEWITHKALEB) == (1))) && ((KQ403_KALEBDONE) == (0))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_KALEB_KQ403_CASE_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_Case_15_01");
    if (((KQ403_OLAFTAVERNREADY) == (1)) && ((NPC_HASITEMS(OTHER, 0x91cd)) >= (1))) {
        KQ403_KALEBDONE = 1;
        B_GIVEINVITEMS(OTHER, SELF, 0x91cd, 1);
        B_STANDUP();
        AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_Case_15_02");
        AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_Case_15_03");
        AI_WAITTILLEND(SELF, OTHER);
        B_USEFAKESCROLL();
        AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
        AI_PLAYANI(SELF, T_STAND_2_LGUARD);
        AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Case_03_04");
        AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Case_03_06");
        AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_Case_15_07");
        AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Case_03_08");
        AI_PLAYANI(SELF, T_LGUARD_2_STAND);
        AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Case_03_09");
        AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_Case_15_10");
        AI_LOGENTRY(TOPIC_KQ403, LOG_KQ403_KALEB_GOODEND);
        INFO_CLEARCHOICES(0x1249b);
        INFO_ADDCHOICE(0x1249b, "(Go to Lorenzo)", 0x1249e);
        INFO_ADDCHOICE(0x1249b, "(Take care of other matters)", 0x1249f);
    };
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_Case_15_11");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_Case_03_12");
}

func void DIA_KALEB_KQ403_CASE_TELEPORT() {
    AI_STOPPROCESSINFOS(SELF);
    KQ403_TELEPORTTOLORENZO();
}

func void DIA_KALEB_KQ403_CASE_NORMAL() {
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_KALEB_KQ403_WHATNOW(C_INFO) {
    NPC = 0xd51a;
    NR = 1;
    CONDITION = DIA_KALEB_KQ403_WHATNOW_CONDITION;
    INFORMATION = DIA_KALEB_KQ403_WHATNOW_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_KALEB_KQ403_WHATNOW_CONDITION() {
    if (((LOG_GETSTATUS(MIS_KQ403)) == (LOG_RUNNING)) && ((KQ403_KALEBCUTSCENE) == (3))) {
        if (((NPC_GETDISTTOWP(SLD_1009_CARAMON, "HARBOUR_PATH_170")) <= (500)) && ((NPC_GETDISTTOWP(VLK_6003_KALEB, "HARBOUR_KQ403_05")) <= (500))) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_KALEB_KQ403_WHATNOW_INFO() {
    TRIA_INVITE(SLD_1009_CARAMON);
    TRIA_START();
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_WhatNow_03_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_WhatNow_15_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_WhatNow_03_03");
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_WhatNow_15_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_WhatNow_03_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_WhatNow_03_07");
    INFO_CLEARCHOICES(0x124a0);
    INFO_ADDCHOICE(0x124a0, "You know - the Guild offer is still up.", 0x124a3);
}

func void DIA_KALEB_KQ403_WHATNOW_GUILD() {
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_WhatNow_Guild_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_WhatNow_Guild_03_02");
    AI_RESETFACEANI(SELF);
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_WhatNow_Guild_03_04");
    INFO_CLEARCHOICES(0x124a0);
    INFO_ADDCHOICE(0x124a0, "I'll talk to Lorenzo. Maybe we can arrange something?", 0x124a6);
    INFO_ADDCHOICE(0x124a0, "That's your problem.", 0x124a5);
}

func void DIA_KALEB_KQ403_WHATNOW_END() {
    TRIA_FINISH();
    INFO_CLEARCHOICES(0x124a0);
    AI_STOPPROCESSINFOS(SELF);
    AI_FUNCTION(SELF, 0x124a7);
}

func void DIA_KALEB_KQ403_WHATNOW_GUILD_PROBLEM() {
    KQ403_DEALWITHKALEB = 1;
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_WhatNow_Problem_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_WhatNow_Problem_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_WhatNow_Problem_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_WhatNow_Problem_03_04");
    DIA_KALEB_KQ403_WHATNOW_END();
    AI_LOGENTRY(TOPIC_KQ403, LOG_KQ403_KALEB_NEWHOME_V1);
}

func void DIA_KALEB_KQ403_WHATNOW_GUILD_LORENZO() {
    KQ403_DEALWITHKALEB = 2;
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_WhatNow_Lorenzo_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_WhatNow_Lorenzo_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Kaleb_KQ403_WhatNow_Lorenzo_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_KQ403_WhatNow_Lorenzo_03_04");
    DIA_KALEB_KQ403_WHATNOW_END();
    AI_LOGENTRY(TOPIC_KQ403, LOG_KQ403_KALEB_NEWHOME_V2);
}

func void KALEB_KQ403_CHANGERTN() {
    NPC_EXCHANGEROUTINE(VLK_6003_KALEB, "KQ403_TAVERN");
    NPC_EXCHANGEROUTINE(SLD_1009_CARAMON, START);
}

instance DIA_KALEB_AMBIENT(C_INFO) {
    NPC = 0xd51a;
    NR = 998;
    CONDITION = DIA_KALEB_AMBIENT_CONDITION;
    INFORMATION = DIA_KALEB_AMBIENT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "How are you doing?";
}

func int DIA_KALEB_AMBIENT_CONDITION() {
    if ((KALEB_AMBIENT) == (TRUE)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_KALEB_AMBIENT_INFO() {
    B_SAY(OTHER, SELF, "$MARVIN_WhatNew4");
    if ((!(NPC_KNOWSINFO(OTHER, 0x12486))) && (!(NPC_KNOWSINFO(OTHER, 0x1248f)))) {
        AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_Ambient_03_01");
    };
    if (((NPC_KNOWSINFO(OTHER, 0x12486)) && (!(NPC_KNOWSINFO(OTHER, 0x12489)))) && (!(NPC_KNOWSINFO(OTHER, 0x1248f)))) {
        AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_Ambient_03_02");
    };
    if ((NPC_KNOWSINFO(OTHER, 0x12489)) && (!(NPC_KNOWSINFO(OTHER, 0x1248f)))) {
        AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_Ambient_03_03");
    };
    if ((NPC_KNOWSINFO(OTHER, 0x1248f)) && (!(NPC_KNOWSINFO(OTHER, 0x124a0)))) {
        AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_Ambient_03_04");
    };
    if (NPC_KNOWSINFO(OTHER, 0x124a0)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Kaleb_Ambient_03_05");
    };
}

instance DIA_KALEB_TRADE(C_INFO) {
    NPC = 0xd51a;
    NR = 800;
    CONDITION = DIA_KALEB_TRADE_CONDITION;
    INFORMATION = DIA_KALEB_TRADE_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "Show me your wares.";
    TRADE = TRUE;
}

func int DIA_KALEB_TRADE_CONDITION() {
    return TRUE;
}

func void DIA_KALEB_TRADE_INFO() {
    B_SAY(OTHER, SELF, "$MARVIN_LetsTrade");
    B_GIVETRADEINV(SELF);
}

instance DIA_KALEB_PICKPOCKET(C_INFO) {
    NPC = 0xd51a;
    NR = 900;
    CONDITION = DIA_KALEB_PICKPOCKET_CONDITION;
    INFORMATION = DIA_KALEB_PICKPOCKET_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = PICKPOCKET_80;
}

func int DIA_KALEB_PICKPOCKET_CONDITION() {
    if (((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_PICKPOCKET)) >= (1)) && ((SELF.AIVAR[6]) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_KALEB_PICKPOCKET_INFO() {
    INFO_CLEARCHOICES(0x124ae);
    INFO_ADDCHOICE(0x124ae, DIALOG_BACK, 0x124b2);
    INFO_ADDCHOICE(0x124ae, DIALOG_PICKPOCKET, 0x124b1);
}

func void DIA_KALEB_PICKPOCKET_DOIT() {
    if ((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_PICKPOCKET)) >= (2)) {
        CREATEINVITEMS(SELF, 0x8d28, 1);
        B_GIVEINVITEMS(SELF, OTHER, 0x8d28, 1);
        B_PICKPOCKET_AMBIENT_TIER_2();
        SELF.AIVAR[6] = TRUE;
        INFO_CLEARCHOICES(0x124ae);
    };
    AI_PLAYANI(HERO, T_CANNOTTAKE);
    PRINTSCREEN(PRINT_CANTPICKPOCKETTHISPERSON, -(1), -(1), FONT_SCREEN, 4);
    INFO_CLEARCHOICES(0x124ae);
}

func void DIA_KALEB_PICKPOCKET_BACK() {
    INFO_CLEARCHOICES(0x124ae);
}

