instance CITY_NOENTERYCUTSCENE(CUTSCENE) {
    ONSTART = FUNCTION(0x1688c);
}

func void CITY_NOENTERYCUTSCENE_START() {
    HERO.FLAGS = 0;
    MDL_APPLYOVERLAYMDS(MIL_6371_DUSTER, "HUMANS_CROSSBOW_DIALOGUE.mds");
    WLD_SENDTRIGGER("CITYNOENTRY_01");
    NPC_CLEARAIQUEUE(MIL_6371_DUSTER);
    TELEPORTNPCTOWP(0xd499, MIL_6371_DUSTER.WP);
    FF_APPLYONCEEXT(0x1688d, 1000, 2);
}

func void CITY_NOENTERYCUTSCENE_APPLY() {
    CITY_NOENTERYCUTSCENE_COUNT = (CITY_NOENTERYCUTSCENE_COUNT) + (1);
    if ((CITY_NOENTERYCUTSCENE_COUNT) == (2)) {
        PRINTD("Duster rusz siê");
        NPC_CLEARAIQUEUE(MIL_6371_DUSTER);
        CREATEINVITEMS(MIL_6371_DUSTER, 0x9060, 1);
        AI_USEITEMTOSTATE(MIL_6371_DUSTER, 0x9060, 1);
        AI_WAIT(MIL_6371_DUSTER, 0x40000000);
        MDL_STARTFACEANI(MIL_6371_DUSTER, S_ANGRY, 0x3f800000, -1082130432);
        AI_USEITEMTOSTATE(MIL_6371_DUSTER, 0x9060, -(1));
        AI_READYRANGEDWEAPON(MIL_6371_DUSTER);
        AI_FUNCTION(MIL_6371_DUSTER, 0x1688f);
        AI_PLAYANI(MIL_6371_DUSTER, "T_CROSSBOW_SHOOT");
        AI_WAIT(MIL_6371_DUSTER, 0x3e99999a);
        AI_FUNCTION(MIL_6371_DUSTER, 0x16890);
    };
}

var int CITY_NOENTERYCUTSCENE_APPLY.CITY_NOENTERYCUTSCENE_COUNT = 0;
func void CITY_NOENTERYCUTSCENE_SND() {
    MDL_STARTFACEANI(MIL_6371_DUSTER, "VISEME", 0x3f800000, -1082130432);
    SND_PLAY("ALARM_DUSTER");
}

func void CITY_NOENTERYCUTSCENE_END() {
    WLD_SENDUNTRIGGER("CITYNOENTRY_01");
    HERO.ATTRIBUTE[1] = -(1);
    HERO.ATTRIBUTE[0] = -(1);
    HERO.AIVAR[4] = FALSE;
}

