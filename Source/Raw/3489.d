func void SQ414_SPAWNGHOST() {
    WLD_INSERTNPC(0xdb6b, "PART6_TOWERGHOST_01");
    WLD_PLAYEFFECT("FX_EarthQuake", NONE_7000_GHOST, NONE_7000_GHOST, 0, 0, 0, FALSE);
    WLD_PLAYEFFECT("spellFX_INCOVATION_RED", NONE_7000_GHOST, NONE_7000_GHOST, 0, 0, 0, FALSE);
    TELEPORTNPCTOWP(0xe3d3, "PART6_TOWERGHOST_02");
    NPC_CLEARAIQUEUE(DJG_13329_TONAN);
    AI_TURNTONPC(DJG_13329_TONAN, HERO);
}

func void SQ414_FINISHQUEST() {
    LOG_SETSTATUS(_@(MIS_SQ414), TOPIC_SQ414, LOG_SUCCESS);
    B_GIVEPLAYERXP(XP_SQ414_FINISH);
}

func void SQ414_REMOVEGHOST() {
    TELEPORTNPCTOWP(0xdb6b, TOT);
    WLD_PLAYEFFECT("FX_EarthQuake", NONE_7000_GHOST, NONE_7000_GHOST, 0, 0, 0, FALSE);
    WLD_PLAYEFFECT("spellFX_INCOVATION_RED", NONE_7000_GHOST, NONE_7000_GHOST, 0, 0, 0, FALSE);
    B_LOGENTRY(TOPIC_SQ414, LOG_SQ414_GHOST_AFTERFIGHT);
    SQ414_FINISHQUEST();
}

func void SQ414_SECRETCHURCH_APPLY() {
    if ((SQ414_SECRETCHURCH_COUNT) == (0)) {
        PRINTD("Rozpoczynam - SQ414_SecretChurch_Apply");
        MOVPTR1 = MEM_SEARCHVOBBYNAME("SQ414_MOVER_TARGET");
        MOVER1 = MEM_PTRTOINST(MOVPTR1);
        CHANGEVOBCOLLISION("SQ414_TRIGGER", FALSE, FALSE, FALSE, FALSE);
        WLD_SENDTRIGGER("SQ414_MOVER_TARGET");
        SQ414_SECRETCHURCH_COUNT = 1;
    };
    if (((MOVER1.MOVERSTATE) != (MOVER_STATE_OPENING)) && ((MOVER1.MOVERSTATE) != (MOVER_STATE_CLOSING))) {
        PRINTD("Skoñczy³em - SQ414_SecretChurch_Apply");
        CHANGEVOBCOLLISION("SQ414_TRIGGER", TRUE, TRUE, TRUE, FALSE);
        FF_REMOVE(0xf43e);
        SQ414_SECRETCHURCH_COUNT = 0;
    };
}

var int SQ414_SECRETCHURCH_APPLY.SQ414_SECRETCHURCH_COUNT = 0;
instance SQ414_SECRETCHURCH_APPLY.MOVER1(ZCMOVER)
var int SQ414_SECRETCHURCH_APPLY.MOVPTR1 = 0;
