func void ITEMIMPORTANTFLAG_CHECKSELLINGITEMS() {
    HER = HLP_GETNPC(0x71b);
    NPC = _^(MEM_INFORMATIONMAN.NPC);
    ITM = _^(LIST_GETS(HER.INVENTORY2_OCITEMCONTAINER_CONTENTS, (HER.INVENTORY2_OCITEMCONTAINER_SELECTEDITEM) + (2)));
    if (((ITM.FLAGS) & (ITEM_IMPORTANT)) == (ITEM_IMPORTANT)) {
        NPC_STARTANIMATION(HERO, T_CANNOTTAKE);
        MEMORYPROTECTIONOVERRIDE((OCVIEWDIALOGTRADE__ONTRANSFERLEFT) + (6), 4);
        MEM_WRITEBYTE((OCVIEWDIALOGTRADE__ONTRANSFERLEFT) + (6), 195);
    };
    MEMORYPROTECTIONOVERRIDE((OCVIEWDIALOGTRADE__ONTRANSFERLEFT) + (6), 4);
    MEM_WRITEBYTE((OCVIEWDIALOGTRADE__ONTRANSFERLEFT) + (6), 106);
}

instance ITEMIMPORTANTFLAG_CHECKSELLINGITEMS.HER(OCNPC)
instance ITEMIMPORTANTFLAG_CHECKSELLINGITEMS.NPC(OCNPC)
instance ITEMIMPORTANTFLAG_CHECKSELLINGITEMS.ITM(OCITEM)
func void TELEMETRY_ONTRADELEFTHOOK() {
    ITM = _^(EBX);
    NPC = _^(MEM_INFORMATIONMAN.NPC);
    TELEMETRY_PLAYERSELL(NPC.INSTANZ, ITM.INSTANZ, 1);
}

instance TELEMETRY_ONTRADELEFTHOOK.ITM(OCITEM)
instance TELEMETRY_ONTRADELEFTHOOK.NPC(OCNPC)
func void TELEMETRY_ONTRADERIGHTHOOK() {
    ITM = _^(EBX);
    NPC = _^(MEM_INFORMATIONMAN.NPC);
    TELEMETRY_PLAYERBUY(NPC.INSTANZ, ITM.INSTANZ, 1);
}

instance TELEMETRY_ONTRADERIGHTHOOK.ITM(OCITEM)
instance TELEMETRY_ONTRADERIGHTHOOK.NPC(OCNPC)
func void INIT_ITEMIMPORTANTFLAG() {
    HOOKENGINEF(OCVIEWDIALOGTRADE__ONTRANSFERLEFTX, 6, 0x53c5);
    HOOKENGINEF(OCVIEWDIALOGTRADE__ONTRANSFERRIGHTX, 6, 0x53c8);
    HOOKENGINEF(OCVIEWDIALOGTRADE__ONTRANSFERLEFT, 6, 0x53c1);
}

