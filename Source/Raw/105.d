func void SCALETIME(var int X) {
    WORLD_TIMER = MEM_TIMER.FRAMETIMEFLOAT;
    ACCELERATION = FRACF(X, 100);
    WORLD_TIMER = MULF(WORLD_TIMER, SUBF(ACCELERATION, MKF(1)));
    MEM_WORLDTIMER.WORLDTIME = ADDF(MEM_WORLDTIMER.WORLDTIME, WORLD_TIMER);
}

var int SCALETIME.WORLD_TIMER = 0;
var int SCALETIME.ACCELERATION = 0;
func int CONVERTTOTIMETICKS(var int H, var int M) {
    TPHF = MKF(OCWORLDTIMER_TICKSPERHOUR);
    TPMF = DIVF(TPHF, MKF(60));
    T = MULF(MKF(H), TPHF);
    T = ADDF(T, MULF(MKF(M), TPMF));
    return T;
}

var int CONVERTTOTIMETICKS.TPHF = 0;
var int CONVERTTOTIMETICKS.TPMF = 0;
var int CONVERTTOTIMETICKS.T = 0;
var int TIMETOSTOPWHEN = 0;
func void STOPTIMEATHOURFF() {
    MEM_WORLDTIMER.WORLDTIME = TIMETOSTOPWHEN;
}

func void STOPTIMEATHOUR(var int H, var int M) {
    TIMETOSTOPWHEN = CONVERTTOTIMETICKS(H, M);
    FF_APPLY(0x5249);
}

func void RESUMETIME() {
    FF_REMOVE(0x5249);
}

var int CLOCKSPEED = 0;
func void CLOCKSPEEDFF() {
    SCALETIME(CLOCKSPEED);
}

func void CHANGETIMESPEED(var int X) {
    CLOCKSPEED = X;
    if ((CLOCKSPEED) != (100)) {
        FF_APPLY(0x524f);
    };
    FF_REMOVE(0x524f);
}

