instance QA301_BADENDING(CUTSCENE) {
    ONSTART = FUNCTION(0x16a62);
}

func void QA301_BADENDING_START() {
    WLD_SENDTRIGGER("KM_QA301_04");
    HERO.AIVAR[4] = TRUE;
    SLD_11056_GRIZ.AIVAR[4] = TRUE;
    QA301_BLOOD();
    QA301_LEAVEGUILD_MOVER_01 = TRUE;
    TELEPORTNPCTOWP(0x71b, "PART12_QA301_FIREPLACE");
    TELEPORTNPCTOWP(0xe16a, "PART12_PATH_107");
    NPC_CLEARAIQUEUE(SLD_11056_GRIZ);
    B_CLEARPERCEPTIONS(SLD_11056_GRIZ);
    AI_WAIT(SLD_11056_GRIZ, 0x40400000);
    AI_WAIT(HERO, 0x3f800000);
    AI_PLAYANI(HERO, "R_STRETCH_RANDOM_01");
    AI_WAIT(HERO, 0x3f800000);
    AI_TURNTONPC(HERO, SLD_11056_GRIZ);
    AI_WAIT(HERO, 0x3f800000);
    AI_FUNCTION(HERO, 0x16a63);
    AI_WAIT(HERO, 0x3fc00000);
    AI_PLAYANI(HERO, R_SCRATCHHEAD);
    AI_WAIT(HERO, 0x3f000000);
    AI_FUNCTION(HERO, 0x16a64);
    AI_WAIT(HERO, 0x3f800000);
    AI_STARTFACEANI(HERO, S_SERIOUS, 1, -(1));
    AI_WAIT(HERO, 0x3fc00000);
    AI_FUNCTION(HERO, 0x16a65);
}

func void QA301_BADENDING_CHANGECAMERA_01() {
    QA301_SPAWNSHADOWBEAST();
    WLD_SENDTRIGGER("KM_QA301_05");
    WLD_SENDUNTRIGGER("KM_QA301_04");
    TELEPORTNPCTOWP(0xe16a, "PART12_FOREST_QA301_SCAVENGER");
    B_KILLNPC(0xe16a);
}

func void QA301_BADENDING_CHANGECAMERA_02() {
    WLD_SENDTRIGGER("KM_QA301_06");
    WLD_SENDUNTRIGGER("KM_QA301_05");
}

func void QA301_BADENDING_END() {
    WLD_SENDUNTRIGGER("KM_QA301_06");
    QA301_BADCUTSCENE = 3;
    B_LOGENTRY(TOPIC_QA301, LOG_QA301_NOTHINGHAPPEND);
    HERO.AIVAR[4] = FALSE;
}

