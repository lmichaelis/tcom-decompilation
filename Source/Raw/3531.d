func void Q506_PREPARESCENE() {
    FF_APPLYONCEEXTGT(0xf745, 0, -(1));
    B_STARTOTHERROUTINE(MIL_6371_DUSTER, "Q506_WAIT");
    NPC_REFRESH(MIL_6371_DUSTER);
    TELEPORTNPCTOWP(0xd499, MIL_6371_DUSTER.WP);
    Q506_DUSTER_RTNCHECK = 1;
    B_STARTOTHERROUTINE(MIL_13752_MILITIA, "Q506_WAIT");
    NPC_REFRESH(MIL_13752_MILITIA);
    TELEPORTNPCTOWP(0xd54a, MIL_13752_MILITIA.WP);
    WLD_INSERTNPC(0xda28, "PART4_PATH_Q506_GUARD_01");
    WLD_INSERTNPC(0xda2b, "PART4_PATH_Q506_GUARD_02");
}

func void Q506_PREPARESCENE_APPLY() {
    if ((Q506_PREPARESCENE_COUNT) == (0)) {
        PRINTD("Rozpoczynam - Q506_PrepareScene_Count");
        MOVPTR1 = MEM_SEARCHVOBBYNAME("Q506_MOVER_DUSTERSCENE");
        MOVER1 = MEM_PTRTOINST(MOVPTR1);
        CHANGEVOBCOLLISION("Q506_TREE_01", FALSE, FALSE, FALSE, FALSE);
        CHANGEVOBCOLLISION("Q506_TREE_02", FALSE, FALSE, FALSE, FALSE);
        CHANGEVOBCOLLISION("Q506_LADDER", FALSE, FALSE, FALSE, FALSE);
        WLD_SENDTRIGGER("Q506_MOVER_DUSTERSCENE");
        Q506_PREPARESCENE_COUNT = 1;
    };
    if (((MOVER1.MOVERSTATE) != (MOVER_STATE_OPENING)) && ((MOVER1.MOVERSTATE) != (MOVER_STATE_CLOSING))) {
        PRINTD("Skoñczy³em - Q506_PrepareScene_Count");
        CHANGEVOBCOLLISION("Q506_LADDER", TRUE, TRUE, TRUE, TRUE);
        FF_REMOVE(0xf745);
        Q506_PREPARESCENE_COUNT = 0;
    };
}

var int Q506_PREPARESCENE_APPLY.Q506_PREPARESCENE_COUNT = 0;
instance Q506_PREPARESCENE_APPLY.MOVER1(ZCMOVER)
var int Q506_PREPARESCENE_APPLY.MOVPTR1 = 0;
func void Q506_REMOVEPATH() {
    PRINTD("Usuwam drogê");
    Q506_REMOVEPATHCHECK = 2;
    B_REMOVENPC(0xda28);
    B_STARTOTHERROUTINE(MIL_13751_MILITIA, "SCARED");
    NPC_REFRESH(MIL_13751_MILITIA);
    TELEPORTNPCTOWP(0xda2b, MIL_13751_MILITIA.WP);
    FF_APPLYONCEEXTGT(0xf74a, 0, -(1));
    WLD_INSERTNPC(0xeb90, "FP_ROAM_PART4_ORC_01");
    WLD_INSERTNPC(0xeb90, "FP_ROAM_PART4_ORC_02");
}

func void Q506_REMOVEPATH_APPLY() {
    CHANGEVOBCOLLISION("Q506_LEAFS_01", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q506_LEAFS_02", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q506_LEAFS_03", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q506_LEAFS_04", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q506_LEAFS_05", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q506_LEAFS_06", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q506_TREE_03", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q506_LADDER", FALSE, FALSE, FALSE, FALSE);
    WLD_SENDTRIGGER("Q506_STONES");
    WLD_SENDTRIGGER("Q506_TREEBANCH");
    WLD_SENDTRIGGER("Q506_BARREL_02");
    WLD_SENDTRIGGER("Q506_BARREL_02");
    WLD_SENDTRIGGER("Q506_MOVER_DUSTERSCENE");
    FF_REMOVE(0xf74a);
}

func void Q506_BARRELSPOT_PREPARE() {
    WLD_SENDTRIGGER("Q506_MOVER_BARRELSPOT_01");
    WLD_SENDTRIGGER("Q506_MOVER_BARRELSPOT_02");
}

