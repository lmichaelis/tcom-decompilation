func void SQ509_SPAWNSCAVENGERS() {
    SQ509_SPAWNEVENTS = 1;
    WLD_INSERTNPC(0xc628, "FP_ROAM_PART3_157");
    WLD_INSERTNPC(0xc629, "FP_ROAM_PART3_158");
    WLD_INSERTNPC(0xc62a, "FP_ROAM_PART3_159");
    WLD_INSERTNPC(0xc62b, "FP_ROAM_PART9_118");
    WLD_INSERTNPC(0xc62c, "FP_ROAM_PART9_119");
    WLD_INSERTNPC(0xc62d, "FP_ROAM_PART9_120");
    WLD_INSERTNPC(0xc62e, "FP_ROAM_PART9_121");
    WLD_INSERTNPC(0xc62f, "FP_ROAM_PART9_122");
    WLD_INSERTNPC(0xc630, "FP_ROAM_PART9_123");
    WLD_INSERTNPC(0xc631, "FP_ROAM_PART3_160");
    WLD_INSERTNPC(0xc632, "FP_ROAM_PART3_161");
    WLD_INSERTNPC(0xc633, "FP_ROAM_PART3_162");
    WLD_INSERTNPC(0xc634, "FP_ROAM_PART3_163");
    WLD_INSERTNPC(0xc635, "FP_ROAM_PART3_164");
    WLD_INSERTITEM(0x9265, "FP_ROAM_BODOWINSCAVENGER_01");
    WLD_INSERTITEM(0x9265, "FP_ROAM_BODOWINSCAVENGER_02");
    WLD_INSERTITEM(0x9265, "FP_ROAM_BODOWINSCAVENGER_03");
    WLD_INSERTITEM(0x9269, "FP_SQ509_POTION_01");
    WLD_INSERTITEM(0x926b, "FP_SQ509_POTION_02");
    WLD_INSERTITEM(0x9271, "FP_SQ509_POTION_03");
    MOB_CREATEITEMS("BODOWIN_SHELF_01", 0x9273, 1);
    MOB_CREATEITEMS("BODOWIN_SHELF_02", 0x9276, 1);
    MOB_CREATEITEMS("BODOWIN_SHELF_03", 0x927a, 1);
}

func void SQ509_PREPARESCENE() {
    B_STARTOTHERROUTINE(NONE_6262_CARDEN, "SQ509_SMALLTALK");
    NPC_REFRESH(NONE_6262_CARDEN);
    TELEPORTNPCTOWP(0xe162, NONE_6262_CARDEN.WP);
    B_STARTOTHERROUTINE(KDW_303_RIEROL, "SQ509_SMALLTALK");
    NPC_REFRESH(KDW_303_RIEROL);
    TELEPORTNPCTOWP(0xdd4a, KDW_303_RIEROL.WP);
    B_STARTOTHERROUTINE(VLK_2261_BODOWIN, TOT);
    NPC_REFRESH(VLK_2261_BODOWIN);
    TELEPORTNPCTOWP(0xd9ed, VLK_2261_BODOWIN.WP);
    FF_APPLYONCEEXTGT(0xb7ba, 0, -(1));
}

func void SQ509_PREPARESCAVENGERS() {
    SQ509_SPAWNSCAVENGERS();
    FF_APPLYONCEEXTGT(0xb7c2, 0, -(1));
}

func void SQ509_PREPARESCENE_APPLY() {
    if ((SQ509_PREPARESCENE_COUNT) == (0)) {
        PRINTD("Rozpoczynam - SQ509_PrepareScene_Apply");
        MOVPTR1 = MEM_SEARCHVOBBYNAME("SQ509_MOVER_DEADSCAVENGERS");
        MOVER1 = MEM_PTRTOINST(MOVPTR1);
        CHANGEVOBCOLLISION("SQ509_CART", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("SQ509_SCAVENGERCORPSE_01", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("SQ509_SCAVENGERCORPSE_02", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("SQ509_SCAVENGERCORPSE_03", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("SQ509_SCAVENGERCORPSE_04", FALSE, FALSE, FALSE, TRUE);
        WLD_SENDTRIGGER("SQ509_MOVER_DEADSCAVENGERS");
        SQ509_PREPARESCENE_COUNT = 1;
    };
    if (((MOVER1.MOVERSTATE) != (MOVER_STATE_OPENING)) && ((MOVER1.MOVERSTATE) != (MOVER_STATE_CLOSING))) {
        PRINTD("Skoñczy³em - SQ509_PrepareScene_Apply");
        CHANGEVOBCOLLISION("SQ509_CART", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("SQ509_SCAVENGERCORPSE_01", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("SQ509_SCAVENGERCORPSE_02", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("SQ509_SCAVENGERCORPSE_03", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("SQ509_SCAVENGERCORPSE_04", TRUE, TRUE, TRUE, TRUE);
        FF_REMOVE(0xb7ba);
        SQ509_PREPARESCENE_COUNT = 0;
    };
}

var int SQ509_PREPARESCENE_APPLY.SQ509_PREPARESCENE_COUNT = 0;
instance SQ509_PREPARESCENE_APPLY.MOVER1(ZCMOVER)
var int SQ509_PREPARESCENE_APPLY.MOVPTR1 = 0;
func int SQ509_SCAVENGERSAREDEAD_CITY() {
    if (((NPC_ISDEAD(SCAVENGER_SQ509_CITY_01)) && (NPC_ISDEAD(SCAVENGER_SQ509_CITY_02))) && (NPC_ISDEAD(SCAVENGER_SQ509_CITY_03))) {
        return TRUE;
    };
    return FALSE;
}

func int SQ509_SCAVENGERSAREDEAD_VILLAGE() {
    if (((NPC_ISDEAD(SCAVENGER_SQ509_VILLAGE_01)) && (NPC_ISDEAD(SCAVENGER_SQ509_VILLAGE_02))) && (NPC_ISDEAD(SCAVENGER_SQ509_VILLAGE_03))) {
        return TRUE;
    };
    return FALSE;
}

func int SQ509_SCAVENGERSAREDEAD_VINEYARD() {
    if (((NPC_ISDEAD(SCAVENGER_SQ509_VINEYARD_01)) && (NPC_ISDEAD(SCAVENGER_SQ509_VINEYARD_02))) && (NPC_ISDEAD(SCAVENGER_SQ509_VINEYARD_03))) {
        return TRUE;
    };
    return FALSE;
}

func int SQ509_SCAVENGERSAREDEAD_BODOWIN() {
    if (((((NPC_ISDEAD(SCAVENGER_SQ509_BODOWIN_01)) && (NPC_ISDEAD(SCAVENGER_SQ509_BODOWIN_02))) && (NPC_ISDEAD(SCAVENGER_SQ509_BODOWIN_03))) && (NPC_ISDEAD(SCAVENGER_SQ509_BODOWIN_04))) && (NPC_ISDEAD(SCAVENGER_SQ509_BODOWIN_05))) {
        return TRUE;
    };
    return FALSE;
}

func void SQ509_PREPARESCAVENGERS_APPLY() {
    if ((SQ509_PREPARESCAVENGERS_COUNT) == (0)) {
        PRINTD("Rozpoczynam - SQ509_PrepareScavengers_Apply");
        MOVPTR1 = MEM_SEARCHVOBBYNAME("SQ509_MOVER_BURDNEDTRAVELER");
        MOVER1 = MEM_PTRTOINST(MOVPTR1);
        MOVPTR2 = MEM_SEARCHVOBBYNAME("KM_BODOWIN_DOOR_MOVER_01");
        MOVER2 = MEM_PTRTOINST(MOVPTR2);
        MOVPTR3 = MEM_SEARCHVOBBYNAME("KM_BODOWIN_DOOR_MOVER_03");
        MOVER3 = MEM_PTRTOINST(MOVPTR3);
        MOVPTR4 = MEM_SEARCHVOBBYNAME("SQ509_MOVER_SCAVENGER");
        MOVER4 = MEM_PTRTOINST(MOVPTR4);
        MOVPTR5 = MEM_SEARCHVOBBYNAME("SQ509_MOVER_BOOKSTANDS_01");
        MOVER5 = MEM_PTRTOINST(MOVPTR5);
        MOVPTR6 = MEM_SEARCHVOBBYNAME("SQ509_MOVER_BOOKSTANDS_02");
        MOVER6 = MEM_PTRTOINST(MOVPTR6);
        MOVPTR7 = MEM_SEARCHVOBBYNAME("SQ509_MOVER_LEACORPSE");
        MOVER7 = MEM_PTRTOINST(MOVPTR7);
        MOVPTR8 = MEM_SEARCHVOBBYNAME("SQ509_MOVER_FARMERCORPSE");
        MOVER8 = MEM_PTRTOINST(MOVPTR8);
        CHANGEVOBCOLLISION("SQ509_BURDNEDTRAVELER", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("SQ509_DEADSCAVENGER_01", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("SQ509_DEADSCAVENGER_02", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("KM_BODOWINDOOR_PERMOPEN", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("KM_BODOWINDOOR_LOCKPICK", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("SQ509_SCAVENGER_BODOWINHOUSE", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("SQ509_BOOKSTANDS_01", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("SQ509_BOOKSTANDS_02", FALSE, FALSE, FALSE, TRUE);
        if ((LOG_GETSTATUS(MIS_Q107)) == (LOG_SUCCESS)) {
            CHANGEVOBCOLLISION("SQ509_LEACORPSE", FALSE, FALSE, FALSE, TRUE);
        } else {
            CHANGEVOBCOLLISION("SQ509_FARMERCORPSE", FALSE, FALSE, FALSE, TRUE);
        } else {
            WLD_SENDTRIGGER("SQ509_MOVER_BURDNEDTRAVELER");
        } else {
            WLD_SENDTRIGGER("KM_BODOWIN_DOOR_MOVER_01");
        } else {
            WLD_SENDTRIGGER("KM_BODOWIN_DOOR_MOVER_03");
        } else {
            WLD_SENDTRIGGER("SQ509_MOVER_SCAVENGER");
        } else {
            WLD_SENDTRIGGER("SQ509_MOVER_BOOKSTANDS_01");
        } else {
            WLD_SENDTRIGGER("SQ509_MOVER_BOOKSTANDS_02");
        } else if ((LOG_GETSTATUS(MIS_Q107)) == (LOG_SUCCESS)) {
            WLD_SENDTRIGGER("SQ509_MOVER_LEACORPSE");
        } else {
            WLD_SENDTRIGGER("SQ509_MOVER_FARMERCORPSE");
        } else {
            SQ509_PREPARESCAVENGERS_COUNT = 1;
        } else {
            /* set_instance(0) */;
        };
    };
    if (((((((((((((((((MOVER1.MOVERSTATE) != (MOVER_STATE_OPENING)) && ((MOVER1.MOVERSTATE) != (MOVER_STATE_CLOSING))) && ((MOVER2.MOVERSTATE) != (MOVER_STATE_OPENING))) && ((MOVER2.MOVERSTATE) != (MOVER_STATE_CLOSING))) && ((MOVER3.MOVERSTATE) != (MOVER_STATE_OPENING))) && ((MOVER3.MOVERSTATE) != (MOVER_STATE_CLOSING))) && ((MOVER4.MOVERSTATE) != (MOVER_STATE_OPENING))) && ((MOVER4.MOVERSTATE) != (MOVER_STATE_CLOSING))) && ((MOVER5.MOVERSTATE) != (MOVER_STATE_OPENING))) && ((MOVER5.MOVERSTATE) != (MOVER_STATE_CLOSING))) && ((MOVER6.MOVERSTATE) != (MOVER_STATE_OPENING))) && ((MOVER6.MOVERSTATE) != (MOVER_STATE_CLOSING))) && ((MOVER7.MOVERSTATE) != (MOVER_STATE_OPENING))) && ((MOVER7.MOVERSTATE) != (MOVER_STATE_CLOSING))) && ((MOVER8.MOVERSTATE) != (MOVER_STATE_OPENING))) && ((MOVER8.MOVERSTATE) != (MOVER_STATE_CLOSING))) {
        PRINTD("Skoñczy³em - SQ509_PrepareScavengers_Apply");
        CHANGEVOBCOLLISION("SQ509_BURDNEDTRAVELER", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("SQ509_DEADSCAVENGER_01", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("SQ509_DEADSCAVENGER_02", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("KM_BODOWINDOOR_PERMOPEN", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("KM_BODOWINDOOR_LOCKPICK", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("SQ509_SCAVENGER_BODOWINHOUSE", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("SQ509_BOOKSTANDS_01", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("SQ509_BOOKSTANDS_02", TRUE, TRUE, TRUE, TRUE);
        if ((LOG_GETSTATUS(MIS_Q107)) == (LOG_SUCCESS)) {
            CHANGEVOBCOLLISION("SQ509_LEACORPSE", TRUE, TRUE, TRUE, TRUE);
        } else {
            CHANGEVOBCOLLISION("SQ509_FARMERCORPSE", TRUE, TRUE, TRUE, TRUE);
        } else {
            FF_REMOVE(0xb7c2);
        } else {
            SQ509_PREPARESCAVENGERS_COUNT = 0;
        };
    };
}

var int SQ509_PREPARESCAVENGERS_APPLY.SQ509_PREPARESCAVENGERS_COUNT = 0;
instance SQ509_PREPARESCAVENGERS_APPLY.MOVER1(ZCMOVER)
instance SQ509_PREPARESCAVENGERS_APPLY.MOVER2(ZCMOVER)
instance SQ509_PREPARESCAVENGERS_APPLY.MOVER3(ZCMOVER)
instance SQ509_PREPARESCAVENGERS_APPLY.MOVER4(ZCMOVER)
instance SQ509_PREPARESCAVENGERS_APPLY.MOVER5(ZCMOVER)
instance SQ509_PREPARESCAVENGERS_APPLY.MOVER6(ZCMOVER)
instance SQ509_PREPARESCAVENGERS_APPLY.MOVER7(ZCMOVER)
instance SQ509_PREPARESCAVENGERS_APPLY.MOVER8(ZCMOVER)
var int SQ509_PREPARESCAVENGERS_APPLY.MOVPTR1 = 0;
var int SQ509_PREPARESCAVENGERS_APPLY.MOVPTR2 = 0;
var int SQ509_PREPARESCAVENGERS_APPLY.MOVPTR3 = 0;
var int SQ509_PREPARESCAVENGERS_APPLY.MOVPTR4 = 0;
var int SQ509_PREPARESCAVENGERS_APPLY.MOVPTR5 = 0;
var int SQ509_PREPARESCAVENGERS_APPLY.MOVPTR6 = 0;
var int SQ509_PREPARESCAVENGERS_APPLY.MOVPTR7 = 0;
var int SQ509_PREPARESCAVENGERS_APPLY.MOVPTR8 = 0;
func void SQ509_PREPAREBODOWIN() {
    B_STARTOTHERROUTINE(VLK_2261_BODOWIN, "SQ509_WAIT");
    NPC_REFRESH(VLK_2261_BODOWIN);
    TELEPORTNPCTOWP(0xd9ed, VLK_2261_BODOWIN.WP);
    WLD_SENDTRIGGER("SQ509_MOVER_TRIGGERBOX");
}

func void SQ509_BODOWINPOWERTIMER() {
    SQ509_BODOWINPOWERTIMER_COUNT = (SQ509_BODOWINPOWERTIMER_COUNT) + (1);
    if ((SQ509_BODOWINPOWERTIMER_COUNT) == (15)) {
        SQ509_POTIONINUSE = 2;
        B_SETATTRIBUTESTOLEVEL(VLK_2261_BODOWIN, 45);
        B_LOGENTRY(TOPIC_SQ509, LOG_SQ509_CANFIGHTAGAIN);
    };
}

var int SQ509_BODOWINPOWERTIMER.SQ509_BODOWINPOWERTIMER_COUNT = 0;
func void BODOWIN_SQ509_GIVEREWARD() {
    SELF.FLAGS = 2;
    B_GIVEINVITEMS(SELF, OTHER, 0x8647, 1);
}

func void SQ509_FINISHQUEST() {
    SQ509_FINISHQUESTSTATUS = 1;
    B_STARTOTHERROUTINE(NONE_6262_CARDEN, "MONASTERY");
    NPC_REFRESH(NONE_6262_CARDEN);
    NPC_EXCHANGEROUTINE(KDW_303_RIEROL, START);
    FF_APPLYONCEEXTGT(0xb7c2, 0, -(1));
    if (HLP_ISVALIDNPC(VLK_2261_BODOWIN)) {
        B_REMOVENPC(0xd9ed);
    };
    HERO.AIVAR[4] = FALSE;
}

