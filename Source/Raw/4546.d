instance HAVEN_NOENTERYCUTSCENE(CUTSCENE) {
    ONSTART = FUNCTION(0x168a2);
}

func void HAVEN_NOENTERYCUTSCENE_START() {
    HERO.FLAGS = 0;
    MDL_APPLYOVERLAYMDS(PIR_13556_PIRATE, "HUMANS_CROSSBOW_DIALOGUE.mds");
    WLD_SENDTRIGGER("HAVENNOENTRY_01");
    NPC_CLEARAIQUEUE(PIR_13556_PIRATE);
    TELEPORTNPCTOWP(0xe60f, PIR_13556_PIRATE.WP);
    FF_APPLYONCEEXT(0x168a3, 1000, 2);
}

func void HAVEN_NOENTERYCUTSCENE_APPLY() {
    HAVEN_NOENTERYCUTSCENE_COUNT = (HAVEN_NOENTERYCUTSCENE_COUNT) + (1);
    if ((HAVEN_NOENTERYCUTSCENE_COUNT) == (2)) {
        PRINTD("Piracie rusz siê");
        NPC_CLEARAIQUEUE(PIR_13556_PIRATE);
        CREATEINVITEMS(PIR_13556_PIRATE, 0x9060, 1);
        AI_USEITEMTOSTATE(PIR_13556_PIRATE, 0x9060, 1);
        AI_WAIT(PIR_13556_PIRATE, 0x40000000);
        MDL_STARTFACEANI(PIR_13556_PIRATE, S_ANGRY, 0x3f800000, -1082130432);
        AI_USEITEMTOSTATE(PIR_13556_PIRATE, 0x9060, -(1));
        AI_READYRANGEDWEAPON(PIR_13556_PIRATE);
        AI_FUNCTION(PIR_13556_PIRATE, 0x168a5);
        AI_PLAYANI(PIR_13556_PIRATE, "T_CROSSBOW_SHOOT");
        AI_WAIT(PIR_13556_PIRATE, 0x3e99999a);
        AI_FUNCTION(PIR_13556_PIRATE, 0x168a6);
    };
}

var int HAVEN_NOENTERYCUTSCENE_APPLY.HAVEN_NOENTERYCUTSCENE_COUNT = 0;
func void HAVEN_NOENTERYCUTSCENE_SND() {
    MDL_STARTFACEANI(PIR_13556_PIRATE, "VISEME", 0x3f800000, -1082130432);
    SND_PLAY("ALARM_PIRATE");
}

func void HAVEN_NOENTERYCUTSCENE_END() {
    WLD_SENDUNTRIGGER("HAVENNOENTRY_01");
    HERO.ATTRIBUTE[1] = -(1);
    HERO.ATTRIBUTE[0] = -(1);
    HERO.AIVAR[4] = FALSE;
}

