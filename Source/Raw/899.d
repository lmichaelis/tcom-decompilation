func void COALSAW_WORK() {
    if ((((LOG_GETSTATUS(MIS_SQ101)) == (LOG_RUNNING)) && ((SQ101_WOODFROMSAW) == (FALSE))) && ((SQ101_ICANSAWBYMYSELF) == (TRUE))) {
        FADESCREENTOBLACKF(1, 0xbd98, 1000);
    };
    if ((KNUT_REGULARWORK) == (1)) {
        FADESCREENTOBLACKF(1, 0xbd99, 1000);
    };
}

func void COALSAW_STOP() {
    HERO.AIVAR[4] = FALSE;
    AI_USEMOB(HERO, NPC_GETDETECTEDMOB(HERO), -(1));
    AI_OUTPUT(HERO, HERO, "DIA_MARVIN_CANTDOIT_15_01");
}

func void SQ221_WORK() {
    FADESCREENTOBLACKF(1, 0xbd9a, 1000);
}

func void COALSAW_KNUT_CHECKSTR() {
    if ((HERO.ATTRIBUTE[4]) >= (20)) {
        COALSAW_WORK();
    };
    COALSAW_STOP();
}

func void COALSAW_S1() {
    HER = HLP_GETNPC(0xc3ab);
    if ((HLP_GETINSTANCEID(SELF)) == (HLP_GETINSTANCEID(HER))) {
        if (((((HLP_STRCMP(NPC_GETNEARESTWP(HERO), "PART11_WOODCUTTERS_LOB01")) || (HLP_STRCMP(NPC_GETNEARESTWP(HERO), "PART11_WOODCUTTERS_LOB02"))) || (HLP_STRCMP(NPC_GETNEARESTWP(HERO), "PART11_WOODCUTTERS_LOB03"))) || (HLP_STRCMP(NPC_GETNEARESTWP(HERO), "PART11_WOODCUTTERS_LOB04"))) || (HLP_STRCMP(NPC_GETNEARESTWP(HERO), "PART11_WOODCUTTERS_LOB05"))) {
            COALSAW_KNUT_CHECKSTR();
        } else if ((HLP_STRCMP(NPC_GETNEARESTWP(HERO), "VILLAGE_HOUSE_11_SAW_01")) || (HLP_STRCMP(NPC_GETNEARESTWP(HERO), "VILLAGE_HOUSE_11_SAW_02"))) {
            if ((LOG_GETSTATUS(MIS_SQ221)) == (LOG_RUNNING)) {
                if ((SQ221_UWE_WORK) == (1)) {
                    SQ221_WORK();
                };
            };
        };
    };
}

instance COALSAW_S1.HER(C_NPC)
func void PC_USESAW_FADESCREEN_QUITWORKING() {
    HERO.AIVAR[4] = FALSE;
    AI_USEMOB(HERO, NPC_GETDETECTEDMOB(HERO), -(1));
    FADESCREENFROMBLACK(1);
}

func void PC_USESAW_FADESCREEN_BACK() {
    SQ101_WOODFROMSAW = TRUE;
    B_PASSTIME(5);
    CREATEINVITEMS(HERO, 0x90c4, 5);
    B_LOGENTRY(TOPIC_SQ101, LOG_SQ101_KNUT_WOODREADY);
    PC_USESAW_FADESCREEN_QUITWORKING();
}

func void PC_USESAW_QUESTKNUT_FADESCREEN_BACK() {
    KNUT_REGULARWORK = 2;
    B_PASSTIME(5);
    CREATEINVITEMS(HERO, 0x90c4, 40);
    PC_USESAW_FADESCREEN_QUITWORKING();
}

func void SQ221_WORK_FADESCREEN() {
    B_PASSTIME(5);
    SQ221_UWE_WORK = 2;
    PC_USESAW_FADESCREEN_QUITWORKING();
}

func void COALSAW_S0() {
    HERO.AIVAR[4] = FALSE;
    B_ENDPRODUCTIONDIALOG();
}

