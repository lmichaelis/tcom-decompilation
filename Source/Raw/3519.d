func void QM201_TELEPORTNPC() {
    if ((NPC_ISDEAD(VLK_13371_GIRL)) == (FALSE)) {
        NPC_REFRESH(VLK_13371_GIRL);
        B_STARTOTHERROUTINE(VLK_13371_GIRL, TOT);
        TELEPORTNPCTOWP(0xd3aa, VLK_13371_GIRL.WP);
    };
    if ((NPC_ISDEAD(VLK_13379_GIRL)) == (FALSE)) {
        NPC_REFRESH(VLK_13379_GIRL);
        B_STARTOTHERROUTINE(VLK_13379_GIRL, TOT);
        TELEPORTNPCTOWP(0xd3be, VLK_13379_GIRL.WP);
    };
    if ((NPC_ISDEAD(VLK_6089_GUY)) == (FALSE)) {
        NPC_REFRESH(VLK_6089_GUY);
        B_STARTOTHERROUTINE(VLK_6089_GUY, TOT);
        TELEPORTNPCTOWP(0xd456, VLK_6089_GUY.WP);
    };
    if ((NPC_ISDEAD(VLK_6091_GUY)) == (FALSE)) {
        NPC_REFRESH(VLK_6091_GUY);
        B_STARTOTHERROUTINE(VLK_6091_GUY, TOT);
        TELEPORTNPCTOWP(0xd45c, VLK_6091_GUY.WP);
    };
    if ((NPC_ISDEAD(MIL_4014_GUARD)) == (FALSE)) {
        NPC_REFRESH(MIL_4014_GUARD);
        B_STARTOTHERROUTINE(MIL_4014_GUARD, TOT);
        TELEPORTNPCTOWP(0xd655, MIL_4014_GUARD.WP);
    };
    if ((NPC_ISDEAD(MIL_4008_HARBGUARD)) == (FALSE)) {
        NPC_REFRESH(MIL_4008_HARBGUARD);
        B_STARTOTHERROUTINE(MIL_4008_HARBGUARD, TOT);
        TELEPORTNPCTOWP(0xd368, MIL_4008_HARBGUARD.WP);
    };
    if ((NPC_ISDEAD(MIL_4009_HARBGUARD)) == (FALSE)) {
        NPC_REFRESH(MIL_4009_HARBGUARD);
        B_STARTOTHERROUTINE(MIL_4009_HARBGUARD, TOT);
        TELEPORTNPCTOWP(0xd36c, MIL_4009_HARBGUARD.WP);
    };
    if ((NPC_ISDEAD(VLK_6060_MYSTERIOUSMAN)) == (FALSE)) {
        NPC_REFRESH(VLK_6060_MYSTERIOUSMAN);
        B_STARTOTHERROUTINE(VLK_6060_MYSTERIOUSMAN, TOT);
        TELEPORTNPCTOWP(0xd72d, VLK_6060_MYSTERIOUSMAN.WP);
    };
}

func void QM201_SPAWNNPC() {
    WLD_INSERTNPC(0xd282, TOT);
    WLD_INSERTNPC(0xd2bf, TOT);
    WLD_INSERTNPC(0xd2c2, TOT);
    WLD_INSERTNPC(0xd2c5, TOT);
    WLD_INSERTNPC(0xd2c8, TOT);
    WLD_INSERTNPC(0xd2cb, TOT);
}

func void QM201_WAITCUTSCENEENABLE() {
    FF_APPLYONCEEXT(0xf5fa, 75, 4);
}

func void QM201_WAITCUTSCENEENABLE_APPLY() {
    QM201_WAITCUTSCENEENABLE_COUNT = (QM201_WAITCUTSCENEENABLE_COUNT) + (1);
    if ((QM201_WAITCUTSCENEENABLE_COUNT) == (4)) {
        CUTSCENE_START(0x16a95);
    };
}

var int QM201_WAITCUTSCENEENABLE_APPLY.QM201_WAITCUTSCENEENABLE_COUNT = 0;
func void QM201_WAITCUTSCENEEND() {
    FF_APPLYONCEEXT(0xf5fd, 75, 4);
}

func void QM201_WAITCUTSCENEEND_APPLY() {
    QM201_WAITCUTSCENEEND_COUNT = (QM201_WAITCUTSCENEEND_COUNT) + (1);
    if ((QM201_WAITCUTSCENEEND_COUNT) == (4)) {
        QM201_CUTSCENEFINISH = TRUE;
        MIL_13583_MILITIA.AIVAR[15] = TRUE;
        MIL_4016_WEGAR.AIVAR[15] = TRUE;
        NONE_13584_PRISONER.AIVAR[15] = TRUE;
        NONE_13585_THUG.GUILD = GIL_BDT;
        NPC_SETTRUEGUILD(NONE_13585_THUG, GIL_BDT);
        NONE_13586_THUG.GUILD = GIL_BDT;
        NPC_SETTRUEGUILD(NONE_13586_THUG, GIL_BDT);
        NONE_13587_THUG.GUILD = GIL_BDT;
        NPC_SETTRUEGUILD(NONE_13587_THUG, GIL_BDT);
        WLD_SENDUNTRIGGER("QM201_WAIT_01");
        WLD_SENDUNTRIGGER("QM201_WAIT_02");
        WLD_SENDUNTRIGGER("QM201_WAIT_03");
        WLD_SENDUNTRIGGER("QM201_WAIT_04");
        WLD_SENDUNTRIGGER("QM201_WAIT_05");
        WLD_SENDUNTRIGGER("QM201_WAIT_06");
        WLD_SENDUNTRIGGER("QM201_WAIT_07");
        HERO.AIVAR[4] = FALSE;
    };
}

var int QM201_WAITCUTSCENEEND_APPLY.QM201_WAITCUTSCENEEND_COUNT = 0;
func void QM201_TELEPORTLEADER() {
    NPC_REFRESH(NONE_13588_THUG);
    B_STARTOTHERROUTINE(NONE_13588_THUG, START);
    TELEPORTNPCTOWP(0xd2cb, NONE_13588_THUG.WP);
}

func void QM201_REMOVEMILITIA() {
    if ((NPC_ISDEAD(NONE_13588_THUG)) == (FALSE)) {
        B_REMOVENPC(0xd2cb);
    };
    if ((NPC_ISDEAD(MIL_13583_MILITIA)) == (FALSE)) {
        B_REMOVENPC(0xd282);
    };
    if ((NPC_ISDEAD(NONE_13584_PRISONER)) == (FALSE)) {
        B_REMOVENPC(0xd2bf);
    };
}

func void QM201_REMOVENPC() {
    if ((NPC_ISDEAD(VLK_13371_GIRL)) == (FALSE)) {
        NPC_REFRESH(VLK_13371_GIRL);
        B_STARTOTHERROUTINE(VLK_13371_GIRL, START);
        TELEPORTNPCTOWP(0xd3aa, VLK_13371_GIRL.WP);
    };
    if ((NPC_ISDEAD(VLK_13379_GIRL)) == (FALSE)) {
        NPC_REFRESH(VLK_13379_GIRL);
        B_STARTOTHERROUTINE(VLK_13379_GIRL, START);
        TELEPORTNPCTOWP(0xd3be, VLK_13379_GIRL.WP);
    };
    if ((NPC_ISDEAD(VLK_6089_GUY)) == (FALSE)) {
        NPC_REFRESH(VLK_6089_GUY);
        B_STARTOTHERROUTINE(VLK_6089_GUY, START);
        TELEPORTNPCTOWP(0xd456, VLK_6089_GUY.WP);
    };
    if ((NPC_ISDEAD(VLK_6091_GUY)) == (FALSE)) {
        NPC_REFRESH(VLK_6091_GUY);
        B_STARTOTHERROUTINE(VLK_6091_GUY, START);
        TELEPORTNPCTOWP(0xd45c, VLK_6091_GUY.WP);
    };
    if ((NPC_ISDEAD(MIL_4014_GUARD)) == (FALSE)) {
        NPC_REFRESH(MIL_4014_GUARD);
        B_STARTOTHERROUTINE(MIL_4014_GUARD, START);
        TELEPORTNPCTOWP(0xd655, MIL_4014_GUARD.WP);
    };
    if ((NPC_ISDEAD(MIL_4008_HARBGUARD)) == (FALSE)) {
        NPC_REFRESH(MIL_4008_HARBGUARD);
        B_STARTOTHERROUTINE(MIL_4008_HARBGUARD, START);
        TELEPORTNPCTOWP(0xd368, MIL_4008_HARBGUARD.WP);
    };
    if ((NPC_ISDEAD(MIL_4009_HARBGUARD)) == (FALSE)) {
        NPC_REFRESH(MIL_4009_HARBGUARD);
        B_STARTOTHERROUTINE(MIL_4009_HARBGUARD, START);
        TELEPORTNPCTOWP(0xd36c, MIL_4009_HARBGUARD.WP);
    };
}

func void QM201_WEIGARPROMOTION() {
    QM201_FINISHQUEST = TRUE;
    QM201_FINISHQUEST_DAY = WLD_GETDAY();
    NPC = HLP_GETNPC(0x71b);
    NPCPTR = _@(0xf603);
    FF_APPLYEXTDATAGT(0xf605, 75, -(1), NPCPTR);
}

instance QM201_WEIGARPROMOTION.NPC(C_NPC)
var int QM201_WEIGARPROMOTION.NPCPTR = 0;
func void QM201_WEIGARPROMOTION_APPLY() {
    if ((CURRENTLEVEL) == (ARCHOLOS_ZEN)) {
        if ((((NPC_GETDISTTONPC(HERO, MIL_4016_WEGAR)) >= (0x9c4)) && ((QM201_FINISHQUEST) == (TRUE))) && ((QM201_FINISHQUEST_DAY) <= ((WLD_GETDAY()) - (1)))) {
            QM201_FINISHQUEST = 2;
            PRINTD("Awansujê Weigara");
            FF_REMOVE(0xf605);
            NPC_REFRESH(MIL_4016_WEGAR);
            B_STARTOTHERROUTINE(MIL_4016_WEGAR, "MasterCrossbow");
            TELEPORTNPCTOWP(0xce6f, MIL_4016_WEGAR.WP);
            NPC_CHANGEARMOR(MIL_4016_WEGAR, 0x8aaa);
            NPC_REMOVEINVITEMS(MIL_4016_WEGAR, 0x8aa5, 1);
            B_SETATTRIBUTESTOCHAPTER(MIL_4016_WEGAR, 4);
            CREATEINVITEMS(MIL_4016_WEGAR, 0x9b36, 20);
            QM201_REMOVENPC();
        } else {
            PRINTD("Oddal siê od Weigara + przeczekaj dzieñ to go awansujê");
        } else {
            /* set_instance(0) */;
        };
    };
    if (((CURRENTLEVEL) == (ARCHOLOS_ENDGAME_ZEN)) || ((CURRENTLEVEL) == (ARCHOLOS_VOLFZACKE_ZEN))) {
        PRINTD("I tak nie zobaczysz efektów");
        FF_REMOVE(0xf605);
    };
    PRINTD("Mogê funkcjê wykonaæ tylko w zenie Archolos! - QM201_WeigarPromotion_Apply");
}

