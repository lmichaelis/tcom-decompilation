func void QM402_PREPARENPC() {
    WLD_INSERTNPC(0xd7ee, "SLUMS_BRAZIER_QM402_STAND");
    WLD_INSERTNPC(0xd7f1, "SLUMS_BRAZIER_QM402_STAND");
    WLD_INSERTNPC(0xd7f4, "SLUMS_BRAZIER_QM402_STAND");
    WLD_INSERTNPC(0xd7f7, "SLUMS_BRAZIER_QM402_STAND");
    WLD_INSERTNPC(0xd7fa, "SLUMS_BRAZIER_QM402_STAND");
    WLD_INSERTNPC(0xd7fd, "SLUMS_BRAZIER_QM402_STAND");
    WLD_INSERTNPC(0xd559, "HARBOUR_QM402_REFUGEE_01");
    WLD_INSERTNPC(0xd55f, "HARBOUR_QM402_REFUGEE_01");
    WLD_INSERTNPC(0xd565, "HARBOUR_QM402_REFUGEE_01");
    WLD_INSERTNPC(0xd56b, "HARBOUR_QM402_REFUGEE_01");
}

func void QM402_SPAWNSOUTHERNER() {
    QM402_SOUTHERENCUTSCENEENABLE = 1;
    WLD_INSERTNPC(0xcf37, "PARTM3_QM402_SOUTHERNER_06");
    WLD_INSERTNPC(0xcf39, "PARTM3_QM402_SOUTHERNER_06");
    WLD_INSERTNPC(0xcf3b, "PARTM3_QM402_SOUTHERNER_06");
    WLD_INSERTNPC(0xcf3d, "PARTM3_QM402_SOUTHERNER_06");
    WLD_INSERTNPC(0xcf3f, "PARTM3_QM402_SOUTHERNER_06");
    WLD_INSERTNPC(0xcf41, "PARTM3_QM402_SOUTHERNER_06");
}

func void QM402_WEIGARSLUMSCUTSCENE_APPLY() {
    QM402_WEIGARSLUMSCUTSCENE_COUNT = (QM402_WEIGARSLUMSCUTSCENE_COUNT) + (1);
    if ((QM402_WEIGARSLUMSCUTSCENE_COUNT) == (4)) {
        CUTSCENE_START(0x16ab3);
    };
}

var int QM402_WEIGARSLUMSCUTSCENE_APPLY.QM402_WEIGARSLUMSCUTSCENE_COUNT = 0;
func void QM402_WEIGARSLUMSCUTSCENE_DISABLE() {
    QM402_WEIGARSLUMSCUTSCENE_DISABLECOUNT = (QM402_WEIGARSLUMSCUTSCENE_DISABLECOUNT) + (1);
    if ((QM402_WEIGARSLUMSCUTSCENE_DISABLECOUNT) == (4)) {
        QM402_GOONPATORL = 4;
        WLD_SENDUNTRIGGER("QM402_WEGAR_01");
        WLD_SENDUNTRIGGER("QM402_WEGAR_02");
        WLD_SENDUNTRIGGER("QM402_WEGAR_03");
        NPC_REFRESH(MIL_4016_WEGAR);
        MIL_4016_WEGAR.AIVAR[92] = FALSE;
        QM402_WEIGAR_RTNCHECK = 2;
        B_STARTOTHERROUTINE(MIL_4016_WEGAR, "QM402_GUIDE_ADANOS");
        NPC_REFRESH(MIL_4016_WEGAR);
        HERO.AIVAR[4] = FALSE;
    };
}

var int QM402_WEIGARSLUMSCUTSCENE_DISABLE.QM402_WEIGARSLUMSCUTSCENE_DISABLECOUNT = 0;
func void QM402_SOUTHERENCUTSCENE_APPLY() {
    QM402_SOUTHERENCUTSCENE_COUNT = (QM402_SOUTHERENCUTSCENE_COUNT) + (1);
    if ((QM402_SOUTHERENCUTSCENE_COUNT) == (4)) {
        CUTSCENE_START(0x16aad);
    };
}

var int QM402_SOUTHERENCUTSCENE_APPLY.QM402_SOUTHERENCUTSCENE_COUNT = 0;
func void QM402_REFUGEEGOAWAY() {
    B_STARTOTHERROUTINE(NONE_13598_REFUGEE, "QM402_WAIT");
    NPC_REFRESH(NONE_13598_REFUGEE);
    B_STARTOTHERROUTINE(NONE_13599_REFUGEE, "QM402_WAIT");
    NPC_REFRESH(NONE_13599_REFUGEE);
    B_STARTOTHERROUTINE(NONE_13600_REFUGEE, "QM402_WAIT");
    NPC_REFRESH(NONE_13600_REFUGEE);
    B_STARTOTHERROUTINE(NONE_13601_REFUGEE, "QM402_WAIT");
    NPC_REFRESH(NONE_13601_REFUGEE);
}

func void QM402_FIGHTWITHSOUTHEREN() {
    NPC_REFRESH(NONE_13606_SOUTHERNER);
    NPC_SETTRUEGUILD(NONE_13606_SOUTHERNER, GIL_BDT);
    NONE_13606_SOUTHERNER.GUILD = GIL_BDT;
    NONE_13606_SOUTHERNER.FLAGS = 0;
    NPC_REFRESH(NONE_13607_SOUTHERNER);
    NPC_SETTRUEGUILD(NONE_13607_SOUTHERNER, GIL_BDT);
    NONE_13607_SOUTHERNER.GUILD = GIL_BDT;
    NONE_13607_SOUTHERNER.FLAGS = 0;
    NPC_REFRESH(NONE_13608_SOUTHERNER);
    NPC_SETTRUEGUILD(NONE_13608_SOUTHERNER, GIL_BDT);
    NONE_13608_SOUTHERNER.GUILD = GIL_BDT;
    NONE_13608_SOUTHERNER.FLAGS = 0;
    NPC_REFRESH(NONE_13609_SOUTHERNER);
    NPC_SETTRUEGUILD(NONE_13609_SOUTHERNER, GIL_BDT);
    NONE_13609_SOUTHERNER.GUILD = GIL_BDT;
    NONE_13609_SOUTHERNER.FLAGS = 0;
    NPC_REFRESH(NONE_13610_SOUTHERNER);
    NPC_SETTRUEGUILD(NONE_13610_SOUTHERNER, GIL_BDT);
    NONE_13610_SOUTHERNER.GUILD = GIL_BDT;
    NONE_13610_SOUTHERNER.FLAGS = 0;
    NPC_REFRESH(NONE_13611_SOUTHERNER);
    NPC_SETTRUEGUILD(NONE_13611_SOUTHERNER, GIL_BDT);
    NONE_13611_SOUTHERNER.GUILD = GIL_BDT;
    NONE_13611_SOUTHERNER.FLAGS = 0;
    if ((QM402_HELPEDREFUGEE) == (TRUE)) {
        B_STARTOTHERROUTINE(NONE_13598_REFUGEE, "QM402_BEFOREFIGHT");
        NPC_REFRESH(NONE_13598_REFUGEE);
        TELEPORTNPCTOWP(0xd559, NONE_13598_REFUGEE.WP);
        NONE_13598_REFUGEE.FLAGS = 0;
        B_STARTOTHERROUTINE(NONE_13599_REFUGEE, "QM402_BEFOREFIGHT");
        NPC_REFRESH(NONE_13599_REFUGEE);
        TELEPORTNPCTOWP(0xd55f, NONE_13599_REFUGEE.WP);
        B_STARTOTHERROUTINE(NONE_13600_REFUGEE, "QM402_BEFOREFIGHT");
        NPC_REFRESH(NONE_13600_REFUGEE);
        TELEPORTNPCTOWP(0xd565, NONE_13600_REFUGEE.WP);
        NONE_13600_REFUGEE.FLAGS = 0;
        B_STARTOTHERROUTINE(NONE_13601_REFUGEE, "QM402_BEFOREFIGHT");
        NPC_REFRESH(NONE_13601_REFUGEE);
        TELEPORTNPCTOWP(0xd56b, NONE_13601_REFUGEE.WP);
        NONE_13601_REFUGEE.FLAGS = 0;
    };
    B_REMOVENPC(0xd559);
    B_REMOVENPC(0xd55f);
    B_REMOVENPC(0xd565);
    B_REMOVENPC(0xd56b);
}

func void QM402_SOUTHERENCUTSCENE_DISABLE() {
    QM402_SOUTHERENCUTSCENE_DISABLECOUNT = (QM402_SOUTHERENCUTSCENE_DISABLECOUNT) + (1);
    if ((QM402_SOUTHERENCUTSCENE_DISABLECOUNT) == (4)) {
        QM402_SOUTHERENCUTSCENEENABLE = 3;
        QM402_SOUTHERNERFIGHT = 1;
        WLD_SENDUNTRIGGER("QM402_SOUTHERNER_01");
        WLD_SENDUNTRIGGER("QM402_SOUTHERNER_02");
        WLD_SENDUNTRIGGER("QM402_SOUTHERNER_03");
        NPC_REFRESH(MIL_4016_WEGAR);
        MIL_4016_WEGAR.AIVAR[92] = FALSE;
        NONE_13611_SOUTHERNER.AIVAR[92] = FALSE;
        QM402_FIGHTWITHSOUTHEREN();
        QM402_WEIGAR_RTNCHECK = 5;
        B_STARTOTHERROUTINE(MIL_4016_WEGAR, "QM402_GUIDE_BARRACK_FIGHT");
        NPC_REFRESH(MIL_4016_WEGAR);
        HERO.AIVAR[4] = FALSE;
    };
}

var int QM402_SOUTHERENCUTSCENE_DISABLE.QM402_SOUTHERENCUTSCENE_DISABLECOUNT = 0;
func int QM402_SOUTHERNERAREDEAD() {
    if ((((((NPC_ISDEAD(NONE_13606_SOUTHERNER)) && (NPC_ISDEAD(NONE_13607_SOUTHERNER))) && (NPC_ISDEAD(NONE_13608_SOUTHERNER))) && (NPC_ISDEAD(NONE_13609_SOUTHERNER))) && (NPC_ISDEAD(NONE_13610_SOUTHERNER))) && (NPC_ISDEAD(NONE_13611_SOUTHERNER))) {
        return TRUE;
    };
    return FALSE;
}

func void QM402_REFUGEEGOAWAY_TOT() {
    B_STARTOTHERROUTINE(NONE_13598_REFUGEE, TOT);
    NPC_REFRESH(NONE_13598_REFUGEE);
    NPC_EXCHANGEROUTINE(NONE_13599_REFUGEE, TOT);
    B_STARTOTHERROUTINE(NONE_13600_REFUGEE, TOT);
    NPC_REFRESH(NONE_13600_REFUGEE);
    B_STARTOTHERROUTINE(NONE_13601_REFUGEE, TOT);
    NPC_REFRESH(NONE_13601_REFUGEE);
}

func void QM402_REMOVENPC() {
    if (HLP_ISVALIDNPC(NONE_13597_HOBO)) {
        if ((NPC_ISDEAD(NONE_13597_HOBO)) == (FALSE)) {
            B_REMOVENPC(0xd7ee);
        };
    };
    if (HLP_ISVALIDNPC(NONE_13614_HOBO)) {
        if ((NPC_ISDEAD(NONE_13614_HOBO)) == (FALSE)) {
            B_REMOVENPC(0xd7f1);
        };
    };
    if (HLP_ISVALIDNPC(NONE_13615_HOBO)) {
        if ((NPC_ISDEAD(NONE_13615_HOBO)) == (FALSE)) {
            B_REMOVENPC(0xd7f4);
        };
    };
    if (HLP_ISVALIDNPC(NONE_13616_HOBO)) {
        if ((NPC_ISDEAD(NONE_13616_HOBO)) == (FALSE)) {
            B_REMOVENPC(0xd7f7);
        };
    };
    if (HLP_ISVALIDNPC(NONE_13617_HOBO)) {
        if ((NPC_ISDEAD(NONE_13617_HOBO)) == (FALSE)) {
            B_REMOVENPC(0xd7fa);
        };
    };
    if (HLP_ISVALIDNPC(NONE_13618_HOBO)) {
        if ((NPC_ISDEAD(NONE_13618_HOBO)) == (FALSE)) {
            B_REMOVENPC(0xd7fd);
        };
    };
    if (HLP_ISVALIDNPC(NONE_13598_REFUGEE)) {
        if ((NPC_ISDEAD(NONE_13598_REFUGEE)) == (FALSE)) {
            B_REMOVENPC(0xd559);
        };
    };
    if (HLP_ISVALIDNPC(NONE_13599_REFUGEE)) {
        if ((NPC_ISDEAD(NONE_13599_REFUGEE)) == (FALSE)) {
            B_REMOVENPC(0xd55f);
        };
    };
    if (HLP_ISVALIDNPC(NONE_13600_REFUGEE)) {
        if ((NPC_ISDEAD(NONE_13600_REFUGEE)) == (FALSE)) {
            B_REMOVENPC(0xd565);
        };
    };
    if (HLP_ISVALIDNPC(NONE_13601_REFUGEE)) {
        if ((NPC_ISDEAD(NONE_13601_REFUGEE)) == (FALSE)) {
            B_REMOVENPC(0xd56b);
        };
    };
}

