instance SQ508_KILLCUTSCENE(CUTSCENE) {
    ONSTART = FUNCTION(0x16b5e);
}

func void SQ508_KILLCUTSCENE_WAIT() {
    AI_WAITTILLEND(NONE_6239_CASPAR, HERO);
    AI_WAITTILLEND(NONE_6239_CASPAR, PAL_100_CANDAC);
    AI_WAITTILLEND(PAL_100_CANDAC, HERO);
    AI_WAITTILLEND(PAL_100_CANDAC, NONE_6239_CASPAR);
    AI_WAITTILLEND(HERO, NONE_6239_CASPAR);
    AI_WAITTILLEND(HERO, PAL_100_CANDAC);
}

func void SQ508_KILLCUTSCENE_START() {
    SQ508_RESULT = 1;
    DIACAM_DISABLE();
    WLD_SENDTRIGGER("SQ508_JUDGMENT_10");
    NONE_6239_CASPAR.FLAGS = 0;
    NONE_6239_CASPAR.ATTRIBUTE[0] = 1;
    CREATEINVITEMS(PAL_100_CANDAC, 0x84eb, 1);
    AI_EQUIPBESTMELEEWEAPON(PAL_100_CANDAC);
    TELEPORTNPCTOWP(0xcaf2, "PART8_GRAVEYARD_INNOS_CASPAR");
    TELEPORTNPCTOWP(0xcafa, "PART8_GRAVEYARD_INNOS_01");
    TELEPORTNPCTOWP(0x71b, "PART8_GRAVEYARD_INNOS_03");
    B_TURNTONPC(NONE_6239_CASPAR, PAL_100_CANDAC);
    B_TURNTONPC(PAL_100_CANDAC, NONE_6239_CASPAR);
    SQ508_KILLCUTSCENE_WAIT();
    NPC_CLEARAIQUEUE(PAL_100_CANDAC);
    AI_DRAWWEAPON(PAL_100_CANDAC);
    AI_SETWALKMODE(PAL_100_CANDAC, NPC_RUN);
    AI_GOTONPC(PAL_100_CANDAC, NONE_6239_CASPAR);
    AI_FUNCTION(PAL_100_CANDAC, 0x16b5f);
    AI_PLAYANI(PAL_100_CANDAC, "T_2HATTACKR");
    AI_WAIT(PAL_100_CANDAC, 0x3ecccccd);
    AI_REMOVEWEAPON(PAL_100_CANDAC);
    AI_FUNCTION(PAL_100_CANDAC, 0xf77c);
}

func void SQ508_KILLCASPAR() {
    MDL_APPLYOVERLAYMDS(NONE_6239_CASPAR, "HUMANS_SUDDENDEATH.MDS");
    AI_PLAYANI(NONE_6239_CASPAR, T_DEAD);
    SND_PLAY("FIG_SwordFinal");
    SND_PLAY("SVM_61_DEAD");
    B_MAGICHURTNPC(PAL_100_CANDAC, NONE_6239_CASPAR, 0x1869f);
}

