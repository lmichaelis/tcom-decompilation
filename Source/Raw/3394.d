instance DIA_ADDON_GIVEPOTION(C_INFO) {
    NR = 998;
    CONDITION = DIA_ADDON_GIVEPOTION_CONDITION;
    INFORMATION = DIA_ADDON_GIVEPOTION_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_GIVEHEALINGPOTION;
}

func int DIA_ADDON_GIVEPOTION_CONDITION() {
    if (((SELF.AIVAR[15]) == (TRUE)) && ((SELF.FLAGS) == (0))) {
        if (C_GOTINGRENDIENTS_ANYHEALTHPOTION(HERO)) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_ADDON_GIVEPOTION_INFO() {
    INFO_CLEARCHOICES(0xeded);
    INFO_ADDCHOICE(0xeded, DIALOG_BACK, 0xedf2);
    if ((NPC_HASITEMS(OTHER, 0x9364)) >= (1)) {
        INFO_ADDCHOICE(0xeded, POTIONNAME_HPREGEN2, 0xedf3);
    };
    if ((NPC_HASITEMS(OTHER, 0x9362)) >= (1)) {
        INFO_ADDCHOICE(0xeded, POTIONNAME_HPREGEN, 0xedf4);
    };
    if ((NPC_HASITEMS(OTHER, 0x8641)) >= (1)) {
        INFO_ADDCHOICE(0xeded, POTIONNAME_HEALTH_04_VOL2, 0xedf5);
    };
    if ((NPC_HASITEMS(OTHER, 0x863f)) >= (1)) {
        INFO_ADDCHOICE(0xeded, POTIONNAME_HEALTH_03_VOL2, 0xedf6);
    };
    if ((NPC_HASITEMS(OTHER, 0x863c)) >= (1)) {
        INFO_ADDCHOICE(0xeded, POTIONNAME_HEALTH_02_VOL2, 0xedf7);
    };
    if ((NPC_HASITEMS(OTHER, 0x8639)) >= (1)) {
        INFO_ADDCHOICE(0xeded, POTIONNAME_HEALTH_01_VOL2, 0xedf8);
    };
    if ((NPC_HASITEMS(OTHER, 0x838e)) >= (1)) {
        INFO_ADDCHOICE(0xeded, POTIONNAME_HEALTH_04, 0xedf9);
    };
    if ((NPC_HASITEMS(OTHER, 0x8635)) >= (1)) {
        INFO_ADDCHOICE(0xeded, POTIONNAME_HEALTH_03, 0xedfa);
    };
    if ((NPC_HASITEMS(OTHER, 0x8632)) >= (1)) {
        INFO_ADDCHOICE(0xeded, POTIONNAME_HEALTH_02, 0xedfb);
    };
    if ((NPC_HASITEMS(OTHER, 0x8630)) >= (1)) {
        INFO_ADDCHOICE(0xeded, POTIONNAME_HEALTH_01, 0xedfc);
    };
}

func void B_ADDON_DRINKPOTION() {
    B_STANDUP();
    MARVIN_SVM_RND = HLP_RANDOM(3);
    if ((MARVIN_SVM_RND) == (0)) {
        B_SAY(OTHER, SELF, "$MARVIN_GiveItem");
    };
    if ((MARVIN_SVM_RND) == (1)) {
        B_SAY(OTHER, SELF, "$MARVIN_GiveItem2");
    };
    if ((MARVIN_SVM_RND) == (2)) {
        B_SAY(OTHER, SELF, "$MARVIN_GiveItem4");
    };
    INFO_CLEARCHOICES(0xeded);
}

var int B_ADDON_DRINKPOTION.MARVIN_SVM_RND = 0;
func void DIA_ADDON_GIVEPOTION_BACK() {
    INFO_CLEARCHOICES(0xeded);
}

func void DIA_ADDON_GIVEPOTION_ITPO_HPREGEN2() {
    B_ADDON_DRINKPOTION();
    if ((SELF.ATTRIBUTE[0]) < (SELF.ATTRIBUTE[1])) {
        AI_STOPLOOKAT(SELF);
        AI_USEITEM(SELF, 0x9364);
    };
    B_GIVEINVITEMS(OTHER, SELF, 0x9364, 1);
}

func void DIA_ADDON_GIVEPOTION_ITPO_HPREGEN() {
    B_ADDON_DRINKPOTION();
    if ((SELF.ATTRIBUTE[0]) < (SELF.ATTRIBUTE[1])) {
        AI_STOPLOOKAT(SELF);
        AI_USEITEM(SELF, 0x9362);
    };
    B_GIVEINVITEMS(OTHER, SELF, 0x9362, 1);
}

func void DIA_ADDON_GIVEPOTION_ITPO_HEALTH_04_VOL2() {
    B_ADDON_DRINKPOTION();
    if ((SELF.ATTRIBUTE[0]) < (SELF.ATTRIBUTE[1])) {
        AI_STOPLOOKAT(SELF);
        AI_USEITEM(SELF, 0x8641);
    };
    B_GIVEINVITEMS(OTHER, SELF, 0x8641, 1);
}

func void DIA_ADDON_GIVEPOTION_ITPO_HEALTH_03_VOL2() {
    B_ADDON_DRINKPOTION();
    if ((SELF.ATTRIBUTE[0]) < (SELF.ATTRIBUTE[1])) {
        AI_STOPLOOKAT(SELF);
        AI_USEITEM(SELF, 0x863f);
    };
    B_GIVEINVITEMS(OTHER, SELF, 0x863f, 1);
}

func void DIA_ADDON_GIVEPOTION_ITPO_HEALTH_02_VOL2() {
    B_ADDON_DRINKPOTION();
    if ((SELF.ATTRIBUTE[0]) < (SELF.ATTRIBUTE[1])) {
        AI_STOPLOOKAT(SELF);
        AI_USEITEM(SELF, 0x863c);
    };
    B_GIVEINVITEMS(OTHER, SELF, 0x863c, 1);
}

func void DIA_ADDON_GIVEPOTION_ITPO_HEALTH_01_VOL2() {
    B_ADDON_DRINKPOTION();
    if ((SELF.ATTRIBUTE[0]) < (SELF.ATTRIBUTE[1])) {
        AI_STOPLOOKAT(SELF);
        AI_USEITEM(SELF, 0x8639);
    };
    B_GIVEINVITEMS(OTHER, SELF, 0x8639, 1);
}

func void DIA_ADDON_GIVEPOTION_ITPO_HEALTH_04() {
    B_ADDON_DRINKPOTION();
    if ((SELF.ATTRIBUTE[0]) < (SELF.ATTRIBUTE[1])) {
        AI_STOPLOOKAT(SELF);
        AI_USEITEM(SELF, 0x838e);
    };
    B_GIVEINVITEMS(OTHER, SELF, 0x838e, 1);
}

func void DIA_ADDON_GIVEPOTION_ITPO_HEALTH_03() {
    B_ADDON_DRINKPOTION();
    if ((SELF.ATTRIBUTE[0]) < (SELF.ATTRIBUTE[1])) {
        AI_STOPLOOKAT(SELF);
        AI_USEITEM(SELF, 0x8635);
    };
    B_GIVEINVITEMS(OTHER, SELF, 0x8635, 1);
}

func void DIA_ADDON_GIVEPOTION_ITPO_HEALTH_02() {
    B_ADDON_DRINKPOTION();
    if ((SELF.ATTRIBUTE[0]) < (SELF.ATTRIBUTE[1])) {
        AI_STOPLOOKAT(SELF);
        AI_USEITEM(SELF, 0x8632);
    };
    B_GIVEINVITEMS(OTHER, SELF, 0x8632, 1);
}

func void DIA_ADDON_GIVEPOTION_ITPO_HEALTH_01() {
    B_ADDON_DRINKPOTION();
    if ((SELF.ATTRIBUTE[0]) < (SELF.ATTRIBUTE[1])) {
        AI_STOPLOOKAT(SELF);
        AI_USEITEM(SELF, 0x8630);
    };
    B_GIVEINVITEMS(OTHER, SELF, 0x8630, 1);
}

func void B_ADDON_GIVEPOTION(var C_NPC SLF) {
    DIA_ADDON_GIVEPOTION.NPC = HLP_GETINSTANCEID(SLF);
}

