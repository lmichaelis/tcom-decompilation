func void EVENTSMANAGER_Q405() {
    if ((LOG_GETSTATUS(MIS_Q405)) != (LOG_RUNNING)) {
        return;
    };
    if ((Q405_STARTQUEST) == (FALSE)) {
        Q405_STARTQUEST = TRUE;
        FF_APPLYONCEEXTGT(0x16f98, 0, -(1));
    };
    if ((Q405_CLOSEDDOORLOGENTRY) == (FALSE)) {
        if ((NPC_GETDISTTOWP(HERO, "SLUMS_HOUSE17_27")) <= (250)) {
            AI_OUTPUT(HERO, HERO, "DIA_Q405_DOORCLOSED_15_01");
            Q405_CLOSEDDOORLOGENTRY = TRUE;
            MOB_CHANGEFOCUSNAME("JORNHOUSE_BARREL_02", "MOBNAME_HIDE_BARREL");
            Q405_VOLKERTIMELIMIT();
        };
    };
    if (((Q404_TELEPORTVOLKERPEOPLE) == (1)) && ((Q405_CLOSEDDOORLOGENTRY) == (4))) {
        if (((NPC_GETDISTTOWP(NONE_6396_VOLKERGUARD, "SLUMS_HOUSE17_VOLKERGUARD_01")) <= (500)) && ((NPC_GETDISTTOWP(NONE_6397_VOLKERGUARD, "SLUMS_HOUSE17_VOLKERGUARD_02")) <= (500))) {
            PRINTD("Ludzie Volkera id¹");
            Q404_TELEPORTVOLKERPEOPLE = 2;
            B_STARTOTHERROUTINE(NONE_6396_VOLKERGUARD, "JORNHOUSEOUTSIDE");
            NPC_REFRESH(NONE_6396_VOLKERGUARD);
            B_STARTOTHERROUTINE(NONE_6397_VOLKERGUARD, "JORNHOUSEOUTSIDE");
            NPC_REFRESH(NONE_6397_VOLKERGUARD);
        };
    };
    if (((Q404_TELEPORTVOLKERPEOPLE) == (2)) && ((Q405_CLOSEDDOORLOGENTRY) == (2))) {
        if (((NPC_GETDISTTOWP(NONE_6396_VOLKERGUARD, "SLUMS_HOUSE17_25")) <= (0x9c4)) && ((NPC_GETDISTTOWP(NONE_6397_VOLKERGUARD, "SLUMS_HOUSE17_25")) <= (0x9c4))) {
            PRINTD("Ludzie Volkera znikneli");
            Q404_TELEPORTVOLKERPEOPLE = 3;
            B_REMOVENPC(0xcfb0);
            B_REMOVENPC(0xcfb9);
        };
    };
    if ((Q405_CORPSELOGENTRY) == (FALSE)) {
        if ((NPC_GETDISTTOWP(HERO, "SLUMS_HOUSE17_CORPSE")) <= (200)) {
            Q405_CORPSELOGENTRY = TRUE;
            AI_OUTPUT(HERO, HERO, "DIA_Q405_DOORCLOSED_15_02");
            B_LOGENTRY(TOPIC_Q405, LOG_Q405_CORPSEWATERCIRCLE);
        };
    };
    if ((Q405_VOLKERPEOPLELOGENTRY) == (FALSE)) {
        if (((NPC_GETDISTTOWP(HERO, "SLUMS_HOUSE17_16")) <= (350)) || ((NPC_GETDISTTOWP(HERO, "SLUMS_HOUSE17_15")) <= (450))) {
            Q405_VOLKERPEOPLELOGENTRY = TRUE;
            AI_OUTPUT(HERO, HERO, "DIA_Q405_DOORCLOSED_15_03");
            if ((NPC_GETTALENTSKILL(HERO, NPC_TALENT_SNEAK)) == (TRUE)) {
                B_LOGENTRY(TOPIC_Q405, LOG_Q405_VOLKERPEOPLEV1);
            } else {
                B_LOGENTRY(TOPIC_Q405, LOG_Q405_VOLKERPEOPLEV2);
            } else {
                VOLKERGUARDS_MAKEMORTAL();
            };
        };
    };
    if ((Q405_SAFEPLACELOGENTRY) == (FALSE)) {
        if (((Q405_VOLKERGUARDSATTACK) == (0)) && ((NPC_GETDISTTOWP(HERO, "SLUMS_HOUSE17_13")) <= (300))) {
            Q405_SAFEPLACELOGENTRY = TRUE;
            B_LOGENTRY(TOPIC_Q405, LOG_Q405_INSIDE);
            MOB_CHANGEFOCUSNAME("KM_JORNHOUSE_BIGCRATES", "MOBNAME_MOVE_BIGCRATES");
        };
    };
    if (((Q405_VOLKERGUARDSATTACK) == (1)) && ((Q405_SAFEPLACELOGENTRY) == (0))) {
        if (((NPC_ISDEAD(NONE_6398_VOLKERGUARD)) && (NPC_ISDEAD(NONE_6399_VOLKERGUARD))) && (NPC_ISDEAD(NONE_6434_VOLKERGUARD))) {
            Q405_SAFEPLACELOGENTRY = 2;
        };
    };
    if ((Q405_SAFEPLACELOGENTRY) == (2)) {
        if ((NPC_GETDISTTOWP(HERO, "SLUMS_HOUSE17_10")) <= (500)) {
            AI_OUTPUT(HERO, HERO, "DIA_Q405_DOORCLOSED_15_04");
            Q405_SAFEPLACELOGENTRY = 3;
        };
    };
}

func void Q405_STARTQUEST_MOVERS() {
    if ((CHANGEDEADBODYCOLLISION) == (0)) {
        PRINTD("Rozpoczynam - Q405_StartQuest_Movers");
        MOVPTR1 = MEM_SEARCHVOBBYNAME("KM_CORPSE_WATERCIRCLE");
        MOVER1 = MEM_PTRTOINST(MOVPTR1);
        CHANGEVOBCOLLISION("KM_CORPSE_WATERCIRCLE_01", FALSE, FALSE, FALSE, TRUE);
        WLD_SENDTRIGGER("KM_CORPSE_WATERCIRCLE");
        CHANGEDEADBODYCOLLISION = 1;
    };
    if (((MOVER1.MOVERSTATE) != (MOVER_STATE_OPENING)) && ((MOVER1.MOVERSTATE) != (MOVER_STATE_CLOSING))) {
        PRINTD("Skoñczy³em - Q405_StartQuest_Movers");
        CHANGEVOBCOLLISION("KM_CORPSE_WATERCIRCLE_01", TRUE, TRUE, TRUE, TRUE);
        FF_REMOVE(0x16f98);
        CHANGEDEADBODYCOLLISION = 0;
    };
}

var int Q405_STARTQUEST_MOVERS.CHANGEDEADBODYCOLLISION = 0;
instance Q405_STARTQUEST_MOVERS.MOVER1(ZCMOVER)
var int Q405_STARTQUEST_MOVERS.MOVPTR1 = 0;
