instance DIA_CITIZEN_SQ207_EXIT(C_INFO) {
    NPC = 0xcc19;
    NR = 999;
    CONDITION = DIA_CITIZEN_SQ207_EXIT_CONDITION;
    INFORMATION = DIA_CITIZEN_SQ207_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_CITIZEN_SQ207_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_CITIZEN_SQ207_EXIT_INFO() {
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_CITIZEN_SQ207_HELLO(C_INFO) {
    NPC = 0xcc19;
    NR = 1;
    CONDITION = DIA_CITIZEN_SQ207_HELLO_CONDITION;
    INFORMATION = DIA_CITIZEN_SQ207_HELLO_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_CITIZEN_SQ207_HELLO_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_SQ207)) == (LOG_RUNNING)) && ((SQ207_DIMATOLEXX) == (6))) && ((SQ207_FAILED) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_CITIZEN_SQ207_HELLO_INFO() {
    AI_STARTFACEANI(SELF, S_WHAT, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Citizen_SQ207_Hello_03_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Citizen_SQ207_Hello_15_02");
    AI_STARTFACEANI(SELF, S_NOPE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Citizen_SQ207_Hello_03_03");
    AI_RESETFACEANI(SELF);
    AI_OUTPUT(SELF, OTHER, "DIA_Citizen_SQ207_Hello_03_04");
    AI_OUTPUT(OTHER, SELF, "DIA_Citizen_SQ207_Hello_15_06");
    AI_OUTPUT(SELF, OTHER, "DIA_Citizen_SQ207_Hello_03_07");
    AI_OUTPUT(OTHER, SELF, "DIA_Citizen_SQ207_Hello_15_08");
    AI_LOGENTRY(TOPIC_SQ207, LOG_SQ207_CHECKDIMACHEST);
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_CITIZEN_SQ207_ITEMS(C_INFO) {
    NPC = 0xcc19;
    NR = 1;
    CONDITION = DIA_CITIZEN_SQ207_ITEMS_CONDITION;
    INFORMATION = DIA_CITIZEN_SQ207_ITEMS_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Indeed. These items are here.";
}

func int DIA_CITIZEN_SQ207_ITEMS_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_SQ207)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 0x11e53))) && ((SQ207_FAILED) == (FALSE))) {
        if ((SQ207_CHECKDIMACHEST) == (TRUE)) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_CITIZEN_SQ207_ITEMS_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Citizen_SQ207_Items_15_01");
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Citizen_SQ207_Items_03_02");
    INFO_CLEARCHOICES(0x11e56);
    if (((NPC_HASITEMS(OTHER, 0x910c)) >= (1)) && ((NPC_HASITEMS(OTHER, 0x85a9)) >= (1))) {
        INFO_ADDCHOICE(0x11e56, "Here they are.", 0x11e5a);
    };
    INFO_ADDCHOICE(0x11e56, "No way.", 0x11e5b);
}

func void DIA_CITIZEN_SQ207_LEAVE() {
    INFO_CLEARCHOICES(0x11e56);
    AI_STOPPROCESSINFOS(SELF);
    NPC_EXCHANGEROUTINE(SELF, TOT);
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
}

func void DIA_CITIZEN_SQ207_ITEMS_YES() {
    SQ207_HELPEDDIMACITIZEN = 1;
    AI_OUTPUT(OTHER, SELF, "DIA_Citizen_SQ207_Items_Yes_15_01");
    NPC_REMOVEINVITEM(SELF, 0x85a9);
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    NPC_REMOVEINVITEM(SELF, 0x910c);
    AI_STARTFACEANI(OTHER, S_SMILE, 1, -(1));
    B_GIVEINVITEMS(OTHER, SELF, 0x85a9, 1);
    AI_OUTPUT(SELF, OTHER, "DIA_Citizen_SQ207_Items_Yes_03_02");
    B_GIVEINVITEMS(OTHER, SELF, 0x910c, 1);
    AI_OUTPUT(OTHER, SELF, "DIA_Citizen_SQ207_Items_Yes_15_03");
    DIA_CITIZEN_SQ207_LEAVE();
}

func void DIA_CITIZEN_SQ207_ITEMS_NO() {
    NPC_REMOVEINVITEM(OTHER, 0x85a9);
    SQ207_HELPEDDIMACITIZEN = 2;
    NPC_REMOVEINVITEM(OTHER, 0x910c);
    AI_OUTPUT(OTHER, SELF, "DIA_Citizen_SQ207_Items_No_15_01");
    AI_STARTFACEANI(SELF, S_SURPRISE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Citizen_SQ207_Items_No_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Citizen_SQ207_Items_No_15_03");
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Citizen_SQ207_Items_No_03_04");
    AI_OUTPUT(OTHER, SELF, "DIA_Citizen_SQ207_Items_No_15_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Citizen_SQ207_Items_No_03_06");
    DIA_CITIZEN_SQ207_LEAVE();
}

