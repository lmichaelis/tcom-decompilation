instance DIA_MILITIA06_SQ311_EXIT(C_INFO) {
    NPC = 0xdf59;
    NR = 999;
    CONDITION = DIA_MILITIA06_SQ311_EXIT_CONDITION;
    INFORMATION = DIA_MILITIA06_SQ311_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_MILITIA06_SQ311_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_MILITIA06_SQ311_EXIT_INFO() {
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_MILITIA06_SQ311_FIGHT(C_INFO) {
    NPC = 0xdf59;
    NR = 1;
    CONDITION = DIA_MILITIA06_SQ311_FIGHT_CONDITION;
    INFORMATION = DIA_MILITIA06_SQ311_FIGHT_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_MILITIA06_SQ311_FIGHT_CONDITION() {
    if (((SQ311_MILITIATRAP) == (1)) && ((LOG_GETSTATUS(MIS_SQ311)) == (LOG_RUNNING))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_MILITIA06_SQ311_FIGHT_INFO() {
    SELF.FLAGS = 0;
    SELF.AIVAR[52] = TRUE;
    SQ311_MILITIATRAP = 2;
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Militia06_SQ311_Fight_03_01");
    AI_STOPPROCESSINFOS(SELF);
    B_ATTACK(SELF, OTHER, AR_KILL, 1);
}

instance DIA_MILITIA06_SQ311_BUSY(C_INFO) {
    NPC = 0xdf59;
    NR = 1;
    CONDITION = DIA_MILITIA06_SQ311_BUSY_CONDITION;
    INFORMATION = DIA_MILITIA06_SQ311_BUSY_INFO;
    PERMANENT = TRUE;
    IMPORTANT = TRUE;
}

func int DIA_MILITIA06_SQ311_BUSY_CONDITION() {
    if (((SQ311_MILITIATRAP) == (1)) && ((LOG_GETSTATUS(MIS_SQ311)) == (LOG_RUNNING))) {
        return FALSE;
    };
    if (NPC_ISINSTATE(SELF, 0xf09f)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_MILITIA06_SQ311_BUSY_INFO() {
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    B_STANDUP();
    B_SAY(SELF, OTHER, "$IMBUSY_ANGRY");
    AI_PLAYANI(SELF, "T_PISSOFF");
    AI_STOPPROCESSINFOS(SELF);
}

