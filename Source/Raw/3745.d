instance DIA_CASPAR_EXIT(C_INFO) {
    NPC = 0xcaf2;
    NR = 999;
    CONDITION = DIA_CASPAR_EXIT_CONDITION;
    INFORMATION = DIA_CASPAR_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_CASPAR_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_CASPAR_EXIT_INFO() {
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_CASPAR_FMQ003_HELLO(C_INFO) {
    NPC = 0xcaf2;
    NR = 1;
    CONDITION = DIA_CASPAR_FMQ003_HELLO_CONDITION;
    INFORMATION = DIA_CASPAR_FMQ003_HELLO_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_CASPAR_FMQ003_HELLO_CONDITION() {
    if ((NPC_ISINSTATE(SELF, 0xf09f)) && ((LOG_GETSTATUS(MIS_FMQ003)) == (LOG_RUNNING))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_CASPAR_FMQ003_HELLO_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_CASPAR_FMQ003_Hello_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_CASPAR_FMQ003_Hello_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_CASPAR_FMQ003_Hello_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_CASPAR_FMQ003_Hello_03_04");
    AI_OUTPUT(OTHER, SELF, "DIA_CASPAR_FMQ003_Hello_15_05");
    AI_OUTPUT(SELF, OTHER, "DIA_CASPAR_FMQ003_Hello_03_06");
    INFO_CLEARCHOICES(0x10d10);
    INFO_ADDCHOICE(0x10d10, "I see what you mean. In that case, I won't disturb you.", 0x10d13);
    INFO_ADDCHOICE(0x10d10, "I don't think so.", 0x10d14);
}

func void DIA_CASPAR_FMQ003_HELLO_UNDERSTANDABLEHAVEANICEDAY() {
    AI_OUTPUT(OTHER, SELF, "DIA_CASPAR_FMQ003_Hello_UnderstandableHaveANiceDay_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_CASPAR_FMQ003_Hello_UnderstandableHaveANiceDay_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_CASPAR_FMQ003_Hello_UnderstandableHaveANiceDay_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_CASPAR_FMQ003_Hello_UnderstandableHaveANiceDay_03_04");
    INFO_CLEARCHOICES(0x10d10);
    AI_STOPPROCESSINFOS(SELF);
    FMQ003_NOVICETALK = 1;
}

func void DIA_CASPAR_FMQ003_HELLO_NOWAY() {
    AI_OUTPUT(OTHER, SELF, "DIA_CASPAR_FMQ003_Hello_NoWay_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_CASPAR_FMQ003_Hello_NoWay_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_CASPAR_FMQ003_Hello_NoWay_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_CASPAR_FMQ003_Hello_NoWay_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_CASPAR_FMQ003_Hello_NoWay_03_05");
    AI_OUTPUT(SELF, OTHER, "DIA_CASPAR_FMQ003_Hello_NoWay_03_06");
    AI_OUTPUT(OTHER, SELF, "DIA_CASPAR_FMQ003_Hello_NoWay_15_07");
    AI_OUTPUT(SELF, OTHER, "DIA_CASPAR_FMQ003_Hello_NoWay_03_08");
    AI_OUTPUT(SELF, OTHER, "DIA_CASPAR_FMQ003_Hello_NoWay_03_09");
    AI_OUTPUT(OTHER, SELF, "DIA_CASPAR_FMQ003_Hello_NoWay_15_10");
    AI_OUTPUT(SELF, OTHER, "DIA_CASPAR_FMQ003_Hello_NoWay_03_11");
    AI_OUTPUT(OTHER, SELF, "DIA_CASPAR_FMQ003_Hello_NoWay_15_12");
    AI_OUTPUT(SELF, OTHER, "DIA_CASPAR_FMQ003_Hello_NoWay_03_13");
    INFO_CLEARCHOICES(0x10d10);
    INFO_ADDCHOICE(0x10d10, "Go to the monastery.", 0x10d15);
    INFO_ADDCHOICE(0x10d10, "Get away as fast as you can!", 0x10d16);
}

func void DIA_CASPAR_FMQ003_HELLO_NOWAY_MONASTERY() {
    AI_OUTPUT(OTHER, SELF, "DIA_CASPAR_FMQ003_Hello_Monastery_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_CASPAR_FMQ003_Hello_Monastery_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_CASPAR_FMQ003_Hello_Monastery_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_CASPAR_FMQ003_Hello_Monastery_03_04");
    AI_OUTPUT(OTHER, SELF, "DIA_CASPAR_FMQ003_Hello_Monastery_15_05");
    AI_OUTPUT(SELF, OTHER, "DIA_CASPAR_FMQ003_Hello_Monastery_03_06");
    AI_OUTPUT(SELF, OTHER, "DIA_CASPAR_FMQ003_Hello_Monastery_03_07");
    INFO_CLEARCHOICES(0x10d10);
    AI_STOPPROCESSINFOS(SELF);
    NPC_EXCHANGEROUTINE(SELF, "MONASTERY");
    FMQ003_NOVICETALK = 2;
}

func void DIA_CASPAR_FMQ003_HELLO_NOWAY_GOAWAY() {
    AI_OUTPUT(OTHER, SELF, "DIA_CASPAR_FMQ003_Hello_GoAway_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_CASPAR_FMQ003_Hello_GoAway_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_CASPAR_FMQ003_Hello_GoAway_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_CASPAR_FMQ003_Hello_GoAway_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_CASPAR_FMQ003_Hello_GoAway_03_05");
    AI_OUTPUT(OTHER, SELF, "DIA_CASPAR_FMQ003_Hello_GoAway_15_06");
    INFO_CLEARCHOICES(0x10d10);
    AI_STOPPROCESSINFOS(SELF);
    NPC_EXCHANGEROUTINE(SELF, "HOME");
    FMQ003_NOVICETALK = 3;
}

instance DIA_CASPAR_SQ508_JUDGMENT(C_INFO) {
    NPC = 0xcaf2;
    NR = 1;
    CONDITION = DIA_CASPAR_SQ508_JUDGMENT_CONDITION;
    INFORMATION = DIA_CASPAR_SQ508_JUDGMENT_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_CASPAR_SQ508_JUDGMENT_CONDITION() {
    if (((LOG_GETSTATUS(MIS_SQ508)) == (LOG_RUNNING)) && ((SQ508_JUDGMENT) == (4))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_CASPAR_SQ508_JUDGMENT_KILL() {
    INFO_CLEARCHOICES(0x10d17);
    TRIA_FINISH();
    AI_STOPLOOKAT(SELF);
    AI_STOPLOOKAT(OTHER);
    AI_STOPPROCESSINFOS(SELF);
    AI_FUNCTION(SELF, 0xf779);
}

func void DIA_CASPAR_SQ508_JUDGMENT_INFO() {
    TRIA_INVITE(PAL_100_CANDAC);
    TRIA_STARTEXT(FALSE);
    AI_LOOKATNPC(OTHER, SELF);
    AI_STOPLOOKAT(SELF);
    AI_OUTPUT(SELF, OTHER, "DIA_Caspar_SQ508_Judgment_03_01");
    TRIA_WAIT();
    TRIA_NEXT(PAL_100_CANDAC);
    AI_OUTPUT(SELF, OTHER, "DIA_Caspar_SQ508_Judgment_03_02");
    INFO_CLEARCHOICES(0x10d17);
    INFO_ADDCHOICE(0x10d17, DIALOG_BESILENT, 0x10d1c);
    INFO_ADDCHOICE(0x10d17, "Wait, let's hear him out!", 0x10d1b);
}

func void DIA_CASPAR_SQ508_JUDGMENT_WAIT() {
    AI_FUNCTION(SELF, 0x10d24);
    AI_TURNTONPC(OTHER, SELF);
    AI_OUTPUT(OTHER, SELF, "DIA_Caspar_SQ508_Judgment_Wait_15_01");
    TRIA_WAIT();
    TRIA_NEXT(PAL_100_CANDAC);
    AI_OUTPUT(SELF, OTHER, "DIA_Caspar_SQ508_Judgment_Wait_03_02");
    TRIA_WAIT();
    TRIA_NEXT(NONE_6239_CASPAR);
    AI_TURNTONPC(OTHER, SELF);
    AI_OUTPUT(SELF, OTHER, "DIA_Caspar_SQ508_Judgment_Wait_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Caspar_SQ508_Judgment_Wait_03_04");
    TRIA_WAIT();
    TRIA_NEXT(PAL_100_CANDAC);
    AI_OUTPUT(SELF, OTHER, "DIA_Caspar_SQ508_Judgment_Wait_03_05");
    INFO_CLEARCHOICES(0x10d17);
    INFO_ADDCHOICE(0x10d17, "Do your duty.", 0x10d1e);
    INFO_ADDCHOICE(0x10d17, "Candac, this boy is terrified.", 0x10d1d);
    if (NPC_KNOWSINFO(OTHER, 0x10d10)) {
        INFO_ADDCHOICE(0x10d17, "Wait a minute, I know this novice...", 0x10d20);
    };
}

func void DIA_CASPAR_SQ508_JUDGMENT_SILENCE() {
    AI_WAIT(OTHER, 0x3e4ccccd);
    AI_WAITTILLEND(SELF, OTHER);
    DIA_CASPAR_SQ508_JUDGMENT_KILL();
}

func void DIA_CASPAR_SQ508_JUDGMENT_WAIT_SCARED() {
    AI_OUTPUT(OTHER, SELF, "DIA_Caspar_SQ508_Judgment_Scared_15_01");
    TRIA_WAIT();
    TRIA_NEXT(PAL_100_CANDAC);
    AI_OUTPUT(SELF, OTHER, "DIA_Caspar_SQ508_Judgment_Scared_03_02");
    INFO_ADDCHOICE(0x10d17, "I think he might be telling the truth. Look at him.", 0x10d21);
}

func void DIA_CASPAR_SQ508_JUDGMENT_WAIT_DOIT() {
    AI_OUTPUT(OTHER, SELF, "DIA_Caspar_SQ508_Judgment_DoIt_15_01");
    AI_WAIT(OTHER, 0x3e4ccccd);
    AI_WAITTILLEND(SELF, OTHER);
    DIA_CASPAR_SQ508_JUDGMENT_KILL();
}

func void DIA_CASPAR_SQ508_JUDGMENT_WAIT_SCARED_TRUTH_NEXT() {
    TRIA_WAIT();
    TRIA_NEXT(PAL_100_CANDAC);
    AI_OUTPUT(SELF, OTHER, "DIA_Caspar_SQ508_Judgment_Next_03_01");
    TRIA_WAIT();
    TRIA_NEXT(NONE_6239_CASPAR);
    AI_FUNCTION(SELF, 0x10d27);
    AI_OUTPUT(SELF, OTHER, "DIA_Caspar_SQ508_Judgment_Next_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Caspar_SQ508_Judgment_Next_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Caspar_SQ508_Judgment_Next_03_04");
    TRIA_WAIT();
    TRIA_NEXT(PAL_100_CANDAC);
    AI_FUNCTION(SELF, 0x10d28);
    AI_OUTPUT(SELF, OTHER, "DIA_Caspar_SQ508_Judgment_Next_03_05");
    TRIA_WAIT();
    TRIA_NEXT(NONE_6239_CASPAR);
    AI_OUTPUT(SELF, OTHER, "DIA_Caspar_SQ508_Judgment_Next_03_06");
    TRIA_WAIT();
    TRIA_NEXT(PAL_100_CANDAC);
    AI_OUTPUT(SELF, OTHER, "DIA_Caspar_SQ508_Judgment_Next_03_07");
    TRIA_WAIT();
    TRIA_NEXT(NONE_6239_CASPAR);
    AI_OUTPUT(SELF, OTHER, "DIA_Caspar_SQ508_Judgment_Next_03_08");
    TRIA_WAIT();
    TRIA_NEXT(PAL_100_CANDAC);
    AI_FUNCTION(SELF, 0x10d29);
    AI_OUTPUT(SELF, OTHER, "DIA_Caspar_SQ508_Judgment_Next_03_09");
    INFO_CLEARCHOICES(0x10d17);
    INFO_ADDCHOICE(0x10d17, "The boy is telling the truth.", 0x10d22);
    INFO_ADDCHOICE(0x10d17, "This story makes no sense, he must be hiding something.", 0x10d23);
}

func void DIA_CASPAR_SQ508_JUDGMENT_WAIT_KNOW() {
    AI_FUNCTION(SELF, 0x10d25);
    AI_OUTPUT(OTHER, SELF, "DIA_Caspar_SQ508_Judgment_Know_15_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Caspar_SQ508_Judgment_Know_15_02");
    AI_WAITTILLEND(SELF, OTHER);
    AI_FUNCTION(SELF, 0x10d26);
    TRIA_WAIT();
    TRIA_NEXT(NONE_6239_CASPAR);
    AI_OUTPUT(SELF, OTHER, "DIA_Caspar_SQ508_Judgment_Know_03_03");
    DIA_CASPAR_SQ508_JUDGMENT_WAIT_SCARED_TRUTH_NEXT();
}

func void DIA_CASPAR_SQ508_JUDGMENT_WAIT_SCARED_TRUTH() {
    AI_FUNCTION(SELF, 0x10d25);
    AI_OUTPUT(OTHER, SELF, "DIA_Caspar_SQ508_Judgment_Truth_15_01");
    AI_WAITTILLEND(SELF, OTHER);
    AI_FUNCTION(SELF, 0x10d26);
    DIA_CASPAR_SQ508_JUDGMENT_WAIT_SCARED_TRUTH_NEXT();
}

func void DIA_CASPAR_SQ508_JUDGMENT_WAIT_SCARED_TRUTH_NEXT_YES() {
    AI_FUNCTION(SELF, 0x10d2a);
    AI_OUTPUT(OTHER, SELF, "DIA_Caspar_SQ508_Judgment_Yes_15_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Caspar_SQ508_Judgment_Yes_15_02");
    TRIA_WAIT();
    TRIA_NEXT(PAL_100_CANDAC);
    AI_OUTPUT(SELF, OTHER, "DIA_Caspar_SQ508_Judgment_Yes_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Caspar_SQ508_Judgment_Yes_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Caspar_SQ508_Judgment_Yes_03_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Caspar_SQ508_Judgment_Yes_03_06");
    TRIA_WAIT();
    TRIA_NEXT(NONE_6239_CASPAR);
    AI_OUTPUT(SELF, OTHER, "DIA_Caspar_SQ508_Judgment_Yes_03_07");
    INFO_CLEARCHOICES(0x10d17);
    TRIA_FINISH();
    AI_STOPLOOKAT(SELF);
    AI_STOPLOOKAT(OTHER);
    AI_STOPPROCESSINFOS(SELF);
    AI_FUNCTION(SELF, 0xf77f);
}

func void DIA_CASPAR_SQ508_JUDGMENT_WAIT_SCARED_TRUTH_NEXT_NO() {
    AI_FUNCTION(SELF, 0x10d2a);
    AI_OUTPUT(OTHER, SELF, "DIA_Caspar_SQ508_Judgment_No_15_01");
    AI_WAIT(OTHER, 0x3e4ccccd);
    AI_WAITTILLEND(SELF, OTHER);
    DIA_CASPAR_SQ508_JUDGMENT_SILENCE();
}

func void CASPAR_SQ508_JUDGMENT_CAMERA_01() {
    WLD_SENDTRIGGER("SQ508_JUDGMENT_03");
    WLD_SENDUNTRIGGER("SQ508_JUDGMENT_02");
    TELEPORTNPCTOWP(0xcaf2, "PART8_SQ508_JUDGMENT_CANDAC_02");
    TELEPORTNPCTOWP(0xcafa, "PART8_GRAVEYARD_INNOS_CASPAR");
    TELEPORTNPCTOWP(0x71b, "PART8_SQ508_JUDGMENT_HERO_02");
}

func void CASPAR_SQ508_JUDGMENT_CAMERA_02() {
    WLD_SENDTRIGGER("SQ508_JUDGMENT_04");
    WLD_SENDUNTRIGGER("SQ508_JUDGMENT_03");
}

func void CASPAR_SQ508_JUDGMENT_CAMERA_03() {
    WLD_SENDTRIGGER("SQ508_JUDGMENT_05");
    WLD_SENDUNTRIGGER("SQ508_JUDGMENT_04");
}

func void CASPAR_SQ508_JUDGMENT_CAMERA_04() {
    WLD_SENDTRIGGER("SQ508_JUDGMENT_06");
    WLD_SENDUNTRIGGER("SQ508_JUDGMENT_05");
}

func void CASPAR_SQ508_JUDGMENT_CAMERA_05() {
    WLD_SENDTRIGGER("SQ508_JUDGMENT_07");
    WLD_SENDUNTRIGGER("SQ508_JUDGMENT_06");
}

func void CASPAR_SQ508_JUDGMENT_CAMERA_06() {
    WLD_SENDTRIGGER("SQ508_JUDGMENT_08");
    WLD_SENDUNTRIGGER("SQ508_JUDGMENT_07");
}

func void CASPAR_SQ508_JUDGMENT_CAMERA_07() {
    WLD_SENDTRIGGER("SQ508_JUDGMENT_09");
    WLD_SENDUNTRIGGER("SQ508_JUDGMENT_08");
}

instance DIA_CASPAR_AMBIENT(C_INFO) {
    NPC = 0xcaf2;
    NR = 998;
    CONDITION = DIA_CASPAR_AMBIENT_CONDITION;
    INFORMATION = DIA_CASPAR_AMBIENT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "How's life?";
}

func int DIA_CASPAR_AMBIENT_CONDITION() {
    if ((NPC_KNOWSINFO(OTHER, 0x10d10)) || (NPC_KNOWSINFO(OTHER, 0x10d17))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_CASPAR_AMBIENT_INFO() {
    B_SAY(OTHER, SELF, "$MARVIN_WhatNew5");
    if (!(NPC_KNOWSINFO(OTHER, 0x10d17))) {
        AI_OUTPUT(SELF, OTHER, "DIA_Caspar_Ambient_03_01");
    };
    if (NPC_KNOWSINFO(OTHER, 0x10d17)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Caspar_Ambient_03_02");
    };
}

