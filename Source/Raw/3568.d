func void Q203_FAILQUESTS() {
    if ((LOG_GETSTATUS(MIS_Q203)) == (LOG_RUNNING)) {
        if ((LOG_GETSTATUS(MIS_FMQ001)) == (LOG_RUNNING)) {
            B_LOGENTRY(TOPIC_FMQ001, LOG_Q203_JOINEDARAXOS);
            LOG_SETSTATUS(_@(MIS_FMQ001), TOPIC_FMQ001, LOG_FAILED);
        };
        if ((LOG_GETSTATUS(MIS_FMQ002)) == (LOG_RUNNING)) {
            B_LOGENTRY(TOPIC_FMQ002, LOG_Q203_JOINEDARAXOS);
            LOG_SETSTATUS(_@(MIS_FMQ002), TOPIC_FMQ002, LOG_FAILED);
        };
        if ((LOG_GETSTATUS(MIS_FMQ003)) == (LOG_RUNNING)) {
            B_LOGENTRY(TOPIC_FMQ003, LOG_Q203_JOINEDARAXOS);
            LOG_SETSTATUS(_@(MIS_FMQ003), TOPIC_FMQ003, LOG_FAILED);
        };
        if (HLP_ISVALIDNPC(MIL_4040_RECRUIT)) {
            if ((NPC_ISDEAD(MIL_4040_RECRUIT)) == (FALSE)) {
                B_REMOVENPC(0xce96);
            };
        };
        if (HLP_ISVALIDNPC(MIL_4041_RECRUIT)) {
            if ((NPC_ISDEAD(MIL_4041_RECRUIT)) == (FALSE)) {
                B_REMOVENPC(0xceaf);
            };
        };
        if (HLP_ISVALIDNPC(MIL_4042_RECRUIT)) {
            if ((NPC_ISDEAD(MIL_4042_RECRUIT)) == (FALSE)) {
                B_REMOVENPC(0xcec5);
            };
        };
        if (HLP_ISVALIDNPC(MIL_4043_INSTRUCTOR)) {
            if ((NPC_ISDEAD(MIL_4043_INSTRUCTOR)) == (FALSE)) {
                B_REMOVENPC(0xcede);
            };
        };
        FMQ003_REMOVEEVENTS();
        FMQ003_TELEPORTTHUGHS();
        FMQ003_REMOVETHIEF();
        B_LOGENTRY(TOPIC_Q203, LOG_Q203_JOINEDARAXOS);
        LOG_SETSTATUS(_@(MIS_Q203), TOPIC_Q203, LOG_FAILED);
        RESTOREROUTINE_WEIGAR();
        RESTOREROUTINE_ARWID();
        RESTOREROUTINE_WINSTAN();
        TELEPORTNPCTOWP(0xce6f, MIL_4016_WEGAR.WP);
        TELEPORTNPCTOWP(0xcca0, MIL_4017_ARWID.WP);
        TELEPORTNPCTOWP(0xccd7, MIL_924_WINSTAN.WP);
    };
}

func void Q203_TELEPORTJOININGMILITIA() {
    Q203_JOININGMILITIA = TRUE;
    NPC_EXCHANGEROUTINE(MIL_4000_RODERICH, "SPEACH");
    Q203_RODERICH_RTNCHECK = 1;
    MIL_4000_RODERICH.AIVAR[15] = TRUE;
    B_STARTOTHERROUTINE(MIL_4044_SALL, "JOININGMILITIA");
    NPC_REFRESH(MIL_4044_SALL);
    TELEPORTNPCTOWP(0xcee7, MIL_4044_SALL.WP);
    B_STARTOTHERROUTINE(MIL_924_WINSTAN, "JOININGMILITIA");
    NPC_REFRESH(MIL_924_WINSTAN);
    TELEPORTNPCTOWP(0xccd7, MIL_924_WINSTAN.WP);
    B_STARTOTHERROUTINE(MIL_4016_WEGAR, "JOININGMILITIA");
    NPC_REFRESH(MIL_4016_WEGAR);
    TELEPORTNPCTOWP(0xce6f, MIL_4016_WEGAR.WP);
    B_STARTOTHERROUTINE(MIL_4043_INSTRUCTOR, "JOININGMILITIA");
    NPC_REFRESH(MIL_4043_INSTRUCTOR);
    TELEPORTNPCTOWP(0xcede, MIL_4043_INSTRUCTOR.WP);
    B_STARTOTHERROUTINE(MIL_840_GOTARD, "JOININGMILITIA");
    NPC_REFRESH(MIL_840_GOTARD);
    TELEPORTNPCTOWP(0xccd0, MIL_840_GOTARD.WP);
    B_STARTOTHERROUTINE(MIL_4017_ARWID, "JOININGMILITIA");
    NPC_REFRESH(MIL_4017_ARWID);
    TELEPORTNPCTOWP(0xcca0, MIL_4017_ARWID.WP);
    B_STARTOTHERROUTINE(MIL_6402_GUIDO, "JOININGMILITIA");
    NPC_REFRESH(MIL_6402_GUIDO);
    TELEPORTNPCTOWP(0xcf02, MIL_6402_GUIDO.WP);
    B_STARTOTHERROUTINE(MIL_6385_SAMBOR, "JOININGMILITIA");
    NPC_REFRESH(MIL_6385_SAMBOR);
    TELEPORTNPCTOWP(0xcefa, MIL_6385_SAMBOR.WP);
    B_STARTOTHERROUTINE(MIL_4047_PRISONGUARD, "JOININGMILITIA");
    NPC_REFRESH(MIL_4047_PRISONGUARD);
    TELEPORTNPCTOWP(0xce23, MIL_4047_PRISONGUARD.WP);
    B_STARTOTHERROUTINE(MIL_6371_DUSTER, "JOININGMILITIA");
    NPC_REFRESH(MIL_6371_DUSTER);
    TELEPORTNPCTOWP(0xd499, MIL_6371_DUSTER.WP);
    Q203_DUSTER_RTNCHECK = 1;
    B_STARTOTHERROUTINE(NONE_2009_LENNART, "JOININGMILITIA");
    NPC_REFRESH(NONE_2009_LENNART);
    TELEPORTNPCTOWP(0xcf09, NONE_2009_LENNART.WP);
    B_STARTOTHERROUTINE(MIL_4001_OKTAV, "JOININGMILITIA");
    NPC_REFRESH(MIL_4001_OKTAV);
    TELEPORTNPCTOWP(0xce55, MIL_4001_OKTAV.WP);
    Q203_OKTAV_RTNCHECK = 1;
    WLD_INSERTNPC(0xcea2, "PARTM3_JOININGMILITIA_01");
    WLD_INSERTNPC(0xcebc, "PARTM3_JOININGMILITIA_02");
    WLD_INSERTNPC(0xced2, "PARTM3_JOININGMILITIA_04");
    B_STARTOTHERROUTINE(MIL_4040_RECRUIT_V2, "JOININGMILITIA");
    NPC_REFRESH(MIL_4040_RECRUIT_V2);
    TELEPORTNPCTOWP(0xcea2, MIL_4040_RECRUIT_V2.WP);
    B_STARTOTHERROUTINE(MIL_4041_RECRUIT_V2, "JOININGMILITIA");
    NPC_REFRESH(MIL_4041_RECRUIT_V2);
    TELEPORTNPCTOWP(0xcebc, MIL_4041_RECRUIT_V2.WP);
    B_STARTOTHERROUTINE(MIL_4042_RECRUIT_V2, "JOININGMILITIA");
    NPC_REFRESH(MIL_4042_RECRUIT_V2);
    TELEPORTNPCTOWP(0xced2, MIL_4042_RECRUIT_V2.WP);
}

func void Q203_MILITIAJOIN_MILSTAND() {
    AI_PLAYANIBS(MIL_4042_RECRUIT_V2, "T_STAND_2_MILSTAND", BS_SIT);
    HERO.AIVAR[4] = FALSE;
}

func void Q203_MILITIAJOIN_MILJOIN() {
    AI_PLAYANIBS(MIL_4040_RECRUIT_V2, "T_MILSTAND_2_MILJOIN", BS_SIT);
    AI_PLAYANIBS(MIL_4041_RECRUIT_V2, "T_MILSTAND_2_MILJOIN", BS_SIT);
    AI_PLAYANIBS(MIL_4042_RECRUIT_V2, "T_MILSTAND_2_MILJOIN", BS_SIT);
    HERO.AIVAR[4] = FALSE;
}

func void Q203_MILITIAJOIN_UNLOCKHERO() {
    DIACAM_ENABLE();
    HERO.AIVAR[4] = FALSE;
}

func void Q203_MILITIAJOIN_TAVERN() {
    TELEPORTNPCTOWP(0xce47, "PARTM3_RODERICH_01");
    WLD_SENDTRIGGER("KM_MILITIAJOIN_05");
    WLD_SENDUNTRIGGER("KM_MILITIAJOIN_04");
    AI_PLAYANIBS(MIL_4040_RECRUIT_V2, "T_REMOVE_MILJOIN", BS_STAND);
    AI_PLAYANIBS(MIL_4041_RECRUIT_V2, "T_REMOVE_MILJOIN", BS_STAND);
    AI_PLAYANIBS(MIL_4042_RECRUIT_V2, "T_REMOVE_MILJOIN", BS_STAND);
    AI_PLAYANIBS(HERO, "T_REMOVE_MILJOIN", BS_STAND);
    FADESCREENTOBLACKF(2, 0xfa10, 1000);
}

func void Q203_MILITIAJOIN_TAVERN_FADESCREEN() {
    WLD_SENDUNTRIGGER("KM_MILITIAJOIN_01");
    WLD_SENDUNTRIGGER("KM_MILITIAJOIN_02");
    WLD_SENDUNTRIGGER("KM_MILITIAJOIN_03");
    WLD_SENDUNTRIGGER("KM_MILITIAJOIN_04");
    WLD_SENDUNTRIGGER("KM_MILITIAJOIN_05");
    BECOMEAGUARD_TAVERNPART = TRUE;
    BECOMEAGUARD_TAVERNPART_DAY = WLD_GETDAY();
    AI_FUNCTION(HERO, 0xfa11);
    TELEPORTNPCTOWP(0x71b, PARTM4_TAVERN_03);
    NPC_EXCHANGEROUTINE(MIL_4000_RODERICH, "JOININGMILITIA_TAVERN");
    Q203_RODERICH_RTNCHECK = 2;
    MIL_4000_RODERICH.AIVAR[15] = FALSE;
    B_STARTOTHERROUTINE(MIL_4044_SALL, "JOININGMILITIA_TAVERN");
    NPC_REFRESH(MIL_4044_SALL);
    TELEPORTNPCTOWP(0xcee7, MIL_4044_SALL.WP);
    B_STARTOTHERROUTINE(MIL_924_WINSTAN, "JOININGMILITIA_TAVERN");
    NPC_REFRESH(MIL_924_WINSTAN);
    TELEPORTNPCTOWP(0xccd7, MIL_924_WINSTAN.WP);
    B_STARTOTHERROUTINE(MIL_4016_WEGAR, "JOININGMILITIA_TAVERN");
    NPC_REFRESH(MIL_4016_WEGAR);
    TELEPORTNPCTOWP(0xce6f, MIL_4016_WEGAR.WP);
    B_STARTOTHERROUTINE(MIL_4043_INSTRUCTOR, "JOININGMILITIA_TAVERN");
    NPC_REFRESH(MIL_4043_INSTRUCTOR);
    TELEPORTNPCTOWP(0xcede, MIL_4043_INSTRUCTOR.WP);
    B_STARTOTHERROUTINE(MIL_840_GOTARD, "JOININGMILITIA_TAVERN");
    NPC_REFRESH(MIL_840_GOTARD);
    TELEPORTNPCTOWP(0xccd0, MIL_840_GOTARD.WP);
    B_STARTOTHERROUTINE(MIL_4017_ARWID, "JOININGMILITIA_TAVERN");
    NPC_REFRESH(MIL_4017_ARWID);
    TELEPORTNPCTOWP(0xcca0, MIL_4017_ARWID.WP);
    B_STARTOTHERROUTINE(MIL_6402_GUIDO, "JOININGMILITIA_TAVERN");
    NPC_REFRESH(MIL_6402_GUIDO);
    TELEPORTNPCTOWP(0xcf02, MIL_6402_GUIDO.WP);
    B_STARTOTHERROUTINE(MIL_6385_SAMBOR, "JOININGMILITIA_TAVERN");
    NPC_REFRESH(MIL_6385_SAMBOR);
    TELEPORTNPCTOWP(0xcefa, MIL_6385_SAMBOR.WP);
    B_STARTOTHERROUTINE(MIL_4047_PRISONGUARD, "JOININGMILITIA_TAVERN");
    NPC_REFRESH(MIL_4047_PRISONGUARD);
    TELEPORTNPCTOWP(0xce23, MIL_4047_PRISONGUARD.WP);
    B_STARTOTHERROUTINE(MIL_6371_DUSTER, "JOININGMILITIA_TAVERN");
    NPC_REFRESH(MIL_6371_DUSTER);
    TELEPORTNPCTOWP(0xd499, MIL_6371_DUSTER.WP);
    Q203_DUSTER_RTNCHECK = 2;
    B_STARTOTHERROUTINE(NONE_2009_LENNART, "JOININGMILITIA_TAVERN");
    NPC_REFRESH(NONE_2009_LENNART);
    TELEPORTNPCTOWP(0xcf09, NONE_2009_LENNART.WP);
    B_STARTOTHERROUTINE(MIL_4001_OKTAV, "JOININGMILITIA_TAVERN");
    NPC_REFRESH(MIL_4001_OKTAV);
    TELEPORTNPCTOWP(0xce55, MIL_4001_OKTAV.WP);
    Q203_OKTAV_RTNCHECK = 2;
    B_STARTOTHERROUTINE(MIL_4040_RECRUIT_V2, "JOININGMILITIA_TAVERN");
    NPC_REFRESH(MIL_4040_RECRUIT_V2);
    TELEPORTNPCTOWP(0xcea2, MIL_4040_RECRUIT_V2.WP);
    B_STARTOTHERROUTINE(MIL_4041_RECRUIT_V2, "JOININGMILITIA_TAVERN");
    NPC_REFRESH(MIL_4041_RECRUIT_V2);
    TELEPORTNPCTOWP(0xcebc, MIL_4041_RECRUIT_V2.WP);
    B_STARTOTHERROUTINE(MIL_4042_RECRUIT_V2, "JOININGMILITIA_TAVERN");
    NPC_REFRESH(MIL_4042_RECRUIT_V2);
    TELEPORTNPCTOWP(0xced2, MIL_4042_RECRUIT_V2.WP);
    NPC_CHANGEARMOR(MIL_4040_RECRUIT_V2, 0x8a9a);
    NPC_CHANGEARMOR(MIL_4041_RECRUIT_V2, 0x8a9a);
    NPC_CHANGEARMOR(MIL_4042_RECRUIT_V2, 0x8a9a);
    NPC_REMOVEINVITEMS(MIL_4042_RECRUIT_V2, 0x8a9d, 1);
    MIL_4040_RECRUIT_V2.NAME[0] = NPCNAME_CABI;
    NPC_REMOVEINVITEMS(MIL_4041_RECRUIT_V2, 0x8a9d, 1);
    MIL_4041_RECRUIT_V2.NAME[0] = NPCNAME_LEVE;
    NPC_REMOVEINVITEMS(MIL_4040_RECRUIT_V2, 0x8a9d, 1);
    MIL_4042_RECRUIT_V2.NAME[0] = NPCNAME_NEIR;
    MIL_4040_RECRUIT_V2.AIVAR[79] = TRUE;
    MIL_4041_RECRUIT_V2.AIVAR[79] = TRUE;
    MIL_4042_RECRUIT_V2.AIVAR[79] = TRUE;
    if ((NPC_ISDEAD(VLK_6421_CITIZEN)) == (FALSE)) {
        B_STARTOTHERROUTINE(VLK_6421_CITIZEN, TOT);
        NPC_REFRESH(VLK_6421_CITIZEN);
        TELEPORTNPCTOWP(0xd066, VLK_6421_CITIZEN.WP);
    };
    if ((NPC_ISDEAD(VLK_6418_CITIZEN)) == (FALSE)) {
        B_STARTOTHERROUTINE(VLK_6418_CITIZEN, TOT);
        NPC_REFRESH(VLK_6418_CITIZEN);
        TELEPORTNPCTOWP(0xd058, VLK_6418_CITIZEN.WP);
    };
    if ((NPC_ISDEAD(VLK_6419_CITIZEN)) == (FALSE)) {
        B_STARTOTHERROUTINE(VLK_6419_CITIZEN, TOT);
        NPC_REFRESH(VLK_6419_CITIZEN);
        TELEPORTNPCTOWP(0xd05c, VLK_6419_CITIZEN.WP);
    };
    if ((NPC_ISDEAD(VLK_6420_CITIZEN)) == (FALSE)) {
        B_STARTOTHERROUTINE(VLK_6420_CITIZEN, TOT);
        NPC_REFRESH(VLK_6420_CITIZEN);
        TELEPORTNPCTOWP(0xd061, VLK_6420_CITIZEN.WP);
    };
    if ((NPC_ISDEAD(VLK_6109_CITIZEN)) == (FALSE)) {
        B_STARTOTHERROUTINE(VLK_6109_CITIZEN, TOT);
        NPC_REFRESH(VLK_6109_CITIZEN);
        TELEPORTNPCTOWP(0xcd45, VLK_6109_CITIZEN.WP);
    };
    if ((NPC_ISDEAD(VLK_6115_GUY)) == (FALSE)) {
        B_STARTOTHERROUTINE(VLK_6115_GUY, TOT);
        NPC_REFRESH(VLK_6115_GUY);
        TELEPORTNPCTOWP(0xcc81, VLK_6115_GUY.WP);
    };
    if ((NPC_ISDEAD(VLK_6116_GUY)) == (FALSE)) {
        B_STARTOTHERROUTINE(VLK_6116_GUY, TOT);
        NPC_REFRESH(VLK_6116_GUY);
        TELEPORTNPCTOWP(0xcc85, VLK_6116_GUY.WP);
    };
    HERO.AIVAR[4] = FALSE;
    WLD_SETTIME(3, 0);
    AI_TURNTONPC(HERO, MIL_4047_PRISONGUARD);
    FADESCREENFROMBLACK(3);
}

func void Q203_MAKEMEGUARD() {
    B_HATEFROMSLUMS();
    B_LOGENTRY(TOPIC_Q203, LOG_Q203_MARVINISGUARD);
    B_GIVEPLAYERXP((XP_Q203_GOODANSWERS) * (Q203_MILITIASPEACHCOUNT));
    NPC_SETTRUEGUILD(HERO, GIL_MIL);
    HERO.GUILD = GIL_MIL;
}

func void Q203_REMOVENPC() {
    B_STARTOTHERROUTINE(MIL_4000_RODERICH, START);
    NPC_REFRESH(MIL_4000_RODERICH);
    B_STARTOTHERROUTINE(MIL_4044_SALL, START);
    NPC_REFRESH(MIL_4044_SALL);
    B_STARTOTHERROUTINE(MIL_924_WINSTAN, START);
    NPC_REFRESH(MIL_924_WINSTAN);
    B_STARTOTHERROUTINE(MIL_4016_WEGAR, START);
    NPC_REFRESH(MIL_4016_WEGAR);
    B_REMOVENPC(0xcede);
    B_STARTOTHERROUTINE(MIL_840_GOTARD, START);
    NPC_REFRESH(MIL_840_GOTARD);
    B_STARTOTHERROUTINE(MIL_4017_ARWID, START);
    NPC_REFRESH(MIL_4017_ARWID);
    B_STARTOTHERROUTINE(MIL_6402_GUIDO, START);
    NPC_REFRESH(MIL_6402_GUIDO);
    B_STARTOTHERROUTINE(MIL_6385_SAMBOR, START);
    NPC_REFRESH(MIL_6385_SAMBOR);
    B_STARTOTHERROUTINE(MIL_4047_PRISONGUARD, START);
    NPC_REFRESH(MIL_4047_PRISONGUARD);
    B_STARTOTHERROUTINE(NONE_2009_LENNART, START);
    NPC_REFRESH(NONE_2009_LENNART);
    B_STARTOTHERROUTINE(MIL_4001_OKTAV, START);
    NPC_REFRESH(MIL_4001_OKTAV);
    B_STARTOTHERROUTINE(MIL_4040_RECRUIT_V2, START);
    NPC_REFRESH(MIL_4040_RECRUIT_V2);
    B_STARTOTHERROUTINE(MIL_4041_RECRUIT_V2, START);
    NPC_REFRESH(MIL_4041_RECRUIT_V2);
    B_STARTOTHERROUTINE(MIL_4042_RECRUIT_V2, START);
    NPC_REFRESH(MIL_4042_RECRUIT_V2);
    RESTOREROUTINE_DUSTER();
    if ((NPC_ISDEAD(VLK_6421_CITIZEN)) == (FALSE)) {
        B_STARTOTHERROUTINE(VLK_6421_CITIZEN, START);
        NPC_REFRESH(VLK_6421_CITIZEN);
        TELEPORTNPCTOWP(0xd066, VLK_6421_CITIZEN.WP);
    };
    if ((NPC_ISDEAD(VLK_6418_CITIZEN)) == (FALSE)) {
        B_STARTOTHERROUTINE(VLK_6418_CITIZEN, START);
        NPC_REFRESH(VLK_6418_CITIZEN);
        TELEPORTNPCTOWP(0xd058, VLK_6418_CITIZEN.WP);
    };
    if ((NPC_ISDEAD(VLK_6419_CITIZEN)) == (FALSE)) {
        B_STARTOTHERROUTINE(VLK_6419_CITIZEN, START);
        NPC_REFRESH(VLK_6419_CITIZEN);
        TELEPORTNPCTOWP(0xd05c, VLK_6419_CITIZEN.WP);
    };
    if ((NPC_ISDEAD(VLK_6420_CITIZEN)) == (FALSE)) {
        B_STARTOTHERROUTINE(VLK_6420_CITIZEN, START);
        NPC_REFRESH(VLK_6420_CITIZEN);
        TELEPORTNPCTOWP(0xd061, VLK_6420_CITIZEN.WP);
    };
    if ((NPC_ISDEAD(VLK_6109_CITIZEN)) == (FALSE)) {
        B_STARTOTHERROUTINE(VLK_6109_CITIZEN, START);
        NPC_REFRESH(VLK_6109_CITIZEN);
        TELEPORTNPCTOWP(0xcd45, VLK_6109_CITIZEN.WP);
    };
    if ((NPC_ISDEAD(VLK_6115_GUY)) == (FALSE)) {
        B_STARTOTHERROUTINE(VLK_6115_GUY, START);
        NPC_REFRESH(VLK_6115_GUY);
        TELEPORTNPCTOWP(0xcc81, VLK_6115_GUY.WP);
    };
    if ((NPC_ISDEAD(VLK_6116_GUY)) == (FALSE)) {
        B_STARTOTHERROUTINE(VLK_6116_GUY, START);
        NPC_REFRESH(VLK_6116_GUY);
        TELEPORTNPCTOWP(0xcc85, VLK_6116_GUY.WP);
    };
}

