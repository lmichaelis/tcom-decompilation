func void ZS_JAVADFIGHT() {
    SELF.SENSES = (SENSE_HEAR) | (SENSE_SEE);
    SELF.SENSES_RANGE = PERC_DIST_ACTIVE_MAX;
    NPC_SETPERCTIME(SELF, 0x3f800000);
    NPC_PERCENABLE(SELF, PERC_ASSESSTALK, 0xa2ad);
    if (((Q306_STATE) == (10)) && (NPC_HASEQUIPPEDMELEEWEAPON(SELF))) {
        if ((NPC_HASREADIEDMELEEWEAPON(SELF)) == (FALSE)) {
            AI_DRAWWEAPON(SELF);
        };
    };
    AI_STARTSTATE(SELF, 0xb422, 0, "");
}

var int ZS_JAVADFIGHT.Q306_JAVEDDRAWWEAPON = 0;
func int ZS_JAVADFIGHTSTATE() {
    AI_STANDUP(SELF);
    B_LOOKATNPC(SELF, HERO);
    B_TURNTONPC(SELF, HERO);
    return 0 /* !broken stack! */;
}

func int ZS_JAVADFIGHT_LOOP() {
    if ((NPC_GETSTATETIME(SELF)) > (1)) {
        B_TURNTONPC(SELF, HERO);
        NPC_SETSTATETIME(SELF, 0);
    };
    if ((NPC_GETDISTTONPC(SELF, HERO)) > (PERC_DIST_INTERMEDIAT)) {
        NPC_CLEARAIQUEUE(SELF);
        return LOOP_END;
    };
    return LOOP_CONTINUE;
}

func void ZS_JAVADFIGHT_END() {
    B_STOPLOOKAT(SELF);
    AI_REMOVEWEAPON(SELF);
}

