func void SQ204_FIRSTROUND_SPAWNWOLFES() {
    SQ204_DETLOWATTACKWOLF = 1;
    WLD_INSERTNPC(0xc6e0, "PART11_PATH_101");
    WLD_INSERTNPC(0xc6e1, "PART11_MOB_06");
    WLD_INSERTNPC(0xc6e2, "PART11_MOB_07");
    WLD_INSERTNPC(0xc6e3, "PART11_MOB_05");
    WLD_INSERTNPC(0xc6e4, "PART11_PATH_109");
}

func void SQ204_SPAWNHURTEDWOLF() {
    WLD_INSERTNPC(0xdfae, "PART11_WOLFDETLOWA_HURT");
}

func void SQ204_SPAWNARMYOFWOLVES() {
    PRINTD("Wilki zrespione!");
    WLD_INSERTNPC(0xc6eb, TOT);
    WLD_INSERTNPC(0xc6ef, TOT);
    WLD_INSERTNPC(0xc6f3, TOT);
    WLD_INSERTNPC(0xc6f7, TOT);
    WLD_INSERTNPC(0xc6fb, TOT);
    WLD_INSERTNPC(0xc700, TOT);
}

func void SQ204_MOVEARMYOFWOLVES() {
    PRINTD("Wilki przeteleportowane!");
    B_STARTOTHERROUTINE(WOLF_DETLOW_07, "TELEPORT");
    B_STARTOTHERROUTINE(WOLF_DETLOW_08, "TELEPORT");
    B_STARTOTHERROUTINE(WOLF_DETLOW_11, "TELEPORT");
    B_STARTOTHERROUTINE(WOLF_DETLOW_12, "TELEPORT");
    B_STARTOTHERROUTINE(WOLF_DETLOW_13, "TELEPORT");
    B_STARTOTHERROUTINE(WOLF_DETLOW_14, "TELEPORT");
    TELEPORTNPCTOWP(0xc6eb, WOLF_DETLOW_07.WP);
    TELEPORTNPCTOWP(0xc6ef, WOLF_DETLOW_08.WP);
    TELEPORTNPCTOWP(0xc6f3, WOLF_DETLOW_11.WP);
    TELEPORTNPCTOWP(0xc6f7, WOLF_DETLOW_12.WP);
    TELEPORTNPCTOWP(0xc6fb, WOLF_DETLOW_13.WP);
    TELEPORTNPCTOWP(0xc700, WOLF_DETLOW_14.WP);
    HERO.AIVAR[4] = FALSE;
}

func void SQ204_THIRDROUND_LASTWOLFSATTACK() {
    PRINTD("O KURWA ATAK WILKÓW, O FAK!");
    B_STARTOTHERROUTINE(WOLF_DETLOW_07, "SUPRPRISEATTACK");
    NPC_REFRESH(WOLF_DETLOW_07);
    B_STARTOTHERROUTINE(WOLF_DETLOW_08, "SUPRPRISEATTACK");
    NPC_REFRESH(WOLF_DETLOW_08);
    B_STARTOTHERROUTINE(WOLF_DETLOW_11, "SUPRPRISEATTACK");
    NPC_REFRESH(WOLF_DETLOW_11);
    B_STARTOTHERROUTINE(WOLF_DETLOW_12, "SUPRPRISEATTACK");
    NPC_REFRESH(WOLF_DETLOW_12);
    B_STARTOTHERROUTINE(WOLF_DETLOW_13, "HOWL");
    NPC_REFRESH(WOLF_DETLOW_13);
    B_STARTOTHERROUTINE(WOLF_DETLOW_14, "HOWL");
    NPC_REFRESH(WOLF_DETLOW_14);
    B_STARTOTHERROUTINE(VLK_3015_DETLOW, "WOLFPHASE03FIGHT");
    SQ204_DETLOW_RTNCHECK = 10;
    NPC_REFRESH(VLK_3015_DETLOW);
    SQ204_FINALWOLFATTACK = 1;
    HERO.AIVAR[4] = FALSE;
}

func void SQ204_THIRDROUND_HOWLWOLFATTACK_01() {
    B_STARTOTHERROUTINE(WOLF_DETLOW_13, "SUPRPRISEATTACK");
    NPC_REFRESH(WOLF_DETLOW_13);
    NPC_SETTRUEGUILD(WOLF_DETLOW_13, GIL_WOLF);
    WOLF_DETLOW_13.GUILD = GIL_WOLF;
    NPC_SETTRUEGUILD(HERO, HERO.GUILD);
    B_IMMEDIATEATTACKPLAYER(WOLF_DETLOW_13, AR_KILL);
    PRINTD("Wkurwi³eœ wilka! 01");
    SQ204_CHANGEWOLFRTN_01 = TRUE;
}

func void SQ204_THIRDROUND_HOWLWOLFATTACK_02() {
    B_STARTOTHERROUTINE(WOLF_DETLOW_14, "SUPRPRISEATTACK");
    NPC_REFRESH(WOLF_DETLOW_14);
    NPC_SETTRUEGUILD(WOLF_DETLOW_14, GIL_WOLF);
    WOLF_DETLOW_14.GUILD = GIL_WOLF;
    NPC_SETTRUEGUILD(HERO, HERO.GUILD);
    B_IMMEDIATEATTACKPLAYER(WOLF_DETLOW_14, AR_KILL);
    PRINTD("Wkurwi³eœ wilka! 02");
    SQ204_CHANGEWOLFRTN_02 = TRUE;
}

func void SQ204_THIRDROUND_FINISH() {
    PRINTD("WILKI NIE ¯YJ¥!");
    B_STARTOTHERROUTINE(VLK_3015_DETLOW, FOLLOW);
    NPC_REFRESH(VLK_3015_DETLOW);
    SQ204_FINALWOLFATTACK = 3;
}

func void SQ204_KILLHURTEDWOLF_DAMAGE() {
    WOLF_DETLOW_HURT.FLAGS = 0;
    B_MAGICHURTNPC(HERO, WOLF_DETLOW_HURT, 0x270f);
    HERO.AIVAR[4] = FALSE;
}

func void SQ204_SECONDROUND_TELEPORTDETLOW() {
    MDL_REMOVEOVERLAYMDS(HERO, "HUMANS_Marvin_Sit_Howls.MDS");
    B_STARTOTHERROUTINE(VLK_3015_DETLOW, "AFTERWOLFPHASE02");
    SQ204_DETLOW_RTNCHECK = 6;
    TELEPORTNPCTOWP(0xd212, VLK_3015_DETLOW.WP);
    PRINTD("Wilki nie ¿yj¹, Detlow zteleportowany!");
}

func void SQ204_CUTSCENEENABLE_START() {
    SQ204_CUTSCENEENABLE_COUNT = (SQ204_CUTSCENEENABLE_COUNT) + (1);
    if ((SQ204_CUTSCENEENABLE_COUNT) == (4)) {
        CUTSCENE_START(0x16ad9);
    };
}

var int SQ204_CUTSCENEENABLE_START.SQ204_CUTSCENEENABLE_COUNT = 0;
func void SQ204_GOWITHDETLOW_APPLY() {
    SQ204_GOWITHDETLOW_COUNT = (SQ204_GOWITHDETLOW_COUNT) + (1);
    if ((SQ204_GOWITHDETLOW_COUNT) == (4)) {
        HERO.AIVAR[4] = FALSE;
        WLD_SENDUNTRIGGER("KM_SQ204_01");
        WLD_SENDUNTRIGGER("KM_SQ204_02");
        DIACAM_ENABLE();
    };
}

var int SQ204_GOWITHDETLOW_APPLY.SQ204_GOWITHDETLOW_COUNT = 0;
func void SQ204_DETLOW_THIRDROUND_FINISHCAMERA() {
    SQ204_DETLOW_THIRDROUND_COUNT = (SQ204_DETLOW_THIRDROUND_COUNT) + (1);
    if ((SQ204_DETLOW_THIRDROUND_COUNT) == (4)) {
        WLD_SENDUNTRIGGER("KM_SQ204_08");
        DIACAM_ENABLE();
        HERO.AIVAR[4] = FALSE;
        HERO.AIVAR[4] = FALSE;
    };
}

var int SQ204_DETLOW_THIRDROUND_FINISHCAMERA.SQ204_DETLOW_THIRDROUND_COUNT = 0;
