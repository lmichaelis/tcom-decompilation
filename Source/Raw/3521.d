func void QM203_SEWERS_RATNEST() {
    QM203_PREPAREMOVERS = 2;
    B_LOGENTRY(TOPIC_QM203, LOG_QM203_INSEWERS);
    FF_APPLYONCEEXTGT(0xf613, 0, -(1));
}

func void QM203_COUNTNEST() {
    B_GIVEPLAYERXP(XP_QM203_DESTROYEDNEST);
    PRINTD(CS2("Zniszczone gniazda ", INTTOSTRING(QM203_RATNESTDESTROYEDCOUNT)));
    AI_WAIT(HERO, 0x3f99999a);
    AI_USEMOB(HERO, NPC_GETDETECTEDMOB(HERO), -(1));
    AI_FUNCTION(HERO, 0xf610);
    if ((QM203_RATNESTDESTROYEDCOUNT) == (1)) {
        B_LOGENTRY(TOPIC_QM203, LOG_SQ228_RATNEST);
        AI_OUTPUT(HERO, HERO, "DIA_Marvin_SQ228_Smell_15_01");
    };
    if ((QM203_RATNESTDESTROYEDCOUNT) == (3)) {
        if ((NPC_GETDISTTOWP(HERO, "S2_PATH_16")) <= (QM203_WPDISTANCE)) {
            WLD_INSERTNPC(0xe682, "S2_PATH_03");
        } else if ((NPC_GETDISTTOWP(HERO, "S2_PATH_19")) <= (QM203_WPDISTANCE)) {
            WLD_INSERTNPC(0xe682, "S2_PATH_16");
        } else if ((NPC_GETDISTTOWP(HERO, "S2_PATH_23")) <= (QM203_WPDISTANCE)) {
            WLD_INSERTNPC(0xe682, "S2_PATH_19");
        } else if ((NPC_GETDISTTOWP(HERO, "S2_PATH_26")) <= (QM203_WPDISTANCE)) {
            WLD_INSERTNPC(0xe682, "S2_PATH_19");
        } else if ((NPC_GETDISTTOWP(HERO, "S2_PATH_29")) <= (QM203_WPDISTANCE)) {
            WLD_INSERTNPC(0xe682, "S2_PATH_26");
        };
    };
    if ((QM203_RATNESTDESTROYEDCOUNT) == (5)) {
        B_LOGENTRY(TOPIC_QM203, LOG_QM203_RATNESTSDONE);
    };
}

const int QM203_COUNTNEST.QM203_WPDISTANCE = 900;
func void QM203_COUNTNEST_REMOVEPOTION() {
    FF_APPLYONCEEXT(0xf611, 30, 5);
    HERO.AIVAR[4] = FALSE;
    PLAYER_MOBSI_PRODUCTION = MOBSI_NONE;
    AI_STOPPROCESSINFOS(HERO);
}

func void QM203_COUNTNEST_REMOVEPOTION_APPLY() {
    QM203_COUNTNEST_REMOVEPOTION_COUNT = (QM203_COUNTNEST_REMOVEPOTION_COUNT) + (1);
    if ((QM203_COUNTNEST_REMOVEPOTION_COUNT) == (5)) {
        QM203_COUNTNEST_REMOVEPOTION_COUNT = 0;
        NPC_REMOVEINVITEMS(HERO, 0x90f7, 1);
        PRINTD("Usuwam truciznê");
    };
}

var int QM203_COUNTNEST_REMOVEPOTION_APPLY.QM203_COUNTNEST_REMOVEPOTION_COUNT = 0;
func void QM203_SEWERS_RATNEST_APPLY() {
    if ((QM203_SEWERS_RATNEST_COUNT) == (0)) {
        PRINTD("Rozpoczynam - QM203_SEWERS_RATNEST_APPLY");
        MOVPTR1 = MEM_SEARCHVOBBYNAME("QM203_MOVER_RATNEST_01");
        MOVER1 = MEM_PTRTOINST(MOVPTR1);
        MOVPTR2 = MEM_SEARCHVOBBYNAME("QM203_MOVER_RATNEST_02");
        MOVER2 = MEM_PTRTOINST(MOVPTR2);
        MOVPTR3 = MEM_SEARCHVOBBYNAME("QM203_MOVER_RATNEST_03");
        MOVER3 = MEM_PTRTOINST(MOVPTR3);
        MOVPTR4 = MEM_SEARCHVOBBYNAME("QM203_MOVER_RATNEST_04");
        MOVER4 = MEM_PTRTOINST(MOVPTR4);
        MOVPTR5 = MEM_SEARCHVOBBYNAME("QM203_MOVER_RATNEST_05");
        MOVER5 = MEM_PTRTOINST(MOVPTR5);
        CHANGEVOBCOLLISION("QM203_RATNEST_01", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("QM203_RATNEST_02", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("QM203_RATNEST_03", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("QM203_RATNEST_04", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("QM203_RATNEST_05", FALSE, FALSE, FALSE, TRUE);
        WLD_SENDTRIGGER("QM203_MOVER_RATNEST_01");
        WLD_SENDTRIGGER("QM203_MOVER_RATNEST_02");
        WLD_SENDTRIGGER("QM203_MOVER_RATNEST_03");
        WLD_SENDTRIGGER("QM203_MOVER_RATNEST_04");
        WLD_SENDTRIGGER("QM203_MOVER_RATNEST_05");
        QM203_SEWERS_RATNEST_COUNT = 1;
    };
    if (((((((((((MOVER1.MOVERSTATE) != (MOVER_STATE_OPENING)) && ((MOVER1.MOVERSTATE) != (MOVER_STATE_CLOSING))) && ((MOVER2.MOVERSTATE) != (MOVER_STATE_OPENING))) && ((MOVER2.MOVERSTATE) != (MOVER_STATE_CLOSING))) && ((MOVER3.MOVERSTATE) != (MOVER_STATE_OPENING))) && ((MOVER3.MOVERSTATE) != (MOVER_STATE_CLOSING))) && ((MOVER4.MOVERSTATE) != (MOVER_STATE_OPENING))) && ((MOVER4.MOVERSTATE) != (MOVER_STATE_CLOSING))) && ((MOVER5.MOVERSTATE) != (MOVER_STATE_OPENING))) && ((MOVER5.MOVERSTATE) != (MOVER_STATE_CLOSING))) {
        PRINTD("Skoñczy³em - QM203_SEWERS_RATNEST_APPLY");
        CHANGEVOBCOLLISION("QM203_RATNEST_01", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("QM203_RATNEST_02", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("QM203_RATNEST_03", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("QM203_RATNEST_04", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("QM203_RATNEST_05", TRUE, TRUE, TRUE, TRUE);
        FF_REMOVE(0xf613);
        QM203_SEWERS_RATNEST_COUNT = 0;
    };
}

var int QM203_SEWERS_RATNEST_APPLY.QM203_SEWERS_RATNEST_COUNT = 0;
instance QM203_SEWERS_RATNEST_APPLY.MOVER1(ZCMOVER)
instance QM203_SEWERS_RATNEST_APPLY.MOVER2(ZCMOVER)
instance QM203_SEWERS_RATNEST_APPLY.MOVER3(ZCMOVER)
instance QM203_SEWERS_RATNEST_APPLY.MOVER4(ZCMOVER)
instance QM203_SEWERS_RATNEST_APPLY.MOVER5(ZCMOVER)
var int QM203_SEWERS_RATNEST_APPLY.MOVPTR1 = 0;
var int QM203_SEWERS_RATNEST_APPLY.MOVPTR2 = 0;
var int QM203_SEWERS_RATNEST_APPLY.MOVPTR3 = 0;
var int QM203_SEWERS_RATNEST_APPLY.MOVPTR4 = 0;
var int QM203_SEWERS_RATNEST_APPLY.MOVPTR5 = 0;
func void QM203_SEWERS_REMOVERATNESTS() {
    QM203_REMOVERATNESTS = 2;
    WLD_SENDTRIGGER("QM203_MOVER_RATNEST_POISON_01");
    WLD_SENDTRIGGER("QM203_MOVER_RATNEST_POISON_02");
    WLD_SENDTRIGGER("QM203_MOVER_RATNEST_POISON_03");
    WLD_SENDTRIGGER("QM203_MOVER_RATNEST_POISON_04");
    WLD_SENDTRIGGER("QM203_MOVER_RATNEST_POISON_05");
    FF_APPLYONCEEXTGT(0xf613, 0, -(1));
}

func void QM203_REMOVEBALUEN() {
    if (HLP_ISVALIDNPC(NONE_13677_BALUEN)) {
        B_REMOVENPC(0xe682);
    };
}

