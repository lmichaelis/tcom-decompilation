func void Q305_SPAWNPIRATES() {
    Q305_PREPARESCENE = 1;
    B_STARTOTHERROUTINE(PIR_1308_SIMON, "CUTSCENEPIRATES");
    NPC_REFRESH(PIR_1308_SIMON);
    TELEPORTNPCTOWP(0xe54f, "P17_HAVEN_SMALLTALK_02");
    FF_APPLYONCEEXTGT(0xee00, 0, -(1));
    WLD_INSERTNPC(0xc99d, "P17_HAVEN_SMALLTALK_02");
    WLD_INSERTNPC(0xc920, "P17_HAVEN_SMALLTALK_01");
}

func void Q305_SPAWNPIRATES_APPLY() {
    if ((Q305_SPAWNPIRATES_COUNT) == (0)) {
        PRINTD("Rozpoczynam - Q305_SpawnPirates_Apply");
        MOVPTR1 = MEM_SEARCHVOBBYNAME("KM_FRIENDS_SHIPSMOVER_01");
        MOVER1 = MEM_PTRTOINST(MOVPTR1);
        CHANGEVOBCOLLISION("KM_PIRATESBOAT_01", FALSE, FALSE, FALSE, TRUE);
        WLD_SENDTRIGGER("KM_FRIENDS_SHIPSMOVER_01");
        Q305_SPAWNPIRATES_COUNT = 1;
    };
    if (((MOVER1.MOVERSTATE) != (MOVER_STATE_OPENING)) && ((MOVER1.MOVERSTATE) != (MOVER_STATE_CLOSING))) {
        PRINTD("Skoñczy³em - Q305_SpawnPirates_Apply");
        CHANGEVOBCOLLISION("KM_PIRATESBOAT_01", FALSE, TRUE, TRUE, TRUE);
        FF_REMOVE(0xee00);
        Q305_SPAWNPIRATES_COUNT = 0;
    };
}

var int Q305_SPAWNPIRATES_APPLY.Q305_SPAWNPIRATES_COUNT = 0;
instance Q305_SPAWNPIRATES_APPLY.MOVER1(ZCMOVER)
var int Q305_SPAWNPIRATES_APPLY.MOVPTR1 = 0;
func void Q305_PREPAREBECKETTCUTSCENE() {
    HERO.AIVAR[4] = TRUE;
    FF_APPLYONCEEXT(0xee05, 75, 4);
}

func void Q305_PREPAREBECKETTCUTSCENE_APPLY() {
    Q305_PREPAREBECKETTCUTSCENE_COUNT = (Q305_PREPAREBECKETTCUTSCENE_COUNT) + (1);
    if ((Q305_PREPAREBECKETTCUTSCENE_COUNT) == (4)) {
        CUTSCENE_START(0x16930);
        Q305_PREPAREBECKETTCUTSCENE_COUNT = 0;
    };
}

var int Q305_PREPAREBECKETTCUTSCENE_APPLY.Q305_PREPAREBECKETTCUTSCENE_COUNT = 0;
func void Q305_BECKETTISBACK_END() {
    FF_APPLYONCEEXT(0xee08, 75, 4);
}

func void Q305_BECKETTISBACK_END_APPLY() {
    Q305_BECKETTISBACK_END_COUNT = (Q305_BECKETTISBACK_END_COUNT) + (1);
    if ((Q305_BECKETTISBACK_END_COUNT) == (4)) {
        WLD_SENDUNTRIGGER("KM_PIRATESMALLTALK");
        PIR_6330_CAPTAIN_ARCHOLOS.AIVAR[92] = FALSE;
        PIR_1308_SIMON.AIVAR[92] = FALSE;
        B_STARTOTHERROUTINE(PIR_1308_SIMON, "Q305");
        NPC_REFRESH(PIR_1308_SIMON);
        B_STARTOTHERROUTINE(PIR_6330_CAPTAIN_ARCHOLOS, "SMALLTALK");
        NPC_REFRESH(PIR_6330_CAPTAIN_ARCHOLOS);
        B_STARTOTHERROUTINE(PIR_13180_SMUGGLER_ARCHOLOS, "SMALLTALK");
        NPC_REFRESH(PIR_13180_SMUGGLER_ARCHOLOS);
        HERO.AIVAR[4] = FALSE;
        Q305_BECKETTISBACK_END_COUNT = 0;
    };
}

var int Q305_BECKETTISBACK_END_APPLY.Q305_BECKETTISBACK_END_COUNT = 0;
func void Q305_CRATESANDBARRELS_ON() {
    CHANGEVOBCOLLISION("Q305_OCEAN_01", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_02", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_03", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_04", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_05", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_06", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_07", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_08", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_09", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_10", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_11", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_12", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_13", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_14", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_15", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_16", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_17", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_18", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_19", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_20", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_21", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_22", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_23", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_24", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_25", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_26", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_27", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_28", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_29", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_30", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_31", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_32", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_33", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_34", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_35", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_36", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_37", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_38", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_39", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_40", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_41", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_42", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_43", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_44", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_45", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_46", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_47", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_48", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_49", TRUE, TRUE, TRUE, TRUE);
    CHANGEVOBCOLLISION("Q305_OCEAN_50", TRUE, TRUE, TRUE, TRUE);
}

func void Q305_CRATESANDBARRELS_OFF() {
    CHANGEVOBCOLLISION("Q305_OCEAN_01", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_02", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_03", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_04", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_05", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_06", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_07", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_08", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_09", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_10", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_11", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_12", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_13", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_14", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_15", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_16", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_17", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_18", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_19", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_20", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_21", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_22", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_23", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_24", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_25", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_26", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_27", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_28", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_29", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_30", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_31", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_32", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_33", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_34", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_35", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_36", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_37", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_38", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_39", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_40", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_41", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_42", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_43", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_44", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_45", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_46", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_47", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_48", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_49", FALSE, FALSE, FALSE, FALSE);
    CHANGEVOBCOLLISION("Q305_OCEAN_50", FALSE, FALSE, FALSE, FALSE);
}

func void Q305_PREPAREALLEVENTS() {
    WLD_INSERTNPC(0xc59f, "FP_PART14_ISLAND_MONSTER_ROAM_01");
    WLD_INSERTNPC(0xc5a0, "FP_PART14_ISLAND_MONSTER_ROAM_02");
    WLD_INSERTNPC(0xc5a1, "FP_PART14_ISLAND_MONSTER_ROAM_03");
    WLD_INSERTNPC(0xe214, "PART14_ISLAND_HERDIS");
    WLD_INSERTNPC(0xe220, "PART14_ISLAND_MILLE");
    MDL_APPLYOVERLAYMDS(NONE_6335_MILLIE, HUMANSHURTMDS);
    WLD_INSERTITEM(0x918d, "PART14_ISLAND_WEAPON_01");
    WLD_INSERTITEM(0x918d, "PART14_ISLAND_WEAPON_02");
    WLD_INSERTITEM(0x918d, "PART14_ISLAND_WEAPON_03");
    WLD_INSERTNPC(0xc9b2, "PART17_ISLAND_PIRATE");
    WLD_INSERTNPC(0xc3b9, "PART17_ISLAND_CRAB");
    B_KILLNPC(0xc3b9);
    WLD_INSERTNPC(0xe4d4, "PART17_PATH_79");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_01");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_02");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_03");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_04");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_05");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_06");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_07");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_08");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_09");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_10");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_11");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_12");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_13");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_14");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_15");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_16");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_17");
    WLD_INSERTNPC(0xc3e7, "PART17_SWAMPBLOOD_17");
    WLD_INSERTNPC(0xc3e7, "PART17_SWAMPBLOOD_16");
    FF_APPLYONCEEXTGT(0xee0d, 0, -(1));
    WLD_INSERTITEM(0x918b, "FP_BLOODTRACE_POCKET");
    WLD_SENDTRIGGER("KM_FRIENDS_FIREPLACE_MOVER");
    WLD_INSERTNPC(0xe4c6, "PART17_CAVE_CAMPFIRE_01");
    WLD_INSERTNPC(0xc596, "FP_ROAM_PART17_27");
    B_KILLNPC(0xc596);
    WLD_INSERTNPC(0xc3fb, "FP_ROAM_PART17_28");
    B_KILLNPC(0xc3fb);
    WLD_INSERTNPC(0xc596, "FP_ROAM_PART17_29");
    B_KILLNPC(0xc596);
    WLD_INSERTNPC(0xc3fb, "FP_ROAM_PART17_147");
    B_KILLNPC(0xc3fb);
    WLD_INSERTNPC(0xc75c, "FP_ROAM_PART17_148");
    B_KILLNPC(0xc75c);
    WLD_INSERTNPC(0xc3fb, "FP_ROAM_PART17_149");
    B_KILLNPC(0xc3fb);
    WLD_INSERTNPC(0xc5e6, "FP_ROAM_PART17_150");
    B_KILLNPC(0xc5e6);
    WLD_INSERTNPC(0xc3e7, "FP_ROAM_PART17_151");
    B_KILLNPC(0xc3e7);
    WLD_INSERTNPC(0xc5e6, "FP_ROAM_PART17_152");
    B_KILLNPC(0xc5e6);
    WLD_INSERTNPC(0xc549, "FP_ROAM_PART15_234");
    WLD_INSERTNPC(0xc3fd, "FP_WITHOUTTRACE_MOLERAT_03");
    WLD_INSERTNPC(0xc549, "FP_WITHOUTTRACE_MOLERAT_01");
    WLD_INSERTNPC(0xc549, "FP_ROAM_PART15_233");
    WLD_INSERTNPC(0xc549, "FP_ROAM_PART15_232");
    WLD_INSERTITEM(0x9188, "FP_PART17_CAVE_JAVADTREASURE");
    WLD_INSERTNPC(0xc3e7, "FP_ROAM_PART17_79");
    WLD_INSERTNPC(0xc596, "FP_ROAM_PART17_83");
    WLD_INSERTNPC(0xe4e0, "PART15_PATH_269");
    WLD_INSERTNPC(0xc53b, "FP_ROAM_PART15_241");
    WLD_INSERTNPC(0xc53b, "FP_ROAM_PART15_243");
    WLD_INSERTNPC(0xc3fb, "FP_ROAM_PART15_248");
    WLD_INSERTNPC(0xc549, "FP_ROAM_PART15_247");
    WLD_INSERTNPC(0xc75c, "FP_ROAM_PART15_219");
    WLD_INSERTNPC(0xc53b, "PART15_PATH_269");
    B_KILLNPC(0xc53b);
    WLD_INSERTITEM(0x9190, "FP_PART17_SPAWNITEM_SWORD_HARRI");
    Q305_CRATESANDBARRELS_ON();
}

func void Q305_PREPAREALLEVENTS_APPLY() {
    if ((Q305_PREPAREALLEVENTS_COUNT) == (0)) {
        PRINTD("Rozpoczynam - Q305_PrepareAllEvents_Apply");
        MOVPTR1 = MEM_SEARCHVOBBYNAME("KM_CORPSEBOAT_MOVER");
        MOVER1 = MEM_PTRTOINST(MOVPTR1);
        MOVPTR2 = MEM_SEARCHVOBBYNAME("KM_BLOODTRACE_MOVER");
        MOVER2 = MEM_PTRTOINST(MOVPTR2);
        MOVPTR3 = MEM_SEARCHVOBBYNAME("KM_SWAMPMINERS_MOVER");
        MOVER3 = MEM_PTRTOINST(MOVPTR3);
        MOVPTR4 = MEM_SEARCHVOBBYNAME("KM_CHESTPUSHSWAMP_MOVER");
        MOVER4 = MEM_PTRTOINST(MOVPTR4);
        MOVPTR5 = MEM_SEARCHVOBBYNAME("Q305_MOVER_HERDISCAMP");
        MOVER5 = MEM_PTRTOINST(MOVPTR5);
        CHANGEVOBCOLLISION("KM_BLOODTRACE_BODY_01", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("KM_BLOODTRACE_BODY_02", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("KM_SWAMPMINER_01", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("KM_SWAMPMINER_02", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("KM_SWAMPMINER_03", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("KM_CHESTPUSHSWAMP", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("KM_FRIENDISLAND_BOAT", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("KM_FRIENDISLAND_PIRATE", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("KM_FRIENDISLAND_CRATE", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("Q305_FIREPLACE", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("Q305_BED_01", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("Q305_BED_02", FALSE, FALSE, FALSE, TRUE);
        WLD_SENDTRIGGER("KM_CORPSEBOAT_MOVER");
        WLD_SENDTRIGGER("KM_BLOODTRACE_MOVER");
        WLD_SENDTRIGGER("KM_SWAMPMINERS_MOVER");
        WLD_SENDTRIGGER("KM_CHESTPUSHSWAMP_MOVER");
        WLD_SENDTRIGGER("Q305_MOVER_HERDISCAMP");
        Q305_PREPAREALLEVENTS_COUNT = 1;
    };
    if (((((((((((MOVER1.MOVERSTATE) != (MOVER_STATE_OPENING)) && ((MOVER1.MOVERSTATE) != (MOVER_STATE_CLOSING))) && ((MOVER2.MOVERSTATE) != (MOVER_STATE_OPENING))) && ((MOVER2.MOVERSTATE) != (MOVER_STATE_CLOSING))) && ((MOVER3.MOVERSTATE) != (MOVER_STATE_OPENING))) && ((MOVER3.MOVERSTATE) != (MOVER_STATE_CLOSING))) && ((MOVER4.MOVERSTATE) != (MOVER_STATE_OPENING))) && ((MOVER4.MOVERSTATE) != (MOVER_STATE_CLOSING))) && ((MOVER5.MOVERSTATE) != (MOVER_STATE_OPENING))) && ((MOVER5.MOVERSTATE) != (MOVER_STATE_CLOSING))) {
        PRINTD("Skoñczy³em - Q305_PrepareAllEvents_Apply");
        CHANGEVOBCOLLISION("KM_BLOODTRACE_BODY_01", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("KM_BLOODTRACE_BODY_02", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("KM_SWAMPMINER_01", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("KM_SWAMPMINER_02", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("KM_SWAMPMINER_03", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("KM_CHESTPUSHSWAMP", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("KM_FRIENDISLAND_BOAT", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("KM_FRIENDISLAND_PIRATE", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("KM_FRIENDISLAND_CRATE", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("Q305_FIREPLACE", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("Q305_BED_01", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("Q305_BED_02", TRUE, TRUE, TRUE, TRUE);
        FF_REMOVE(0xee0d);
        Q305_PREPAREALLEVENTS_COUNT = 0;
    };
}

var int Q305_PREPAREALLEVENTS_APPLY.Q305_PREPAREALLEVENTS_COUNT = 0;
instance Q305_PREPAREALLEVENTS_APPLY.MOVER1(ZCMOVER)
instance Q305_PREPAREALLEVENTS_APPLY.MOVER2(ZCMOVER)
instance Q305_PREPAREALLEVENTS_APPLY.MOVER3(ZCMOVER)
instance Q305_PREPAREALLEVENTS_APPLY.MOVER4(ZCMOVER)
instance Q305_PREPAREALLEVENTS_APPLY.MOVER5(ZCMOVER)
var int Q305_PREPAREALLEVENTS_APPLY.MOVPTR1 = 0;
var int Q305_PREPAREALLEVENTS_APPLY.MOVPTR2 = 0;
var int Q305_PREPAREALLEVENTS_APPLY.MOVPTR3 = 0;
var int Q305_PREPAREALLEVENTS_APPLY.MOVPTR4 = 0;
var int Q305_PREPAREALLEVENTS_APPLY.MOVPTR5 = 0;
func void Q305_BERTELBETRAY() {
    NONE_6332_BERTEL.GUILD = GIL_BDT;
    NPC_SETTRUEGUILD(HERO, HERO.GUILD);
    PIR_1308_SIMON.FLAGS = 2;
    NPC_SETTRUEGUILD(NONE_6332_BERTEL, GIL_BDT);
    NONE_6332_BERTEL.FLAGS = 0;
    NONE_6332_BERTEL.ATTRIBUTE[0] = 10;
    NONE_6332_BERTEL.ATTRIBUTE[1] = 10;
    NONE_6332_BERTEL.AIVAR[52] = TRUE;
}

func void Q305_BERTELGOTOCITY() {
    B_STARTOTHERROUTINE(NONE_6332_BERTEL, "CITY");
    NPC_REFRESH(NONE_6332_BERTEL);
    TELEPORTNPCTOWP(0xe4d4, NONE_6332_BERTEL.WP);
}

func void Q305_ASKEGRAVE() {
    HERO.AIVAR[4] = TRUE;
    FF_APPLYONCEEXT(0xee1c, 75, 4);
}

func void Q305_ASKEGRAVE_APPLY() {
    Q305_ASKEGRAVE_COUNT = (Q305_ASKEGRAVE_COUNT) + (1);
    if ((Q305_ASKEGRAVE_COUNT) == (4)) {
        WLD_SENDTRIGGER("KM_FRIENDSISLAND_PIRATE");
        TELEPORTNPCTOWP(0xc9b2, "PART17_ISLAND_PIRATE");
        TELEPORTNPCTOWP(0x71b, "PART17_ISLAND_HERO");
        AI_PLAYANIBS(HERO, "T_STAND_2_TURKISHSIT", BS_SIT);
        AI_PLAYANIBS(PIR_132290_SMUGGLER_ARCHOLOS, T_STAND_2_SIT, BS_SIT);
        FADESCREENTOBLACKF(4, 0xee1e, 1000);
    };
}

var int Q305_ASKEGRAVE_APPLY.Q305_ASKEGRAVE_COUNT = 0;
func void Q305_ASKEGRAVE_FADESCREEN() {
    WLD_SENDUNTRIGGER("KM_FRIENDSISLAND_PIRATE");
    TELEPORTNPCTOWP(0x71b, "PART17_ISLAND_HERO2");
    AI_PLAYANIBS(HERO, "T_TURKISHSIT_2_STAND", BS_STAND);
    B_REMOVENPC(0xc9b2);
    FF_APPLYONCEEXTGT(0xee27, 0, -(1));
    B_PASSTIME(1);
    HERO.AIVAR[4] = FALSE;
    FADESCREENFROMBLACK(2);
}

func void Q305_BERTEL_PUSHCHEST() {
    HERO.AIVAR[4] = TRUE;
    FF_APPLYONCEEXT(0xee20, 75, 4);
}

func void Q305_BERTEL_PUSHCHEST_APPLY() {
    Q305_BERTEL_PUSHCHEST_COUNT = (Q305_BERTEL_PUSHCHEST_COUNT) + (1);
    if ((Q305_BERTEL_PUSHCHEST_COUNT) == (4)) {
        CUTSCENE_START(0x16935);
        Q305_BERTEL_PUSHCHEST_COUNT = 0;
    };
}

var int Q305_BERTEL_PUSHCHEST_APPLY.Q305_BERTEL_PUSHCHEST_COUNT = 0;
func void Q305_BERTELSWAMPCHEST() {
    FF_APPLYONCEEXTGT(0xee23, 0, -(1));
}

func void Q305_BERTELSWAMPCHEST_APPLY() {
    if ((CHANGECHESTSWAMPCOLLISION) == (0)) {
        PRINTD("Rozpoczynam - Q305_BertelSwampChest_Apply");
        MOVPTR1 = MEM_SEARCHVOBBYNAME("KM_CHESTPUSHSWAMP_MOVER");
        MOVER1 = MEM_PTRTOINST(MOVPTR1);
        CHANGEVOBCOLLISION("KM_CHESTPUSHSWAMP", FALSE, FALSE, FALSE, TRUE);
        WLD_SENDTRIGGER("KM_CHESTPUSHSWAMP_MOVER");
        CHANGECHESTSWAMPCOLLISION = 1;
    };
    if (((MOVER1.MOVERSTATE) != (MOVER_STATE_OPENING)) && ((MOVER1.MOVERSTATE) != (MOVER_STATE_CLOSING))) {
        PRINTD("Skoñczy³em - Q305_BertelSwampChest_Apply");
        CHANGEVOBCOLLISION("KM_CHESTPUSHSWAMP", TRUE, TRUE, TRUE, TRUE);
        FF_REMOVE(0xee23);
        CHANGECHESTSWAMPCOLLISION = 0;
    };
}

var int Q305_BERTELSWAMPCHEST_APPLY.CHANGECHESTSWAMPCOLLISION = 0;
instance Q305_BERTELSWAMPCHEST_APPLY.MOVER1(ZCMOVER)
var int Q305_BERTELSWAMPCHEST_APPLY.MOVPTR1 = 0;
func void Q305_ASKECHEST_APPLY() {
    if ((Q305_ASKECHEST_COUNT) == (0)) {
        PRINTD("Rozpoczynam - Q305_AskeChest_Apply");
        MOVPTR = MEM_SEARCHVOBBYNAME("KM_ISLANDPIRATE_MOVER");
        MOVER = MEM_PTRTOINST(MOVPTR);
        CHANGEVOBCOLLISION("KM_ISLANDPIRATE_CHEST", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("KM_ISLANDPIRATE_SAND", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("KM_ISLANDPIRATE_SHOVEL", FALSE, FALSE, FALSE, TRUE);
        WLD_SENDTRIGGER("KM_ISLANDPIRATE_MOVER");
        Q305_ASKECHEST_COUNT = 1;
    };
    if (((MOVER.MOVERSTATE) != (MOVER_STATE_OPENING)) && ((MOVER.MOVERSTATE) != (MOVER_STATE_CLOSING))) {
        PRINTD("Skoñczy³em - Q305_AskeChest_Apply");
        CHANGEVOBCOLLISION("KM_ISLANDPIRATE_CHEST", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("KM_ISLANDPIRATE_SAND", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("KM_ISLANDPIRATE_SHOVEL", TRUE, TRUE, TRUE, TRUE);
        FF_REMOVE(0xee27);
        Q305_ASKECHEST_COUNT = 0;
    };
}

var int Q305_ASKECHEST_APPLY.Q305_ASKECHEST_COUNT = 0;
instance Q305_ASKECHEST_APPLY.MOVER(ZCMOVER)
var int Q305_ASKECHEST_APPLY.MOVPTR = 0;
func void Q305_CHANGEPALMTRUNKNAME() {
    PRINTSCREENS(PRINT_THATSENOUGH, -(1), -(1), FONT_SCREENSMALL, 2);
    MOB_CHANGEFOCUSNAME("Q305_PALMTRUNK_03", "MOBNAME_NOTHING");
}

func void Q305_BLOCKOTHERPALMS() {
    Q305_ISLANDPALM01_CUT = TRUE;
    Q305_ISLANDPALM02_CUT = TRUE;
    Q305_ISLANDPALM03_CUT = TRUE;
}

func void Q305_CHANGEPALMNAME() {
    MOB_CHANGEFOCUSNAME("Q305_PALM_03", "MOBNAME_NOTHING");
}

func void Q305_CAPTAINATTACK() {
    B_IMMEDIATEATTACKPLAYER(PIR_6330_CAPTAIN_ARCHOLOS, AR_KILL);
    B_IMMEDIATEATTACKPLAYER(PIR_13180_SMUGGLER_ARCHOLOS, AR_KILL);
    PIR_6330_CAPTAIN_ARCHOLOS.FLAGS = 0;
    PIR_13180_SMUGGLER_ARCHOLOS.FLAGS = 0;
    PIR_6330_CAPTAIN_ARCHOLOS.AIVAR[52] = TRUE;
    PIR_13180_SMUGGLER_ARCHOLOS.AIVAR[52] = TRUE;
}

func void Q305_HERDISHELPMILLIE_PREPARE() {
    HERO.AIVAR[4] = TRUE;
    FF_APPLYONCEEXT(0xee30, 75, 4);
}

func void Q305_HERDISHELPMILLIE_APPLY() {
    Q305_HERDISHELPMILLIE_COUNT = (Q305_HERDISHELPMILLIE_COUNT) + (1);
    if ((Q305_HERDISHELPMILLIE_COUNT) == (4)) {
        CUTSCENE_START(0x16933);
        Q305_HERDISHELPMILLIE_COUNT = 0;
    };
}

var int Q305_HERDISHELPMILLIE_APPLY.Q305_HERDISHELPMILLIE_COUNT = 0;
func void Q305_HERDISHELPMILLIE_END() {
    FF_APPLYONCEEXT(0xee33, 75, 4);
}

func void Q305_HERDISHELPMILLIE_END_APPLY() {
    Q305_HERDISHELPMILLIE_END_COUNT = (Q305_HERDISHELPMILLIE_END_COUNT) + (1);
    if ((Q305_HERDISHELPMILLIE_END_COUNT) == (4)) {
        Q305_MILLIECANTALK = TRUE;
        WLD_SENDUNTRIGGER("KM_ISLANDFRIENDS_01");
        B_STARTOTHERROUTINE(NONE_6334_HERDIS, "ISLAND");
        NPC_REFRESH(NONE_6334_HERDIS);
        B_STARTOTHERROUTINE(NONE_6335_MILLIE, "ISLAND");
        NPC_REFRESH(NONE_6335_MILLIE);
        MDL_REMOVEOVERLAYMDS(NONE_6335_MILLIE, HUMANSHURTMDS);
        HERO.AIVAR[4] = FALSE;
        Q305_HERDISHELPMILLIE_END_COUNT = 0;
    };
}

var int Q305_HERDISHELPMILLIE_END_APPLY.Q305_HERDISHELPMILLIE_END_COUNT = 0;
func void Q305_HIDEHERDISCAMP() {
    FF_APPLYONCEEXTGT(0xee36, 0, -(1));
}

func void Q305_HIDEHERDISCAMP_APPLY() {
    if ((Q305_HIDEHERDISCAMP_COUNT) == (0)) {
        PRINTD("Rozpoczynam - Q305_HideHerdisCamp_Apply");
        MOVPTR1 = MEM_SEARCHVOBBYNAME("Q305_MOVER_HERDISCAMP");
        MOVER1 = MEM_PTRTOINST(MOVPTR1);
        MOVPTR2 = MEM_SEARCHVOBBYNAME("KM_ISLAND_READYSHIP_MOVER");
        MOVER2 = MEM_PTRTOINST(MOVPTR2);
        CHANGEVOBCOLLISION("Q305_FIREPLACE", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("Q305_BED_01", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("Q305_BED_02", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("KM_ISLAND_SHIPREADY", FALSE, FALSE, FALSE, TRUE);
        WLD_SENDTRIGGER("Q305_MOVER_HERDISCAMP");
        WLD_SENDTRIGGER("KM_ISLAND_READYSHIP_MOVER");
        Q305_HIDEHERDISCAMP_COUNT = 1;
    };
    if (((((MOVER1.MOVERSTATE) != (MOVER_STATE_OPENING)) && ((MOVER1.MOVERSTATE) != (MOVER_STATE_CLOSING))) && ((MOVER2.MOVERSTATE) != (MOVER_STATE_OPENING))) && ((MOVER2.MOVERSTATE) != (MOVER_STATE_CLOSING))) {
        PRINTD("Skoñczy³em - Q305_HideHerdisCamp_Apply");
        CHANGEVOBCOLLISION("Q305_FIREPLACE", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("Q305_BED_01", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("Q305_BED_02", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("KM_ISLAND_SHIPREADY", TRUE, TRUE, TRUE, TRUE);
        FF_REMOVE(0xee36);
        Q305_HIDEHERDISCAMP_COUNT = 0;
    };
}

var int Q305_HIDEHERDISCAMP_APPLY.Q305_HIDEHERDISCAMP_COUNT = 0;
instance Q305_HIDEHERDISCAMP_APPLY.MOVER1(ZCMOVER)
instance Q305_HIDEHERDISCAMP_APPLY.MOVER2(ZCMOVER)
var int Q305_HIDEHERDISCAMP_APPLY.MOVPTR1 = 0;
var int Q305_HIDEHERDISCAMP_APPLY.MOVPTR2 = 0;
func void Q305_TELEPORTGIRLS_PIRATES() {
    FADESCREENTOBLACKF(1, 0xee3e, 1000);
}

func void Q305_TELEPORTGIRLS_FARM() {
    FADESCREENTOBLACKF(1, 0xee3f, 1000);
}

func void Q305_TELEPORTGIRLS_PIRATES_FADESCREEN() {
    B_STARTOTHERROUTINE(NONE_6334_HERDIS, "TOPIRATES");
    NPC_REFRESH(NONE_6334_HERDIS);
    TELEPORTNPCTOWP(0xe214, NONE_6334_HERDIS.WP);
    B_STARTOTHERROUTINE(NONE_6335_MILLIE, "TOPIRATES");
    NPC_REFRESH(NONE_6335_MILLIE);
    TELEPORTNPCTOWP(0xe220, NONE_6335_MILLIE.WP);
    TELEPORTNPCTOWP(0x71b, "P17_HAVEN_OUT_07");
    B_PASSTIME(6);
    Q305_HIDEHERDISCAMP();
    HERO.AIVAR[4] = FALSE;
    FADESCREENFROMBLACK(1);
}

func void Q305_TELEPORTGIRLS_FARM_FADESCREEN() {
    NPC_REFRESH(NONE_6334_HERDIS);
    B_STARTOTHERROUTINE(NONE_6334_HERDIS, "TOFARM");
    TELEPORTNPCTOWP(0xe214, NONE_6334_HERDIS.WP);
    B_STARTOTHERROUTINE(NONE_6335_MILLIE, "TOFARM");
    NPC_REFRESH(NONE_6335_MILLIE);
    TELEPORTNPCTOWP(0xe220, NONE_6335_MILLIE.WP);
    TELEPORTNPCTOWP(0x71b, "PART15_PATH_165");
    B_PASSTIME(6);
    Q305_HIDEHERDISCAMP();
    HERO.AIVAR[4] = FALSE;
    FADESCREENFROMBLACK(1);
}

func void Q305_HERDISANDMIELLEGOHOME() {
    if ((Q305_HERDIS_FINISHWAY) == (1)) {
        NPC_EXCHANGEROUTINE(NONE_6334_HERDIS, "PIRATES");
        B_STARTOTHERROUTINE(NONE_6335_MILLIE, "PIRATES");
    };
    NPC_EXCHANGEROUTINE(NONE_6334_HERDIS, "FARM");
    B_STARTOTHERROUTINE(NONE_6335_MILLIE, "FARM");
}

func void Q305_FOUNDBLOOD() {
    AI_OUTPUT(HERO, HERO, "DIA_Marvin_BloodTrace_15_00");
}

func void Q305_COUNTITEMSPOINTS() {
    if ((NPC_HASITEMS(OTHER, 0x918f)) >= (1)) {
        if ((NPC_HASITEMS(OTHER, 0x918f)) == (1)) {
            Q305_CORTEZRESULT_COUNT = (Q305_CORTEZRESULT_COUNT) + (1);
        } else if ((NPC_HASITEMS(OTHER, 0x918f)) == (2)) {
            Q305_CORTEZRESULT_COUNT = (Q305_CORTEZRESULT_COUNT) + (2);
        } else if ((NPC_HASITEMS(OTHER, 0x918f)) == (3)) {
            Q305_CORTEZRESULT_COUNT = (Q305_CORTEZRESULT_COUNT) + (3);
        };
    };
    if ((NPC_HASITEMS(OTHER, 0x918e)) >= (1)) {
        Q305_CORTEZRESULT_COUNT = (Q305_CORTEZRESULT_COUNT) + (1);
    };
    if ((NPC_HASITEMS(OTHER, 0x918d)) >= (1)) {
        if ((NPC_HASITEMS(OTHER, 0x918d)) == (1)) {
            Q305_CORTEZRESULT_COUNT = (Q305_CORTEZRESULT_COUNT) + (1);
        } else if ((NPC_HASITEMS(OTHER, 0x918d)) == (2)) {
            Q305_CORTEZRESULT_COUNT = (Q305_CORTEZRESULT_COUNT) + (2);
        } else if ((NPC_HASITEMS(OTHER, 0x918d)) == (3)) {
            Q305_CORTEZRESULT_COUNT = (Q305_CORTEZRESULT_COUNT) + (3);
        };
    };
    if ((NPC_HASITEMS(OTHER, 0x918c)) >= (1)) {
        if ((NPC_HASITEMS(OTHER, 0x918c)) == (1)) {
            Q305_CORTEZRESULT_COUNT = (Q305_CORTEZRESULT_COUNT) + (1);
        } else if ((NPC_HASITEMS(OTHER, 0x918c)) == (2)) {
            Q305_CORTEZRESULT_COUNT = (Q305_CORTEZRESULT_COUNT) + (2);
        } else if ((NPC_HASITEMS(OTHER, 0x918c)) == (3)) {
            Q305_CORTEZRESULT_COUNT = (Q305_CORTEZRESULT_COUNT) + (3);
        };
    };
    if ((NPC_HASITEMS(OTHER, 0x918b)) >= (1)) {
        Q305_CORTEZRESULT_COUNT = (Q305_CORTEZRESULT_COUNT) + (1);
    };
    if ((NPC_HASITEMS(OTHER, 0x918a)) >= (1)) {
        Q305_CORTEZRESULT_COUNT = (Q305_CORTEZRESULT_COUNT) + (1);
    };
    if ((((NPC_HASITEMS(OTHER, 0x9188)) == (1)) && ((NPC_HASITEMS(OTHER, 0x9189)) == (0))) || (((NPC_HASITEMS(OTHER, 0x9189)) == (1)) && ((NPC_HASITEMS(OTHER, 0x9188)) == (0)))) {
        Q305_CORTEZRESULT_COUNT = (Q305_CORTEZRESULT_COUNT) + (1);
    };
    if (((NPC_HASITEMS(OTHER, 0x9188)) == (1)) && ((NPC_HASITEMS(OTHER, 0x9189)) == (1))) {
        Q305_CORTEZRESULT_COUNT = (Q305_CORTEZRESULT_COUNT) + (2);
    };
    if ((NPC_HASITEMS(OTHER, 0x9190)) >= (1)) {
        Q305_CORTEZRESULT_COUNT = (Q305_CORTEZRESULT_COUNT) + (1);
    };
}

func void Q305_GIVEITEMSTOCORTEZ() {
    CORTEZ_MARVINCURRENTQ305ORE = NPC_HASITEMS(HERO, 0x918f);
    CORTEZ_MARVINCURRENTQ305WPN = NPC_HASITEMS(HERO, 0x918d);
    CORTEZ_MARVINCURRENTQ305STEEL = NPC_HASITEMS(HERO, 0x918c);
    CORTEZ_MARVINCURRENTGOLDCHEST = NPC_HASITEMS(HERO, 0x9188);
    if ((NPC_HASITEMS(HERO, 0x918f)) >= (1)) {
        B_GIVEINVITEMS(HERO, PIR_1303_CORTEZ, 0x918f, CORTEZ_MARVINCURRENTQ305ORE);
        NPC_REMOVEINVITEMS(PIR_1303_CORTEZ, 0x918f, NPC_HASITEMS(PIR_1303_CORTEZ, 0x918f));
    };
    if ((NPC_HASITEMS(HERO, 0x918d)) >= (1)) {
        B_GIVEINVITEMS(HERO, PIR_1303_CORTEZ, 0x918d, CORTEZ_MARVINCURRENTQ305WPN);
        NPC_REMOVEINVITEMS(PIR_1303_CORTEZ, 0x918d, NPC_HASITEMS(PIR_1303_CORTEZ, 0x918d));
    };
    if ((NPC_HASITEMS(HERO, 0x918c)) >= (1)) {
        B_GIVEINVITEMS(HERO, PIR_1303_CORTEZ, 0x918c, CORTEZ_MARVINCURRENTQ305STEEL);
        NPC_REMOVEINVITEMS(PIR_1303_CORTEZ, 0x918c, NPC_HASITEMS(PIR_1303_CORTEZ, 0x918c));
    };
    if ((NPC_HASITEMS(HERO, 0x9188)) >= (1)) {
        B_GIVEINVITEMS(HERO, PIR_1303_CORTEZ, 0x9188, CORTEZ_MARVINCURRENTGOLDCHEST);
        NPC_REMOVEINVITEMS(PIR_1303_CORTEZ, 0x9188, NPC_HASITEMS(PIR_1303_CORTEZ, 0x9188));
    };
    if ((NPC_HASITEMS(HERO, 0x9189)) >= (1)) {
        B_GIVEINVITEMS(HERO, PIR_1303_CORTEZ, 0x9189, 1);
        NPC_REMOVEINVITEMS(PIR_1303_CORTEZ, 0x9189, NPC_HASITEMS(PIR_1303_CORTEZ, 0x9189));
    };
    if ((NPC_HASITEMS(HERO, 0x918a)) >= (1)) {
        B_GIVEINVITEMS(HERO, PIR_1303_CORTEZ, 0x918a, 1);
        NPC_REMOVEINVITEMS(PIR_1303_CORTEZ, 0x918a, NPC_HASITEMS(PIR_1303_CORTEZ, 0x918a));
    };
    if ((NPC_HASITEMS(HERO, 0x918b)) >= (1)) {
        B_GIVEINVITEMS(HERO, PIR_1303_CORTEZ, 0x918b, 1);
        NPC_REMOVEINVITEMS(PIR_1303_CORTEZ, 0x918b, NPC_HASITEMS(PIR_1303_CORTEZ, 0x918b));
    };
    if ((NPC_HASITEMS(HERO, 0x918e)) >= (1)) {
        B_GIVEINVITEMS(HERO, PIR_1303_CORTEZ, 0x918e, 1);
        NPC_REMOVEINVITEMS(PIR_1303_CORTEZ, 0x918e, NPC_HASITEMS(PIR_1303_CORTEZ, 0x918e));
    };
    if ((NPC_HASITEMS(HERO, 0x9190)) >= (1)) {
        B_GIVEINVITEMS(HERO, PIR_1303_CORTEZ, 0x9190, 1);
        NPC_REMOVEINVITEMS(PIR_1303_CORTEZ, 0x9190, NPC_HASITEMS(PIR_1303_CORTEZ, 0x9190));
    };
}

var int Q305_GIVEITEMSTOCORTEZ.CORTEZ_MARVINCURRENTQ305ORE = 0;
var int Q305_GIVEITEMSTOCORTEZ.CORTEZ_MARVINCURRENTQ305WPN = 0;
var int Q305_GIVEITEMSTOCORTEZ.CORTEZ_MARVINCURRENTQ305STEEL = 0;
var int Q305_GIVEITEMSTOCORTEZ.CORTEZ_MARVINCURRENTGOLDCHEST = 0;
var int Q305_EVENT1_FINISH = 0;
var int Q305_EVENT3_FINISH = 0;
var int Q305_EVENT4_FINISH = 0;
var int Q305_EVENT5_FINISH = 0;
var int Q305_EVENT6_FINISH = 0;
func void Q305_HIDEEVENTS() {
    if ((NPC_ISDEAD(PIR_1320_SMUGGLER_ARCHOLOS)) == (FALSE)) {
        B_REMOVENPC(0xe59a);
    };
    if ((Q305_BOATREMOVE) == (2)) {
        Q305_EVENT1_FINISH = 2;
    };
    Q305_EVENT1_FINISH = 1;
    if ((Q305_HERDIS_FINISHWAY) == (0)) {
        B_KILLNPC(0xe214);
        WLD_INSERTNPC(0xc596, "PART14_ISLAND_HERDIS");
        B_KILLNPC(0xe220);
        WLD_INSERTNPC(0xc596, "PART14_ISLAND_MILLE");
        Q305_HIDEHERDISCAMP();
    };
    if ((Q305_HERDIS_FINISHWAY) >= (1)) {
        if ((Q305_HERDIS_FINISHWAY) == (1)) {
            AI_UNEQUIPARMOR(NONE_6334_HERDIS);
            AI_UNEQUIPARMOR(NONE_6335_MILLIE);
            B_STARTOTHERROUTINE(NONE_6334_HERDIS, "HAVEN");
            B_STARTOTHERROUTINE(NONE_6335_MILLIE, "HAVEN");
        } else if ((Q305_HERDIS_FINISHWAY) == (2)) {
            1;
            Q305_EVENT2_FINISH;
            (0) == (0);
            if (0) {
                Q305_EVENT2_FINISH = TRUE;
            };
            0;
            Q305_EVENT2_FINISH;
            (0) == (0);
            2;
            Q305_EVENT2_FINISH;
            (0) == (0);
            (0) || (0);
            if (0) {
                B_KILLNPC(0xc9b2);
                WLD_INSERTNPC(0xc3b9, "PART17_ISLAND_CRAB");
            };
            1;
            Q305_BERTELWAY;
            (0) == (0);
            if (0) {
                NPC_REMOVEINVITEM(NONE_6332_BERTEL, 0x8af3);
                NPC_CHANGEARMOR(NONE_6332_BERTEL, 0x8a46);
                B_STARTOTHERROUTINE(NONE_6332_BERTEL, "HAVEN");
                Q305_EVENT3_FINISH = 2;
            };
            6;
            Q305_BERTELWAY;
            (0) <= (0);
            2;
            Q305_BERTELWAY;
            (0) >= (0);
            (0) && (0);
            if (0) {
                B_STARTOTHERROUTINE(PIR_1308_SIMON, START);
                Q305_BERTELWAY = 0;
            };
            7;
            Q305_BERTELWAY;
            (0) >= (0);
            if (0) {
                Q305_EVENT3_FINISH = 1;
                B_STARTOTHERROUTINE(PIR_1308_SIMON, START);
                if ((Q305_BERTELWAY) == (7)) {
                    PRINTD("Bertel poszed³ do miasta");
                    NPC_REMOVEINVITEM(NONE_6332_BERTEL, 0x8af3);
                    NPC_CHANGEARMOR(NONE_6332_BERTEL, 0x8adb);
                    B_STARTOTHERROUTINE(NONE_6332_BERTEL, "CITY");
                };
            };
            0;
            Q305_BERTELWAY;
            (0) == (0);
            if (0) {
                Q305_EVENT3_FINISH = 1;
                B_KILLNPC(0xe4d4);
                WLD_INSERTNPC(0xc73a, "PART17_PATH_211");
            };
            0;
            Q305_JAVAD_WENTTONEWHOME;
            (0) == (0);
            if (0) {
                B_KILLNPC(0xe4c6);
                WLD_INSERTNPC(0xc65e, "PART17_CAVE_CAMPFIRE_01");
            };
            1;
            Q305_JAVAD_WENTTONEWHOME;
            (0) >= (0);
            if (0) {
                NONE_6331_JAVAD.FLAGS = NPC_FLAG_IMPORTANT;
                if ((Q305_JAVAD_WENTTONEWHOME) == (1)) {
                    B_STARTOTHERROUTINE(NONE_6331_JAVAD, "HAVEN");
                } else if ((Q305_JAVAD_WENTTONEWHOME) == (2)) {
                    B_STARTOTHERROUTINE(NONE_6331_JAVAD, "CITY");
                };
            };
            3;
            Q305_HARRISTATUS;
            (0) < (0);
            if (0) {
                B_KILLNPC(0xe4e0);
                WLD_INSERTNPC(0xc3fb, "PART15_PATH_269");
            };
            3;
            Q305_HARRISTATUS;
            (0) >= (0);
            if (0) {
                if ((Q305_HARRISTATUS) == (3)) {
                } else if ((Q305_HARRISTATUS) == (4)) {
                    TRUE;
                    Q305_EVENT4_FINISH;
                    0 = 0;
                    TRUE;
                    Q305_EVENT5_FINISH;
                    0 = 0;
                    TRUE;
                    Q305_EVENT6_FINISH;
                    0 = 0;
                    Q305_CRATESANDBARRELS_OFF();
                    return;
                };
            };
            TRUE;
            Q305_EVENT4_FINISH;
            0 = 0;
            TRUE;
            Q305_EVENT5_FINISH;
            0 = 0;
            TRUE;
            Q305_EVENT6_FINISH;
            0 = 0;
            Q305_CRATESANDBARRELS_OFF();
            return;
        };
    };
    if ((Q305_EVENT2_FINISH) == (1)) {
        Q305_EVENT2_FINISH = TRUE;
    };
    if (((Q305_EVENT2_FINISH) == (2)) || ((Q305_EVENT2_FINISH) == (0))) {
        B_KILLNPC(0xc9b2);
        WLD_INSERTNPC(0xc3b9, "PART17_ISLAND_CRAB");
    };
    if ((Q305_BERTELWAY) == (1)) {
        NPC_REMOVEINVITEM(NONE_6332_BERTEL, 0x8af3);
        NPC_CHANGEARMOR(NONE_6332_BERTEL, 0x8a46);
        B_STARTOTHERROUTINE(NONE_6332_BERTEL, "HAVEN");
        Q305_EVENT3_FINISH = 2;
    };
    if (((Q305_BERTELWAY) >= (2)) && ((Q305_BERTELWAY) <= (6))) {
        B_STARTOTHERROUTINE(PIR_1308_SIMON, START);
        Q305_BERTELWAY = 0;
    };
    if ((Q305_BERTELWAY) >= (7)) {
        Q305_EVENT3_FINISH = 1;
        B_STARTOTHERROUTINE(PIR_1308_SIMON, START);
        if ((Q305_BERTELWAY) == (7)) {
            PRINTD("Bertel poszed³ do miasta");
            NPC_REMOVEINVITEM(NONE_6332_BERTEL, 0x8af3);
            NPC_CHANGEARMOR(NONE_6332_BERTEL, 0x8adb);
            B_STARTOTHERROUTINE(NONE_6332_BERTEL, "CITY");
        };
    };
    if ((Q305_BERTELWAY) == (0)) {
        Q305_EVENT3_FINISH = 1;
        B_KILLNPC(0xe4d4);
        WLD_INSERTNPC(0xc73a, "PART17_PATH_211");
    };
    if ((Q305_JAVAD_WENTTONEWHOME) == (0)) {
        B_KILLNPC(0xe4c6);
        WLD_INSERTNPC(0xc65e, "PART17_CAVE_CAMPFIRE_01");
    };
    if ((Q305_JAVAD_WENTTONEWHOME) >= (1)) {
        NONE_6331_JAVAD.FLAGS = NPC_FLAG_IMPORTANT;
        if ((Q305_JAVAD_WENTTONEWHOME) == (1)) {
            B_STARTOTHERROUTINE(NONE_6331_JAVAD, "HAVEN");
        } else if ((Q305_JAVAD_WENTTONEWHOME) == (2)) {
            B_STARTOTHERROUTINE(NONE_6331_JAVAD, "CITY");
        };
    };
    if ((Q305_HARRISTATUS) < (3)) {
        B_KILLNPC(0xe4e0);
        WLD_INSERTNPC(0xc3fb, "PART15_PATH_269");
    };
    if ((Q305_HARRISTATUS) >= (3)) {
        if ((Q305_HARRISTATUS) == (3)) {
        } else if ((Q305_HARRISTATUS) == (4)) {
            TRUE;
            Q305_EVENT4_FINISH;
            0 = 0;
            TRUE;
            Q305_EVENT5_FINISH;
            0 = 0;
            TRUE;
            Q305_EVENT6_FINISH;
            0 = 0;
            Q305_CRATESANDBARRELS_OFF();
            return;
        };
    };
    Q305_EVENT4_FINISH = TRUE;
    Q305_EVENT5_FINISH = TRUE;
    Q305_EVENT6_FINISH = TRUE;
    Q305_CRATESANDBARRELS_OFF();
}

func void Q305_HIDEEVENTS_APPLY() {
    if ((Q305_EVENT1_FINISH) == (1)) {
        CHANGEVOBCOLLISION("KM_FRIENDISLAND_BOAT", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("KM_FRIENDISLAND_PIRATE", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("KM_FRIENDISLAND_CRATE", FALSE, FALSE, FALSE, TRUE);
    };
    if ((Q305_EVENT2_FINISH) == (1)) {
        CHANGEVOBCOLLISION("KM_ISLANDPIRATE_CHEST", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("KM_ISLANDPIRATE_SAND", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("KM_ISLANDPIRATE_SHOVEL", FALSE, FALSE, FALSE, TRUE);
    };
    if ((Q305_EVENT3_FINISH) == (1)) {
        CHANGEVOBCOLLISION("KM_CHESTPUSHSWAMP", FALSE, FALSE, FALSE, TRUE);
    };
    if ((Q305_EVENT3_FINISH) == (2)) {
        CHANGEVOBCOLLISION("KM_GOLDCHEST_PIRATES", FALSE, FALSE, FALSE, TRUE);
    };
    CHANGEVOBCOLLISION("KM_BLOODTRACE_BODY_01", FALSE, FALSE, FALSE, TRUE);
    CHANGEVOBCOLLISION("KM_BLOODTRACE_BODY_02", FALSE, FALSE, FALSE, TRUE);
    CHANGEVOBCOLLISION("KM_SWAMPMINER_01", FALSE, FALSE, FALSE, TRUE);
    CHANGEVOBCOLLISION("KM_SWAMPMINER_02", FALSE, FALSE, FALSE, TRUE);
    CHANGEVOBCOLLISION("KM_SWAMPMINER_03", FALSE, FALSE, FALSE, TRUE);
    if ((Q305_EVENT1_FINISH) == (1)) {
        WLD_SENDTRIGGER("KM_CORPSEBOAT_MOVER");
    };
    if ((Q305_EVENT2_FINISH) == (1)) {
        WLD_SENDTRIGGER("KM_ISLANDPIRATE_MOVER");
    };
    if ((Q305_EVENT3_FINISH) == (1)) {
        WLD_SENDTRIGGER("KM_CHESTPUSHSWAMP_MOVER");
    };
    if ((Q305_EVENT3_FINISH) == (2)) {
        WLD_SENDTRIGGER("KM_SWAMPCHESTPIRATES_MOVER");
    };
    WLD_SENDTRIGGER("KM_BLOODTRACE_MOVER");
    WLD_SENDTRIGGER("KM_SWAMPMINERS_MOVER");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_01");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_02");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_03");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_04");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_05");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_06");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_07");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_08");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_09");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_10");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_11");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_12");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_13");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_14");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_15");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_16");
    WLD_SENDTRIGGER("KM_SWAMPBLOOD_17");
    WLD_SENDTRIGGER("KM_FRIENDS_FIREPLACE_MOVER");
}

func void Q305_HIDEEVENTS_FUNCTION() {
    Q305_HIDEEVENTS_APPLY();
}

func void Q305_GIVEREWARD() {
    B_GIVEPLAYERXP((XP_Q305_CORTEZPOINTS) * (Q305_CORTEZRESULT_COUNT));
    if ((CORTEZ_SPECIALREWARD) >= (1)) {
        if (((HERO.ATTRIBUTE[4]) > (HERO.ATTRIBUTE[5])) || ((HERO.ATTRIBUTE[4]) == (HERO.ATTRIBUTE[5]))) {
            CREATEINVITEMS(PIR_1303_CORTEZ, 0x86db, 1);
        } else if ((HERO.ATTRIBUTE[5]) > (HERO.ATTRIBUTE[4])) {
            CREATEINVITEMS(PIR_1303_CORTEZ, 0x86cf, 1);
        } else if (((HERO.ATTRIBUTE[3]) > (HERO.ATTRIBUTE[4])) && ((HERO.ATTRIBUTE[3]) > (HERO.ATTRIBUTE[5]))) {
            CREATEINVITEMS(PIR_1303_CORTEZ, 0x86e1, 1);
            B_GIVEINVITEMS(PIR_1303_CORTEZ, HERO, 0x86e1, 1);
        };
        CREATEINVITEMS(PIR_1303_CORTEZ, 0x859b, (Q305_REWARD) / (4));
        if ((CORTEZ_SPECIALREWARD) == (2)) {
            CREATEINVITEMS(PIR_1303_CORTEZ, 0x859b, Q305_REWARD);
            B_GIVEINVITEMS(PIR_1303_CORTEZ, HERO, 0x859b, Q305_REWARD);
        };
    };
}

func void Q305_SPAWNNEWMONSTERS() {
    WLD_INSERTNPC(0xc657, "FP_ROAM_PART17_122");
    WLD_INSERTNPC(0xc658, "FP_ROAM_PART17_117");
    if ((NPC_ISDEAD(LURKER_SWAMPISLAND_01)) == (FALSE)) {
        B_REMOVENPC(0xc59f);
    };
    WLD_INSERTNPC(0xc599, "FP_PART14_ISLAND_MONSTER_ROAM_03");
    if ((NPC_ISDEAD(LURKER_SWAMPISLAND_02)) == (FALSE)) {
        B_REMOVENPC(0xc5a0);
    };
    WLD_INSERTNPC(0xc599, "FP_PART14_ISLAND_MONSTER_ROAM_02");
    if ((NPC_ISDEAD(LURKER_SWAMPISLAND_03)) == (FALSE)) {
        B_REMOVENPC(0xc5a1);
    };
    WLD_INSERTNPC(0xc599, "FP_PART14_ISLAND_MONSTER_ROAM_01");
}

