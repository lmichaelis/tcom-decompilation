instance DIA_MIA_EXIT(C_INFO) {
    NPC = 0xd780;
    NR = 999;
    CONDITION = DIA_MIA_EXIT_CONDITION;
    INFORMATION = DIA_MIA_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_MIA_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_MIA_EXIT_INFO() {
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_MIA_PICKPOCKET(C_INFO) {
    NPC = 0xd780;
    NR = 900;
    CONDITION = DIA_MIA_PICKPOCKET_CONDITION;
    INFORMATION = DIA_MIA_PICKPOCKET_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = PICKPOCKET_40_FEMALE;
}

func int DIA_MIA_PICKPOCKET_CONDITION() {
    if (((SQ309_CHAIRWORKINNOS_DONE) == (2)) || ((LOG_GETSTATUS(MIS_SQ309)) == (LOG_SUCCESS))) {
        if (((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_PICKPOCKET)) >= (1)) && ((SELF.AIVAR[6]) == (FALSE))) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_MIA_PICKPOCKET_INFO() {
    INFO_CLEARCHOICES(0x128a7);
    INFO_ADDCHOICE(0x128a7, DIALOG_BACK, 0x128ab);
    INFO_ADDCHOICE(0x128a7, DIALOG_PICKPOCKET, 0x128aa);
}

func void DIA_MIA_PICKPOCKET_DOIT() {
    if ((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_PICKPOCKET)) >= (1)) {
        B_PICKPOCKET_AMBIENT_TIER_1();
        if ((LOG_GETSTATUS(MIS_SQ309)) == (LOG_RUNNING)) {
            B_GIVEINVITEMS(SELF, OTHER, 0x91a6, 1);
            SQ309_PROOFPOINTS = (SQ309_PROOFPOINTS) + (1);
            PRINTD("Marvin ma kontrakt, +1 pkt do dowodów");
        };
        SELF.AIVAR[6] = TRUE;
        INFO_CLEARCHOICES(0x128a7);
    };
    AI_PLAYANI(HERO, T_CANNOTTAKE);
    PRINTSCREEN(PRINT_CANTPICKPOCKETTHISPERSON, -(1), -(1), FONT_SCREEN, 4);
    INFO_CLEARCHOICES(0x128a7);
}

func void DIA_MIA_PICKPOCKET_BACK() {
    INFO_CLEARCHOICES(0x128a7);
}

instance DIA_MIA_SQ309(C_INFO) {
    NPC = 0xd780;
    NR = 1;
    CONDITION = DIA_MIA_SQ309_CONDITION;
    INFORMATION = DIA_MIA_SQ309_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_MIA_SQ309_CONDITION() {
    if ((LOG_GETSTATUS(MIS_SQ309)) == (LOG_RUNNING)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_MIA_SQ309_INFO() {
    MOB_CHANGEFOCUSNAME("CHAIRINNOS", "MOBNAME_SQ309_CHAIR");
    AI_OUTPUT(SELF, OTHER, "DIA_Mia_SQ309_03_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Mia_SQ309_15_02");
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Mia_SQ309_03_03");
    AI_RESETFACEANI(SELF);
    INFO_CLEARCHOICES(0x128ac);
    INFO_ADDCHOICE(0x128ac, "What is the daily quota?", 0x128b0);
    INFO_ADDCHOICE(0x128ac, "How much gold do I get for one day?", 0x128b1);
}

func void DIA_MIA_SQ309_GOLD_START() {
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Mia_SQ309_Start_03_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Mia_SQ309_Start_15_02");
    AI_RESETFACEANI(SELF);
    SQ309_CHAIRWORKINNOS = TRUE;
    INFO_CLEARCHOICES(0x128ac);
    AI_STOPPROCESSINFOS(SELF);
    NPC_EXCHANGEROUTINE(SELF, "SQ309");
}

func void DIA_MIA_SQ309_MANY() {
    AI_OUTPUT(OTHER, SELF, "DIA_Mia_SQ309_Many_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Mia_SQ309_Many_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Mia_SQ309_Many_03_03");
    SQ309_MIAINFORMATION = (SQ309_MIAINFORMATION) + (1);
    if ((SQ309_MIAINFORMATION) == (2)) {
        DIA_MIA_SQ309_GOLD_START();
    };
}

func void DIA_MIA_SQ309_GOLD() {
    AI_OUTPUT(OTHER, SELF, "DIA_Mia_SQ309_Gold_15_01");
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Mia_SQ309_Gold_03_02");
    AI_RESETFACEANI(SELF);
    AI_OUTPUT(SELF, OTHER, "DIA_Mia_SQ309_Gold_03_03");
    SQ309_MIAINFORMATION = (SQ309_MIAINFORMATION) + (1);
    if ((SQ309_MIAINFORMATION) == (2)) {
        DIA_MIA_SQ309_GOLD_START();
    };
}

instance DIA_MIA_BREAK(C_INFO) {
    NPC = 0xd780;
    NR = 2;
    CONDITION = DIA_MIA_BREAK_CONDITION;
    INFORMATION = DIA_MIA_BREAK_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_MIA_BREAK_CONDITION() {
    if (((LOG_GETSTATUS(MIS_SQ309)) == (LOG_RUNNING)) && ((SQ309_CHAIRWORKINNOS_DONE) == (1))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_MIA_BREAK_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Mia_Break_03_01");
    SQ309_CHAIRWORKINNOS_DONE = 2;
    AI_STOPPROCESSINFOS(SELF);
    B_STARTOTHERROUTINE(VLK_6314_WORKERINNOS, "BREAK");
    B_STARTOTHERROUTINE(VLK_6315_WORKERINNOS, "BREAK");
}

instance DIA_MIA_BACKTOWORK(C_INFO) {
    NPC = 0xd780;
    NR = 3;
    CONDITION = DIA_MIA_BACKTOWORK_CONDITION;
    INFORMATION = DIA_MIA_BACKTOWORK_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_MIA_BACKTOWORK_CONDITION() {
    if (((LOG_GETSTATUS(MIS_SQ309)) == (LOG_RUNNING)) && ((SQ309_CHAIRWORKINNOS_DONE) == (3))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_MIA_BACKTOWORK_INFO() {
    MOB_CHANGEFOCUSNAME("CHAIRINNOS", "MOBNAME_SQ309_CHAIR");
    AI_OUTPUT(SELF, OTHER, "DIA_Mia_BackToWork_03_01");
    SQ309_CHAIRWORKINNOS = TRUE;
    AI_STOPPROCESSINFOS(SELF);
    B_STARTOTHERROUTINE(VLK_6314_WORKERINNOS, START);
    B_STARTOTHERROUTINE(VLK_6315_WORKERINNOS, START);
}

instance DIA_MIA_AFTERWORK(C_INFO) {
    NPC = 0xd780;
    NR = 4;
    CONDITION = DIA_MIA_AFTERWORK_CONDITION;
    INFORMATION = DIA_MIA_AFTERWORK_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_MIA_AFTERWORK_CONDITION() {
    if (((SQ309_CHAIRWORKINNOS_DONE) == (4)) && ((LOG_GETSTATUS(MIS_SQ309)) == (LOG_RUNNING))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_MIA_AFTERWORK_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Mia_AfterWork_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Mia_AfterWork_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Mia_AfterWork_03_03");
    AI_LOGENTRY(TOPIC_SQ309, LOG_SQ309_MIA_AFTERWORK);
    CREATEINVITEMS(SELF, 0x84b2, 2);
    B_GIVEINVITEMS(SELF, OTHER, 0x84b2, 2);
    CREATEINVITEMS(SELF, 0x84be, 2);
    B_GIVEINVITEMS(SELF, OTHER, 0x84be, 2);
    MDL_REMOVEOVERLAYMDS(HERO, "HumanS_Chair_Innos.mds");
    AI_STOPPROCESSINFOS(SELF);
    SQ309_CHAIRWORKINNOS_DONE = 5;
    FF_APPLYONCEEXTGT(0xf3ac, 0, -(1));
    B_STARTOTHERROUTINE(PAL_100_CANDAC, "SQ309");
    B_STARTOTHERROUTINE(KDF_9004_TENGRAL, "SQ309");
    B_STARTOTHERROUTINE(VLK_6314_WORKERINNOS, "BREAK");
    B_STARTOTHERROUTINE(VLK_6315_WORKERINNOS, "BREAK");
}

