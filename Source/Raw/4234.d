instance DIA_SOREN_EXIT(C_INFO) {
    NPC = 0xe2a6;
    NR = 999;
    CONDITION = DIA_SOREN_EXIT_CONDITION;
    INFORMATION = DIA_SOREN_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_SOREN_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_SOREN_EXIT_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_EXIT_15_01");
    AI_WAITTILLEND(SELF, OTHER);
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_SOREN_HELLO(C_INFO) {
    NPC = 0xe2a6;
    NR = 1;
    CONDITION = DIA_SOREN_HELLO_CONDITION;
    INFORMATION = DIA_SOREN_HELLO_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Hey, who are you?";
}

func int DIA_SOREN_HELLO_CONDITION() {
    return TRUE;
}

func void DIA_SOREN_HELLO_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_Hello_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Hello_902_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_Hello_15_03");
    AI_STARTFACEANI(SELF, S_ANGRY, 0, 1);
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Hello_902_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Hello_902_05");
    AI_RESETFACEANI(SELF);
}

instance DIA_SOREN_WORSEPLACE(C_INFO) {
    NPC = 0xe2a6;
    NR = 1;
    CONDITION = DIA_SOREN_WORSEPLACE_CONDITION;
    INFORMATION = DIA_SOREN_WORSEPLACE_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Don't complain, you could have ended up in a much worse place.";
}

func int DIA_SOREN_WORSEPLACE_CONDITION() {
    if (NPC_KNOWSINFO(OTHER, 0x15073)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_SOREN_WORSEPLACE_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_WorsePlace_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_WorsePlace_902_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_WorsePlace_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_WorsePlace_902_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_WorsePlace_902_05");
}

instance DIA_SOREN_SQ208_START(C_INFO) {
    NPC = 0xe2a6;
    NR = 1;
    CONDITION = DIA_SOREN_SQ208_START_CONDITION;
    INFORMATION = DIA_SOREN_SQ208_START_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Do you need some help?";
}

func int DIA_SOREN_SQ208_START_CONDITION() {
    if (NPC_KNOWSINFO(OTHER, 0x15076)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_SOREN_SQ208_START_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_SQ208_Start_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_SQ208_Start_902_02");
    LOG_CREATETOPIC(TOPIC_SQ208, LOG_MISSION);
    LOG_SETSTATUS(_@(MIS_SQ208), TOPIC_SQ208, LOG_RUNNING);
    if (WLD_ISTIME(5, 0, 15, 0)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Soren_SQ208_Start_902_03");
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_SQ208_Start_902_04");
    AI_LOGENTRY(TOPIC_SQ208, LOG_SQ208_START);
}

instance DIA_SOREN_SQ208_LIGHTSOURCE(C_INFO) {
    NPC = 0xe2a6;
    NR = 1;
    CONDITION = DIA_SOREN_SQ208_LIGHTSOURCE_CONDITION;
    INFORMATION = DIA_SOREN_SQ208_LIGHTSOURCE_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "(Suggest light source)";
}

func int DIA_SOREN_SQ208_LIGHTSOURCE_CONDITION() {
    if ((LOG_GETSTATUS(MIS_SQ208)) == (LOG_RUNNING)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_SOREN_SQ208_LIGHTSOURCE_BACK() {
    INFO_CLEARCHOICES(0x1507c);
}

func void DIA_SOREN_SQ208_LIGHTSOURCE_INFO() {
    INFO_CLEARCHOICES(0x1507c);
    INFO_ADDCHOICE(0x1507c, DIALOG_BACK, 0x1507e);
    if ((NPC_HASITEMS(OTHER, 0x87b6)) >= (1)) {
        INFO_ADDCHOICE(0x1507c, "(Give torch)", 0x15081);
    };
    if ((NPC_HASITEMS(OTHER, 0x877e)) >= (1)) {
        INFO_ADDCHOICE(0x1507c, "(Give scroll of light)", 0x15082);
    };
}

func void DIA_SOREN_SQ208_LIGHTSOURCE_RESULT() {
    if ((LOG_GETSTATUS(MIS_SQ206)) != (LOG_RUNNING)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Soren_SQ208_Result_902_01");
        AI_OUTPUT(SELF, OTHER, "DIA_Soren_SQ208_Result_902_02");
    };
    if ((SQ208_LIGHT_TORCH) == (TRUE)) {
        AI_LOGENTRY(TOPIC_SQ208, LOG_SQ208_FINISH_V1);
        B_GIVEPLAYERXP(XP_SQ208_FINISH_TORCH);
    };
    if ((SQ208_LIGHT_LIGHTSPELL) == (TRUE)) {
        AI_LOGENTRY(TOPIC_SQ208, LOG_SQ208_FINISH_V2);
        B_GIVEPLAYERXP(XP_SQ208_FINISH_SCROLL);
    };
    LOG_SETSTATUS(_@(MIS_SQ208), TOPIC_SQ208, LOG_SUCCESS);
    INFO_CLEARCHOICES(0x1507c);
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
    if ((SQ208_LIGHT_TORCH) == (TRUE)) {
        WLD_SENDTRIGGER("SQ208_MOVER_TORCH");
        NPC_EXCHANGEROUTINE(SELF, "PLUNDERTORCH");
    };
}

func void DIA_SOREN_SQ208_LIGHTSOURCE_TORCH() {
    SQ208_LIGHT_TORCH = TRUE;
    B_GIVEINVITEMS(OTHER, SELF, 0x87b6, 1);
    AI_WAITTILLEND(SELF, OTHER);
    AI_WAITTILLEND(OTHER, SELF);
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_SQ208_LightSource_Torch_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_SQ208_LightSource_Torch_902_02");
    DIA_SOREN_SQ208_LIGHTSOURCE_RESULT();
}

func void DIA_SOREN_SQ208_LIGHTSOURCE_SCROLL() {
    SQ208_LIGHT_LIGHTSPELL = TRUE;
    B_GIVEINVITEMS(OTHER, SELF, 0x877e, 1);
    AI_STARTFACEANI(SELF, S_SURPRISE, 0, 1);
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_SQ208_LightSource_Scroll_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_SQ208_LightSource_Scroll_902_02");
    AI_STARTFACEANI(SELF, S_THINK, 0, 1);
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_SQ208_LightSource_Scroll_902_03");
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_SQ208_LightSource_Scroll_15_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_SQ208_LightSource_Scroll_902_05");
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_SQ208_LightSource_Scroll_15_06");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_SQ208_LightSource_Scroll_902_07");
    AI_RESETFACEANI(SELF);
    B_READYSPELL(SELF, SPL_LIGHT, SPL_COST_LIGHT);
    AI_PLAYANI(SELF, "T_MAGRUN_2_SLESHOOT");
    AI_FUNCTION(SELF, 0x15083);
    AI_PLAYANI(SELF, "T_SLESHOOT_2_STAND");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_SQ208_LightSource_Scroll_902_08");
    AI_UNREADYSPELL(SELF);
    DIA_SOREN_SQ208_LIGHTSOURCE_RESULT();
}

func void ISSAC_SQ208_LIGHTSOURCE_SCROLL_PLAYSPELLEFFECT() {
    WLD_PLAYEFFECT("spellFX_IssacLight", BAU_902_SOREN, BAU_902_SOREN, 0, 0, 0, FALSE);
}

instance DIA_SOREN_Q207_ANTONIO(C_INFO) {
    NPC = 0xe2a6;
    NR = 1;
    CONDITION = DIA_SOREN_Q207_ANTONIO_CONDITION;
    INFORMATION = DIA_SOREN_Q207_ANTONIO_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Do you know where I can find Antonio?";
}

func int DIA_SOREN_Q207_ANTONIO_CONDITION() {
    if ((LOG_GETSTATUS(MIS_Q205)) == (LOG_SUCCESS)) {
        if ((LOG_GETSTATUS(MIS_Q207)) == (LOG_RUNNING)) {
            if ((Q207_MARVINKNOWABOUTANTONIO) == (FALSE)) {
                return TRUE;
            };
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_SOREN_Q207_ANTONIO_INFO() {
    B_SAY(OTHER, SELF, "$Q207_SearchAntonio");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_Antonio_902_03");
    INFO_CLEARCHOICES(0x15084);
    INFO_ADDCHOICE(0x15084, "Apparently, he's got connections to a dangerous gang.", 0x1508a);
    if (NPC_HASGUILDARMOREQUIPPED(OTHER, GIL_MIL)) {
        INFO_ADDCHOICE(0x15084, "It's city guard business.", 0x15096);
    };
}

func void DIA_SOREN_Q207_ANTONIO_GIVEUP() {
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_Antonio_Band_902_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_Antonio_Band_902_05");
}

func void DIA_SOREN_Q207_ANTONIO_TRYTOFLEE() {
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_Antonio_Band_902_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_Antonio_Band_902_03");
}

func void DIA_SOREN_Q207_ANTONIO_CHOICES() {
    INFO_CLEARCHOICES(0x15084);
    INFO_ADDCHOICE(0x15084, "I'm looking for my brother.", 0x15095);
    INFO_ADDCHOICE(0x15084, "(Intimidate)", 0x1508d);
    INFO_ADDCHOICE(0x15084, "How much do you want for this information?", 0x1508b);
}

func void DIA_SOREN_Q207_ANTONIO_BAND() {
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_Q207_Antonio_Band_15_01");
    if (NPC_HASGUILDARMOREQUIPPED(OTHER, GIL_MIL)) {
        DIA_SOREN_Q207_ANTONIO_TRYTOFLEE();
    };
    DIA_SOREN_Q207_ANTONIO_GIVEUP();
    DIA_SOREN_Q207_ANTONIO_CHOICES();
}

func void DIA_SOREN_Q207_ANTONIO_BAND_MONEY() {
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_Q207_Antonio_Money_15_01");
    AI_STARTFACEANI(SELF, S_ANGRY, 0, 1);
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_Antonio_Money_902_02");
}

func void DIA_SOREN_Q207_ANTONIO_INFORMATION() {
    BAU_6287_GONZALO.NAME[0] = NPCNAME_GONZALO;
    BAU_6287_GONZALO.AIVAR[79] = 1;
    Q207_MARVINKNOWABOUTANTONIO = TRUE;
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_Antonio_Band_Scare_902_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_Antonio_Band_Scare_902_05");
    INFO_CLEARCHOICES(0x15084);
    INFO_ADDCHOICE(0x15084, "What did these people do to him? Did they threaten him?", 0x15092);
    INFO_ADDCHOICE(0x15084, "Why didn't he report to the guard?", 0x15093);
    INFO_ADDCHOICE(0x15084, "What do you know about these kidnappers?", 0x15094);
}

func void DIA_SOREN_Q207_ANTONIO_BAND_SCARE() {
    Q207_ISSACDIALOGUERESULT = 1;
    AI_STARTFACEANI(OTHER, S_ANGRY, 0, 1);
    AI_DRAWWEAPON(OTHER);
    AI_WAITTILLEND(SELF, OTHER);
    AI_PLAYANI(SELF, T_STAND_2_SCAREDDIALOGUE);
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_Q207_Antonio_Band_Scare_15_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_Q207_Antonio_Band_Scare_15_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_Antonio_Band_Scare_902_03");
    AI_REMOVEWEAPON(OTHER);
    AI_WAITTILLEND(SELF, OTHER);
    AI_PLAYANI(SELF, "T_REMOVE_SCAREDDIALOGUE");
    AI_RESETFACEANI(HERO);
    AI_RESETFACEANI(SELF);
    DIA_SOREN_Q207_ANTONIO_INFORMATION();
}

func void DIA_SOREN_Q207_ANTONIO_RESULT() {
    if ((Q207_ISSACDIALOGUERESULT) == (1)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_Antonio_Where_902_08");
        AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_Antonio_Where_902_09");
    };
    AI_STARTFACEANI(SELF, S_SAD, 0, 1);
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_Antonio_Where_902_10");
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
    INFO_CLEARCHOICES(0x15084);
    AI_LOGENTRY(TOPIC_Q207, LOG_Q207_ISSAC_GONZALO);
}

func void DIA_SOREN_Q207_ANTONIO_WHERE() {
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_Q207_Antonio_Where_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_Antonio_Where_902_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_Antonio_Where_902_03");
    DIA_SOREN_Q207_ANTONIO_RESULT();
}

func void DIA_SOREN_Q207_ANTONIO_COUNT() {
    ISSAC_Q207_INFORMATION = (ISSAC_Q207_INFORMATION) + (1);
    if ((ISSAC_Q207_INFORMATION) == (3)) {
        DIA_SOREN_Q207_ANTONIO_WHERE();
    };
}

var int DIA_SOREN_Q207_ANTONIO_COUNT.ISSAC_Q207_INFORMATION = 0;
func void DIA_SOREN_Q207_ANTONIO_GONZALO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_Q207_Antonio_Gonzalo_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_Antonio_Gonzalo_902_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_Antonio_Gonzalo_902_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_Antonio_Gonzalo_902_04");
    DIA_SOREN_Q207_ANTONIO_COUNT();
}

func void DIA_SOREN_Q207_ANTONIO_BAND_SCARE_MILITIA() {
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_Q207_Antonio_Militia_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_Antonio_Militia_902_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_Antonio_Militia_902_05");
    if (NPC_HASGUILDARMOREQUIPPED(OTHER, GIL_MIL)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_Antonio_Militia_902_06");
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_Antonio_Militia_902_07");
    DIA_SOREN_Q207_ANTONIO_COUNT();
}

func void DIA_SOREN_Q207_ANTONIO_BAND_SCARE_KIDNAPPER() {
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_Q207_Antonio_Kidnapper_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_Antonio_Kidnapper_902_02");
    DIA_SOREN_Q207_ANTONIO_COUNT();
}

func void DIA_SOREN_Q207_ANTONIO_BROTHER() {
    Q207_ISSACDIALOGUERESULT = 2;
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_Q207_Antonio_Brother_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_Antonio_Brother_902_02");
    DIA_SOREN_Q207_ANTONIO_GIVEUP();
    DIA_SOREN_Q207_ANTONIO_INFORMATION();
}

func void DIA_SOREN_Q207_ANTONIO_MILITIA() {
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_Q207_Antonio_Militia_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_Antonio_Militia_902_02");
    DIA_SOREN_Q207_ANTONIO_TRYTOFLEE();
    DIA_SOREN_Q207_ANTONIO_CHOICES();
}

instance DIA_SOREN_Q207_WINECHESTS(C_INFO) {
    NPC = 0xe2a6;
    NR = 1;
    CONDITION = DIA_SOREN_Q207_WINECHESTS_CONDITION;
    INFORMATION = DIA_SOREN_Q207_WINECHESTS_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_SOREN_Q207_WINECHESTS_CONDITION() {
    if ((LOG_GETSTATUS(MIS_Q205)) == (LOG_SUCCESS)) {
        if ((LOG_GETSTATUS(MIS_Q207)) == (LOG_RUNNING)) {
            if (((MOB_HASITEMS("WITHOUTRACE_VINEYARD_CHEST_02", 0x911b)) == (2)) && ((LOG_GETSTATUS(MIS_Q207)) == (LOG_RUNNING))) {
                return TRUE;
            };
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_SOREN_Q207_WINECHESTS_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_WineChests_902_01");
    AI_STARTFACEANI(OTHER, S_WHAT, 0, 1);
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_Q207_WineChests_15_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_WineChests_902_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_WineChests_902_04");
    AI_RESETFACEANI(OTHER);
    INFO_CLEARCHOICES(0x15097);
    INFO_ADDCHOICE(0x15097, "They were lying between the bushes.", 0x1509b);
    INFO_ADDCHOICE(0x15097, "Gonzalo took them.", 0x1509c);
}

func void DIA_SOREN_Q207_WINECHESTS_RESULT() {
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_WineChests_Bush_902_05");
    INFO_CLEARCHOICES(0x15097);
    AI_STOPPROCESSINFOS(SELF);
    if ((SQ208_LIGHT_TORCH) == (TRUE)) {
        NPC_EXCHANGEROUTINE(SELF, "PLUNDERTORCH");
    };
    NPC_EXCHANGEROUTINE(SELF, START);
}

func void DIA_SOREN_Q207_WINECHESTS_BUSH() {
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_Q207_WineChests_Bush_15_01");
    AI_STARTFACEANI(SELF, S_WHAT, 0, 1);
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_WineChests_Bush_902_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_Q207_WineChests_Bush_15_03");
    AI_RESETFACEANI(SELF);
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_WineChests_Bush_902_04");
    B_GIVEPLAYERXP(XP_Q207_ISSACBUSH);
    DIA_SOREN_Q207_WINECHESTS_RESULT();
}

func void DIA_SOREN_Q207_WINECHESTS_GONZALO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_Q207_WineChests_Gonzalo_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_WineChests_Gonzalo_902_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_WineChests_Gonzalo_902_03");
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_Q207_WineChests_Gonzalo_15_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_WineChests_Gonzalo_902_05");
    B_GIVEPLAYERXP(XP_Q207_ISSACGONZALO);
    DIA_SOREN_Q207_WINECHESTS_RESULT();
}

instance DIA_SOREN_Q207_RIKANTONIO(C_INFO) {
    NPC = 0xe2a6;
    NR = 1;
    CONDITION = DIA_SOREN_Q207_RIKANTONIO_CONDITION;
    INFORMATION = DIA_SOREN_Q207_RIKANTONIO_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "How did that drunken Rik know Antonio's name?";
}

func int DIA_SOREN_Q207_RIKANTONIO_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_Q207)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 0x15bac))) && (NPC_KNOWSINFO(OTHER, 0x15084))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_SOREN_Q207_RIKANTONIO_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_Q207_RikAntonio_15_01");
    AI_STARTFACEANI(SELF, S_SAD, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_RikAntonio_902_02");
    AI_RESETFACEANI(SELF);
}

instance DIA_SOREN_Q207_GONZALODEAD(C_INFO) {
    NPC = 0xe2a6;
    NR = 1;
    CONDITION = DIA_SOREN_Q207_GONZALODEAD_CONDITION;
    INFORMATION = DIA_SOREN_Q207_GONZALODEAD_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "I'm sorry, but your friend is dead...";
}

func int DIA_SOREN_Q207_GONZALODEAD_CONDITION() {
    if ((LOG_GETSTATUS(MIS_Q207)) == (LOG_SUCCESS)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_SOREN_Q207_GONZALODEAD_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Soren_Q207_GonzaloDead_15_01");
    AI_STARTFACEANI(SELF, S_SAD, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Soren_Q207_GonzaloDead_902_02");
    AI_RESETFACEANI(SELF);
    B_GIVEPLAYERXP(XP_Q207_TELLSADNEWS);
}

instance DIA_SOREN_AMBIENT(C_INFO) {
    NPC = 0xe2a6;
    NR = 850;
    CONDITION = DIA_SOREN_AMBIENT_CONDITION;
    INFORMATION = DIA_SOREN_AMBIENT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "What's new?";
}

func int DIA_SOREN_AMBIENT_CONDITION() {
    if (NPC_KNOWSINFO(OTHER, 0x15073)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_SOREN_AMBIENT_INFO() {
    B_SAY(OTHER, SELF, "$MARVIN_WhatNew");
    NPC_INITAMBIENTS(SELF, 3);
    if ((NPC_GETLASTAMBIENT(SELF)) == (1)) {
        AI_STARTFACEANI(SELF, S_TIRED, 1, -(1));
        AI_OUTPUT(SELF, OTHER, "DIA_SOREN_AMB_V1_03_01");
        AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
        AI_OUTPUT(SELF, OTHER, "DIA_SOREN_AMB_V1_03_02");
    };
    if ((NPC_GETLASTAMBIENT(SELF)) == (2)) {
        AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
        AI_OUTPUT(SELF, OTHER, "DIA_SOREN_AMB_V2_03_01");
        AI_OUTPUT(SELF, OTHER, "DIA_SOREN_AMB_V2_03_02");
    };
    if ((NPC_GETLASTAMBIENT(SELF)) == (3)) {
        AI_STARTFACEANI(SELF, S_SERIOUS, 1, -(1));
        AI_OUTPUT(SELF, OTHER, "DIA_SOREN_AMB_V3_03_01");
        AI_OUTPUT(SELF, OTHER, "DIA_SOREN_AMB_V3_03_02");
    };
    AI_RESETFACEANI(SELF);
}

instance DIA_SOREN_PICKPOCKET(C_INFO) {
    NPC = 0xe2a6;
    NR = 900;
    CONDITION = DIA_SOREN_PICKPOCKET_CONDITION;
    INFORMATION = DIA_SOREN_PICKPOCKET_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = PICKPOCKET_40_FEMALE;
}

func int DIA_SOREN_PICKPOCKET_CONDITION() {
    if (((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_PICKPOCKET)) >= (1)) && ((SELF.AIVAR[6]) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_SOREN_PICKPOCKET_INFO() {
    INFO_CLEARCHOICES(0x150a6);
    INFO_ADDCHOICE(0x150a6, DIALOG_BACK, 0x150aa);
    INFO_ADDCHOICE(0x150a6, DIALOG_PICKPOCKET, 0x150a9);
}

func void DIA_SOREN_PICKPOCKET_DOIT() {
    if ((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_PICKPOCKET)) >= (1)) {
        B_PICKPOCKET_AMBIENT_TIER_1();
        SELF.AIVAR[6] = TRUE;
        INFO_CLEARCHOICES(0x150a6);
    };
    AI_PLAYANI(HERO, T_CANNOTTAKE);
    PRINTSCREEN(PRINT_CANTPICKPOCKETTHISPERSON, -(1), -(1), FONT_SCREEN, 4);
    INFO_CLEARCHOICES(0x150a6);
}

func void DIA_SOREN_PICKPOCKET_BACK() {
    INFO_CLEARCHOICES(0x150a6);
}

