var int DAYOFSMITHING = 0;
var int SMITHSTATUS = 0;
instance DIA_SMITH_EXIT2(C_INFO) {
    NPC = 0xcf73;
    NR = 999;
    CONDITION = DIA_SMITH_EXIT2_CONDITION;
    INFORMATION = DIA_SMITH_EXIT2_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_SMITH_EXIT2_CONDITION() {
    return TRUE;
}

func void DIA_SMITH_EXIT2_INFO() {
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_SMITH_NS56_START(C_INFO) {
    NPC = 0xcf73;
    NR = 1;
    CONDITION = DIA_SMITH_NS56_START_CONDITION;
    INFORMATION = DIA_SMITH_NS56_START_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_SMITH_NS56_START_CONDITION() {
    return TRUE;
}

func void DIA_SMITH_NS56_START_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Smith_NS56_Start_03_01");
}

instance DIA_SMITH_NS56_NOITMISWORDRAW(C_INFO) {
    NPC = 0xcf73;
    NR = 2;
    CONDITION = DIA_SMITH_NS56_NOITMISWORDRAW_CONDITION;
    INFORMATION = DIA_SMITH_NS56_NOITMISWORDRAW_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "How much steel do you need?";
}

func int DIA_SMITH_NS56_NOITMISWORDRAW_CONDITION() {
    if ((NPC_KNOWSINFO(OTHER, 0x10b37)) && ((NPC_HASITEMS(OTHER, 0x8586)) < (2))) {
        if (!(NPC_KNOWSINFO(OTHER, 0x10b3d))) {
            if ((SMITHSTATUS) == (0)) {
                return TRUE;
            };
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_SMITH_NS56_NOITMISWORDRAW_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Smith_NS56_NoItmiswordraw_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Smith_NS56_NoItmiswordraw_03_02");
}

instance DIA_SMITH_NS56_ITMISWORDRAW(C_INFO) {
    NPC = 0xcf73;
    NR = 3;
    CONDITION = DIA_SMITH_NS56_ITMISWORDRAW_CONDITION;
    INFORMATION = DIA_SMITH_NS56_ITMISWORDRAW_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Here's the steel.";
}

func int DIA_SMITH_NS56_ITMISWORDRAW_CONDITION() {
    if ((NPC_KNOWSINFO(OTHER, 0x10b37)) && ((NPC_HASITEMS(OTHER, 0x8586)) >= (2))) {
        if ((SMITHSTATUS) == (0)) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_SMITH_NS56_ITMISWORDRAW_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Smith_NS56_Itmiswordraw_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Smith_NS56_Itmiswordraw_03_02");
    B_GIVEINVITEMS(OTHER, SELF, 0x8586, 2);
    SMITHSTATUS = 1;
    DAYOFSMITHING = WLD_GETDAY();
    B_GIVEPLAYERXP(XP_EVENT_SMITH);
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_SMITH_NS56_REWARD(C_INFO) {
    NPC = 0xcf73;
    NR = 4;
    CONDITION = DIA_SMITH_NS56_REWARD_CONDITION;
    INFORMATION = DIA_SMITH_NS56_REWARD_INFO;
    PERMANENT = TRUE;
    IMPORTANT = TRUE;
}

func int DIA_SMITH_NS56_REWARD_CONDITION() {
    if (((NPC_KNOWSINFO(OTHER, 0x10b37)) && (NPC_KNOWSINFO(OTHER, 0x10b3d))) && (NPC_ISINSTATE(SELF, 0xf09f))) {
        if ((SMITHSTATUS) == (1)) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_SMITH_NS56_REWARD_INFO() {
    if ((DAYOFSMITHING) == (WLD_GETDAY())) {
        AI_OUTPUT(SELF, OTHER, "DIA_Smith_NS56_Reward_03_01");
    };
    if ((SELF.ATTRIBUTE[5]) >= (SELF.ATTRIBUTE[4])) {
        CREATEINVITEMS(SELF, 0x9a3a, 1);
    };
    CREATEINVITEMS(SELF, 0x9a39, 1);
    B_GIVEINVITEMS(SELF, OTHER, 0x9a39, 1);
    AI_OUTPUT(SELF, OTHER, "DIA_Smith_NS56_Reward_03_02");
    B_GIVEPLAYERXP(XP_EVENT_SMITH_NS56_REWARD);
    NPC_EXCHANGEROUTINE(SELF, TOT);
    SMITHSTATUS = 2;
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_SMITH_NS56_AFTERAFTER(C_INFO) {
    NPC = 0xcf73;
    NR = 5;
    CONDITION = DIA_SMITH_NS56_AFTERAFTER_CONDITION;
    INFORMATION = DIA_SMITH_NS56_AFTERAFTER_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_SMITH_NS56_AFTERAFTER_CONDITION() {
    if ((NPC_KNOWSINFO(OTHER, 0x10b37)) && (NPC_ISINSTATE(SELF, 0xf09f))) {
        if ((SMITHSTATUS) == (2)) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_SMITH_NS56_AFTERAFTER_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Smith_NS56_AfterAfter_03_01");
    AI_STOPPROCESSINFOS(SELF);
}

