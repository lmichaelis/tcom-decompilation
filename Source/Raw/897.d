var int SQ225_VINEYARDDESTROYEDCOUNT = 0;
func void VINEYARDLIAM_S1() {
    HER = HLP_GETNPC(0xc3ab);
    if ((HLP_GETINSTANCEID(SELF)) == (HLP_GETINSTANCEID(HER))) {
        if (((LOG_GETSTATUS(MIS_SQ213)) == (LOG_RUNNING)) && ((SQ213_VINECOLLECT) == (TRUE))) {
            FADESCREENTOBLACKF(3, 0xbd8e, 350);
        } else if ((((LOG_GETSTATUS(MIS_SQ225)) == (LOG_RUNNING)) && ((SQ225_ANDERASWAY_AGREED) == (TRUE))) && ((SQ225_ANDERASWAY_FAILED) != (2))) {
            if ((SQ225_VINEYARDDESTROYEDCOUNT) < (5)) {
                SQ225_VINEYARDDESTROYEDCOUNT = (SQ225_VINEYARDDESTROYEDCOUNT) + (1);
                PRINT(PRINT_SQ225_VINEYARDDESTROYED);
                if ((SQ225_VINEYARDDESTROYEDCOUNT) == (1)) {
                    B_LOGENTRY(TOPIC_SQ225, LOG_SQ225_GRAPEDESTROYED_IDEA);
                } else if ((SQ225_VINEYARDDESTROYEDCOUNT) == (3)) {
                    AI_OUTPUT(HERO, HERO, "DIA_SQ225_Marvin_GrapeDestroyed_15_01");
                } else if ((SQ225_VINEYARDDESTROYEDCOUNT) == (5)) {
                    B_LOGENTRY(TOPIC_SQ225, LOG_SQ225_GRAPEDESTROYED_DONE);
                    SQ225_GRAPESDESTROYED = TRUE;
                    SQ225_ANDERASWAY_COUNT = (SQ225_ANDERASWAY_COUNT) + (1);
                };
            };
        };
    };
}

instance VINEYARDLIAM_S1.HER(C_NPC)
func void VINEYARDLIAM_FADESCREEN() {
    SQ213_VINECOLLECT = FALSE;
    SQ213_VINECOLLECT_DONE = 1;
    NPC_CLEARAIQUEUE(HERO);
    HERO.AIVAR[4] = FALSE;
    B_PASSTIME(8);
    B_ENDPRODUCTIONDIALOG();
    AI_WAIT(HERO, 0x3f800000);
    AI_USEMOB(HERO, NPC_GETDETECTEDMOB(HERO), -(1));
    FADESCREENFROMBLACK(3);
}

