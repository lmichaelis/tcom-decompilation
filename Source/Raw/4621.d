instance SQ118_FLORADEATH(CUTSCENE) {
    ONSTART = FUNCTION(0x16abf);
}

func void SQ118_FLORADEATH_START() {
    NPC_CLEARAIQUEUE(BAU_706_LOKVAR);
    TELEPORTNPCTOWP(0xe0db, BAU_706_LOKVAR.WP);
    TELEPORTNPCTOWP(0xc924, NONE_3_EZEKIEL.WP);
    TELEPORTNPCTOWP(0x71b, "VILLAGE_CEMETERY_05");
    BAU_706_LOKVAR.AIVAR[92] = TRUE;
    AI_TURNTONPC(BAU_706_LOKVAR, NONE_3_EZEKIEL);
    WLD_SENDTRIGGER("SQ118_FINAL_01");
    MDL_APPLYOVERLAYMDS(BAU_706_LOKVAR, "HumanS_MageSpeech.MDS");
    AI_PLAYANI(BAU_706_LOKVAR, T_STAND_2_LGUARD);
    AI_OUTPUT(BAU_706_LOKVAR, HERO, "DIA_LOKVAR_FLORADEATH_03_01");
    AI_FUNCTION(BAU_706_LOKVAR, 0x16ac0);
    AI_OUTPUT(BAU_706_LOKVAR, HERO, "DIA_LOKVAR_FLORADEATH_03_02");
    AI_FUNCTION(BAU_706_LOKVAR, 0x16ac1);
    AI_OUTPUT(BAU_706_LOKVAR, HERO, "DIA_LOKVAR_FLORADEATH_03_03");
    AI_PLAYANI(BAU_706_LOKVAR, T_LGUARD_2_STAND);
    AI_FUNCTION(BAU_706_LOKVAR, 0x16ac2);
}

func void SQ118_FLORADEATH_CHANGECAMERA_01() {
    WLD_SENDTRIGGER("SQ118_FINAL_02");
    WLD_SENDUNTRIGGER("SQ118_FINAL_01");
}

func void SQ118_FLORADEATH_CHANGECAMERA_02() {
    WLD_SENDTRIGGER("SQ118_FINAL_03");
    WLD_SENDUNTRIGGER("SQ118_FINAL_02");
}

func void SQ118_FLORADEATH_END() {
    WLD_SENDUNTRIGGER("SQ118_FINAL_01");
    WLD_SENDUNTRIGGER("SQ118_FINAL_02");
    WLD_SENDUNTRIGGER("SQ118_FINAL_03");
    BAU_706_LOKVAR.AIVAR[92] = FALSE;
    B_STARTOTHERROUTINE(BAU_706_LOKVAR, START);
    NPC_REFRESH(BAU_706_LOKVAR);
    MDL_REMOVEOVERLAYMDS(BAU_706_LOKVAR, "HumanS_MageSpeech.MDS");
    B_STARTOTHERROUTINE(NONE_3_EZEKIEL, "VILLAGE");
    NPC_REFRESH(NONE_3_EZEKIEL);
    HERO.AIVAR[4] = FALSE;
}

