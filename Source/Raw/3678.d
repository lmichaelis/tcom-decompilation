instance DIA_KAZEEM_CHAPTER4_EXIT(C_INFO) {
    NPC = 0xc8df;
    NR = 999;
    CONDITION = DIA_KAZEEM_CHAPTER4_EXIT_CONDITION;
    INFORMATION = DIA_KAZEEM_CHAPTER4_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_KAZEEM_CHAPTER4_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_KAZEEM_CHAPTER4_EXIT_INFO() {
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_KAZEEM_CHAPTER4_SQ411_HELLO(C_INFO) {
    NPC = 0xc8df;
    NR = 1;
    CONDITION = DIA_KAZEEM_CHAPTER4_SQ411_HELLO_CONDITION;
    INFORMATION = DIA_KAZEEM_CHAPTER4_SQ411_HELLO_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_KAZEEM_CHAPTER4_SQ411_HELLO_CONDITION() {
    if ((LOG_GETSTATUS(MIS_SQ411)) == (LOG_RUNNING)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_KAZEEM_CHAPTER4_SQ411_HELLO_INFO() {
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_Hello_03_01");
    INFO_CLEARCHOICES(0x10827);
    if ((LOG_GETSTATUS(MIS_Q405)) == (LOG_SUCCESS)) {
        INFO_ADDCHOICE(0x10827, "I found him, unfortunately, too late.", 0x10831);
    };
    INFO_ADDCHOICE(0x10827, "Not yet, but I think I'm on track.", 0x10830);
    INFO_ADDCHOICE(0x10827, "It's a long story...", 0x10832);
}

func void DIA_KAZEEM_CHAPTER4_SQ411_HELLO_NEXT() {
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
    AI_OUTPUT(OTHER, SELF, "DIA_Kazeem_Chapter4_SQ411_Hello_Yes_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_Hello_Yes_03_04");
    INFO_CLEARCHOICES(0x10827);
    INFO_ADDCHOICE(0x10827, "I'm distributing notices about a bidding on the house.", 0x1082b);
}

func void DIA_KAZEEM_CHAPTER4_SQ411_POSTERS() {
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Kazeem_Chapter4_SQ411_Posters_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_Posters_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_Posters_03_03");
    NPC_EXCHANGEROUTINE(SELF, "SQ411_FISH");
    INFO_CLEARCHOICES(0x10827);
    INFO_ADDCHOICE(0x10827, "Maybe you'd like to help me? I'm planning to buy this house.", 0x1082c);
}

func void DIA_KAZEEM_CHAPTER4_SQ411_HELP() {
    AI_OUTPUT(OTHER, SELF, "DIA_Kazeem_Chapter4_SQ411_HELP_15_01");
    AI_STARTFACEANI(SELF, S_SURPRISE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_HELP_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Kazeem_Chapter4_SQ411_HELP_15_03");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_HELP_03_04");
    INFO_CLEARCHOICES(0x10827);
    INFO_ADDCHOICE(0x10827, "Disguise yourself as a buyer and bid on the house in your name.", 0x1082d);
}

func void DIA_KAZEEM_CHAPTER4_SQ411_HELP_AUCTION() {
    AI_OUTPUT(OTHER, SELF, "DIA_Kazeem_Chapter4_SQ411_HELP_Auction_15_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Kazeem_Chapter4_SQ411_HELP_Auction_15_02");
    AI_STARTFACEANI(SELF, S_THINK, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_HELP_Auction_03_03");
    AI_RESETFACEANI(SELF);
    AI_PLAYANI(SELF, T_SEARCH);
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_HELP_Auction_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_HELP_Auction_03_05");
    INFO_CLEARCHOICES(0x10827);
    INFO_ADDCHOICE(0x10827, "I'll take care of getting the outfit and the gold.", 0x1082e);
}

func void DIA_KAZEEM_CHAPTER4_SQ411_HELP_AUCTION_ARMOR() {
    SQ411_KAZEEMWILLHELP = TRUE;
    AI_OUTPUT(OTHER, SELF, "DIA_Kazeem_Chapter4_SQ411_HELP_Armor_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_HELP_Armor_03_02");
    INFO_CLEARCHOICES(0x10827);
    AI_LOGENTRY(TOPIC_SQ411, LOG_SQ411_KAZEEM_HELP);
    NPC_EXCHANGEROUTINE(SELF, "SQ411_OLDCITY");
}

func void DIA_KAZEEM_CHAPTER4_SQ411_HELLO_UNDERSTAND() {
    AI_STARTFACEANI(SELF, S_TIRED, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_Hello_NotYet_03_02");
    DIA_KAZEEM_CHAPTER4_SQ411_HELLO_NEXT();
}

func void DIA_KAZEEM_CHAPTER4_SQ411_HELLO_NOTYET() {
    AI_OUTPUT(OTHER, SELF, "DIA_Kazeem_Chapter4_SQ411_Hello_NotYet_15_01");
    DIA_KAZEEM_CHAPTER4_SQ411_HELLO_UNDERSTAND();
}

func void DIA_KAZEEM_CHAPTER4_SQ411_HELLO_YES() {
    AI_STARTFACEANI(OTHER, S_TIRED, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Kazeem_Chapter4_SQ411_Hello_Yes_15_01");
    AI_STARTFACEANI(SELF, S_SAD, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_Hello_Yes_03_02");
    DIA_KAZEEM_CHAPTER4_SQ411_HELLO_NEXT();
}

func void DIA_KAZEEM_CHAPTER4_SQ411_HELLO_STORY() {
    AI_OUTPUT(OTHER, SELF, "DIA_Kazeem_Chapter4_SQ411_Hello_Story_15_01");
    DIA_KAZEEM_CHAPTER4_SQ411_HELLO_UNDERSTAND();
}

instance DIA_KAZEEM_CHAPTER4_SQ411_GOTEVERYTHING(C_INFO) {
    NPC = 0xc8df;
    NR = 1;
    CONDITION = DIA_KAZEEM_CHAPTER4_SQ411_GOTEVERYTHING_CONDITION;
    INFORMATION = DIA_KAZEEM_CHAPTER4_SQ411_GOTEVERYTHING_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "I brought the outfit and the gold.";
}

func int DIA_KAZEEM_CHAPTER4_SQ411_GOTEVERYTHING_CONDITION() {
    if (((LOG_GETSTATUS(MIS_SQ411)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 0x10827))) {
        if (((NPC_HASITEMS(OTHER, 0x859b)) >= (1000)) && (C_SQ411_GOTRICHVLKARMOR(OTHER))) {
            if ((SQ411_ALLPOSTERSDONE) == (2)) {
                return TRUE;
            };
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_KAZEEM_CHAPTER4_SQ411_GOTEVERYTHING_INFO() {
    MDL_APPLYOVERLAYMDS(SELF, HUMANSRELAXEDMDS);
    AI_OUTPUT(OTHER, SELF, "DIA_Kazeem_Chapter4_SQ411_GotEverything_15_01");
    AI_WAITTILLEND(SELF, OTHER);
    B_STANDUP();
    SQ411_GIVEKAZEEMARMORANDGOLD();
    AI_PLAYANI(SELF, R_SCRATCHRSHOULDER);
    AI_STARTFACEANI(SELF, S_WHAT, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_GotEverything_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Kazeem_Chapter4_SQ411_GotEverything_15_03");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_GotEverything_03_04");
    AI_STOPPROCESSINFOS(SELF);
    AI_LOGENTRY(TOPIC_SQ411, LOG_SQ411_KAZEEM_AUCTION);
    SQ411_KAZZEM_AUCTION();
}

instance DIA_KAZEEM_CHAPTER4_SQ411_WAITASEC(C_INFO) {
    NPC = 0xc8df;
    NR = 1;
    CONDITION = DIA_KAZEEM_CHAPTER4_SQ411_WAITASEC_CONDITION;
    INFORMATION = DIA_KAZEEM_CHAPTER4_SQ411_WAITASEC_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_KAZEEM_CHAPTER4_SQ411_WAITASEC_CONDITION() {
    return FALSE;
}

func void DIA_KAZEEM_CHAPTER4_SQ411_WAITASEC_INFO() {
    MARVIN_CURRENTREALDOCSCOUNT = NPC_HASITEMS(OTHER, 0x91f9);
    B_GIVEINVITEMS(OTHER, SELF, 0x91f9, MARVIN_CURRENTREALDOCSCOUNT);
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_WaitASec_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_WaitASec_03_02");
    AI_LOGENTRY(TOPIC_SQ411, LOG_SQ411_KAZEEM_AUCTION);
    AI_STOPPROCESSINFOS(SELF);
}

var int DIA_KAZEEM_CHAPTER4_SQ411_WAITASEC_INFO.MARVIN_CURRENTREALDOCSCOUNT = 0;
instance DIA_KAZEEM_CHAPTER4_SQ411_AFTERAUCTION(C_INFO) {
    NPC = 0xc8df;
    NR = 1;
    CONDITION = DIA_KAZEEM_CHAPTER4_SQ411_AFTERAUCTION_CONDITION;
    INFORMATION = DIA_KAZEEM_CHAPTER4_SQ411_AFTERAUCTION_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_KAZEEM_CHAPTER4_SQ411_AFTERAUCTION_CONDITION() {
    if (((LOG_GETSTATUS(MIS_SQ411)) == (LOG_RUNNING)) && ((SQ411_KAZEEMNEGOCIATION) == (2))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

var int KAZEEM_SQ411_MONEYFORHOME = 0;
func void DIA_KAZEEM_CHAPTER4_SQ411_AFTERAUCTION_INFO() {
    AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_AfterAuction_03_01");
    B_USEFAKEKEY_THROW();
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_AfterAuction_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_AfterAuction_03_03");
    INFO_CLEARCHOICES(0x1083a);
    INFO_ADDCHOICE(0x1083a, "How about double what you had to pay? (1000 GP)", 0x1083f);
    INFO_ADDCHOICE(0x1083a, "I can pay you 2,000 gold pieces.", 0x10840);
}

func void DIA_KAZEEM_CHAPTER4_SQ411_AFTERAUCTION_IDEA() {
    AI_STARTFACEANI(OTHER, "S_HOSTILE", 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Kazeem_Chapter4_SQ411_AfterAuction_Idea_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_AfterAuction_Idea_03_02");
    B_USEFAKESCROLL();
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_AfterAuction_Idea_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_AfterAuction_Idea_03_04");
    INFO_CLEARCHOICES(0x1083a);
    AI_STOPPROCESSINFOS(SELF);
    AI_RESETFACEANI(OTHER);
    AI_LOGENTRY(TOPIC_SQ411, LOG_SQ411_FAILED_V2);
    LOG_SETSTATUS(_@(MIS_SQ411), TOPIC_SQ411, LOG_FAILED);
}

func void DIA_KAZEEM_CHAPTER4_SQ411_AFTERAUCTION_1000() {
    KAZEEM_SQ411_MONEYFORHOME = 1;
    AI_OUTPUT(OTHER, SELF, "DIA_Kazeem_Chapter4_SQ411_AfterAuction_1000_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_AfterAuction_1000_03_02");
    INFO_CLEARCHOICES(0x1083a);
}

func void DIA_KAZEEM_CHAPTER4_SQ411_AFTERAUCTION_2000() {
    KAZEEM_SQ411_MONEYFORHOME = 2;
    AI_OUTPUT(OTHER, SELF, "DIA_Kazeem_Chapter4_SQ411_AfterAuction_2000_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_AfterAuction_2000_03_02");
    INFO_CLEARCHOICES(0x1083a);
}

instance DIA_KAZEEM_CHAPTER4_SQ411_PAY(C_INFO) {
    NPC = 0xc8df;
    NR = 1;
    CONDITION = DIA_KAZEEM_CHAPTER4_SQ411_PAY_CONDITION;
    INFORMATION = DIA_KAZEEM_CHAPTER4_SQ411_PAY_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_PAYFORHOUSEKEYS;
}

func int DIA_KAZEEM_CHAPTER4_SQ411_PAY_CONDITION() {
    if (((LOG_GETSTATUS(MIS_SQ411)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 0x1083a))) {
        if (((KAZEEM_SQ411_MONEYFORHOME) == (1)) || ((KAZEEM_SQ411_MONEYFORHOME) == (2))) {
            if ((SQ411_MARVINGOTKEYS) == (FALSE)) {
                return TRUE;
            };
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_KAZEEM_CHAPTER4_SQ411_PAY_INFO() {
    if ((((KAZEEM_SQ411_MONEYFORHOME) == (1)) && ((NPC_HASITEMS(OTHER, 0x859b)) >= (SQ411_KAZEEM_MONEYFORHOME_V1))) || (((KAZEEM_SQ411_MONEYFORHOME) == (2)) && ((NPC_HASITEMS(OTHER, 0x859b)) >= (SQ411_KAZEEM_MONEYFORHOME_V2)))) {
        GAMESERVICES_UNLOCKACHIEVEMENT(ACH_27);
        SQ411_MARVINGOTKEYS = TRUE;
        if ((KAZEEM_SQ411_MONEYFORHOME) == (1)) {
        } else if ((KAZEEM_SQ411_MONEYFORHOME) == (2)) {
            B_GIVEINVITEMS(OTHER, SELF, 0x859b, SQ411_KAZEEM_MONEYFORHOME_V2);
        };
        B_GIVEINVITEMS(SELF, OTHER, 0x901d, 1);
        AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_Pay_03_01");
        AI_LOGENTRY(TOPIC_SQ411, LOG_SQ411_KAZZEM_GOTKEYS);
        NPC_EXCHANGEROUTINE(SELF, "SQ411_FISH");
    };
    B_SAY(SELF, OTHER, "$NOGOLD");
}

instance DIA_KAZEEM_CHAPTER4_SQ411_WHATNEXT(C_INFO) {
    NPC = 0xc8df;
    NR = 950;
    CONDITION = DIA_KAZEEM_CHAPTER4_SQ411_WHATNEXT_CONDITION;
    INFORMATION = DIA_KAZEEM_CHAPTER4_SQ411_WHATNEXT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "What are you gonna do now?";
}

func int DIA_KAZEEM_CHAPTER4_SQ411_WHATNEXT_CONDITION() {
    if ((SQ411_MARVINGOTKEYS) == (TRUE)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_KAZEEM_CHAPTER4_SQ411_WHATNEXT_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Kazeem_Chapter4_SQ411_WhatNext_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Chapter4_SQ411_WhatNext_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Kazeem_Ambient_03_04");
}

instance DIA_KAZEEM_CHAPTER4_PICKPOCKET(C_INFO) {
    NPC = 0xc8df;
    NR = 900;
    CONDITION = DIA_KAZEEM_CHAPTER4_PICKPOCKET_CONDITION;
    INFORMATION = DIA_KAZEEM_CHAPTER4_PICKPOCKET_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = PICKPOCKET_120;
}

func int DIA_KAZEEM_CHAPTER4_PICKPOCKET_CONDITION() {
    if (((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_PICKPOCKET)) >= (1)) && ((SELF.AIVAR[6]) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_KAZEEM_CHAPTER4_PICKPOCKET_INFO() {
    INFO_CLEARCHOICES(0x10847);
    INFO_ADDCHOICE(0x10847, DIALOG_BACK, 0x1084b);
    INFO_ADDCHOICE(0x10847, DIALOG_PICKPOCKET, 0x1084a);
}

func void DIA_KAZEEM_CHAPTER4_PICKPOCKET_DOIT() {
    if ((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_PICKPOCKET)) >= (3)) {
        B_PICKPOCKET_AMBIENT_TIER_3();
        SELF.AIVAR[6] = TRUE;
        INFO_CLEARCHOICES(0x10847);
    };
    AI_PLAYANI(HERO, T_CANNOTTAKE);
    PRINTSCREEN(PRINT_CANTPICKPOCKETTHISPERSON, -(1), -(1), FONT_SCREEN, 4);
    INFO_CLEARCHOICES(0x10847);
}

func void DIA_KAZEEM_CHAPTER4_PICKPOCKET_BACK() {
    INFO_CLEARCHOICES(0x10847);
}

