instance DIA_ORCSLAVE_EXIT(C_INFO) {
    NPC = 0xeb9c;
    NR = 999;
    CONDITION = DIA_ARENAGUARD_EXIT_CONDITION;
    INFORMATION = DIA_ARENAGUARD_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_ORCSLAVE_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_ORCSLAVE_EXIT_INFO() {
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_ORCSLAVE_TOURNAMENTFIGHT(C_INFO) {
    NPC = 0xeb9c;
    NR = 1;
    CONDITION = DIA_ORCSLAVE_TOURNAMENTFIGHT_CONDITION;
    INFORMATION = DIA_ORCSLAVE_TOURNAMENTFIGHT_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_ORCSLAVE_TOURNAMENTFIGHT_CONDITION() {
    if ((Q306_STATE) == (18)) {
        if (((NPC_GETDISTTOWP(SELF, "P17_HAVEN_ARENA_OPPONENT_02")) <= (500)) && ((NPC_GETDISTTOWP(HERO, "P17_HAVEN_ARENA_OPPONENT_01")) >= (500))) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void ORCSLAVE_TOURNAMENT_CHANGEMUSIC() {
    MUSIC_OVERRIDETRACK(0x55b9);
    HERO.AIVAR[4] = FALSE;
}

func void DIA_ORCSLAVE_TOURNAMENTFIGHT_INFO() {
    SELF.AIVAR[15] = FALSE;
    B_HEALNPC_SELF();
    CREATEINVITEMS(SELF, 0x84ee, 1);
    AI_EQUIPBESTMELEEWEAPON(SELF);
    HERO.AIVAR[95] = TRUE;
    HERO.AIVAR[94] = TRUE;
    SELF.AIVAR[94] = TRUE;
    HERO.AIVAR[96] = 10;
    INFO_ADDCHOICE(0x143d6, "Die, you filthy beast!", 0x143dd);
    INFO_ADDCHOICE(0x143d6, "I don't want to hurt you.", 0x143dc);
}

func void ORCSLAVE_ARENAFIGHT() {
    Q306_STATE = 19;
    AI_STOPPROCESSINFOS(SELF);
    SELF.FLAGS = 0;
    B_ATTACK(SELF, HERO, AR_KILL, 0);
}

func void DIA_ORCSLAVE_TOURNAMENTFIGHT_ATTACK() {
    INFO_CLEARCHOICES(0x143d6);
    AI_WAITTILLEND(SELF, OTHER);
    AI_FUNCTION(OTHER, 0x143df);
    AI_STOPPROCESSINFOS(OTHER);
    AI_FUNCTION(OTHER, 0x143d8);
    AI_WAITTILLEND(SELF, OTHER);
    ORCSLAVE_ARENAFIGHT();
}

func void DIA_ORCSLAVE_TOURNAMENTFIGHT_GOOD() {
    AI_FUNCTION(OTHER, 0x143de);
    AI_OUTPUT(OTHER, SELF, "DIA_OrcSlave_TournamentFight_15_01");
    DIA_ORCSLAVE_TOURNAMENTFIGHT_ATTACK();
}

func void DIA_ORCSLAVE_TOURNAMENTFIGHT_BAD() {
    AI_FUNCTION(OTHER, 0x143de);
    AI_OUTPUT(OTHER, SELF, "DIA_OrcSlave_TournamentFight_15_02");
    DIA_ORCSLAVE_TOURNAMENTFIGHT_ATTACK();
}

func void ORCSLAVE_ENABLECAMERA() {
    DIACAM_ENABLE();
}

func void ORCSLAVE_UNTRIGGERCAMERA() {
    WLD_SENDUNTRIGGER("KM_ARENAFIGHT_4_03");
}

