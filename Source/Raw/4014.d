instance DIA_OTMAR_ONLYHEAD_EXIT(C_INFO) {
    NPC = 0xcb83;
    NR = 999;
    CONDITION = DIA_OTMAR_ONLYHEAD_EXIT_CONDITION;
    INFORMATION = DIA_OTMAR_ONLYHEAD_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_OTMAR_ONLYHEAD_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_OTMAR_ONLYHEAD_EXIT_INFO() {
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_OTMAR_ONLYHEAD_QA401_TRAITOR(C_INFO) {
    NPC = 0xcb83;
    NR = 1;
    CONDITION = DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_CONDITION;
    INFORMATION = DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_CONDITION() {
    if (((LOG_GETSTATUS(MIS_QA401)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 0x1121a))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_INFO() {
    if (((LOG_GETSTATUS(MIS_QA304)) == (LOG_SUCCESS)) || ((LOG_GETSTATUS(MIS_SQ223)) == (LOG_SUCCESS))) {
        AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
        AI_OUTPUT(SELF, OTHER, "DIA_Otmar_OnlyHead_QA401_Traitor_03_01");
    };
    AI_LOOKATNPC(OTHER, SELF);
    AI_STARTFACEANI(OTHER, S_SERIOUS, 1, -(1));
    AI_SETWALKMODE(OTHER, NPC_WALK);
    AI_GOTONPC(OTHER, OTHER);
    AI_PLAYANI(OTHER, "T_STAND_2_SLAVSQUATDIALOGUE");
    AI_OUTPUT(OTHER, SELF, "DIA_Otmar_OnlyHead_QA401_Traitor_15_02");
    AI_STARTFACEANI(SELF, S_FRIGHTENED, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Otmar_OnlyHead_QA401_Traitor_03_03");
    INFO_CLEARCHOICES(0x13121);
    INFO_ADDCHOICE(0x13121, "Give us what we need and we'll think about what to do next.", 0x13125);
}

func void DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_ENDCHOICE() {
    INFO_ADDCHOICE(0x13121, "I don't think I'll learn more from you... (End the conversation)", 0x13130);
}

func void DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_GIVE() {
    AI_OUTPUT(OTHER, SELF, "DIA_Otmar_OnlyHead_QA401_Traitor_Give_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Otmar_OnlyHead_QA401_Traitor_Give_03_02");
    INFO_CLEARCHOICES(0x13121);
    INFO_ADDCHOICE(0x13121, "Where are the other smugglers?", 0x13127);
}

func void DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_CHOICES() {
    INFO_CLEARCHOICES(0x13121);
    DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_ENDCHOICE();
    INFO_ADDCHOICE(0x13121, "Tell me what you know!", 0x13129);
    INFO_ADDCHOICE(0x13121, "So you talked to them after all?", 0x13128);
}

func void DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_GIVE_SMUGGLERS() {
    AI_OUTPUT(OTHER, SELF, "DIA_Otmar_OnlyHead_QA401_Traitor_Smugglers_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Otmar_OnlyHead_QA401_Traitor_Smugglers_03_02");
    AI_WAITTILLEND(OTHER, SELF);
    AI_PLAYANI(OTHER, "T_REMOVE_SLAVSQUATDIALOGUE");
    AI_DRAWWEAPON(OTHER);
    AI_WAITTILLEND(SELF, OTHER);
    AI_OUTPUT(SELF, OTHER, "DIA_Otmar_OnlyHead_QA401_Traitor_Smugglers_03_03");
    DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_CHOICES();
}

func void DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_GIVE_SMUGGLERS_TALK() {
    AI_REMOVEWEAPON(OTHER);
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Otmar_OnlyHead_QA401_Traitor_Talk_15_01");
    AI_RESETFACEANI(OTHER);
    AI_OUTPUT(SELF, OTHER, "DIA_Otmar_OnlyHead_QA401_Traitor_Talk_03_02");
    INFO_ADDCHOICE(0x13121, "If you tell me everything you know, you might come out of this safe and sound.", 0x1312a);
}

func void DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_GIVE_SMUGGLERS_SPEAKNOW() {
    AI_STARTFACEANI(OTHER, S_ANGRY, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Otmar_OnlyHead_QA401_Traitor_SpeakNow_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Otmar_OnlyHead_QA401_Traitor_SpeakNow_03_02");
    INFO_CLEARCHOICES(0x13121);
    DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_ENDCHOICE();
    INFO_ADDCHOICE(0x13121, "You have nothing left to lose, why are you covering for them?", 0x1312f);
}

func void DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_GIVE_SMUGGLERS_TALK_SURE() {
    AI_STARTFACEANI(OTHER, S_SMILE, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Otmar_OnlyHead_QA401_Traitor_Sure_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Otmar_OnlyHead_QA401_Traitor_Sure_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Otmar_OnlyHead_QA401_Traitor_Sure_15_03");
    AI_RESETFACEANI(OTHER);
    AI_STARTFACEANI(SELF, S_SAD, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Otmar_OnlyHead_QA401_Traitor_Sure_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Otmar_OnlyHead_QA401_Traitor_Sure_03_05");
    AI_LOGENTRY(TOPIC_QA401, LOG_QA401_OTMAR_STARTEDTALK);
    INFO_CLEARCHOICES(0x13121);
    DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_ENDCHOICE();
    INFO_ADDCHOICE(0x13121, "Any of ours worked with them yet?", 0x1312c);
    INFO_ADDCHOICE(0x13121, "Where are all the smugglers now?", 0x1312b);
}

func void DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_GIVE_SMUGGLERS_TALK_SURE_WHERE() {
    QA401_OTMAR_GOTANYTHING = TRUE;
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Otmar_OnlyHead_QA401_Traitor_Where_15_01");
    AI_RESETFACEANI(OTHER);
    AI_OUTPUT(SELF, OTHER, "DIA_Otmar_OnlyHead_QA401_Traitor_Where_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Otmar_OnlyHead_QA401_Traitor_Where_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Otmar_OnlyHead_QA401_Traitor_Where_03_04");
    AI_LOGENTRY(TOPIC_QA401, LOG_QA401_OTMAR_WHERE);
}

func void DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_GIVE_SMUGGLERS_TALK_SURE_TOGETHER() {
    QA401_OTMAR_GOTANYTHING = TRUE;
    AI_OUTPUT(OTHER, SELF, "DIA_Otmar_OnlyHead_QA401_Traitor_Together_15_01");
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Otmar_OnlyHead_QA401_Traitor_Together_03_02");
    INFO_CLEARCHOICES(0x13121);
    DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_ENDCHOICE();
    INFO_ADDCHOICE(0x13121, "This may be your only chance to save your skin.", 0x1312d);
    INFO_ADDCHOICE(0x13121, "You said you didn't want to do harm to the Guild.", 0x1312e);
}

func void DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_GIVE_SMUGGLERS_TALK_SURE_TOGETHER_LASTCHANCE() {
    AI_OUTPUT(OTHER, SELF, "DIA_Otmar_OnlyHead_QA401_Traitor_LastChance_15_01");
    AI_STARTFACEANI(SELF, S_SAD, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Otmar_OnlyHead_QA401_Traitor_LastChance_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Otmar_OnlyHead_QA401_Traitor_LastChance_03_03");
    if ((QA401_ARMARRESULT) >= (1)) {
        AI_LOGENTRY(TOPIC_QA401, LOG_QA401_OTMAR_ARMAR_V1);
    };
    AI_LOGENTRY(TOPIC_QA401, LOG_QA401_OTMAR_ARMAR_V2);
    INFO_CLEARCHOICES(0x13121);
    DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_ENDCHOICE();
}

func void DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_GIVE_SMUGGLERS_TALK_SURE_TOGETHER_GUILD() {
    AI_OUTPUT(OTHER, SELF, "DIA_Otmar_OnlyHead_QA401_Traitor_Guild_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Otmar_OnlyHead_QA401_Traitor_Guild_03_02");
    AI_RESETFACEANI(SELF);
    AI_OUTPUT(SELF, OTHER, "DIA_Otmar_OnlyHead_QA401_Traitor_Guild_03_03");
    AI_LOGENTRY(TOPIC_QA401, LOG_QA401_OTMAR_EVERYTHING);
    INFO_CLEARCHOICES(0x13121);
    DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_ENDCHOICE();
}

func void DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_GIVE_SMUGGLERS_SPEAKNOW_HIDE() {
    AI_OUTPUT(OTHER, SELF, "DIA_Otmar_OnlyHead_QA401_Traitor_Hide_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Otmar_OnlyHead_QA401_Traitor_Hide_03_02");
    AI_LOGENTRY(TOPIC_QA401, LOG_QA401_OTMAR_SCARED);
}

func void DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_END() {
    AI_REMOVEWEAPON(OTHER);
    AI_RESETFACEANI(OTHER);
    AI_OUTPUT(OTHER, SELF, "DIA_Otmar_OnlyHead_QA401_Traitor_End_15_01");
    AI_STARTFACEANI(SELF, S_FRIGHTENED, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Otmar_OnlyHead_QA401_Traitor_End_03_02");
    INFO_CLEARCHOICES(0x13121);
    INFO_ADDCHOICE(0x13121, "Sorry Otmar, there is only one punishment for traitors.", 0x13132);
    INFO_ADDCHOICE(0x13121, "I'll talk to Adelard about your release.", 0x13133);
}

func void DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_QUITDIALOGUE() {
    INFO_CLEARCHOICES(0x13121);
    AI_STOPPROCESSINFOS(SELF);
    AI_STOPLOOKAT(OTHER);
}

func void DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_END_NO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Otmar_OnlyHead_QA401_Traitor_No_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Otmar_OnlyHead_QA401_Traitor_No_03_02");
    DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_QUITDIALOGUE();
}

func void DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_END_YES() {
    QA401_OTMAR_PROMISEDTOHELP = TRUE;
    AI_OUTPUT(OTHER, SELF, "DIA_Otmar_OnlyHead_QA401_Traitor_Yes_15_01");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Otmar_OnlyHead_QA401_Traitor_Yes_03_02");
    DIA_OTMAR_ONLYHEAD_QA401_TRAITOR_QUITDIALOGUE();
}

