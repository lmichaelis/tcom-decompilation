instance DIA_ARAXOS_GUARDMINE_EXIT(C_INFO) {
    NPC = 0xdbfa;
    NR = 999;
    CONDITION = DIA_ARAXOS_GUARDMINE_EXIT_CONDITION;
    INFORMATION = DIA_ARAXOS_GUARDMINE_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_ARAXOS_GUARDMINE_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_ARAXOS_GUARDMINE_EXIT_INFO() {
    AI_STOPPROCESSINFOS(SELF);
}

const string ARAXOS_GUARDMINE_CHECKPOINT = "PART7_MINE_ENTER_GUARD";
var int ARAXOS_GUARDMINE_ALLOWUSTOGO = 0;
instance DIA_ARAXOS_GUARDMINE_FIRSTWARN(C_INFO) {
    NPC = 0xdbfa;
    NR = 1;
    CONDITION = DIA_ARAXOS_GUARDMINE_FIRSTWARN_CONDITION;
    INFORMATION = DIA_ARAXOS_GUARDMINE_FIRSTWARN_INFO;
    PERMANENT = TRUE;
    IMPORTANT = TRUE;
}

func int DIA_ARAXOS_GUARDMINE_FIRSTWARN_CONDITION() {
    if ((ARAXOS_GUARDMINE_ALLOWUSTOGO) == (TRUE)) {
        SELF.AIVAR[14] = TRUE;
    };
    if ((NPC_GETDISTTONPC(SELF, OTHER)) <= (700)) {
        if (((((SELF.AIVAR[12]) == (GP_NONE)) && ((SELF.AIVAR[14]) == (FALSE))) && ((HLP_STRCMP(NPC_GETNEARESTWP(SELF), SELF.WP)) == (TRUE))) && ((NPC_REFUSETALK(SELF)) == (FALSE))) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_ARAXOS_GUARDMINE_FIRSTWARN_INFO() {
    AI_STARTFACEANI(SELF, S_SERIOUS, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_FIRSTWARN_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_FIRSTWARN_03_02");
    AI_RESETFACEANI(SELF);
    OTHER.AIVAR[13] = NPC_GETDISTTOWP(OTHER, ARAXOS_GUARDMINE_CHECKPOINT);
    SELF.AIVAR[12] = GP_FIRSTWARNGIVEN;
}

instance DIA_ARAXOS_GUARDMINE_SECONDWARN(C_INFO) {
    NPC = 0xdbfa;
    NR = 1;
    CONDITION = DIA_ARAXOS_GUARDMINE_SECONDWARN_CONDITION;
    INFORMATION = DIA_ARAXOS_GUARDMINE_SECONDWARN_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_ARAXOS_GUARDMINE_SECONDWARN_CONDITION() {
    if (((((SELF.AIVAR[12]) == (GP_FIRSTWARNGIVEN)) && ((SELF.AIVAR[14]) == (FALSE))) && ((HLP_STRCMP(NPC_GETNEARESTWP(SELF), SELF.WP)) == (TRUE))) && ((NPC_GETDISTTOWP(OTHER, ARAXOS_GUARDMINE_CHECKPOINT)) < ((OTHER.AIVAR[13]) - (50)))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_ARAXOS_GUARDMINE_SECONDWARN_INFO() {
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_SECONDWARN_03_01");
    AI_RESETFACEANI(SELF);
    OTHER.AIVAR[13] = NPC_GETDISTTOWP(OTHER, ARAXOS_GUARDMINE_CHECKPOINT);
    SELF.AIVAR[12] = GP_SECONDWARNGIVEN;
}

instance DIA_ARAXOS_GUARDMINE_LASTWARN(C_INFO) {
    NPC = 0xdbfa;
    NR = 1;
    CONDITION = DIA_ARAXOS_GUARDMINE_LASTWARN_CONDITION;
    INFORMATION = DIA_ARAXOS_GUARDMINE_LASTWARN_INFO;
    PERMANENT = TRUE;
    IMPORTANT = TRUE;
}

func int DIA_ARAXOS_GUARDMINE_LASTWARN_CONDITION() {
    if (((((SELF.AIVAR[12]) == (GP_SECONDWARNGIVEN)) && ((SELF.AIVAR[14]) == (FALSE))) && ((HLP_STRCMP(NPC_GETNEARESTWP(SELF), SELF.WP)) == (TRUE))) && ((NPC_GETDISTTOWP(OTHER, ARAXOS_GUARDMINE_CHECKPOINT)) < ((OTHER.AIVAR[13]) - (50)))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_ARAXOS_GUARDMINE_LASTWARN_INFO() {
    OTHER.AIVAR[13] = 0;
    SELF.AIVAR[12] = GP_NONE;
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    B_SAY(SELF, OTHER, "$Alarm");
    AI_DRAWWEAPON(SELF);
    AI_STOPPROCESSINFOS(SELF);
    B_ATTACK(SELF, OTHER, AR_GUARDSTOPSINTRUDER, 1);
}

instance DIA_ARAXOS_GUARDMINE_WORKER(C_INFO) {
    NPC = 0xdbfa;
    NR = 1;
    CONDITION = DIA_ARAXOS_GUARDMINE_WORKER_CONDITION;
    INFORMATION = DIA_ARAXOS_GUARDMINE_WORKER_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "How do I become a mine worker?";
}

func int DIA_ARAXOS_GUARDMINE_WORKER_CONDITION() {
    if (((ARAXOS_GUARDMINE_ALLOWUSTOGO) == (FALSE)) && ((SQ119_CANGOTOARAXOSMINE) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_ARAXOS_GUARDMINE_WORKER_INFO() {
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Araxos_GuardMine_Worker_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_Worker_03_02");
    AI_RESETFACEANI(OTHER);
}

instance DIA_ARAXOS_GUARDMINE_SKILL(C_INFO) {
    NPC = 0xdbfa;
    NR = 1;
    CONDITION = DIA_ARAXOS_GUARDMINE_SKILL_CONDITION;
    INFORMATION = DIA_ARAXOS_GUARDMINE_SKILL_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "How can I prove my skills?";
}

func int DIA_ARAXOS_GUARDMINE_SKILL_CONDITION() {
    if (NPC_KNOWSINFO(OTHER, 0x134e9)) {
        if (((ARAXOS_GUARDMINE_ALLOWUSTOGO) == (FALSE)) && ((SQ119_CANGOTOARAXOSMINE) == (FALSE))) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_ARAXOS_GUARDMINE_SKILL_INFO() {
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Araxos_GuardMine_Skill_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_Skill_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_Skill_03_03");
    AI_RESETFACEANI(OTHER);
}

instance DIA_ARAXOS_GUARDMINE_CONTRACT(C_INFO) {
    NPC = 0xdbfa;
    NR = 1;
    CONDITION = DIA_ARAXOS_GUARDMINE_CONTRACT_CONDITION;
    INFORMATION = DIA_ARAXOS_GUARDMINE_CONTRACT_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "What's in the contract?";
}

func int DIA_ARAXOS_GUARDMINE_CONTRACT_CONDITION() {
    if (NPC_KNOWSINFO(OTHER, 0x134e9)) {
        if (((ARAXOS_GUARDMINE_ALLOWUSTOGO) == (FALSE)) && ((SQ119_CANGOTOARAXOSMINE) == (FALSE))) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_ARAXOS_GUARDMINE_CONTRACT_INFO() {
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Araxos_GuardMine_Contract_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_Contract_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_Contract_03_03");
    AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_Contract_03_04");
    AI_RESETFACEANI(OTHER);
    AI_RESETFACEANI(SELF);
}

instance DIA_ARAXOS_GUARDMINE_IMINGUILD(C_INFO) {
    NPC = 0xdbfa;
    NR = 1;
    CONDITION = DIA_ARAXOS_GUARDMINE_IMINGUILD_CONDITION;
    INFORMATION = DIA_ARAXOS_GUARDMINE_IMINGUILD_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "I belong to the Merchant's Guild.";
}

func int DIA_ARAXOS_GUARDMINE_IMINGUILD_CONDITION() {
    if ((HERO.GUILD) == (GIL_SLD)) {
        if (((ARAXOS_GUARDMINE_ALLOWUSTOGO) == (FALSE)) && ((SQ119_CANGOTOARAXOSMINE) == (FALSE))) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_ARAXOS_GUARDMINE_IMINGUILD_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Araxos_GuardMine_ImInGuild_15_01");
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_ImInGuild_03_02");
    AI_RESETFACEANI(SELF);
}

instance DIA_ARAXOS_GUARDMINE_GOTCONTRACT(C_INFO) {
    NPC = 0xdbfa;
    NR = 1;
    CONDITION = DIA_ARAXOS_GUARDMINE_GOTCONTRACT_CONDITION;
    INFORMATION = DIA_ARAXOS_GUARDMINE_GOTCONTRACT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "I want to go into the mine, here's my contract.";
}

func int DIA_ARAXOS_GUARDMINE_GOTCONTRACT_CONDITION() {
    if ((ARAXOSMINE_LASTTIME) == (3)) {
        return FALSE;
    };
    if (((((SQ119_CANGOTOARAXOSMINE) == (TRUE)) && ((ARAXOS_GUARDMINE_ALLOWUSTOGO) == (FALSE))) && ((ARAXOS_GUARDMINE_MARVINNEEDTOPAY) == (FALSE))) && ((SQ119_INSIDEMINE) == (0))) {
        if ((LOG_GETSTATUS(MIS_QA306)) == (LOG_RUNNING)) {
            if ((QA306_BLOODWYNCUTSCENESTATUS) != (3)) {
                return TRUE;
            };
        } else {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

var int ARAXOS_GUARDMINE_MARVINNEEDTOPAY = 0;
func void DIA_ARAXOS_GUARDMINE_ENTERMINE() {
    ARAXOS_GUARDMINE_ALLOWUSTOGO = TRUE;
    ARAXOS_GUARDMINE_MARVINNEEDTOPAY = FALSE;
    SQ119_OPENARAXOSMINE();
    AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_GotContract_03_09");
    AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_GotContract_03_10");
    AI_FUNCTION(SELF, 0xb885);
    AI_FUNCTION(SELF, 0xb886);
    AI_FUNCTION(SELF, 0xb887);
    AI_FUNCTION(SELF, 0xb888);
    if ((ARAXOS_GUARDMINE_GIVEARMOR) == (FALSE)) {
        ARAXOS_GUARDMINE_GIVEARMOR = TRUE;
        AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_GotContract_03_06");
        AI_FUNCTION(SELF, 0xb88a);
    };
    AI_STOPPROCESSINFOS(SELF);
    AI_RESETFACEANI(SELF);
}

var int DIA_ARAXOS_GUARDMINE_ENTERMINE.ARAXOS_GUARDMINE_GIVEARMOR = 0;
func void DIA_ARAXOS_GUARDMINE_GOTCONTRACT_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Araxos_GuardMine_GotContract_15_01");
    if ((((QA306_GOTOARAXOSMINE) == (1)) || (((ARAXOSMINE_LASTTIME) == (2)) && ((ARAXOSMINE_LASTTIME_DAY) <= ((WLD_GETDAY()) - (1))))) || ((LOG_GETSTATUS(MIS_QA306)) == (LOG_SUCCESS))) {
        AI_STARTFACEANI(SELF, S_TIRED, 1, -(1));
        AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_GotContract_03_08");
        AI_RESETFACEANI(SELF);
        if ((ARAXOSMINE_LASTTIME) == (2)) {
            ARAXOSMINE_LASTTIME = 3;
            B_SAY(SELF, OTHER, "$REWARD_CALM");
            CREATEINVITEMS(SELF, 0x9df0, 1);
            B_GIVEINVITEMS(SELF, OTHER, 0x9df0, 1);
        };
    };
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_GotContract_03_02");
    B_USEFAKESCROLL();
    if ((SQ119_PASSAGEPAYMENT) == (1)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_GotContract_03_05");
        DIA_ARAXOS_GUARDMINE_ENTERMINE();
    };
    if ((SQ119_PASSAGEPAYMENT) == (2)) {
        ARAXOS_GUARDMINE_MARVINNEEDTOPAY = TRUE;
        AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_GotContract_03_03");
    };
    if ((SQ119_PASSAGEPAYMENT) == (3)) {
        ARAXOS_GUARDMINE_MARVINNEEDTOPAY = TRUE;
        AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_GotContract_03_04");
    };
    AI_RESETFACEANI(SELF);
}

instance DIA_ARAXOS_GUARDMINE_PAY(C_INFO) {
    NPC = 0xdbfa;
    NR = 1;
    CONDITION = DIA_ARAXOS_GUARDMINE_PAY_CONDITION;
    INFORMATION = DIA_ARAXOS_GUARDMINE_PAY_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "I want to pay to get into the mine.";
}

func int DIA_ARAXOS_GUARDMINE_PAY_CONDITION() {
    if (((((SQ119_CANGOTOARAXOSMINE) == (TRUE)) && ((ARAXOS_GUARDMINE_ALLOWUSTOGO) == (FALSE))) && ((ARAXOS_GUARDMINE_MARVINNEEDTOPAY) == (TRUE))) && ((SQ119_INSIDEMINE) == (0))) {
        if ((LOG_GETSTATUS(MIS_QA306)) == (LOG_RUNNING)) {
            if ((QA306_BLOODWYNCUTSCENESTATUS) != (3)) {
                return TRUE;
            };
        } else {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_ARAXOS_GUARDMINE_PAY_INFO() {
    INFO_CLEARCHOICES(0x134fb);
    INFO_ADDCHOICE(0x134fb, DIALOG_BACK, 0x134fe);
    if ((SQ119_PASSAGEPAYMENT) == (2)) {
        INFO_ADDCHOICE(0x134fb, DIALOG_PAY200G, 0x134ff);
    };
    if ((SQ119_PASSAGEPAYMENT) == (3)) {
        INFO_ADDCHOICE(0x134fb, DIALOG_PAY100G, 0x13500);
    };
}

func void DIA_ARAXOS_GUARDMINE_PAY_BACK() {
    INFO_CLEARCHOICES(0x134fb);
}

func void DIA_ARAXOS_GUARDMINE_PAY_200() {
    if ((NPC_HASITEMS(OTHER, 0x859b)) >= (SQ119_PASSAGEPAYMENT_V1)) {
        NPC_REMOVEINVITEMS(SELF, 0x859b, SQ119_PASSAGEPAYMENT_V1);
        DIA_ARAXOS_GUARDMINE_ENTERMINE();
    };
    B_SAY(SELF, OTHER, "$NOGOLD");
    DIA_ARAXOS_GUARDMINE_PAY_INFO();
}

func void DIA_ARAXOS_GUARDMINE_PAY_100() {
    if ((NPC_HASITEMS(OTHER, 0x859b)) >= (SQ119_PASSAGEPAYMENT_V2)) {
        NPC_REMOVEINVITEMS(SELF, 0x859b, SQ119_PASSAGEPAYMENT_V2);
        DIA_ARAXOS_GUARDMINE_ENTERMINE();
    };
    B_SAY(SELF, OTHER, "$NOGOLD");
    DIA_ARAXOS_GUARDMINE_PAY_INFO();
}

instance DIA_ARAXOS_GUARDMINE_NOARAXOSARMOR(C_INFO) {
    NPC = 0xdbfa;
    NR = 1;
    CONDITION = DIA_ARAXOS_GUARDMINE_NOARAXOSARMOR_CONDITION;
    INFORMATION = DIA_ARAXOS_GUARDMINE_NOARAXOSARMOR_INFO;
    PERMANENT = TRUE;
    IMPORTANT = TRUE;
}

func int DIA_ARAXOS_GUARDMINE_NOARAXOSARMOR_CONDITION() {
    if ((((SQ119_INSIDEMINE) >= (1)) && ((SQ119_INSIDEMINE) < (3))) && (NPC_HASGUILDARMORINEQ(HERO, GIL_SLD))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_ARAXOS_GUARDMINE_NOARAXOSARMOR_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_NoAraxosArmor_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_NoAraxosArmor_03_02");
    AI_FUNCTION(SELF, 0xb88c);
}

instance DIA_ARAXOS_GUARDMINE_LEAVEMINE(C_INFO) {
    NPC = 0xdbfa;
    NR = 1;
    CONDITION = DIA_ARAXOS_GUARDMINE_LEAVEMINE_CONDITION;
    INFORMATION = DIA_ARAXOS_GUARDMINE_LEAVEMINE_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "I want to leave the mine.";
}

func int DIA_ARAXOS_GUARDMINE_LEAVEMINE_CONDITION() {
    if (((SQ119_INSIDEMINE) == (2)) && ((NPC_GETDISTTOWP(SELF, SELF.WP)) <= (500))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_ARAXOS_GUARDMINE_LEAVEMINE_CHOICES() {
    INFO_CLEARCHOICES(0x13504);
    INFO_ADDCHOICE(0x13504, "(Move along)", 0x1350b);
    INFO_ADDCHOICE(0x13504, "Get out of my way, or I'll move you myself.", 0x1350c);
    INFO_ADDCHOICE(0x13504, "Maybe you can turn a blind eye to this...", 0x1350d);
}

func void DIA_ARAXOS_GUARDMINE_LEAVEMINE_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Araxos_GuardMine_LeaveMine_15_01");
    if ((QA306_BLOODWYNCUTSCENESTATUS) == (3)) {
        if ((QA306_LOAFSJUDGMENT_RESULT) == (0)) {
            AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_LeaveMine_03_09");
        } else {
            AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_LeaveMine_03_10");
            if ((QA306_LEAVE_ASKFIRSTTIME) == (FALSE)) {
                AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
                AI_OUTPUT(OTHER, SELF, "DIA_Araxos_GuardMine_LeaveMine_15_11");
                AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_LeaveMine_03_12");
                AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_LeaveMine_03_13");
                AI_RESETFACEANI(OTHER);
            };
        } else if ((QA306_CLOSEDGATES_LOGENTRY) == (FALSE)) {
            QA306_CLOSEDGATES_LOGENTRY = TRUE;
            AI_LOGENTRY(TOPIC_QA306, LOG_QA306_CLOSEDGATES);
        };
        if ((((QA306_LOAFSJUDGMENT_RESULT) == (2)) || ((QA306_FIGHTWITHLOAFSTATUS) == (2))) || (NPC_KNOWSINFO(OTHER, 0x133d0))) {
            DIA_ARAXOS_GUARDMINE_LEAVEMINE_CHOICES();
        };
    };
    SQ119_INSIDEMINE = 3;
    MARVIN_CURRENTGOLDNUGGETCOUNT = NPC_HASITEMS(OTHER, 0x837c);
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_LeaveMine_03_02");
    if ((MARVIN_CURRENTGOLDNUGGETCOUNT) == (0)) {
        AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
        AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_LeaveMine_03_08");
    };
    if (((MARVIN_CURRENTGOLDNUGGETCOUNT) >= (1)) && ((MARVIN_CURRENTGOLDNUGGETCOUNT) <= (29))) {
        AI_STARTFACEANI(SELF, S_SERIOUS, 1, -(1));
        AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_LeaveMine_03_03");
    };
    if (((MARVIN_CURRENTGOLDNUGGETCOUNT) >= (30)) && ((MARVIN_CURRENTGOLDNUGGETCOUNT) <= (69))) {
        AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
        AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_LeaveMine_03_04");
    };
    if ((MARVIN_CURRENTGOLDNUGGETCOUNT) >= (70)) {
        AI_STARTFACEANI(SELF, S_SURPRISE, 1, -(1));
        AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_LeaveMine_03_05");
    };
    if ((MARVIN_CURRENTGOLDNUGGETCOUNT) >= (1)) {
        if ((SQ119_GOTPAYMENT) == (1)) {
            CREATEINVITEMS(SELF, 0x837c, (MARVIN_CURRENTGOLDNUGGETCOUNT) / (2));
        } else {
            CREATEINVITEMS(SELF, 0x837c, ((MARVIN_CURRENTGOLDNUGGETCOUNT) / (4)) * (3));
            B_GIVEINVITEMS(SELF, OTHER, 0x837c, ((MARVIN_CURRENTGOLDNUGGETCOUNT) / (4)) * (3));
        } else {
            AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
        } else {
            AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_LeaveMine_03_06");
        } else {
            AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_LeaveMine_03_07");
        };
    };
    if ((LOG_GETSTATUS(MIS_SQ119)) == (LOG_RUNNING)) {
        AI_LOGENTRY(TOPIC_SQ119, LOG_SQ119_FINISH);
        LOG_SETSTATUS(_@(MIS_SQ119), TOPIC_SQ119, LOG_SUCCESS);
        LOG_CREATETOPIC(TOPIC_BARTER, LOG_NOTE);
        AI_LOGENTRY(TOPIC_BARTER, LOG_BARTER_GOLD);
        LOG_CREATETOPIC(TOPIC_GOLDMINE, LOG_NOTE);
        AI_LOGENTRY(TOPIC_GOLDMINE, LOG_BARTER_GOLD);
        if (((LORENZO_QA306_ARAXOSMINESTATUS) == (1)) && ((LOG_GETSTATUS(MIS_QA306)) == (LOG_RUNNING))) {
            AI_LOGENTRY(TOPIC_QA306, LOG_QA306_TOLORENZO);
        };
    };
    AI_FUNCTION(SELF, 0xb889);
    AI_RESETFACEANI(SELF);
    SQ119_LEAVEARAXOSMINE();
    AI_FUNCTION(SELF, 0xb88d);
    if ((ARAXOSMINE_LASTTIME) == (1)) {
        ARAXOSMINE_LASTTIME = 2;
        ARAXOSMINE_LASTTIME_DAY = WLD_GETDAY();
    };
    AI_PRINTSCREEN(RESERVED_CONST_STRING_02, -(1), -(1), FONT_SCREEN, 10);
}

var int DIA_ARAXOS_GUARDMINE_LEAVEMINE_INFO.QA306_LEAVE_ASKFIRSTTIME = 0;
var int DIA_ARAXOS_GUARDMINE_LEAVEMINE_INFO.QA306_CLOSEDGATES_LOGENTRY = 0;
var int DIA_ARAXOS_GUARDMINE_LEAVEMINE_INFO.MARVIN_CURRENTGOLDNUGGETCOUNT = 0;
func void DIA_ARAXOS_GUARDMINE_LEAVE() {
    INFO_CLEARCHOICES(0x13504);
    AI_STOPPROCESSINFOS(SELF);
}

func void DIA_ARAXOS_GUARDMINE_MOVEIT() {
    QA306_FIGHTWITHARAXOSGUARDSTATUS = 1;
    SELF.AIVAR[96] = -(1);
    SELF.FLAGS = NPC_FLAG_IMPORTANT;
    AI_STARTFACEANI(OTHER, S_ANGRY, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Araxos_GuardMine_LeaveMine_MoveIt_15_01");
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_LeaveMine_MoveIt_03_02");
    AI_STOPPROCESSINFOS(SELF);
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
    INFO_CLEARCHOICES(0x13504);
    B_ATTACK(SELF, OTHER, AR_KILL, 1);
}

func void DIA_ARAXOS_GUARDMINE_GOLD() {
    AI_OUTPUT(OTHER, SELF, "DIA_Araxos_GuardMine_Gold_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_Gold_03_02");
    INFO_CLEARCHOICES(0x13504);
    INFO_ADDCHOICE(0x13504, DIALOG_BACK, 0x1350e);
    if ((NPC_HASITEMS(OTHER, 0x837c)) >= (50)) {
        INFO_ADDCHOICE(0x13504, "(Offer 50 nuggets)", 0x13510);
    };
    if ((NPC_HASITEMS(OTHER, 0x837c)) >= (20)) {
        INFO_ADDCHOICE(0x13504, "(Offer 20 nuggets)", 0x1350f);
    };
}

func void DIA_ARAXOS_GUARDMINE_GOLD_BACK() {
    AI_RESETFACEANI(SELF);
    DIA_ARAXOS_GUARDMINE_LEAVEMINE_CHOICES();
}

func void DIA_ARAXOS_GUARDMINE_GOLD_20() {
    B_USEFAKEGOLDNUGGET_MARVIN();
    AI_WAITTILLEND(SELF, OTHER);
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_Gold_20_03_01");
}

func void DIA_ARAXOS_GUARDMINE_GOLD_50() {
    B_USEFAKEGOLDNUGGET_MARVIN();
    AI_WAITTILLEND(SELF, OTHER);
    AI_RESETFACEANI(SELF);
    AI_PLAYANI(SELF, T_SEARCH);
    AI_OUTPUT(SELF, OTHER, "DIA_Araxos_GuardMine_Gold_50_03_01");
    NPC_REMOVEINVITEMS(SELF, 0x837c, 50);
    AI_FUNCTION(SELF, 0xf71b);
    B_GIVEINVITEMS(OTHER, SELF, 0x837c, 50);
    INFO_CLEARCHOICES(0x13504);
    AI_STOPPROCESSINFOS(SELF);
}

