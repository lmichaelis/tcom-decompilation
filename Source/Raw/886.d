var int PRAYDAY = 0;
func void PRAYSHRINE_S1() {
    HER = HLP_GETNPC(0xc3ab);
    if ((HLP_GETINSTANCEID(SELF)) == (HLP_GETINSTANCEID(HER))) {
        SELF.AIVAR[4] = TRUE;
        PLAYER_MOBSI_PRODUCTION = MOBSI_PRAYSHRINE;
        AI_PROCESSINFOS(HER);
        ACH_14_INNOS = TRUE;
    };
}

instance PRAYSHRINE_S1.HER(C_NPC)
instance PC_PRAYSHRINE_END(C_INFO) {
    NPC = 0xc3ab;
    NR = 999;
    CONDITION = PC_PRAYSHRINE_END_CONDITION;
    INFORMATION = PC_PRAYSHRINE_END_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int PC_PRAYSHRINE_END_CONDITION() {
    if ((PLAYER_MOBSI_PRODUCTION) == (MOBSI_PRAYSHRINE)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void PC_PRAYSHRINE_END_INFO() {
    B_ENDPRODUCTIONDIALOG();
}

instance PC_PRAYSHRINE_PRAY(C_INFO) {
    NPC = 0xc3ab;
    NR = 2;
    CONDITION = PC_PRAYSHRINE_PRAY_CONDITION;
    INFORMATION = PC_PRAYSHRINE_PRAY_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = NAME_ADDON_BETEN;
}

func int PC_PRAYSHRINE_PRAY_CONDITION() {
    if ((PLAYER_MOBSI_PRODUCTION) == (MOBSI_PRAYSHRINE)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

var int PRAYSHRINE_COUNTHP = 0;
const int PRAYSHRINE_LIMIT = 100;
func void PC_PRAYSHRINE_PRAY_INFO() {
    INFO_CLEARCHOICES(0xbb49);
    INFO_ADDCHOICE(0xbb49, DIALOG_BACK, 0xbb4e);
    INFO_ADDCHOICE(0xbb49, "I want to pray.", 0xbb50);
    if ((PRAYSHRINE_COUNTHP) <= (PRAYSHRINE_LIMIT)) {
        if (((PRAYDAY) != (WLD_GETDAY())) || ((KAPITEL) == (6))) {
            if ((NPC_HASITEMS(HERO, 0x859b)) >= (10)) {
                INFO_ADDCHOICE(0xbb49, "I want to pray and make an offering of 10 gold pieces.", 0xbb54);
            };
            if ((NPC_HASITEMS(HERO, 0x859b)) >= (50)) {
                INFO_ADDCHOICE(0xbb49, "I want to pray and make an offering of 50 gold pieces.", 0xbb56);
            };
            if ((NPC_HASITEMS(HERO, 0x859b)) >= (100)) {
                INFO_ADDCHOICE(0xbb49, "I want to pray and make an offering of 100 gold pieces.", 0xbb58);
            };
        };
    };
}

func void PC_PRAYSHRINE_PRAY_BACK() {
    INFO_CLEARCHOICES(0xbb49);
}

func void PC_PRAYSHRINE_HEALPLAYER() {
    if ((HERO.ATTRIBUTE[0]) != (HERO.ATTRIBUTE[1])) {
        HERO.ATTRIBUTE[0] = HERO.ATTRIBUTE[1];
    };
    PRINTSCREEN(PRINT_BLESSHITPOINTS, -(1), 53, FONT_SCREEN, 3);
}

func void PC_PRAYSHRINE_PRAY_NOPAY() {
    PRINTSCREEN(PRINT_BLESSNONE, -(1), 48, FONT_SCREEN, 3);
    PC_PRAYSHRINE_HEALPLAYER();
    PRAYDAY = WLD_GETDAY();
    INFO_CLEARCHOICES(0xbb49);
}

const int INNOS_POWERUP_SMALL = 1;
const int INNOS_POWERUP_MEDIUM = 5;
const int INNOS_POWERUP_HIGH = 10;
func void PC_PRAYSHRINE_PRAY_SMALLPAY() {
    if ((PRAYDAY) == (WLD_GETDAY())) {
    };
    if ((PRAYSHRINE_COUNTHP) >= (PRAYSHRINE_LIMIT)) {
    };
    NPC_REMOVEINVITEMS(HERO, 0x859b, 10);
    CONCATTEXT = CONCATSTRINGS(PRINT_BLESSHITPOINTS_MAX, INTTOSTRING(INNOS_POWERUP_SMALL));
    PRINTSCREEN(CONCATTEXT, -(1), 48, FONT_SCREEN, 3);
    NPC_CHANGEATTRIBUTE(SELF, ATR_HITPOINTS_MAX, INNOS_POWERUP_SMALL);
    NPC_CHANGEATTRIBUTE(SELF, ATR_HITPOINTS, INNOS_POWERUP_SMALL);
    MARVINTRANSFORMHP = (MARVINTRANSFORMHP) + (INNOS_POWERUP_SMALL);
    PRAYSHRINE_COUNTHP = (PRAYSHRINE_COUNTHP) + (INNOS_POWERUP_SMALL);
    PC_PRAYSHRINE_HEALPLAYER();
    PRAYDAY = WLD_GETDAY();
    INFO_CLEARCHOICES(0xbb49);
}

var string PC_PRAYSHRINE_PRAY_SMALLPAY.CONCATTEXT = "";
func void PC_PRAYSHRINE_PRAY_MEDIUMPAY() {
    if ((PRAYDAY) == (WLD_GETDAY())) {
    };
    if ((PRAYSHRINE_COUNTHP) >= (PRAYSHRINE_LIMIT)) {
    };
    NPC_REMOVEINVITEMS(HERO, 0x859b, 50);
    CONCATTEXT2 = CONCATSTRINGS(PRINT_BLESSHITPOINTS_MAX, INTTOSTRING(INNOS_POWERUP_MEDIUM));
    PRINTSCREEN(CONCATTEXT2, -(1), 48, FONT_SCREEN, 3);
    NPC_CHANGEATTRIBUTE(SELF, ATR_HITPOINTS_MAX, INNOS_POWERUP_MEDIUM);
    NPC_CHANGEATTRIBUTE(SELF, ATR_HITPOINTS, INNOS_POWERUP_MEDIUM);
    MARVINTRANSFORMHP = (MARVINTRANSFORMHP) + (INNOS_POWERUP_MEDIUM);
    PRAYSHRINE_COUNTHP = (PRAYSHRINE_COUNTHP) + (INNOS_POWERUP_MEDIUM);
    PC_PRAYSHRINE_HEALPLAYER();
    PRAYDAY = WLD_GETDAY();
    INFO_CLEARCHOICES(0xbb49);
}

var string PC_PRAYSHRINE_PRAY_MEDIUMPAY.CONCATTEXT2 = "";
func void PC_PRAYSHRINE_PRAY_BIGPAY() {
    if ((PRAYDAY) == (WLD_GETDAY())) {
    };
    if ((PRAYSHRINE_COUNTHP) >= (PRAYSHRINE_LIMIT)) {
    };
    NPC_REMOVEINVITEMS(HERO, 0x859b, 100);
    CONCATTEXT3 = CONCATSTRINGS(PRINT_BLESSHITPOINTS_MAX, INTTOSTRING(INNOS_POWERUP_HIGH));
    PRINTSCREEN(CONCATTEXT3, -(1), 48, FONT_SCREEN, 3);
    NPC_CHANGEATTRIBUTE(SELF, ATR_HITPOINTS_MAX, INNOS_POWERUP_HIGH);
    NPC_CHANGEATTRIBUTE(SELF, ATR_HITPOINTS, INNOS_POWERUP_HIGH);
    MARVINTRANSFORMHP = (MARVINTRANSFORMHP) + (INNOS_POWERUP_HIGH);
    PRAYSHRINE_COUNTHP = (PRAYSHRINE_COUNTHP) + (INNOS_POWERUP_HIGH);
    PC_PRAYSHRINE_HEALPLAYER();
    PRAYDAY = WLD_GETDAY();
    INFO_CLEARCHOICES(0xbb49);
}

var string PC_PRAYSHRINE_PRAY_BIGPAY.CONCATTEXT3 = "";
