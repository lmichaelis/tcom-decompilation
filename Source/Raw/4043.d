instance DIA_DANIEL_EXIT(C_INFO) {
    NPC = 0xdbf3;
    NR = 999;
    CONDITION = DIA_DANIEL_EXIT_CONDITION;
    INFORMATION = DIA_DANIEL_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_DANIEL_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_DANIEL_EXIT_INFO() {
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_DANIEL_AMBIENT(C_INFO) {
    NPC = 0xdbf3;
    NR = 990;
    CONDITION = DIA_DANIEL_AMBIENT_CONDITION;
    INFORMATION = DIA_DANIEL_AMBIENT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "How are you doing?";
}

func int DIA_DANIEL_AMBIENT_CONDITION() {
    if (NPC_KNOWSINFO(OTHER, 0x134c9)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DANIEL_AMBIENT_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Daniel_Ambient_15_00");
    NPC_INITAMBIENTS(SELF, 2);
    if ((NPC_GETLASTAMBIENT(SELF)) == (1)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Daniel_Ambient_13_01");
    };
    if ((NPC_GETLASTAMBIENT(SELF)) == (2)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Daniel_Ambient_13_03");
    };
}

instance DIA_DANIEL_Q205_RENEGADE(C_INFO) {
    NPC = 0xdbf3;
    NR = 1;
    CONDITION = DIA_DANIEL_Q205_RENEGADE_CONDITION;
    INFORMATION = DIA_DANIEL_Q205_RENEGADE_INFO;
    PERMANENT = TRUE;
    IMPORTANT = TRUE;
}

func int DIA_DANIEL_Q205_RENEGADE_CONDITION() {
    if (NPC_ISINSTATE(SELF, 0xf09f)) {
        if ((Q205_TRYSOLVEDANIELPROBLEM) == (TRUE)) {
            if (((Q205_TRYTOSAVEDANIEL) == (0)) || ((Q205_TRYTOSAVEDANIEL) == (1))) {
                return TRUE;
            };
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_DANIEL_LEAVEME() {
    AI_OUTPUT(SELF, OTHER, "DIA_Daniel_Q205_Renegade_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Daniel_Q205_Renegade_03_02");
}

func void DIA_DANIEL_Q205_RENEGADE_INFO() {
    DIA_DANIEL_LEAVEME();
    INFO_CLEARCHOICES(0x134c9);
    INFO_ADDCHOICE(0x134c9, "(Move along)", 0x134d7);
    INFO_ADDCHOICE(0x134c9, "(Try to free Daniel)", 0x134d6);
    INFO_ADDCHOICE(0x134c9, "(Kill Daniel)", 0x134cd);
    INFO_ADDCHOICE(0x134c9, "Who are you?", 0x134cf);
}

func void DIA_DANIEL_Q205_RENEGADE_KILL() {
    AI_OUTPUT(OTHER, SELF, "DIA_Daniel_Q205_Renegade_Kill_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Daniel_Q205_Renegade_Kill_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Daniel_Q205_Renegade_Kill_03_03");
    Q205_TRYTOSAVEDANIEL = 4;
    B_MARVIN_ATTACKINDIALOGUE_PREPARE();
    AI_FUNCTION(OTHER, 0x134ce);
    B_MARVIN_ATTACKINDIALOGUE_ATTACK();
    INFO_CLEARCHOICES(0x134c9);
    AI_STOPPROCESSINFOS(HERO);
}

func void KILLDANIEL() {
    MDL_APPLYOVERLAYMDS(NONE_6269_DANIEL, "HUMANS_SUDDENDEATH.MDS");
    AI_PLAYANI(NONE_6269_DANIEL, T_DEAD);
    SND_PLAY("FIG_SwordFinal");
    SND_PLAY("SVM_46_DEAD");
    B_MAGICHURTNPC(HERO, NONE_6269_DANIEL, 0x270f);
    AI_LOGENTRY(TOPIC_Q205, LOG_Q205_KILLEDDANIEL);
    AI_REMOVEWEAPON(HERO);
    MIL_6264_RENEGADE.AIVAR[54] = FALSE;
    MIL_6267_SALVI.AIVAR[54] = FALSE;
    MIL_6268_BRODDY.AIVAR[54] = FALSE;
    MIL_6275_BERTO.AIVAR[54] = FALSE;
    MIL_6276_TILL.AIVAR[54] = FALSE;
    MIL_6277_RENEGADE.AIVAR[54] = FALSE;
    HERO.AIVAR[4] = FALSE;
}

func void DIA_DANIEL_Q205_RENEGADE_WHO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Daniel_Q205_Renegade_Who_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Daniel_Q205_Renegade_Who_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Daniel_Q205_Renegade_Who_03_03");
    AI_OUTPUT(OTHER, SELF, "DIA_Daniel_Q205_Renegade_Who_15_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Daniel_Q205_Renegade_Who_03_05");
    AI_OUTPUT(OTHER, SELF, "DIA_Daniel_Q205_Renegade_Who_15_06");
    AI_OUTPUT(SELF, OTHER, "DIA_Daniel_Q205_Renegade_Who_03_07");
    AI_OUTPUT(OTHER, SELF, "DIA_Daniel_Q205_Renegade_Who_15_08");
    AI_OUTPUT(SELF, OTHER, "DIA_Daniel_Q205_Renegade_Who_03_09");
    INFO_ADDCHOICE(0x134c9, "I have bad news.", 0x134d0);
}

func void DIA_DANIEL_Q205_RENEGADE_JOIN() {
    AI_OUTPUT(OTHER, SELF, "DIA_Daniel_Q205_Renegade_Join_15_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Daniel_Q205_Renegade_Join_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Daniel_Q205_Renegade_Join_03_04");
    AI_OUTPUT(OTHER, SELF, "DIA_Daniel_Q205_Renegade_Join_15_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Daniel_Q205_Renegade_Join_03_06");
    AI_OUTPUT(SELF, OTHER, "DIA_Daniel_Q205_Renegade_Join_03_07");
    AI_OUTPUT(OTHER, SELF, "DIA_Daniel_Q205_Renegade_Join_15_08");
    AI_OUTPUT(SELF, OTHER, "DIA_Daniel_Q205_Renegade_Join_03_09");
    INFO_CLEARCHOICES(0x134c9);
    INFO_ADDCHOICE(0x134c9, "If you don't do what I tell you to do, they'll kill me too.", 0x134d5);
    INFO_ADDCHOICE(0x134c9, "The unit you serve is long gone.", 0x134d4);
    INFO_ADDCHOICE(0x134c9, "(Intimidate)", 0x134d3);
}

func void DIA_DANIEL_Q205_RENEGADE_AGREE() {
    AI_OUTPUT(SELF, OTHER, "DIA_Daniel_Q205_Renegade_Scare_03_04");
    AI_REMOVEWEAPON(OTHER);
    Q205_TRYTOSAVEDANIEL = 2;
    Q205_RENEGADESIGNOREMURDER_DISABLE();
    INFO_CLEARCHOICES(0x134c9);
    AI_STOPPROCESSINFOS(SELF);
    AI_LOGENTRY(TOPIC_Q205, LOG_Q205_PERSUADEDANIEL);
}

func void DIA_DANIEL_Q205_RENEGADE_DISAGREE() {
    Q205_TRYTOSAVEDANIEL = 3;
    Q205_RENEGADESIGNOREMURDER_DISABLE();
    INFO_CLEARCHOICES(0x134c9);
    AI_STOPPROCESSINFOS(SELF);
}

func void DIA_DANIEL_Q205_RENEGADE_JOIN_SCARE() {
    AI_DRAWWEAPON(OTHER);
    AI_OUTPUT(OTHER, SELF, "DIA_Daniel_Q205_Renegade_Scare_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Daniel_Q205_Renegade_Scare_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Daniel_Q205_Renegade_Scare_15_03");
    DIA_DANIEL_Q205_RENEGADE_AGREE();
}

func void DIA_DANIEL_Q205_RENEGADE_JOIN_GERWINDEAD() {
    AI_OUTPUT(OTHER, SELF, "DIA_Daniel_Q205_Renegade_GerwinDead_15_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Daniel_Q205_Renegade_GerwinDead_15_02");
    DIA_DANIEL_Q205_RENEGADE_AGREE();
}

func void DIA_DANIEL_Q205_RENEGADE_JOIN_MYSAKE() {
    AI_OUTPUT(OTHER, SELF, "DIA_Daniel_Q205_Renegade_MySake_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Daniel_Q205_Renegade_MySake_03_02");
    Q205_TRYTOSAVEDANIEL = 3;
    DIA_DANIEL_Q205_RENEGADE_DISAGREE();
}

func void DIA_DANIEL_Q205_RENEGADE_SAVE() {
    AI_OUTPUT(OTHER, SELF, "DIA_Daniel_Q205_Renegade_Save_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Daniel_Q205_Renegade_Save_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Daniel_Q205_Renegade_Save_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Daniel_Q205_Renegade_Save_03_04");
    AI_OUTPUT(OTHER, SELF, "DIA_Daniel_Q205_Renegade_Save_15_05");
    AI_OUTPUT(OTHER, SELF, "DIA_Daniel_Q205_Renegade_Save_15_06");
    AI_OUTPUT(SELF, OTHER, "DIA_Daniel_Q205_Renegade_Save_03_07");
    AI_LOGENTRY(TOPIC_Q205, LOG_Q205_WANTEDTOFREE);
    DIA_DANIEL_Q205_RENEGADE_DISAGREE();
}

func void DIA_DANIEL_Q205_RENEGADE_LEAVE() {
    INFO_CLEARCHOICES(0x134c9);
    AI_STOPPROCESSINFOS(HERO);
}

instance DIA_DANIEL_Q205_HELLO(C_INFO) {
    NPC = 0xdbf3;
    NR = 1;
    CONDITION = DIA_DANIEL_Q205_HELLO_CONDITION;
    INFORMATION = DIA_DANIEL_Q205_HELLO_INFO;
    PERMANENT = TRUE;
    IMPORTANT = TRUE;
}

func int DIA_DANIEL_Q205_HELLO_CONDITION() {
    if (((Q205_TRYTOSAVEDANIEL) == (2)) && (NPC_ISINSTATE(SELF, 0xf09f))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DANIEL_Q205_HELLO_INFO() {
    DIA_DANIEL_LEAVEME();
}

