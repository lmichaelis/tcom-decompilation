instance Q515_SHOOTMARVIN(CUTSCENE) {
    ONSTART = FUNCTION(0x16a34);
}

func void Q515_SHOOTMARVIN_WAIT() {
    AI_WAITTILLEND(DJG_10040_WOLFSON_Q515, HERO);
    AI_WAITTILLEND(DJG_10040_WOLFSON_Q515, KDW_203_RIORDIAN);
    AI_WAITTILLEND(KDW_203_RIORDIAN, HERO);
    AI_WAITTILLEND(KDW_203_RIORDIAN, DJG_10040_WOLFSON_Q515);
    AI_WAITTILLEND(HERO, DJG_10040_WOLFSON_Q515);
    AI_WAITTILLEND(HERO, KDW_203_RIORDIAN);
}

func void Q515_SHOOTMARVIN_START() {
    WLD_SENDTRIGGER("KM_ULRYK_KILL");
    WLD_SENDUNTRIGGER("KM_ULRYK_09");
    TELEPORTNPCTOWP(0x71b, "PART5_VOLFZACKE_RIORDIAN_HERO");
    TELEPORTNPCTOWP(0xdd28, "PART5_VOLFZACKE_RIORDIAN_ULRYK");
    TELEPORTNPCTOWP(0xdad7, "PART5_VOLFZACKE_Q515_CROSSBOW");
    NPC_CLEARAIQUEUE(DJG_10040_WOLFSON_Q515);
    AI_TURNTONPC(DJG_10040_WOLFSON_Q515, HERO);
    AI_READYRANGEDWEAPON(DJG_10040_WOLFSON_Q515);
    AI_AIMAT(DJG_10040_WOLFSON_Q515, HERO);
    AI_WAIT(DJG_10040_WOLFSON_Q515, 0x3e99999a);
    AI_TURNTONPC(HERO, DJG_10040_WOLFSON_Q515);
    Q515_SHOOTMARVIN_WAIT();
    AI_WAIT(KDW_203_RIORDIAN, 0x3dcccccd);
    AI_FUNCTION(KDW_203_RIORDIAN, 0x16a35);
    AI_PLAYANI(KDW_203_RIORDIAN, T_JUMPB);
    AI_PLAYANI(DJG_10040_WOLFSON_Q515, "T_CBOWAIM_2_CBOWSHOOT");
    AI_WAIT(DJG_10040_WOLFSON_Q515, 0x3f800000);
    AI_FUNCTION(DJG_10040_WOLFSON_Q515, 0x16a36);
}

func void Q515_SHOOTMARVIN_SHOOT() {
    HERO.FLAGS = 0;
    SND_PLAY("FIG_SwordFinal");
    SND_PLAY("SVM_15_DEAD");
    SND_PLAY("CrossbowShoot");
    HERO.ATTRIBUTE[1] = -(1);
    HERO.ATTRIBUTE[0] = -(1);
}

func void Q515_SHOOTMARVIN_END() {
    WLD_SENDUNTRIGGER("KM_ULRYK_KILL");
    KDW_203_RIORDIAN.FLAGS = 0;
    Q515_MAKEWOLFSONBANDITS();
}

