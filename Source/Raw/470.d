func void Q312_MARVIN_TELEPORTBLOCKED() {
    if ((LOG_GETSTATUS(MIS_Q312)) == (LOG_RUNNING)) {
        AI_OUTPUT(HERO, HERO, "DIA_Marvin_CantLeave_15_02");
        if ((Q312_FASTTRAVEL_MAGIC_LOGENTRY) == (FALSE)) {
            Q312_FASTTRAVEL_MAGIC_LOGENTRY = TRUE;
            AI_LOGENTRY(TOPIC_Q312, LOG_Q312_FASTTRAVEL_MAGIC);
        };
    };
}

var int Q312_MARVIN_TELEPORTBLOCKED.Q312_FASTTRAVEL_MAGIC_LOGENTRY = 0;
func void Q312_CLOSESEWERS() {
    FF_APPLYONCEEXTGT(0xa93f, 0, -(1));
    B_REMOVENPC(0xc3ea);
    WLD_INSERTNPC(0xd988, "PART2_SEWERS_REPAIR");
    WLD_INSERTNPC(0xd98b, "PART2_SEWERS_WATCH");
}

func void Q312_CLOSESEWERS_APPLY() {
    if ((Q312_CLOSESEWERS_COUNT) == (0)) {
        PRINTD("Rozpoczynam - Q312_CloseSewers_Apply");
        MOVPTR1 = MEM_SEARCHVOBBYNAME("Q201_MOVER_CORPSE");
        MOVER1 = MEM_PTRTOINST(MOVPTR1);
        CHANGEVOBCOLLISION("Q201_CORPSE", FALSE, FALSE, FALSE, TRUE);
        WLD_SENDTRIGGER("Q201_SEWERSDOOR");
        WLD_SENDTRIGGER("Q201_MOVER_CORPSE");
        WLD_SENDTRIGGER("Q312_REPAIRSEWERS");
        Q312_CLOSESEWERS_COUNT = 1;
    };
    if (((MOVER1.MOVERSTATE) != (MOVER_STATE_OPENING)) && ((MOVER1.MOVERSTATE) != (MOVER_STATE_CLOSING))) {
        PRINTD("Skoñczy³em - Q312_CloseSewers_Apply");
        CHANGEVOBCOLLISION("Q201_CORPSE", TRUE, TRUE, TRUE, TRUE);
        FF_REMOVE(0xa93f);
        Q312_CLOSESEWERS_COUNT = 0;
    };
}

var int Q312_CLOSESEWERS_APPLY.Q312_CLOSESEWERS_COUNT = 0;
instance Q312_CLOSESEWERS_APPLY.MOVER1(ZCMOVER)
var int Q312_CLOSESEWERS_APPLY.MOVPTR1 = 0;
func void Q312_OPENSEWERS() {
    WLD_SENDTRIGGER("Q201_SEWERSDOOR");
    WLD_SENDTRIGGER("Q312_REPAIRSEWERS");
    B_REMOVENPC(0xd988);
    B_REMOVENPC(0xd98b);
    WLD_INSERTNPC(0xc46f, "PART2_SEWERS_01");
}

