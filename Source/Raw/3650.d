instance DIA_MEDIKAMENTEN_EXIT(C_INFO) {
    NPC = 0xcf35;
    NR = 999;
    CONDITION = DIA_MEDIKAMENTEN_EXIT_CONDITION;
    INFORMATION = DIA_MEDIKAMENTEN_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_MEDIKAMENTEN_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_MEDIKAMENTEN_EXIT_INFO() {
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_MEDIKAMENTEN_HEALME(C_INFO) {
    NPC = 0xcf35;
    NR = 90;
    CONDITION = DIA_MEDIKAMENTEN_HEALME_CONDITION;
    INFORMATION = DIA_MEDIKAMENTEN_HEALME_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "Can you heal me?";
}

func int DIA_MEDIKAMENTEN_HEALME_CONDITION() {
    return TRUE;
}

func void DIA_MEDIKAMENTEN_HEALME_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Medikamenten_HealMe_15_01");
    if (((HERO.GUILD) == (GIL_MIL)) || ((HERO.GUILD) == (GIL_VLK))) {
        if ((HERO.ATTRIBUTE[0]) < (HERO.ATTRIBUTE[1])) {
            AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_HealMe_03_02");
            AI_WAITTILLEND(OTHER, SELF);
            CREATEINVITEMS(OTHER, 0x838e, 1);
            HERO.ATTRIBUTE[0] = HERO.ATTRIBUTE[1];
            AI_PRINTSCREEN(PRINT_FULLYHEALED, -(1), -(1), FONT_SCREEN, 2);
            AI_USEITEM(OTHER, 0x838e);
        } else {
            AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_HealMe_03_03");
        } else {
            /* set_instance(0) */;
        };
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_HealMe_03_04");
}

instance DIA_MEDIKAMENTEN_QM203_NEEDHELP(C_INFO) {
    NPC = 0xcf35;
    NR = 1;
    CONDITION = DIA_MEDIKAMENTEN_QM203_NEEDHELP_CONDITION;
    INFORMATION = DIA_MEDIKAMENTEN_QM203_NEEDHELP_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Is there anything I can help with?";
}

func int DIA_MEDIKAMENTEN_QM203_NEEDHELP_CONDITION() {
    if ((HERO.GUILD) == (GIL_MIL)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_MEDIKAMENTEN_QM203_NEEDHELP_INFO() {
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Medikamenten_QM203_NeedHelp_15_01");
    AI_RESETFACEANI(OTHER);
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_NeedHelp_03_02");
    INFO_CLEARCHOICES(0x10147);
    INFO_ADDCHOICE(0x10147, "Get to the point.", 0x1014b);
    INFO_ADDCHOICE(0x10147, "Unbelievable. You have to do something unpleasant in this city?", 0x1014a);
}

func void DIA_MEDIKAMENTEN_QM203_NEEDHELP_WOW() {
    AI_STARTFACEANI(OTHER, S_SMUG, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Medikamenten_QM203_NeedHelp_Wow_15_01");
    AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_NeedHelp_Wow_03_02");
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
}

func void DIA_MEDIKAMENTEN_QM203_NEEDHELP_TELL() {
    AI_OUTPUT(OTHER, SELF, "DIA_Medikamenten_QM203_NeedHelp_Tell_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_NeedHelp_Tell_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_NeedHelp_Tell_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_NeedHelp_Tell_03_04");
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Medikamenten_QM203_NeedHelp_Tell_15_05");
    AI_RESETFACEANI(OTHER);
    AI_STARTFACEANI(SELF, S_TIRED, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_NeedHelp_Tell_03_06");
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_NeedHelp_Tell_03_07");
    AI_RESETFACEANI(SELF);
}

instance DIA_MEDIKAMENTEN_QM203_HOW(C_INFO) {
    NPC = 0xcf35;
    NR = 1;
    CONDITION = DIA_MEDIKAMENTEN_QM203_HOW_CONDITION;
    INFORMATION = DIA_MEDIKAMENTEN_QM203_HOW_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Where does this disease come from?";
}

func int DIA_MEDIKAMENTEN_QM203_HOW_CONDITION() {
    if (((HERO.GUILD) == (GIL_MIL)) && (NPC_KNOWSINFO(OTHER, 0x10147))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

var int MEDIKAMENTEN_QM203_HOW_WHAT = 0;
var int MEDIKAMENTEN_QM203_HOW_NOONE = 0;
var int MEDIKAMENTEN_QM203_HOW_WHY = 0;
func void DIA_MEDIKAMENTEN_QM203_HOW_CHOICES() {
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
    INFO_CLEARCHOICES(0x1014c);
    if (((MEDIKAMENTEN_QM203_HOW_WHAT) == (TRUE)) && ((MEDIKAMENTEN_QM203_HOW_NOONE) == (TRUE))) {
        INFO_ADDCHOICE(0x1014c, "That's all I wanted to know.", 0x10156);
    };
    if ((MEDIKAMENTEN_QM203_HOW_WHY) == (FALSE)) {
        INFO_ADDCHOICE(0x1014c, "Why aren't the people in the district getting sick?", 0x10155);
    };
    if ((MEDIKAMENTEN_QM203_HOW_NOONE) == (FALSE)) {
        INFO_ADDCHOICE(0x1014c, "No one has tried to combat the problem before?", 0x10154);
    };
    if ((MEDIKAMENTEN_QM203_HOW_WHAT) == (FALSE)) {
        INFO_ADDCHOICE(0x1014c, "How do I get rid of them?", 0x10153);
    };
}

func void DIA_MEDIKAMENTEN_QM203_HOW_INFO() {
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Medikamenten_QM203_How_15_01");
    AI_RESETFACEANI(OTHER);
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_How_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_How_03_03");
    DIA_MEDIKAMENTEN_QM203_HOW_CHOICES();
}

func void DIA_MEDIKAMENTEN_QM203_HOW_WHAT() {
    MEDIKAMENTEN_QM203_HOW_WHAT = TRUE;
    AI_OUTPUT(OTHER, SELF, "DIA_Medikamenten_QM203_How_What_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_How_What_03_02");
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Medikamenten_QM203_How_What_15_03");
    AI_STARTFACEANI(SELF, S_NOPE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_How_What_03_04");
    AI_OUTPUT(OTHER, SELF, "DIA_Medikamenten_QM203_How_What_15_06");
    AI_RESETFACEANI(SELF);
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_How_What_03_07");
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_How_What_03_08");
    CREATEINVITEMS(SELF, 0x859b, QM203_MONEYFORPOISON);
    B_GIVEINVITEMS(SELF, OTHER, 0x859b, QM203_MONEYFORPOISON);
    CREATEINVITEMS(SELF, 0x90f4, 1);
    B_GIVEINVITEMS(SELF, OTHER, 0x90f4, 1);
    CREATEINVITEMS(SELF, 0x90f7, 1);
    B_GIVEINVITEMS(SELF, OTHER, 0x90f7, 1);
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_How_What_03_09");
    DIA_MEDIKAMENTEN_QM203_HOW_CHOICES();
}

func void DIA_MEDIKAMENTEN_QM203_HOW_NOONE() {
    MEDIKAMENTEN_QM203_HOW_NOONE = TRUE;
    AI_OUTPUT(OTHER, SELF, "DIA_Medikamenten_QM203_How_NoOne_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_How_NoOne_03_02");
    AI_STARTFACEANI(SELF, S_DOUBT, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_How_NoOne_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_How_NoOne_03_04");
    DIA_MEDIKAMENTEN_QM203_HOW_CHOICES();
}

func void DIA_MEDIKAMENTEN_QM203_HOW_WHY() {
    MEDIKAMENTEN_QM203_HOW_WHY = TRUE;
    AI_OUTPUT(OTHER, SELF, "DIA_Medikamenten_QM203_How_Why_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_How_Why_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_How_Why_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_How_Why_03_04");
    DIA_MEDIKAMENTEN_QM203_HOW_CHOICES();
}

func void DIA_MEDIKAMENTEN_QM203_HOW_THANKS() {
    AI_OUTPUT(OTHER, SELF, "DIA_Medikamenten_QM203_How_Thanks_15_01");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_How_Thanks_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_How_Thanks_03_03");
    AI_RESETFACEANI(SELF);
    QM203_PREPAREMOVERS = 1;
    LOG_CREATETOPIC(TOPIC_QM203, LOG_MISSION);
    LOG_SETSTATUS(_@(MIS_QM203), TOPIC_QM203, LOG_RUNNING);
    if ((LOG_GETSTATUS(MIS_SQ228)) != (LOG_SUCCESS)) {
        AI_LOGENTRY(TOPIC_QM203, LOG_QM203_START);
    };
    if ((LOG_GETSTATUS(MIS_SQ228)) == (LOG_SUCCESS)) {
        AI_LOGENTRY(TOPIC_QM203, LOG_QM203_START_SQ228);
    };
    INFO_CLEARCHOICES(0x1014c);
}

instance DIA_MEDIKAMENTEN_QM203_FINISH(C_INFO) {
    NPC = 0xcf35;
    NR = 1;
    CONDITION = DIA_MEDIKAMENTEN_QM203_FINISH_CONDITION;
    INFORMATION = DIA_MEDIKAMENTEN_QM203_FINISH_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "I got rid of the rats.";
}

func int DIA_MEDIKAMENTEN_QM203_FINISH_CONDITION() {
    if (((LOG_GETSTATUS(MIS_QM203)) == (LOG_RUNNING)) && ((QM203_RATNESTDESTROYEDCOUNT) == (5))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

var int MEDIKAMENTEN_QM203_FINISH_BALUENSTORY = 0;
func void DIA_MEDIKAMENTEN_QM203_FINISH_GIVEREWARD() {
    QM203_REMOVERATNESTS = 1;
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
    if ((MEDIKAMENTEN_QM203_FINISH_BALUENSTORY) == (1)) {
        AI_LOGENTRY(TOPIC_QM203, LOG_QM203_FINISH_V1);
    };
    if ((MEDIKAMENTEN_QM203_FINISH_BALUENSTORY) == (2)) {
        AI_LOGENTRY(TOPIC_QM203, LOG_QM203_FINISH_V2);
    };
    if ((MEDIKAMENTEN_QM203_FINISH_BALUENSTORY) == (3)) {
        AI_LOGENTRY(TOPIC_QM203, LOG_QM203_FINISH_V3);
    };
    QM203_TELLOKTAV = 2;
    AI_LOGENTRY(TOPIC_QM203, LOG_QM203_FINISH_V4);
    INFO_CLEARCHOICES(0x10157);
    LOG_SETSTATUS(_@(MIS_QM203), TOPIC_QM203, LOG_SUCCESS);
    B_GIVEPLAYERXP(XP_QM203_FINISH);
}

func void DIA_MEDIKAMENTEN_QM203_FINISH_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Medikamenten_QM203_Finish_15_01");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_Finish_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Medikamenten_QM203_Finish_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_Finish_03_04");
    CREATEINVITEMS(SELF, 0x8632, 2);
    B_GIVEINVITEMS(SELF, OTHER, 0x8632, 2);
    CREATEINVITEMS(SELF, 0x864b, 1);
    B_GIVEINVITEMS(SELF, OTHER, 0x864b, 1);
    CREATEINVITEMS(SELF, 0x936a, 1);
    B_GIVEINVITEMS(SELF, OTHER, 0x936a, 1);
    INFO_CLEARCHOICES(0x10157);
    if ((QM203_BALUENISDEAD) >= (1)) {
        INFO_ADDCHOICE(0x10157, "I met Baluen.", 0x10161);
    };
    if ((QM203_KNOWBALUENWORKSHOPLOCATION) == (TRUE)) {
        INFO_ADDCHOICE(0x10157, "I know where Baluen is hiding. (Give him up)", 0x10162);
        INFO_ADDCHOICE(0x10157, DIALOG_DONOTTALK, 0x1015c);
    };
    INFO_ADDCHOICE(0x10157, "I met Baluen.", 0x10160);
}

func void DIA_MEDIKAMENTEN_QM203_FINISH_DONT() {
    MEDIKAMENTEN_QM203_FINISH_BALUENSTORY = 3;
    DIA_MEDIKAMENTEN_QM203_FINISH_GIVEREWARD();
}

func void DIA_MEDIKAMENTEN_QM203_FINISH_TELLOKTAV() {
    QM203_TELLOKTAV = TRUE;
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_Finish_Tell_03_03");
}

func void DIA_MEDIKAMENTEN_QM203_FINISH_TELLHISTORY() {
    AI_STARTFACEANI(SELF, S_THINK, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_Finish_BaluenDead_03_07");
    AI_OUTPUT(OTHER, SELF, "DIA_Medikamenten_QM203_Finish_BaluenDead_15_08");
    AI_RESETFACEANI(SELF);
}

func void DIA_MEDIKAMENTEN_QM203_FINISH_IMEETBALUEN() {
    AI_OUTPUT(OTHER, SELF, "DIA_Medikamenten_QM203_Finish_BaluenDead_15_01");
}

func void DIA_MEDIKAMENTEN_QM203_FINISH_BALUENLOST() {
    MEDIKAMENTEN_QM203_FINISH_BALUENSTORY = 4;
    DIA_MEDIKAMENTEN_QM203_FINISH_IMEETBALUEN();
    DIA_MEDIKAMENTEN_QM203_FINISH_TELLHISTORY();
    AI_OUTPUT(OTHER, SELF, "DIA_Medikamenten_QM203_Finish_BaluenDead_15_10");
    AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_Finish_BaluenDead_03_11");
    DIA_MEDIKAMENTEN_QM203_FINISH_GIVEREWARD();
}

func void DIA_MEDIKAMENTEN_QM203_FINISH_BALUENDEAD() {
    DIA_MEDIKAMENTEN_QM203_FINISH_IMEETBALUEN();
    DIA_MEDIKAMENTEN_QM203_FINISH_TELLHISTORY();
    AI_OUTPUT(OTHER, SELF, "DIA_Medikamenten_QM203_Finish_BaluenDead_15_09");
    if ((QM203_BALUENISDEAD) == (2)) {
        MEDIKAMENTEN_QM203_FINISH_BALUENSTORY = 1;
        AI_OUTPUT(OTHER, SELF, "DIA_Medikamenten_QM203_Finish_BaluenDead_15_02");
        AI_STARTFACEANI(SELF, S_SURPRISE, 1, -(1));
        AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_Finish_BaluenDead_03_03");
        AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_Finish_BaluenDead_03_04");
        AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
        AI_OUTPUT(SELF, OTHER, "DIA_Medikamenten_QM203_Finish_BaluenDead_03_05");
        DIA_MEDIKAMENTEN_QM203_FINISH_TELLOKTAV();
        CREATEINVITEMS(SELF, 0x8795, 1);
        B_GIVEINVITEMS(SELF, OTHER, 0x8795, 1);
        DIA_MEDIKAMENTEN_QM203_FINISH_GIVEREWARD();
    };
    MEDIKAMENTEN_QM203_FINISH_BALUENSTORY = 2;
    AI_STARTFACEANI(OTHER, S_SERIOUS, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Medikamenten_QM203_Finish_BaluenDead_15_06");
    DIA_MEDIKAMENTEN_QM203_FINISH_TELLOKTAV();
    DIA_MEDIKAMENTEN_QM203_FINISH_GIVEREWARD();
    INFO_CLEARCHOICES(0x10157);
}

func void DIA_MEDIKAMENTEN_QM203_FINISH_TELL() {
    MEDIKAMENTEN_QM203_FINISH_BALUENSTORY = 2;
    AI_OUTPUT(OTHER, SELF, "DIA_Medikamenten_QM203_Finish_Tell_15_01");
    DIA_MEDIKAMENTEN_QM203_FINISH_TELLHISTORY();
    AI_OUTPUT(OTHER, SELF, "DIA_Medikamenten_QM203_Finish_Tell_15_02");
    DIA_MEDIKAMENTEN_QM203_FINISH_TELLOKTAV();
    DIA_MEDIKAMENTEN_QM203_FINISH_GIVEREWARD();
    INFO_CLEARCHOICES(0x10157);
}

instance DIA_MEDIKAMENTEN_PICKPOCKET(C_INFO) {
    NPC = 0xcf35;
    NR = 900;
    CONDITION = DIA_MEDIKAMENTEN_PICKPOCKET_CONDITION;
    INFORMATION = DIA_MEDIKAMENTEN_PICKPOCKET_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = PICKPOCKET_40;
}

func int DIA_MEDIKAMENTEN_PICKPOCKET_CONDITION() {
    if (((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_PICKPOCKET)) >= (1)) && ((SELF.AIVAR[6]) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_MEDIKAMENTEN_PICKPOCKET_INFO() {
    INFO_CLEARCHOICES(0x10163);
    INFO_ADDCHOICE(0x10163, DIALOG_BACK, 0x10167);
    INFO_ADDCHOICE(0x10163, DIALOG_PICKPOCKET, 0x10166);
}

func void DIA_MEDIKAMENTEN_PICKPOCKET_DOIT() {
    if ((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_PICKPOCKET)) >= (1)) {
        CREATEINVITEMS(SELF, 0x8781, 1);
        B_GIVEINVITEMS(SELF, OTHER, 0x8781, 1);
        B_PICKPOCKET_AMBIENT_TIER_1();
        SELF.AIVAR[6] = TRUE;
        INFO_CLEARCHOICES(0x10163);
    };
    AI_PLAYANI(HERO, T_CANNOTTAKE);
    PRINTSCREEN(PRINT_CANTPICKPOCKETTHISPERSON, -(1), -(1), FONT_SCREEN, 4);
    INFO_CLEARCHOICES(0x10163);
}

func void DIA_MEDIKAMENTEN_PICKPOCKET_BACK() {
    INFO_CLEARCHOICES(0x10163);
}

