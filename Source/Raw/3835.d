var int DA_BEGGARSSTART_DAY1 = 0;
instance DIA_BEGGAR_11277_EXIT(C_INFO) {
    NPC = 0xcabb;
    NR = 999;
    CONDITION = DIA_BEGGAR_11277_EXIT_CONDITION;
    INFORMATION = DIA_BEGGAR_11277_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "I can't help you.";
}

func int DIA_BEGGAR_11277_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_BEGGAR_11277_EXIT_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Beggar_11277_EXIT_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Beggar_11277_EXIT_03_02");
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_BEGGAR_11277_DA_BEGGARSSTART(C_INFO) {
    NPC = 0xcabb;
    NR = 1;
    CONDITION = DIA_BEGGAR_11277_DA_BEGGARSSTART_CONDITION;
    INFORMATION = DIA_BEGGAR_11277_DA_BEGGARSSTART_INFO;
    PERMANENT = TRUE;
    IMPORTANT = TRUE;
}

func int DIA_BEGGAR_11277_DA_BEGGARSSTART_CONDITION() {
    if (((DA_BEGGARSSTART_DAY1) != (WLD_GETDAY())) && ((DA_BEGGARSSTART_DAY2FLAG) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_BEGGAR_11277_DA_BEGGARSSTART_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Beggar_11277_DA_BeggarsStart_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Beggar_11277_DA_BeggarsStart_03_02");
    DA_BEGGARSSTART_DAY1 = WLD_GETDAY();
}

instance DIA_BEGGAR_11277_10GOLD(C_INFO) {
    NPC = 0xcabb;
    NR = 2;
    CONDITION = DIA_BEGGAR_11277_10GOLD_CONDITION;
    INFORMATION = DIA_BEGGAR_11277_10GOLD_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Here's the gold.";
}

func int DIA_BEGGAR_11277_10GOLD_CONDITION() {
    if ((NPC_HASITEMS(OTHER, 0x859b)) >= (EVENT_BEGGARARMY)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_BEGGAR_11277_10GOLD_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Beggar_11277_10Gold_15_01");
    B_GIVEINVITEMS(OTHER, SELF, 0x859b, EVENT_BEGGARARMY);
    B_GIVEPLAYERXP(XP_EVENT_DA1);
    AI_OUTPUT(SELF, OTHER, "DIA_Beggar_11277_10Gold_03_02");
    DA_BEGGARSSTART_DAY2FLAG = TRUE;
    DA_BEGGARSSTART_DAY2 = WLD_GETDAY();
    NPC_EXCHANGEROUTINE(SELF, TOT);
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_BEGGAR_11277_AFTER10GOLD(C_INFO) {
    NPC = 0xcabb;
    NR = 1;
    CONDITION = DIA_BEGGAR_11277_AFTER10GOLD_CONDITION;
    INFORMATION = DIA_BEGGAR_11277_AFTER10GOLD_INFO;
    PERMANENT = TRUE;
    IMPORTANT = TRUE;
}

func int DIA_BEGGAR_11277_AFTER10GOLD_CONDITION() {
    if ((NPC_ISINSTATE(SELF, 0xf09f)) && (NPC_KNOWSINFO(OTHER, 0x11a86))) {
        if ((TRAP_DA2_SPAWNED) == (FALSE)) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_BEGGAR_11277_AFTER10GOLD_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Beggar_11277_After10Gold_03_01");
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_BEGGAR_11277_TRAP_DA2(C_INFO) {
    NPC = 0xcabb;
    NR = 1;
    CONDITION = DIA_BEGGAR_11277_TRAP_DA2_CONDITION;
    INFORMATION = DIA_BEGGAR_11277_TRAP_DA2_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_BEGGAR_11277_TRAP_DA2_CONDITION() {
    if ((TRAP_DA2_SPAWNED) == (TRUE)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_BEGGAR_11277_TRAP_DA2_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Beggar_11277_Trap_DA2_03_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Beggar_11277_Trap_DA2_15_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Beggar_11277_Trap_DA2_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Beggar_11277_Trap_DA2_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Beggar_11277_Trap_DA2_03_05");
    INFO_CLEARCHOICES(0x11a8c);
    INFO_ADDCHOICE(0x11a8c, "(Do nothing)", 0x11a8f);
    if ((NPC_HASITEMS(OTHER, 0x859b)) >= (EVENT_BEGGARARMY)) {
        INFO_ADDCHOICE(0x11a8c, DIALOG_GIVE10G, 0x11a90);
    };
}

func void DIA_BEGGAR_11277_TRAP_DONTGIVE() {
    AI_OUTPUT(OTHER, SELF, "DIA_Beggar_11277_Trap_DontGive_15_01");
    AI_WAITTILLEND(SELF, OTHER);
    AI_STOPPROCESSINFOS(SELF);
}

func void DIA_BEGGAR_11277_TRAP_GIVEMONEY() {
    AI_OUTPUT(OTHER, SELF, "DIA_Beggar_11277_Trap_GiveMoney_15_01");
    B_GIVEINVITEMS(OTHER, SELF, 0x859b, EVENT_BEGGARARMY);
    TRAP_DA2_COUNTER = (TRAP_DA2_COUNTER) + (1);
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_BEGGAR_11277_DA2_AFTER(C_INFO) {
    NPC = 0xcabb;
    NR = 2;
    CONDITION = DIA_BEGGAR_11277_DA2_AFTER_CONDITION;
    INFORMATION = DIA_BEGGAR_11277_DA2_AFTER_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_BEGGAR_11277_DA2_AFTER_CONDITION() {
    if ((NPC_KNOWSINFO(OTHER, 0x11a9c)) && (NPC_KNOWSINFO(OTHER, 0x11aa6))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_BEGGAR_11277_DA2_AFTER_INFO() {
    if ((TRAP_DA2_COUNTER) == (3)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Beggar_11277_DA2_After_03_01");
        AI_OUTPUT(SELF, OTHER, "DIA_Beggar_11277_DA2_After_03_02");
    };
    if ((TRAP_DA2_COUNTER) == (0)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Beggar_11277_DA2_After_03_03");
        AI_OUTPUT(SELF, OTHER, "DIA_Beggar_11277_DA2_After_03_04");
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Beggar_11277_DA2_After_03_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Beggar_11277_DA2_After_03_06");
    B_GIVEPLAYERXP(XP_EVENT_DA2);
    NPC_EXCHANGEROUTINE(VLK_11277_BEGGAR, FLEE);
    NPC_EXCHANGEROUTINE(VLK_11278_BEGGAR, FLEE);
    NPC_REFRESH(VLK_11278_BEGGAR);
    NPC_EXCHANGEROUTINE(VLK_11279_BEGGAR, FLEE);
    NPC_REFRESH(VLK_11279_BEGGAR);
    DA_BEGGARSSTART_DAY3 = WLD_GETDAY();
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_BEGGAR_11277_TRAP_DA3(C_INFO) {
    NPC = 0xcabb;
    NR = 1;
    CONDITION = DIA_BEGGAR_11277_TRAP_DA3_CONDITION;
    INFORMATION = DIA_BEGGAR_11277_TRAP_DA3_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_BEGGAR_11277_TRAP_DA3_CONDITION() {
    if ((TRAP_DA3_SPAWNED) == (TRUE)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_BEGGAR_11277_TRAP_DA3_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Beggar_11277_Trap_DA3_03_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Beggar_11277_Trap_DA3_15_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Beggar_11277_Trap_DA3_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Beggar_11277_Trap_DA3_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Beggar_11277_Trap_DA3_03_05");
    INFO_CLEARCHOICES(0x11a94);
    INFO_ADDCHOICE(0x11a94, "(Do nothing)", 0x11a97);
    if ((NPC_HASITEMS(OTHER, 0x859b)) >= (EVENT_BEGGARARMY)) {
        INFO_ADDCHOICE(0x11a94, DIALOG_GIVE10G, 0x11a98);
    };
}

func void DIA_BEGGAR_11277_TRAP_DONTGIVE2() {
    AI_OUTPUT(OTHER, SELF, "DIA_Thug_10034_After_SQ218_YouGetNothing_15_01");
    AI_WAITTILLEND(SELF, OTHER);
    AI_STOPPROCESSINFOS(SELF);
    AI_FUNCTION(HERO, 0x171c4);
}

func void DIA_BEGGAR_11277_TRAP_GIVEMONEY2() {
    M1_DA3_BEGGAR_GIVEMONEY();
    B_GIVEINVITEMS(OTHER, SELF, 0x859b, EVENT_BEGGARARMY);
    TRAP_DA3_COUNTER = (TRAP_DA3_COUNTER) + (1);
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_BEGGAR_11277_DA3_AFTER(C_INFO) {
    NPC = 0xcabb;
    NR = 2;
    CONDITION = DIA_BEGGAR_11277_DA3_AFTER_CONDITION;
    INFORMATION = DIA_BEGGAR_11277_DA3_AFTER_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_BEGGAR_11277_DA3_AFTER_CONDITION() {
    if ((TRAP_DA3_COUNTER) == (6)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_BEGGAR_11277_DA3_AFTER_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Beggar_11277_DA3_After_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Beggar_11277_DA3_After_03_02");
    B_GIVEPLAYERXP(XP_EVENT_DA3);
    NPC_EXCHANGEROUTINE(VLK_11277_BEGGAR, FLEE);
    NPC_EXCHANGEROUTINE(VLK_11278_BEGGAR, FLEE);
    NPC_REFRESH(VLK_11278_BEGGAR);
    NPC_EXCHANGEROUTINE(VLK_11279_BEGGAR, FLEE);
    NPC_REFRESH(VLK_11279_BEGGAR);
    NPC_EXCHANGEROUTINE(VLK_11280_BEGGAR, FLEE);
    NPC_REFRESH(VLK_11280_BEGGAR);
    NPC_EXCHANGEROUTINE(VLK_11281_BEGGAR, FLEE);
    NPC_REFRESH(VLK_11281_BEGGAR);
    NPC_EXCHANGEROUTINE(VLK_11282_BEGGAR, FLEE);
    NPC_REFRESH(VLK_11282_BEGGAR);
    AI_STOPPROCESSINFOS(SELF);
}

