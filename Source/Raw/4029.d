instance DIA_RENEGADE2_EXIT(C_INFO) {
    NPC = 0xdba9;
    NR = 999;
    CONDITION = DIA_RENEGADE2_EXIT_CONDITION;
    INFORMATION = DIA_RENEGADE2_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_RENEGADE2_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_RENEGADE2_EXIT_INFO() {
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_RENEGADE2_BLOCK(C_INFO) {
    NPC = 0xdba9;
    NR = 1;
    CONDITION = DIA_RENEGADE2_BLOCK_CONDITION;
    INFORMATION = DIA_RENEGADE2_BLOCK_INFO;
    PERMANENT = TRUE;
    IMPORTANT = TRUE;
}

func int DIA_RENEGADE2_BLOCK_CONDITION() {
    if ((SELF.AIVAR[93]) <= (WLD_GETDAY())) {
        if (((NPC_GETDISTTOWP(MIL_6270_JERRAN, "PART7_RENEGADE_01")) <= (500)) && ((NPC_GETDISTTOWP(MIL_6271_RENEGADE, "PART7_RENEGADE_02")) <= (500))) {
            if ((QM302_RENEGADESEVENT) == (0)) {
                return TRUE;
            };
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_RENEGADE2_BLOCK_INFO() {
    if ((LOG_GETSTATUS(MIS_Q205)) == (LOG_RUNNING)) {
        Q205_MEETPART4RENEGADES = TRUE;
    };
    TRIA_INVITE(MIL_6270_JERRAN);
    TRIA_START();
    AI_LOOKATNPC(HERO, SELF);
    AI_TURNTONPC(SELF, HERO);
    AI_TURNTONPC(MIL_6270_JERRAN, HERO);
    AI_OUTPUT(SELF, OTHER, "DIA_Renegade2_Block_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Renegade2_Block_03_03");
    AI_OUTPUT(OTHER, SELF, "DIA_Renegade2_Block_15_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Renegade2_Block_03_05");
    INFO_CLEARCHOICES(0x13309);
    INFO_ADDCHOICE(0x13309, "I thought tolls were paid for transporting goods.", 0x13310);
    INFO_ADDCHOICE(0x13309, "You're not getting anything from me.", 0x1330f);
    INFO_ADDCHOICE(0x13309, "How much do you want?", 0x1330d);
    HEROARMOR = NPC_GETEQUIPPEDARMOR(HERO);
    if (HLP_ISITEM(HEROARMOR, 0x8ab5)) {
        INFO_ADDCHOICE(0x13309, "I'm one of Salvi's men, are you crazy?", 0x13317);
    };
    if ((HERO.GUILD) == (GIL_MIL)) {
        INFO_ADDCHOICE(0x13309, "I'm a city guard, damn it!", 0x13311);
    };
}

instance DIA_RENEGADE2_BLOCK_INFO.HEROARMOR(C_ITEM)
func void DIA_RENEGADE2_BLOCK_GOLD() {
    AI_OUTPUT(OTHER, SELF, "DIA_Renegade2_Block_Gold_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Renegade2_Block_Gold_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Renegade2_Block_Gold_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Renegade2_Block_Gold_03_04");
    INFO_ADDCHOICE(0x13309, "I'm sorry, but I don't have that much on me.", 0x13314);
    if ((NPC_HASITEMS(OTHER, 0x859b)) >= (RENEGADE_PASSAGE)) {
        INFO_ADDCHOICE(0x13309, "Here's the money.", 0x13312);
    };
}

func void DIA_RENEGADE2_BLOCK_GOLD_FIGHTME() {
    AI_OUTPUT(OTHER, SELF, "DIA_Renegade2_Block_FightMe_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Renegade2_Block_FightMe_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Renegade2_Block_FightMe_15_03");
    AI_OUTPUT(OTHER, SELF, "DIA_Renegade2_Block_FightMe_15_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Renegade2_Block_FightMe_03_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Renegade2_Block_FightMe_03_06");
    TRIA_FINISH();
    INFO_CLEARCHOICES(0x13309);
    AI_STOPPROCESSINFOS(SELF);
    AI_FUNCTION(HERO, 0x13316);
}

func void DIA_RENEGADE2_BLOCK_NOWAY() {
    DIA_RENEGADE2_BLOCK_GOLD_FIGHTME();
}

func void DIA_RENEGADE2_BLOCK_NEEDS() {
    AI_OUTPUT(OTHER, SELF, "DIA_Renegade2_Block_Needs_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Renegade2_Block_Needs_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Renegade2_Block_Needs_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Renegade2_Block_Needs_03_04");
}

func void DIA_RENEGADE2_BLOCK_MILITIA() {
    AI_OUTPUT(OTHER, SELF, "DIA_Renegade2_Block_Militia_15_01");
    if (NPC_HASGUILDARMOREQUIPPED(OTHER, GIL_MIL)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Renegade2_Block_Militia_03_02");
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Renegade2_Block_Militia_03_03");
    AI_OUTPUT(OTHER, SELF, "DIA_Renegade2_Block_Militia_15_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Renegade2_Block_Militia_03_05");
    INFO_CLEARCHOICES(0x13309);
    INFO_ADDCHOICE(0x13309, "In that case, show the papers.", 0x13315);
}

func void DIA_RENEGADE2_BLOCK_GOLD_100GOLD() {
    AI_OUTPUT(OTHER, SELF, "DIA_Renegade2_Block_100Gold_15_01");
    MARVINCURRENTGOLD = NPC_HASITEMS(OTHER, 0x859b);
    if ((NPC_HASITEMS(OTHER, 0x859b)) >= (RENEGADE_PASSAGE)) {
    };
    B_GIVEINVITEMS(OTHER, SELF, 0x859b, MARVINCURRENTGOLD);
    AI_OUTPUT(SELF, OTHER, "DIA_Renegade2_Block_100Gold_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Renegade2_Block_100Gold_03_03");
    TRIA_FINISH();
    INFO_CLEARCHOICES(0x13309);
    SELF.AIVAR[93] = (WLD_GETDAY()) + (1);
    AI_STOPPROCESSINFOS(SELF);
}

var int DIA_RENEGADE2_BLOCK_GOLD_100GOLD.MARVINCURRENTGOLD = 0;
func void DIA_RENEGADE2_BLOCK_GOLD_NOGOLD() {
    AI_OUTPUT(OTHER, SELF, "DIA_Renegade2_Block_NoGold_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Renegade2_Block_NoGold_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Renegade2_Block_NoGold_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Renegade2_Block_NoGold_03_04");
}

func void DIA_RENEGADE2_BLOCK_MILITIA_PAPERSPLEASE() {
    AI_OUTPUT(OTHER, SELF, "DIA_Renegade2_Block_PapersPlease_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Renegade2_Block_PapersPlease_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Renegade2_Block_PapersPlease_03_03");
    TRIA_FINISH();
    INFO_CLEARCHOICES(0x13309);
    AI_STOPPROCESSINFOS(SELF);
    AI_FUNCTION(HERO, 0x13316);
}

func void KILLMARVINRENEGADEPATH() {
    HERO.AIVAR[4] = FALSE;
    MIL_6270_JERRAN.AIVAR[61] = FALSE;
    MIL_6271_RENEGADE.AIVAR[61] = FALSE;
    B_IMMEDIATEATTACKPLAYER(MIL_6270_JERRAN, AR_KILL);
    B_IMMEDIATEATTACKPLAYER(MIL_6271_RENEGADE, AR_KILL);
}

func void DIA_RENEGADE2_BLOCK_SALVI() {
    AI_OUTPUT(OTHER, SELF, "DIA_Renegade2_Block_PapersPlease_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Renegade2_Block_PapersPlease_03_02");
    TRIA_FINISH();
    INFO_CLEARCHOICES(0x13309);
    SELF.AIVAR[93] = (WLD_GETDAY()) + (1);
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_RENEGADE2_AMBIENTAFTERPAY(C_INFO) {
    NPC = 0xdba9;
    NR = 1;
    CONDITION = DIA_RENEGADE2_AMBIENTAFTERPAY_CONDITION;
    INFORMATION = DIA_RENEGADE2_AMBIENTAFTERPAY_INFO;
    PERMANENT = TRUE;
    IMPORTANT = TRUE;
}

func int DIA_RENEGADE2_AMBIENTAFTERPAY_CONDITION() {
    if ((SELF.AIVAR[93]) > (WLD_GETDAY())) {
        if (NPC_ISINSTATE(SELF, 0xf09f)) {
            if ((QM302_RENEGADESEVENT) == (0)) {
                return TRUE;
            };
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_RENEGADE2_AMBIENTAFTERPAY_INFO() {
    NPC_INITAMBIENTS(SELF, 2);
    if ((NPC_GETLASTAMBIENT(SELF)) == (1)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Renegade2_AmbientAfterPay_03_01");
    };
    if ((NPC_GETLASTAMBIENT(SELF)) == (2)) {
        AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
        AI_OUTPUT(SELF, OTHER, "DIA_Renegade2_AmbientAfterPay_03_02");
    };
    AI_RESETFACEANI(SELF);
    AI_STOPPROCESSINFOS(SELF);
}

