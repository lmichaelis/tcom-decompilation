instance Q306_LOSTTOURNAMENT(CUTSCENE) {
    ONSTART = FUNCTION(92518);
}

func void Q306_LOSTTOURNAMENT_WAIT() {
    AI_WAITTILLEND(PIR_1307_PROXIMO, HERO);
    AI_WAITTILLEND(HERO, PIR_1307_PROXIMO);
}

func void Q306_LOSTTOURNAMENT_START() {
    MUSIC_OVERRIDETRACK(21950);
    PIR_1330_ALVAREZ.AIVAR[15] = FALSE;
    NONE_6331_JAVAD.AIVAR[15] = FALSE;
    PIR_13050_OTIS_ARENA.AIVAR[15] = FALSE;
    PIR_1329_SAUL.AIVAR[15] = FALSE;
    if ((Q306_STATE) >= (24)) {
        FINISH_BOSSUI();
        NPC_CLEARAIQUEUE(NONE_7500_BEN);
        Q306_BENSPECIALATTACK = 6;
    };
    WLD_SENDTRIGGER("KM_ARENAFIGHT_4_01");
    WLD_SENDUNTRIGGER("Q306_ARENACROWD");
    Q306_ENDFINALROUND_CROWDSTOP();
    NPC_CLEARAIQUEUE(PIR_1307_PROXIMO);
    TELEPORTNPCTOWP(58696, "P17_HAVEN_ARENA_SPEAKER_01");
    TELEPORTNPCTOWP(1819, "P17_HAVEN_ARENA_PLAYER_02");
    PIR_1307_PROXIMO.AIVAR[92] = TRUE;
    AI_TURNTONPC(PIR_1307_PROXIMO, PIR_1306_RODRIGO);
    AI_PLAYANI(PIR_1307_PROXIMO, "T_FACEPALM");
    AI_OUTPUT(PIR_1307_PROXIMO, HERO, "DIA_Proximo_LostTournament_13_01");
    AI_FUNCTION(PIR_1307_PROXIMO, 92519);
}

func void Q306_LOSTTOURNAMENT_END() {
    MUSIC_DISABLEOVERRIDE();
    PRINTD("Finito!");
    Q306_STATE = 27;
    Q306_TOURNAMENTSTATUS = 2;
    HERO.AIVAR[96] = 1;
    HERO.AIVAR[95] = 0;
    HERO.AIVAR[94] = 0;
    LOG_SETSTATUS(_@(MIS_Q306), TOPIC_Q306, LOG_SUCCESS);
    AI_LOGENTRY(TOPIC_Q306, LOG_Q306_TOURNAMENTLOST);
    B_GIVEPLAYERXP(XP_Q306_LOST);
    NPC_REFRESH(PIR_1307_PROXIMO);
    PIR_1307_PROXIMO.AIVAR[92] = FALSE;
    WLD_SENDTRIGGER("KM_ARENAFIGHT_6_03");
    WLD_SENDUNTRIGGER("KM_ARENAFIGHT_4_01");
    HAVEN_AFTERQ306();
}

