instance DIA_INNKEEPER_EXIT(C_INFO) {
    NPC = 58125;
    NR = 999;
    CONDITION = DIA_INNKEEPER_EXIT_CONDITION;
    INFORMATION = DIA_INNKEEPER_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_INNKEEPER_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_INNKEEPER_EXIT_INFO() {
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_INNKEEPER_SEARCHING(C_INFO) {
    NPC = 58125;
    NR = 1;
    CONDITION = DIA_INNKEEPER_SEARCHING_CONDITION;
    INFORMATION = DIA_INNKEEPER_SEARCHING_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "I'm looking for Henk and Legrif.";
}

func int DIA_INNKEEPER_SEARCHING_CONDITION() {
    if (((LOG_GETSTATUS(MIS_Q402)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 81528))) {
        if ((Q402_FOUNDVARHALANDLEGRIF) == (FALSE)) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_INNKEEPER_SEARCHING_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_Searching_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_Searching_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_Searching_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_Searching_03_04");
    AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_Searching_15_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_Searching_03_06");
}

instance DIA_INNKEEPER_DALMON(C_INFO) {
    NPC = 58125;
    NR = 1;
    CONDITION = DIA_INNKEEPER_DALMON_CONDITION;
    INFORMATION = DIA_INNKEEPER_DALMON_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "I'm looking for someone strong for some work.";
}

func int DIA_INNKEEPER_DALMON_CONDITION() {
    if (((LOG_GETSTATUS(MIS_Q404)) == (LOG_RUNNING)) && ((Q404_GUARDMINE_NEEDHELP) == (TRUE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_INNKEEPER_DALMON_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_Dalmon_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_Dalmon_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_Dalmon_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_Dalmon_03_04");
    AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_Dalmon_15_05");
}

instance DIA_INNKEEPER_IVY(C_INFO) {
    NPC = 58125;
    NR = 1;
    CONDITION = DIA_INNKEEPER_IVY_CONDITION;
    INFORMATION = DIA_INNKEEPER_IVY_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "There was a girl staying here recently.";
}

func int DIA_INNKEEPER_IVY_CONDITION() {
    if (((Q404_MARVINFINISHEDMINE) == (2)) && ((LOG_GETSTATUS(MIS_Q402)) == (LOG_RUNNING))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_INNKEEPER_IVY_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_Ivy_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_Ivy_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_Ivy_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_Ivy_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_Ivy_03_05");
    AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_Ivy_15_06");
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_Ivy_03_07");
    AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_Ivy_15_08");
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_Ivy_03_09");
    AI_LOGENTRY(TOPIC_Q402, LOG_Q402_WHEREIVY);
}

instance DIA_INNKEEPER_JONHOUSE(C_INFO) {
    NPC = 58125;
    NR = 1;
    CONDITION = DIA_INNKEEPER_JONHOUSE_CONDITION;
    INFORMATION = DIA_INNKEEPER_JONHOUSE_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Do you happen to know which house Jon lived in?";
}

func int DIA_INNKEEPER_JONHOUSE_CONDITION() {
    if ((NPC_KNOWSINFO(OTHER, 81833)) && ((LOG_GETSTATUS(MIS_Q402)) == (LOG_RUNNING))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_INNKEEPER_JONHOUSE_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_JonHouse_15_01");
    if ((Q402_AFTERMINE) == (TRUE)) {
        if ((Q402_AFTERMINE_DAY) == ((WLD_GETDAY()) - (1))) {
            AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_JonHouse_03_02");
            AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_JonHouse_15_03");
        } else {
            AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_JonHouse_03_04");
            AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_JonHouse_15_05");
        };
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_JonHouse_03_06");
    AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_JonHouse_15_07");
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_JonHouse_03_08");
    AI_LOGENTRY(TOPIC_Q402, LOG_Q402_INNKEEPER_JONHOUSE);
}

instance DIA_INNKEEPER_SQ405_HELLO(C_INFO) {
    NPC = 58125;
    NR = 1;
    CONDITION = DIA_INNKEEPER_SQ405_HELLO_CONDITION;
    INFORMATION = DIA_INNKEEPER_SQ405_HELLO_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_INNKEEPER_SQ405_HELLO_CONDITION() {
    return TRUE;
}

func void DIA_INNKEEPER_SQ405_HELLO_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_SQ405_Hello_03_01");
}

instance DIA_INNKEEPER_SQ405_AFTERHELLO(C_INFO) {
    NPC = 58125;
    NR = 1;
    CONDITION = DIA_INNKEEPER_SQ405_AFTERHELLO_CONDITION;
    INFORMATION = DIA_INNKEEPER_SQ405_AFTERHELLO_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Yeah, why do you ask?";
}

func int DIA_INNKEEPER_SQ405_AFTERHELLO_CONDITION() {
    if (NPC_KNOWSINFO(OTHER, 81839)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_INNKEEPER_SQ405_AFTERHELLO_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_SQ405_AfterHello_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_SQ405_AfterHello_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_SQ405_AfterHello_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_SQ405_AfterHello_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_SQ405_AfterHello_03_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_SQ405_AfterHello_03_06");
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_SQ405_AfterHello_03_07");
}

instance DIA_DIRK_TRADE(C_INFO) {
    NPC = 58125;
    NR = 10;
    CONDITION = DIA_DIRK_TRADE_CONDITION;
    INFORMATION = DIA_DIRK_TRADE_INFO;
    PERMANENT = TRUE;
    TRADE = TRUE;
    DESCRIPTION = "Let's deal.";
}

func int DIA_DIRK_TRADE_CONDITION() {
    if (NPC_KNOWSINFO(OTHER, 81842)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DIRK_TRADE_INFO() {
    B_SAY(OTHER, SELF, "$MARVIN_LetsTrade");
    B_GIVETRADEINV(SELF);
}

instance DIA_INNKEEPER_SQ405_REALSTART(C_INFO) {
    NPC = 58125;
    NR = 1;
    CONDITION = DIA_INNKEEPER_SQ405_REALSTART_CONDITION;
    INFORMATION = DIA_INNKEEPER_SQ405_REALSTART_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "I'm not promising anything, but I'll see what I can do.";
}

func int DIA_INNKEEPER_SQ405_REALSTART_CONDITION() {
    if (NPC_KNOWSINFO(OTHER, 81842)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_INNKEEPER_SQ405_REALSTART_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_SQ405_RealStart_15_01");
    LOG_CREATETOPIC(TOPIC_SQ405, LOG_MISSION);
    LOG_SETSTATUS(_@(MIS_SQ405), TOPIC_SQ405, LOG_RUNNING);
    AI_LOGENTRY(TOPIC_SQ405, LOG_SQ405_REALSTART);
}

var int INNKEEPER_LEGACYARRAZOL;
var int INNKEEPER_STARKA;
instance DIA_INNKEEPER_GIVEALCO(C_INFO) {
    NPC = 58125;
    NR = 1;
    CONDITION = DIA_INNKEEPER_GIVEALCO_CONDITION;
    INFORMATION = DIA_INNKEEPER_GIVEALCO_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "(Hand over the alcohol)";
}

func int DIA_INNKEEPER_GIVEALCO_CONDITION() {
    if (((NPC_KNOWSINFO(OTHER, 81848)) && ((LOG_GETSTATUS(MIS_SQ405)) == (LOG_RUNNING))) && ((INNKEEPER_DARKBEER) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_INNKEEPER_CHECKTHISOUT() {
    AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_CheckThisOut_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_CheckThisOut_03_02");
}

func void DIA_INNKEEPER_WEHAVEADEAL() {
    AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_WeHaveADeal_15_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_WeHaveADeal_03_03");
}

func void DIA_INNKEEPER_BAD_V1() {
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_Starka_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_Starka_03_04");
}

func void DIA_INNKEEPER_BAD_V2() {
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_LegacyArrazol_03_02");
}

var int INNKEEPER_ITFO_BEER;
var int INNKEEPER_ITFO_BOOZE;
var int INNKEEPER_ITFO_GERSTANDBEER;
var int INNKEEPER_ITFO_WINE;
var int INNKEEPER_ITFO_SPIRIT;
var int INNKEEPER_ITFO_MOONSHINE;
var int INNKEEPER_ITFO_WISP;
var int INNKEEPER_ITFO_SAILOR;
var int INNKEEPER_ITFO_OWBEER;
var int INNKEEPER_ITFO_BEER_02;
var int INNKEEPER_ITFO_WINE_ARAXOS;
var int INNKEEPER_ITFO_BEER_03;
var int INNKEEPER_WINEARRAZOL;
var int INNKEEPER_ITFO_WINE_02;
var int INNKEEPER_ITFO_WINE_01;
var int INNKEEPER_ITFO_ADDON_GROG;
var int INNKEEPER_ITFO_ADDON_RUM;
func void DIA_INNKEEPER_GIVEALCO_INFO() {
    INFO_CLEARCHOICES(81853);
    INFO_ADDCHOICE(81853, DIALOG_BACK, 81877);
    if (((NPC_HASITEMS(OTHER, 36393)) >= (1)) && ((INNKEEPER_LEGACYARRAZOL) == (FALSE))) {
        INFO_ADDCHOICE(81853, FOODNAME_LEGACYARRAZOL, 81897);
    };
    if (((NPC_HASITEMS(OTHER, 36391)) >= (1)) && ((INNKEEPER_WINEARRAZOL) == (FALSE))) {
        INFO_ADDCHOICE(81853, FOODNAME_WINEARRAZOL, 81882);
    };
    if ((((NPC_HASITEMS(OTHER, 36364)) >= (1)) && ((INNKEEPER_DARKBEER) == (FALSE))) && ((LOG_GETSTATUS(MIS_CQ003)) == (LOG_SUCCESS))) {
        INFO_ADDCHOICE(81853, FOODNAME_DARKBEER, 81898);
    };
    if (((NPC_HASITEMS(OTHER, 36355)) >= (1)) && ((INNKEEPER_STARKA) == (FALSE))) {
        INFO_ADDCHOICE(81853, FOODNAME_STARK, 81899);
    };
    if (((NPC_HASITEMS(OTHER, 33984)) >= (1)) && ((INNKEEPER_ITFO_BEER) == (FALSE))) {
        INFO_ADDCHOICE(81853, FOODNAME_BEER, 81896);
    };
    if (((NPC_HASITEMS(OTHER, 33986)) >= (1)) && ((INNKEEPER_ITFO_BOOZE) == (FALSE))) {
        INFO_ADDCHOICE(81853, FOODNAME_BOOZE, 81895);
    };
    if (((NPC_HASITEMS(OTHER, 33974)) >= (1)) && ((INNKEEPER_ITFO_GERSTANDBEER) == (FALSE))) {
        INFO_ADDCHOICE(81853, FOODNAME_GERSTANDBEER, 81894);
    };
    if (((NPC_HASITEMS(OTHER, 33988)) >= (1)) && ((INNKEEPER_ITFO_WINE) == (FALSE))) {
        INFO_ADDCHOICE(81853, FOODNAME_WINE, 81893);
    };
    if (((NPC_HASITEMS(OTHER, 36383)) >= (1)) && ((INNKEEPER_ITFO_SPIRIT) == (FALSE))) {
        INFO_ADDCHOICE(81853, FOODNAME_SPIRIT, 81892);
    };
    if (((NPC_HASITEMS(OTHER, 36385)) >= (1)) && ((INNKEEPER_ITFO_MOONSHINE) == (FALSE))) {
        INFO_ADDCHOICE(81853, FOODNAME_MOONSHINE, 81891);
    };
    if (((NPC_HASITEMS(OTHER, 36387)) >= (1)) && ((INNKEEPER_ITFO_WISP) == (FALSE))) {
        INFO_ADDCHOICE(81853, FOODNAME_WISP, 81890);
    };
    if (((NPC_HASITEMS(OTHER, 36389)) >= (1)) && ((INNKEEPER_ITFO_SAILOR) == (FALSE))) {
        INFO_ADDCHOICE(81853, FOODNAME_SAILOR, 81889);
    };
    if (((NPC_HASITEMS(OTHER, 36363)) >= (1)) && ((INNKEEPER_ITFO_OWBEER) == (FALSE))) {
        INFO_ADDCHOICE(81853, FOODNAME_OWBEER, 81888);
    };
    if (((NPC_HASITEMS(OTHER, 36368)) >= (1)) && ((INNKEEPER_ITFO_BEER_02) == (FALSE))) {
        INFO_ADDCHOICE(81853, FOODNAME_BEER_02, 81887);
    };
    if (((NPC_HASITEMS(OTHER, 36370)) >= (1)) && ((INNKEEPER_ITFO_WINE_ARAXOS) == (FALSE))) {
        INFO_ADDCHOICE(81853, FOODNAME_WINE_ARAXOS, 81886);
    };
    if (((NPC_HASITEMS(OTHER, 36372)) >= (1)) && ((INNKEEPER_ITFO_WINE_01) == (FALSE))) {
        INFO_ADDCHOICE(81853, FOODNAME_WINE_01, 81885);
    };
    if (((NPC_HASITEMS(OTHER, 36373)) >= (1)) && ((INNKEEPER_ITFO_WINE_02) == (FALSE))) {
        INFO_ADDCHOICE(81853, FOODNAME_WINE_02, 81884);
    };
    if (((NPC_HASITEMS(OTHER, 36375)) >= (1)) && ((INNKEEPER_ITFO_BEER_03) == (FALSE))) {
        INFO_ADDCHOICE(81853, FOODNAME_BEER_03, 81883);
    };
    if (((NPC_HASITEMS(OTHER, 33652)) >= (1)) && ((INNKEEPER_ITFO_ADDON_RUM) == (FALSE))) {
        INFO_ADDCHOICE(81853, FOODNAME_RUM, 81881);
    };
    if (((NPC_HASITEMS(OTHER, 33654)) >= (1)) && ((INNKEEPER_ITFO_ADDON_GROG) == (FALSE))) {
        INFO_ADDCHOICE(81853, FOODNAME_GROG, 81880);
    };
}

func void DIA_INNKEEPER_GIVEALCO_BACK() {
    INFO_CLEARCHOICES(81853);
}

func void SQ405_TRYBEERCOUNT() {
    var int SQ405_TRYBEERCOUNT_CHECK;
    B_GIVEPLAYERXP(XP_SQ405_TRYBEER);
    SQ405_TRYBEERCOUNT_CHECK = (SQ405_TRYBEERCOUNT_CHECK) + (1);
    if ((SQ405_TRYBEERCOUNT_CHECK) >= (4)) {
        SQ405_TRYBEERCOUNT_CHECK = 50;
        AI_LOGENTRY(TOPIC_SQ405, LOG_SQ405_NOIDEA);
    };
}

func void DIA_INNKEEPER_ITFO_ADDON_GROG() {
    INNKEEPER_ITFO_ADDON_GROG = TRUE;
    NPC_REMOVEINVITEMS(SELF, 33654, 1);
    AI_WAITTILLEND(SELF, OTHER);
    B_GIVEINVITEMS(OTHER, SELF, 33654, 1);
    DIA_INNKEEPER_CHECKTHISOUT();
    AI_WAITTILLEND(SELF, OTHER);
    B_USEFAKEBEER_ITFO_ADDON_GROG();
    DIA_INNKEEPER_BAD_V1();
    AI_LOGENTRY(TOPIC_SQ405, LOG_SQ405_GROG);
    SQ405_TRYBEERCOUNT();
}

func void DIA_INNKEEPER_ITFO_ADDON_RUM() {
    INNKEEPER_ITFO_ADDON_RUM = TRUE;
    NPC_REMOVEINVITEMS(SELF, 33652, 1);
    AI_WAITTILLEND(SELF, OTHER);
    B_GIVEINVITEMS(OTHER, SELF, 33652, 1);
    DIA_INNKEEPER_CHECKTHISOUT();
    AI_WAITTILLEND(SELF, OTHER);
    B_USEFAKEBEER_ITFO_ADDON_RUM();
    DIA_INNKEEPER_BAD_V1();
    AI_LOGENTRY(TOPIC_SQ405, LOG_SQ405_RUM);
    SQ405_TRYBEERCOUNT();
}

func void DIA_INNKEEPER_WINEARRAZOL() {
    INNKEEPER_WINEARRAZOL = TRUE;
    NPC_REMOVEINVITEMS(SELF, 36391, 1);
    AI_WAITTILLEND(SELF, OTHER);
    B_GIVEINVITEMS(OTHER, SELF, 36391, 1);
    DIA_INNKEEPER_CHECKTHISOUT();
    AI_WAITTILLEND(SELF, OTHER);
    B_USEFAKEBEER_WINEARRAZOL();
    DIA_INNKEEPER_BAD_V2();
    AI_LOGENTRY(TOPIC_SQ405, LOG_SQ405_WINEARRAZOL);
    SQ405_TRYBEERCOUNT();
}

func void DIA_INNKEEPER_ITFO_BEER_03() {
    INNKEEPER_ITFO_BEER_03 = TRUE;
    NPC_REMOVEINVITEMS(SELF, 36375, 1);
    AI_WAITTILLEND(SELF, OTHER);
    B_GIVEINVITEMS(OTHER, SELF, 36375, 1);
    DIA_INNKEEPER_CHECKTHISOUT();
    AI_WAITTILLEND(SELF, OTHER);
    B_USEFAKEBEER_BEER_03();
    DIA_INNKEEPER_BAD_V1();
    AI_LOGENTRY(TOPIC_SQ405, LOG_SQ405_BEER_03);
    SQ405_TRYBEERCOUNT();
}

func void DIA_INNKEEPER_ITFO_WINE_02() {
    INNKEEPER_ITFO_WINE_02 = TRUE;
    NPC_REMOVEINVITEMS(SELF, 36373, 1);
    AI_WAITTILLEND(SELF, OTHER);
    B_GIVEINVITEMS(OTHER, SELF, 36373, 1);
    DIA_INNKEEPER_CHECKTHISOUT();
    AI_WAITTILLEND(SELF, OTHER);
    B_USEFAKEBEER_WINE_02();
    DIA_INNKEEPER_BAD_V2();
    AI_LOGENTRY(TOPIC_SQ405, LOG_SQ405_WINE_02);
    SQ405_TRYBEERCOUNT();
}

func void DIA_INNKEEPER_ITFO_WINE_01() {
    INNKEEPER_ITFO_WINE_01 = TRUE;
    NPC_REMOVEINVITEMS(SELF, 36372, 1);
    AI_WAITTILLEND(SELF, OTHER);
    B_GIVEINVITEMS(OTHER, SELF, 36372, 1);
    DIA_INNKEEPER_CHECKTHISOUT();
    AI_WAITTILLEND(SELF, OTHER);
    B_USEFAKEBEER_WINE_01();
    DIA_INNKEEPER_BAD_V2();
    AI_LOGENTRY(TOPIC_SQ405, LOG_SQ405_WINE_01);
    SQ405_TRYBEERCOUNT();
}

func void DIA_INNKEEPER_ITFO_WINE_ARAXOS() {
    INNKEEPER_ITFO_WINE_ARAXOS = TRUE;
    NPC_REMOVEINVITEMS(SELF, 36370, 1);
    AI_WAITTILLEND(SELF, OTHER);
    B_GIVEINVITEMS(OTHER, SELF, 36370, 1);
    DIA_INNKEEPER_CHECKTHISOUT();
    AI_WAITTILLEND(SELF, OTHER);
    B_USEFAKEBEER_WINE_ARAXOS();
    DIA_INNKEEPER_BAD_V2();
    AI_LOGENTRY(TOPIC_SQ405, LOG_SQ405_WINE_ARAXOS);
    SQ405_TRYBEERCOUNT();
}

func void DIA_INNKEEPER_ITFO_BEER_02() {
    INNKEEPER_ITFO_BEER_02 = TRUE;
    NPC_REMOVEINVITEMS(SELF, 36368, 1);
    AI_WAITTILLEND(SELF, OTHER);
    B_GIVEINVITEMS(OTHER, SELF, 36368, 1);
    DIA_INNKEEPER_CHECKTHISOUT();
    AI_WAITTILLEND(SELF, OTHER);
    B_USEFAKEBEER_OWBEER();
    DIA_INNKEEPER_BAD_V1();
    AI_LOGENTRY(TOPIC_SQ405, LOG_SQ405_BEER_02);
    SQ405_TRYBEERCOUNT();
}

func void DIA_INNKEEPER_ITFO_OWBEER() {
    INNKEEPER_ITFO_OWBEER = TRUE;
    NPC_REMOVEINVITEMS(SELF, 36363, 1);
    AI_WAITTILLEND(SELF, OTHER);
    B_GIVEINVITEMS(OTHER, SELF, 36363, 1);
    DIA_INNKEEPER_CHECKTHISOUT();
    AI_WAITTILLEND(SELF, OTHER);
    B_USEFAKEBEER_OWBEER();
    DIA_INNKEEPER_BAD_V1();
    AI_LOGENTRY(TOPIC_SQ405, LOG_SQ405_BEER_OW);
    SQ405_TRYBEERCOUNT();
}

func void DIA_INNKEEPER_ITFO_SAILOR() {
    INNKEEPER_ITFO_SAILOR = TRUE;
    NPC_REMOVEINVITEMS(SELF, 36389, 1);
    AI_WAITTILLEND(SELF, OTHER);
    B_GIVEINVITEMS(OTHER, SELF, 36389, 1);
    DIA_INNKEEPER_CHECKTHISOUT();
    AI_WAITTILLEND(SELF, OTHER);
    B_USEFAKEBEER_SAILOR();
    DIA_INNKEEPER_BAD_V1();
    AI_LOGENTRY(TOPIC_SQ405, LOG_SQ405_SAILOR);
    SQ405_TRYBEERCOUNT();
}

func void DIA_INNKEEPER_ITFO_WISP() {
    INNKEEPER_ITFO_WISP = TRUE;
    NPC_REMOVEINVITEMS(SELF, 36387, 1);
    AI_WAITTILLEND(SELF, OTHER);
    B_GIVEINVITEMS(OTHER, SELF, 36387, 1);
    DIA_INNKEEPER_CHECKTHISOUT();
    AI_WAITTILLEND(SELF, OTHER);
    B_USEFAKEBEER_WISP();
    DIA_INNKEEPER_BAD_V1();
    AI_LOGENTRY(TOPIC_SQ405, LOG_SQ405_WISP);
    SQ405_TRYBEERCOUNT();
}

func void DIA_INNKEEPER_ITFO_MOONSHINE() {
    INNKEEPER_ITFO_MOONSHINE = TRUE;
    NPC_REMOVEINVITEMS(SELF, 36385, 1);
    AI_WAITTILLEND(SELF, OTHER);
    B_GIVEINVITEMS(OTHER, SELF, 36385, 1);
    DIA_INNKEEPER_CHECKTHISOUT();
    AI_WAITTILLEND(SELF, OTHER);
    B_USEFAKEBEER_MOONSHINE();
    DIA_INNKEEPER_BAD_V1();
    AI_LOGENTRY(TOPIC_SQ405, LOG_SQ405_MOONSHINE);
    SQ405_TRYBEERCOUNT();
}

func void DIA_INNKEEPER_ITFO_SPIRIT() {
    INNKEEPER_ITFO_SPIRIT = TRUE;
    NPC_REMOVEINVITEMS(SELF, 36383, 1);
    AI_WAITTILLEND(SELF, OTHER);
    B_GIVEINVITEMS(OTHER, SELF, 36383, 1);
    DIA_INNKEEPER_CHECKTHISOUT();
    AI_WAITTILLEND(SELF, OTHER);
    B_USEFAKEBEER_SPIRIT();
    DIA_INNKEEPER_BAD_V1();
    AI_LOGENTRY(TOPIC_SQ405, LOG_SQ405_SPIRIT);
    SQ405_TRYBEERCOUNT();
}

func void DIA_INNKEEPER_ITFO_WINE() {
    INNKEEPER_ITFO_WINE = TRUE;
    NPC_REMOVEINVITEMS(SELF, 33988, 1);
    AI_WAITTILLEND(SELF, OTHER);
    B_GIVEINVITEMS(OTHER, SELF, 33988, 1);
    DIA_INNKEEPER_CHECKTHISOUT();
    AI_WAITTILLEND(SELF, OTHER);
    B_USEFAKEBEER_WINE();
    DIA_INNKEEPER_BAD_V2();
    AI_LOGENTRY(TOPIC_SQ405, LOG_SQ405_WINE);
    SQ405_TRYBEERCOUNT();
}

func void DIA_INNKEEPER_ITFO_GERSTANDBEER() {
    INNKEEPER_ITFO_GERSTANDBEER = TRUE;
    NPC_REMOVEINVITEMS(SELF, 33974, 1);
    AI_WAITTILLEND(SELF, OTHER);
    B_GIVEINVITEMS(OTHER, SELF, 33974, 1);
    DIA_INNKEEPER_CHECKTHISOUT();
    AI_WAITTILLEND(SELF, OTHER);
    B_USEFAKEBEER_GERSTANDBEER();
    DIA_INNKEEPER_BAD_V1();
    AI_LOGENTRY(TOPIC_SQ405, LOG_SQ405_GERSTANDBEER);
    SQ405_TRYBEERCOUNT();
}

func void DIA_INNKEEPER_ITFO_BOOZE() {
    INNKEEPER_ITFO_BOOZE = TRUE;
    NPC_REMOVEINVITEMS(SELF, 33986, 1);
    AI_WAITTILLEND(SELF, OTHER);
    B_GIVEINVITEMS(OTHER, SELF, 33986, 1);
    DIA_INNKEEPER_CHECKTHISOUT();
    AI_WAITTILLEND(SELF, OTHER);
    B_USEFAKEBEER_BOOZE();
    DIA_INNKEEPER_BAD_V1();
    AI_LOGENTRY(TOPIC_SQ405, LOG_SQ405_BOOZE);
    SQ405_TRYBEERCOUNT();
}

func void DIA_INNKEEPER_ITFO_BEER() {
    INNKEEPER_ITFO_BEER = TRUE;
    NPC_REMOVEINVITEMS(SELF, 33984, 1);
    AI_WAITTILLEND(SELF, OTHER);
    B_GIVEINVITEMS(OTHER, SELF, 33984, 1);
    DIA_INNKEEPER_CHECKTHISOUT();
    AI_WAITTILLEND(SELF, OTHER);
    B_USEFAKEBEER_BEER();
    DIA_INNKEEPER_BAD_V1();
    AI_LOGENTRY(TOPIC_SQ405, LOG_SQ405_BEER);
    SQ405_TRYBEERCOUNT();
}

func void DIA_INNKEEPER_LEGACYARRAZOL() {
    DIA_INNKEEPER_CHECKTHISOUT();
    NPC_REMOVEINVITEMS(SELF, 36393, 1);
    AI_WAITTILLEND(SELF, OTHER);
    B_GIVEINVITEMS(OTHER, SELF, 36393, 1);
    B_USEFAKEBEER_LEGACYARCHOLOS();
    DIA_INNKEEPER_BAD_V2();
    AI_LOGENTRY(TOPIC_SQ405, LOG_SQ405_LEGACYARRAZO);
    INNKEEPER_LEGACYARRAZOL = TRUE;
    SQ405_TRYBEERCOUNT();
}

func void DIA_INNKEEPER_DARKBEER() {
    DIA_INNKEEPER_CHECKTHISOUT();
    AI_WAITTILLEND(SELF, OTHER);
    B_USEFAKEBEER_DARKBEER();
    B_GIVEINVITEMS(OTHER, SELF, 36364, 1);
    AI_STOPLOOKAT(SELF);
    AI_USEITEM(SELF, 36364);
    AI_WAITTILLEND(OTHER, SELF);
    AI_WAITTILLEND(SELF, OTHER);
    AI_LOOKATNPC(SELF, OTHER);
    INNKEEPER_DARKBEER = TRUE;
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_DarkBeer_03_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_DarkBeer_15_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_DarkBeer_15_03");
    INFO_CLEARCHOICES(81853);
    INFO_ADDCHOICE(81853, "...150 gold pieces per box.", 81901);
    INFO_ADDCHOICE(81853, "...100 gold pieces per box.", 81902);
}

func void DIA_INNKEEPER_STARKA() {
    DIA_INNKEEPER_CHECKTHISOUT();
    NPC_REMOVEINVITEMS(SELF, 36355, 1);
    AI_WAITTILLEND(SELF, OTHER);
    B_GIVEINVITEMS(OTHER, SELF, 36355, 1);
    B_USEFAKEBEER_STARKA();
    DIA_INNKEEPER_BAD_V1();
    AI_LOGENTRY(TOPIC_SQ405, LOG_SQ405_STARK);
    INNKEEPER_STARKA = TRUE;
    SQ405_TRYBEERCOUNT();
}

func void DIA_INNKEEPER_GOLD200() {
    AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_Gold200_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_Gold200_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_Gold200_03_03");
    AI_LOGENTRY(TOPIC_SQ405, LOG_SQ405_FAIL);
    LOG_SETSTATUS(_@(MIS_SQ405), TOPIC_SQ405, LOG_FAILED);
    AI_STOPPROCESSINFOS(SELF);
}

func void DIA_INNKEEPER_GOLD150() {
    AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_Gold150_15_01");
    DIA_INNKEEPER_WEHAVEADEAL();
    AI_LOGENTRY(TOPIC_SQ405, LOG_SQ405_DARKBEERV2);
    SQ405_WEHAVEADEAL = 2;
    AI_STOPPROCESSINFOS(SELF);
}

func void DIA_INNKEEPER_GOLD100() {
    AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_Gold100_15_01");
    DIA_INNKEEPER_WEHAVEADEAL();
    AI_LOGENTRY(TOPIC_SQ405, LOG_SQ405_DARKBEERV1);
    SQ405_WEHAVEADEAL = 1;
    AI_STOPPROCESSINFOS(SELF);
}

var int INNKEEPER_SQ405_GOTSBEER;
instance DIA_INNKEEPER_SQ405_AFTERMATCH(C_INFO) {
    NPC = 58125;
    NR = 1;
    CONDITION = DIA_INNKEEPER_SQ405_AFTERMATCH_CONDITION;
    INFORMATION = DIA_INNKEEPER_SQ405_AFTERMATCH_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "Tomas agreed to your proposal.";
}

func int DIA_INNKEEPER_SQ405_AFTERMATCH_CONDITION() {
    if ((NPC_KNOWSINFO(OTHER, 69832)) && ((INNKEEPER_SQ405_GOTSBEER) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_INNKEEPER_SQ405_AFTERMATCH_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Innkeeper_SQ405_Aftermatch_15_01");
    if ((SQ405_DAYSUPPLY) == (WLD_GETDAY())) {
        AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_SQ405_Aftermatch_03_02");
        AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_SQ405_Aftermatch_03_03");
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_SQ405_Aftermatch_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_SQ405_Aftermatch_03_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Innkeeper_SQ405_Aftermatch_03_06");
    CREATEINVITEMS(SELF, 33652, 3);
    B_GIVEINVITEMS(SELF, OTHER, 33652, 3);
    INNKEEPER_SQ405_GOTSBEER = TRUE;
}

instance DIA_INNKEEPER_PICKPOCKET(C_INFO) {
    NPC = 58125;
    NR = 900;
    CONDITION = DIA_INNKEEPER_PICKPOCKET_CONDITION;
    INFORMATION = DIA_INNKEEPER_PICKPOCKET_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = PICKPOCKET_80;
}

func int DIA_INNKEEPER_PICKPOCKET_CONDITION() {
    if (((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_PICKPOCKET)) >= (1)) && ((SELF.AIVAR[6]) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_INNKEEPER_PICKPOCKET_INFO() {
    INFO_CLEARCHOICES(81907);
    INFO_ADDCHOICE(81907, DIALOG_BACK, 81911);
    INFO_ADDCHOICE(81907, DIALOG_PICKPOCKET, 81910);
}

func void DIA_INNKEEPER_PICKPOCKET_DOIT() {
    if ((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_PICKPOCKET)) >= (2)) {
        CREATEINVITEMS(SELF, 36377, 1);
        B_GIVEINVITEMS(SELF, OTHER, 36377, 1);
        B_PICKPOCKET_AMBIENT_TIER_2();
        SELF.AIVAR[6] = TRUE;
        INFO_CLEARCHOICES(81907);
    };
    AI_PLAYANI(HERO, T_CANNOTTAKE);
    PRINTSCREEN(PRINT_CANTPICKPOCKETTHISPERSON, -(1), -(1), FONT_SCREEN, 4);
    INFO_CLEARCHOICES(81907);
}

func void DIA_INNKEEPER_PICKPOCKET_BACK() {
    INFO_CLEARCHOICES(81907);
}

