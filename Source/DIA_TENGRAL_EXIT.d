instance DIA_TENGRAL_EXIT(C_INFO) {
    NPC = 55422;
    NR = 999;
    CONDITION = DIA_TENGRAL_EXIT_CONDITION;
    INFORMATION = DIA_TENGRAL_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_TENGRAL_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_TENGRAL_EXIT_INFO() {
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_TENGRAL_HELLO(C_INFO) {
    NPC = 55422;
    NR = 1;
    CONDITION = DIA_TENGRAL_HELLO_CONDITION;
    INFORMATION = DIA_TENGRAL_HELLO_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_TENGRAL_HELLO_CONDITION() {
    if (((NPC_ISINSTATE(SELF, 61599)) && ((NPC_GETDISTTOWP(SELF, "PARTM8_PATH_PREACH")) <= (500))) && (WLD_ISTIME(13, 0, 14, 0))) {
        return FALSE;
    };
    if (NPC_ISINSTATE(SELF, 61599)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_TENGRAL_HELLO_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_Hello_03_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_Hello_15_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_Hello_03_02");
}

instance DIA_TENGRAL_INNOS(C_INFO) {
    NPC = 55422;
    NR = 2;
    CONDITION = DIA_TENGRAL_INNOS_CONDITION;
    INFORMATION = DIA_TENGRAL_INNOS_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "I would like to know more about your deity.";
}

func int DIA_TENGRAL_INNOS_CONDITION() {
    if (NPC_KNOWSINFO(OTHER, 65401)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_TENGRAL_INNOS_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_Innos_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_Innos_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_Innos_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_Innos_03_04");
    INFO_CLEARCHOICES(65404);
    INFO_ADDCHOICE(65404, "I am a follower of Adanos.", 65408);
    INFO_ADDCHOICE(65404, "I am a humble servant of Beliar.", 65409);
    INFO_ADDCHOICE(65404, "I don't get along with gods.", 65407);
}

func void DIA_TENGRAL_INNOS_ATHEIST() {
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_Innos_Atheist_15_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_Innos_Atheist_15_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_Innos_Atheist_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_Innos_Atheist_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_Innos_Atheist_03_05");
    INFO_CLEARCHOICES(65404);
}

func void DIA_TENGRAL_INNOS_ADANOS() {
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_Innos_Adanos_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_Innos_Adanos_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_Innos_Adanos_03_03");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_Innos_Adanos_15_04");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_Innos_Adanos_15_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_Innos_Adanos_03_06");
    INFO_CLEARCHOICES(65404);
}

func void DIA_TENGRAL_INNOS_BELIAR() {
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_Innos_Beliar_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_Innos_Beliar_03_02");
    INFO_CLEARCHOICES(65404);
}

instance DIA_TENGRAL_MAGIC(C_INFO) {
    NPC = 55422;
    NR = 3;
    CONDITION = DIA_TENGRAL_MAGIC_CONDITION;
    INFORMATION = DIA_TENGRAL_MAGIC_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Tell me about Magic.";
}

func int DIA_TENGRAL_MAGIC_CONDITION() {
    if (NPC_KNOWSINFO(OTHER, 65404)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_TENGRAL_MAGIC_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_Magic_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_Magic_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_Magic_03_03");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_Magic_15_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_Magic_03_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_Magic_03_06");
}

instance DIA_TENGRAL_FIREMAGE(C_INFO) {
    NPC = 55422;
    NR = 4;
    CONDITION = DIA_TENGRAL_FIREMAGE_CONDITION;
    INFORMATION = DIA_TENGRAL_FIREMAGE_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Could I join the Fire Mages?";
}

func int DIA_TENGRAL_FIREMAGE_CONDITION() {
    if ((NPC_KNOWSINFO(OTHER, 65404)) && ((LOG_GETSTATUS(MIS_Q405)) == (0))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_TENGRAL_FIREMAGE_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_FireMage_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_FireMage_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_FireMage_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_FireMage_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_FireMage_03_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_FireMage_03_06");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_FireMage_15_07");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_FireMage_03_08");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_FireMage_15_09");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_FireMage_03_10");
}

instance DIA_TENGRAL_CQ005_START(C_INFO) {
    NPC = 55422;
    NR = 5;
    CONDITION = DIA_TENGRAL_CQ005_START_CONDITION;
    INFORMATION = DIA_TENGRAL_CQ005_START_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Maybe I could do something for you?";
}

func int DIA_TENGRAL_CQ005_START_CONDITION() {
    if (NPC_KNOWSINFO(OTHER, 65404)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_TENGRAL_CQ005_START_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_Start_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_Start_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_Start_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_Start_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_Start_03_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_Start_03_06");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_Start_15_07");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_Start_03_08");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_Start_15_10");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_Start_03_11");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_Start_03_12");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_Start_03_13");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_Start_03_14");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_Start_03_15");
    INFO_CLEARCHOICES(65416);
    INFO_ADDCHOICE(65416, "How am I supposed to do that?", 65419);
}

func void DIA_TENGRAL_CQ005_START_HOW() {
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_Start_How_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_Start_How_03_02");
    if ((LOG_GETSTATUS(MIS_Q202)) == (LOG_RUNNING)) {
        AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_Start_How_15_03");
        AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_Start_How_15_04");
        AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_Start_How_03_05");
        AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_Start_How_15_06");
        AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_Start_How_03_07");
        CQ005_TENGRALREWARD = 1;
    };
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_Start_How_15_08");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_Start_How_15_09");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_Start_How_03_10");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_Start_How_03_11");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_Start_How_15_12");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_Start_How_03_07");
    CQ005_TENGRALREWARD = 2;
    LOG_CREATETOPIC(TOPIC_CQ005, LOG_MISSION);
    LOG_SETSTATUS(_@(MIS_CQ005), TOPIC_CQ005, LOG_RUNNING);
    AI_LOGENTRY(TOPIC_CQ005, LOG_CQ005_START);
    INFO_CLEARCHOICES(65416);
}

instance DIA_TENGRAL_CQ005_BADENDING(C_INFO) {
    NPC = 55422;
    NR = 10;
    CONDITION = DIA_TENGRAL_CQ005_BADENDING_CONDITION;
    INFORMATION = DIA_TENGRAL_CQ005_BADENDING_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Things got a little complicated.";
}

func int DIA_TENGRAL_CQ005_BADENDING_CONDITION() {
    if (((CQ005_SILVESTRWENTTORODERICH) == (TRUE)) && ((LOG_GETSTATUS(MIS_CQ005)) == (LOG_RUNNING))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_TENGRAL_CQ005_BADENDING_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_BadEnding_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_BadEnding_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_BadEnding_15_03");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_BadEnding_15_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_BadEnding_03_05");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_BadEnding_15_06");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_BadEnding_03_07");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_BadEnding_15_08");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_BadEnding_03_09");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_BadEnding_03_10");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_BadEnding_15_11");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_BadEnding_03_12");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_BadEnding_03_13");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_BadEnding_03_14");
    AI_LOGENTRY(TOPIC_CQ005, LOG_CQ005_TENGRAL_BADENDING);
    CQ005_FINISHQUEST();
    B_STARTOTHERROUTINE(PAL_101_SILVESTR, START);
    NPC_REFRESH(PAL_101_SILVESTR);
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_TENGRAL_CQ005_SILVESTRDEAD(C_INFO) {
    NPC = 55422;
    NR = 1;
    CONDITION = DIA_TENGRAL_CQ005_SILVESTRDEAD_CONDITION;
    INFORMATION = DIA_TENGRAL_CQ005_SILVESTRDEAD_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "I have bad news.";
}

func int DIA_TENGRAL_CQ005_SILVESTRDEAD_CONDITION() {
    if ((NPC_KNOWSINFO(OTHER, 77174)) && ((LOG_GETSTATUS(MIS_CQ005)) == (LOG_RUNNING))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_TENGRAL_CQ005_SILVESTRDEAD_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_SilvestrDead_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_SilvestrDead_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_SilvestrDead_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_SilvestrDead_03_04");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_SilvestrDead_15_05");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_SilvestrDead_15_06");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_SilvestrDead_15_07");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_SilvestrDead_03_08");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_SilvestrDead_15_09");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_SilvestrDead_03_10");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_SilvestrDead_15_11");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_SilvestrDead_03_12");
    if ((CQ005_TENGRALREWARD) == (1)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_SilvestrDead_03_13");
        AI_LOGENTRY(TOPIC_CQ005, LOG_CQ005_FINISH_V1);
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_SilvestrDead_03_14");
    AI_LOGENTRY(TOPIC_CQ005, LOG_CQ005_FINISH_V2);
    CQ005_FINISHQUEST();
    B_GIVEPLAYERXP(XP_CQ005_BADENDING);
    CQ005_GIVEREWARD();
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_SilvestrDead_15_15");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_SilvestrDead_03_16");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_SilvestrDead_03_17");
    CQ005_TELEPORTTHUGS();
}

instance DIA_TENGRAL_CQ005_GOODENDING(C_INFO) {
    NPC = 55422;
    NR = 2;
    CONDITION = DIA_TENGRAL_CQ005_GOODENDING_CONDITION;
    INFORMATION = DIA_TENGRAL_CQ005_GOODENDING_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Runar will no longer cause problems.";
}

func int DIA_TENGRAL_CQ005_GOODENDING_CONDITION() {
    if ((NPC_KNOWSINFO(OTHER, 70063)) && ((LOG_GETSTATUS(MIS_CQ005)) == (LOG_RUNNING))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_TENGRAL_CQ005_GOODENDING_INFO() {
    CQ005_TENGRAL_BONUSREWARD = TRUE;
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_GoodEnding_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_GoodEnding_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_GoodEnding_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_GoodEnding_03_04");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_GoodEnding_15_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_GoodEnding_03_06");
    if ((CQ005_TENGRALREWARD) == (1)) {
        AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_GoodEnding_15_07");
    };
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CQ005_GoodEnding_15_10");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_GoodEnding_03_08");
    if ((CQ005_TENGRALREWARD) == (1)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_GoodEnding_03_09");
        AI_LOGENTRY(TOPIC_CQ005, LOG_CQ005_FINISH_V3);
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_GoodEnding_03_11");
    AI_LOGENTRY(TOPIC_CQ005, LOG_CQ005_FINISH_V4);
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CQ005_GoodEnding_03_12");
    CQ005_FINISHQUEST();
    B_GIVEPLAYERXP(XP_CQ005_GOODENDING);
    CQ005_GIVEREWARD();
}

instance DIA_TENGRAL_REFERENCEEXCHANGE(C_INFO) {
    NPC = 55422;
    NR = 1;
    CONDITION = DIA_TENGRAL_REFERENCEEXCHANGE_CONDITION;
    INFORMATION = DIA_TENGRAL_REFERENCEEXCHANGE_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "Could I exchange my reward for a reference? (100 GP)";
}

func int DIA_TENGRAL_REFERENCEEXCHANGE_CONDITION() {
    if ((((CQ005_TENGRAL_REFERENCEEXCHANGE) == (1)) && ((LOG_GETSTATUS(MIS_Q202)) == (LOG_RUNNING))) && (NPC_KNOWSINFO(OTHER, 73577))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_TENGRAL_REFERENCEEXCHANGE_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Boris_ReferenceExchange_15_01");
    if ((NPC_HASITEMS(OTHER, 34203)) >= (CQ005_REWARD)) {
        NPC_REMOVEINVITEMS(SELF, 34203, CQ005_REWARD);
        AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
        B_GIVEINVITEMS(OTHER, SELF, 34203, CQ005_REWARD);
        B_SAY(SELF, OTHER, "$SURE_V3");
        AI_RESETFACEANI(SELF);
        CREATEINVITEMS(SELF, 37165, 1);
        B_GIVEINVITEMS(SELF, OTHER, 37165, 1);
        CQ005_TENGRAL_REFERENCEEXCHANGE = 2;
    };
    B_SAY(SELF, OTHER, "$NOGOLD");
}

instance DIA_TENGRAL_SQ309(C_INFO) {
    NPC = 55422;
    NR = 1;
    CONDITION = DIA_TENGRAL_SQ309_CONDITION;
    INFORMATION = DIA_TENGRAL_SQ309_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_TENGRAL_SQ309_CONDITION() {
    if (((LOG_GETSTATUS(MIS_SQ309)) == (LOG_RUNNING)) && ((SQ309_CHAIRWORKINNOS_DONE) == (5))) {
        if ((KAPITEL) < (5)) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_TENGRAL_SQ309_SELLING_SQ309() {
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_SQ309_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_SQ309_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_SQ309_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_SQ309_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_SQ309_03_05");
    TRIA_WAIT();
    TRIA_NEXT(PAL_100_CANDAC);
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_SQ309_03_06");
    TRIA_WAIT();
    TRIA_NEXT(KDF_9004_TENGRAL);
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_SQ309_03_07");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_SQ309_03_08");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_SQ309_03_09");
    INFO_CLEARCHOICES(65432);
    INFO_ADDCHOICE(65432, DIALOG_BESILENT, 65435);
    INFO_ADDCHOICE(65432, "There is some information that may make you change your mind...", 65437);
}

func void DIA_TENGRAL_SQ309_SELLING_SQ309_SILENCE() {
    TRIA_WAIT();
    TRIA_NEXT(KDF_9004_TENGRAL);
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_Silence_03_01");
    AI_TURNTONPC(SELF, PAL_100_CANDAC);
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_Silence_03_02");
    AI_TURNTONPC(SELF, HERO);
    if ((HERO.GUILD) == (GIL_SLD)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_Silence_03_03");
    };
    if ((HERO.GUILD) == (GIL_MIL)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_Silence_03_04");
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_Silence_03_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_Silence_03_06");
    AI_FUNCTION(SELF, 65436);
}

func void SQ309_FINISHTRIALOG() {
    TRIA_FINISH();
    INFO_CLEARCHOICES(65432);
    AI_STOPPROCESSINFOS(SELF);
    if ((LOG_GETSTATUS(MIS_SQ313)) != (LOG_SUCCESS)) {
        if (((LOG_GETSTATUS(MIS_CQ005)) == (LOG_SUCCESS)) && ((CQ005_ENDING) == (1))) {
            if ((SQ313_ENDING) == (1)) {
                SQ313_PREPAREMAGES_HUGHENDING();
            } else if ((SQ313_ENDING) == (2)) {
                SQ313_PREPAREMAGES_TRIMEGISTOENDING();
            } else {
                NPC_EXCHANGEROUTINE(KDF_9004_TENGRAL, START);
            };
        } else {
            NPC_EXCHANGEROUTINE(KDF_9004_TENGRAL, START);
        };
    };
    NPC_EXCHANGEROUTINE(KDF_9004_TENGRAL, START);
    NPC_EXCHANGEROUTINE(PAL_100_CANDAC, START);
}

func void DIA_TENGRAL_SQ309_SELLING_SQ309_INFORMATION() {
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_SQ309_Information_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_Information_03_02");
    DIA_TENGRAL_SQ309_SELLING_SQ309_SILENCE();
}

func void DIA_TENGRAL_SQ309_INFO() {
    TRIA_INVITE(PAL_100_CANDAC);
    TRIA_START();
    AI_LOOKATNPC(HERO, KDF_9004_TENGRAL);
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_SQ309_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_03_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_03_06");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_03_07");
    INFO_CLEARCHOICES(65432);
    INFO_ADDCHOICE(65432, "Selling golden Innoses is against the will of the Fire Archmages!", 65440);
    INFO_ADDCHOICE(65432, "I had no ill intentions.", 65439);
}

func void DIA_TENGRAL_SQ309_INTENTIONS() {
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_SQ309_Intentions_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_Intentions_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_Intentions_03_03");
    DIA_TENGRAL_SQ309_SELLING_SQ309();
}

func void DIA_TENGRAL_SQ309_SELLING() {
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_SQ309_Selling_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_Selling_03_02");
    CREATEINVITEMS(SELF, 34600, 1);
    B_READYSPELL(SELF, SPL_INSTANTFIREBALL, SPL_COST_INSTANTFIREBALL);
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_Selling_03_03");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_SQ309_Selling_15_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ309_Selling_03_05");
    AI_UNREADYSPELL(SELF);
    DIA_TENGRAL_SQ309_SELLING_SQ309();
}

instance DIA_TENGRAL_SQ313_PROBLEM(C_INFO) {
    NPC = 55422;
    NR = 1;
    CONDITION = DIA_TENGRAL_SQ313_PROBLEM_CONDITION;
    INFORMATION = DIA_TENGRAL_SQ313_PROBLEM_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Master Trimegisto was very concerned about Runar's case.";
}

func int DIA_TENGRAL_SQ313_PROBLEM_CONDITION() {
    if ((LOG_GETSTATUS(MIS_SQ313)) == (LOG_RUNNING)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_TENGRAL_SQ313_PROBLEM_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_SQ313_Problem_15_01");
    AI_STARTFACEANI(SELF, S_TIRED, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ313_Problem_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ313_Problem_03_03");
    AI_RESETFACEANI(SELF);
}

instance DIA_TENGRAL_KQ404_GRAYSON(C_INFO) {
    NPC = 55422;
    NR = 1;
    CONDITION = DIA_TENGRAL_KQ404_GRAYSON_CONDITION;
    INFORMATION = DIA_TENGRAL_KQ404_GRAYSON_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Master. Have you had a chance to meet Grayson?";
}

func int DIA_TENGRAL_KQ404_GRAYSON_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_KQ404)) == (LOG_RUNNING)) && ((KQ404_UNICORNLIST_READ) == (TRUE))) && ((INEXTREMO_CANPLAYCONCERT) == (TRUE))) {
        if (((LOG_GETSTATUS(MIS_CQ005)) == (LOG_SUCCESS)) || ((LOG_GETSTATUS(MIS_SQ313)) == (LOG_SUCCESS))) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_TENGRAL_KQ404_GRAYSON_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_KQ404_Grayson_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_KQ404_Grayson_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_KQ404_Grayson_03_03");
    AI_STARTFACEANI(SELF, S_SURPRISE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_KQ404_Grayson_03_04");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_KQ404_Grayson_15_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_KQ404_Grayson_03_06");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_KQ404_Grayson_15_07");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_KQ404_Grayson_03_08");
}

instance DIA_TENGRAL_KQ404_FIREMAGEARMOR(C_INFO) {
    NPC = 55422;
    NR = 1;
    CONDITION = DIA_TENGRAL_KQ404_FIREMAGEARMOR_CONDITION;
    INFORMATION = DIA_TENGRAL_KQ404_FIREMAGEARMOR_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "I need two of your robes.";
}

func int DIA_TENGRAL_KQ404_FIREMAGEARMOR_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_KQ404)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 65444))) && ((INEXTREMO_CANPLAYCONCERT) == (TRUE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_TENGRAL_KQ404_FIREMAGEARMOR_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_KQ404_FireMageArmor_15_01");
    AI_STARTFACEANI(SELF, S_SURPRISE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_KQ404_FireMageArmor_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_KQ404_FireMageArmor_15_03");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_KQ404_FireMageArmor_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_KQ404_FireMageArmor_03_05");
    AI_LOGENTRY(TOPIC_KQ404, LOG_KQ404_TENGRAL_NIGHT);
    NPC_EXCHANGEROUTINE(SELF, "KQ404_NIGHT");
}

instance DIA_TENGRAL_KQ404_NIGHTMEETING(C_INFO) {
    NPC = 55422;
    NR = 1;
    CONDITION = DIA_TENGRAL_KQ404_NIGHTMEETING_CONDITION;
    INFORMATION = DIA_TENGRAL_KQ404_NIGHTMEETING_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_TENGRAL_KQ404_NIGHTMEETING_CONDITION() {
    if ((((((LOG_GETSTATUS(MIS_KQ404)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 65447))) && (WLD_ISTIME(22, 0, 8, 0))) && ((INEXTREMO_CANPLAYCONCERT) == (TRUE))) && ((NPC_GETDISTTOWP(SELF, "PARTM1_PATH_66")) <= (1500))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_TENGRAL_KQ404_NIGHTMEETING_INFO() {
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_STARTFACEANI(OTHER, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_KQ404_NightMeeting_03_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_KQ404_NightMeeting_15_02");
    AI_RESETFACEANI(OTHER);
    CREATEINVITEMS(SELF, 37332, 2);
    B_GIVEINVITEMS(SELF, OTHER, 37332, 2);
    AI_STOPPROCESSINFOS(SELF);
    NPC_EXCHANGEROUTINE(SELF, START);
}

instance DIA_TENGRAL_SQ505_GOODCHOICE(C_INFO) {
    NPC = 55422;
    NR = 1;
    CONDITION = DIA_TENGRAL_SQ505_GOODCHOICE_CONDITION;
    INFORMATION = DIA_TENGRAL_SQ505_GOODCHOICE_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_TENGRAL_SQ505_GOODCHOICE_CONDITION() {
    if (((LOG_GETSTATUS(MIS_SQ505)) == (LOG_RUNNING)) && ((SQ505_YOUNGVOLKERGUARD_GRAVE) == (2))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_TENGRAL_SQ505_GOODCHOICE_INFO() {
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ505_GoodChoice_03_01");
    AI_STARTFACEANI(SELF, S_TIRED, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ505_GoodChoice_03_02");
    AI_STARTFACEANI(SELF, S_SAD, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ505_GoodChoice_03_03");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_SQ505_GoodChoice_03_04");
    AI_RESETFACEANI(SELF);
    NPC_EXCHANGEROUTINE(SELF, START);
    AI_LOGENTRY(TOPIC_SQ505, LOG_SQ505_YOUNGVOLKERGUARD_GRAVE_V2);
    SQ505_VOLKERGUARDS_M3_WAIT();
}

instance DIA_TENGRAL_CANYOUTEACH(C_INFO) {
    NPC = 55422;
    NR = 1;
    CONDITION = DIA_TENGRAL_CANYOUTEACH_CONDITION;
    INFORMATION = DIA_TENGRAL_CANYOUTEACH_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Can you teach me something about magic?";
}

func int DIA_TENGRAL_CANYOUTEACH_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_KQ404)) == (LOG_SUCCESS)) || ((LOG_GETSTATUS(MIS_SQ309)) == (LOG_SUCCESS))) || ((LOG_GETSTATUS(MIS_CQ005)) == (LOG_SUCCESS))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_TENGRAL_CANYOUTEACH_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_CanYouTeach_15_01");
    if ((HERO.GUILD) == (GIL_MIL)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CanYouTeach_03_02");
        AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CanYouTeach_03_03");
        LOG_CREATETOPIC(TOPIC_CITYTEACHER, LOG_NOTE);
        AI_LOGENTRY(TOPIC_CITYTEACHER, LOG_TEACHER_TENGRAL);
    };
    if ((HERO.GUILD) == (GIL_SLD)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CanYouTeach_03_04");
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_CanYouTeach_03_05");
    LOG_CREATETOPIC(TOPIC_CITYTEACHER, LOG_NOTE);
    AI_LOGENTRY(TOPIC_CITYTEACHER, LOG_TEACHER_TENGRAL_NOTYET);
}

var string TENGRAL_PRINTS;
var int TENGRALCURRENTMANALEVEL;
var int TENGRAL_NOMORE;
instance DIA_TENGRAL_TEACH(C_INFO) {
    NPC = 55422;
    NR = 99;
    CONDITION = DIA_TENGRAL_TEACH_CONDITION;
    INFORMATION = DIA_TENGRAL_TEACH_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "Increase my magic power.";
}

func int DIA_TENGRAL_TEACH_CONDITION() {
    if (((NPC_KNOWSINFO(OTHER, 65456)) && ((TENGRAL_NOMORE) == (FALSE))) && ((HERO.GUILD) == (GIL_MIL))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_TENGRAL_TEACH_CHOICES() {
    var int TENGRAL_GOLDCOST;
    TENGRAL_GOLDCOST = 25;
    TENGRALCURRENTMANALEVEL = OTHER.AIVAR[83];
    INFO_CLEARCHOICES(65462);
    INFO_ADDCHOICE(65462, DIALOG_BACK, 65467);
    INFO_ADDCHOICE(65462, B_BUILDLEARNSTRING2(PRINT_LEARNMANA1, B_GETLEARNCOSTATTRIBUTE(OTHER, ATR_MANA_MAX, 1), TENGRAL_GOLDCOST), 65468);
    INFO_ADDCHOICE(65462, B_BUILDLEARNSTRING2(PRINT_LEARNMANA5, B_GETLEARNCOSTATTRIBUTE(OTHER, ATR_MANA_MAX, 5), (TENGRAL_GOLDCOST) * (5)), 65469);
}

func void DIA_TENGRAL_TEACH_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_TEACH_15_00");
    if ((OTHER.AIVAR[83]) < (150)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Tengral_TEACH_13_01");
        DIA_TENGRAL_TEACH_CHOICES();
    };
    if ((OTHER.AIVAR[83]) >= (150)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Tengral_TEACH_13_02");
        TENGRAL_NOMORE = TRUE;
    };
}

func void DIA_TENGRAL_TEACH_BACK() {
    INFO_CLEARCHOICES(65462);
}

func void DIA_TENGRAL_TEACH1() {
    if ((NPC_HASITEMS(OTHER, 34203)) >= (TENGRAL_PAYMENT1)) {
        if ((TENGRALCURRENTMANALEVEL) < (OTHER.AIVAR[83])) {
            SND_PLAY(GELDBEUTEL);
            B_GIVEINVITEMS(OTHER, SELF, 34203, TENGRAL_PAYMENT1);
            NPC_REMOVEINVITEMS(SELF, 34203, TENGRAL_PAYMENT1);
        };
        B_TEACHATTRIBUTEPOINTS(SELF, OTHER, ATR_MANA_MAX, 1, 150);
        DIA_TENGRAL_TEACH_CHOICES();
    };
    if ((NPC_HASITEMS(OTHER, 34203)) < (TENGRAL_PAYMENT1)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Tengral_Teach1_13_01");
        TENGRAL_PRINTS = CONCATSTRINGS(PRINT_RGOLD, INTTOSTRING(TENGRAL_PAYMENT1));
        PRINTSCREEN(TENGRAL_PRINTS, -(1), -(1), FONT_SCREEN, 2);
        DIA_TENGRAL_TEACH_CHOICES();
    };
}

func void DIA_TENGRAL_TEACH5() {
    if ((NPC_HASITEMS(OTHER, 34203)) >= (TENGRAL_PAYMENT5)) {
        if ((TENGRALCURRENTMANALEVEL) < (OTHER.AIVAR[83])) {
            SND_PLAY(GELDBEUTEL);
            B_GIVEINVITEMS(OTHER, SELF, 34203, TENGRAL_PAYMENT5);
            NPC_REMOVEINVITEMS(SELF, 34203, TENGRAL_PAYMENT5);
        };
        B_TEACHATTRIBUTEPOINTS(SELF, OTHER, ATR_MANA_MAX, 5, 150);
        DIA_TENGRAL_TEACH_CHOICES();
    };
    if ((NPC_HASITEMS(OTHER, 34203)) < (TENGRAL_PAYMENT5)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Tengral_Teach5_13_01");
        TENGRAL_PRINTS = CONCATSTRINGS(PRINT_RGOLD, INTTOSTRING(TENGRAL_PAYMENT5));
        PRINTSCREEN(TENGRAL_PRINTS, -(1), -(1), FONT_SCREEN, 2);
        DIA_TENGRAL_TEACH_CHOICES();
    };
}

instance DIA_TENGRAL_DIDYOUEVERHEAR(C_INFO) {
    NPC = 55422;
    NR = 1;
    CONDITION = DIA_TENGRAL_DIDYOUEVERHEAR_CONDITION;
    INFORMATION = DIA_TENGRAL_DIDYOUEVERHEAR_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_TENGRAL_DIDYOUEVERHEAR_CONDITION() {
    if (((NPC_ISINSTATE(SELF, 61599)) && ((NPC_GETDISTTOWP(SELF, "PARTM8_PATH_PREACH")) <= (500))) && (WLD_ISTIME(13, 0, 14, 0))) {
        return FALSE;
    };
    if ((((LOG_GETSTATUS(MIS_KQ404)) == (LOG_SUCCESS)) && ((LOG_GETSTATUS(MIS_SQ309)) == (LOG_SUCCESS))) && ((LOG_GETSTATUS(MIS_CQ005)) == (LOG_SUCCESS))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_TENGRAL_DIDYOUEVERHEAR_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_DidYouEverHear_03_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_DidYouEverHear_15_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_DidYouEverHear_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_DidYouEverHear_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_DidYouEverHear_03_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_DidYouEverHear_03_06");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_DidYouEverHear_03_07");
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_DidYouEverHear_15_08");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_DidYouEverHear_03_09");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_DidYouEverHear_03_10");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_DidYouEverHear_03_11");
}

instance DIA_TENGRAL_Q505_HELP(C_INFO) {
    NPC = 55422;
    NR = 1;
    CONDITION = DIA_TENGRAL_Q505_HELP_CONDITION;
    INFORMATION = DIA_TENGRAL_Q505_HELP_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "I'm on my way to the ruins of Vardhal, could you assist me in any way?";
}

func int DIA_TENGRAL_Q505_HELP_CONDITION() {
    if (((LOG_GETSTATUS(MIS_Q505)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 80244))) {
        if ((((LOG_GETSTATUS(MIS_CQ005)) == (LOG_SUCCESS)) && ((CQ005_ENDING) == (1))) && ((LOG_GETSTATUS(MIS_SQ313)) == (LOG_SUCCESS))) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_TENGRAL_Q505_HELP_INFO() {
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Tengral_Q505_Help_15_01");
    AI_STARTFACEANI(SELF, S_TIRED, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_Q505_Help_03_02");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_Q505_Help_03_03");
    CREATEINVITEMS(SELF, 37593, 1);
    B_GIVEINVITEMS(SELF, OTHER, 37593, 1);
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
}

instance DIA_TENGRAL_MAGICRUNE(C_INFO) {
    NPC = 55422;
    NR = 70;
    CONDITION = DIA_TENGRAL_MAGICRUNE_CONDITION;
    INFORMATION = DIA_TENGRAL_MAGICRUNE_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Can you tell me anything about this stone?";
}

func int DIA_TENGRAL_MAGICRUNE_CONDITION() {
    if ((C_GOTANYKINDOFRUNE(HERO)) && ((SELLINGRUNES_INFO) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_TENGRAL_MAGICRUNE_INFO() {
    SELLINGRUNES_INFO = TRUE;
    B_SAY(OTHER, SELF, "$MARVIN_AskMagicRune");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_MagicRune_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_MagicRune_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Tengral_MagicRune_03_04");
    LOG_CREATETOPIC(TOPIC_BARTER, LOG_NOTE);
    AI_LOGENTRY(TOPIC_BARTER, LOG_CITYBARTER_LAUDUS);
}

instance DIA_TENGRAL_TRADE(C_INFO) {
    NPC = 55422;
    NR = 940;
    CONDITION = DIA_TENGRAL_TRADE_CONDITION;
    INFORMATION = DIA_TENGRAL_TRADE_INFO;
    PERMANENT = TRUE;
    TRADE = TRUE;
    DESCRIPTION = "Let's deal.";
}

func int DIA_TENGRAL_TRADE_CONDITION() {
    if (NPC_KNOWSINFO(OTHER, 65401)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_TENGRAL_TRADE_INFO() {
    var int TENGRAL_TRADE_CHECKINFO;
    B_SAY(OTHER, SELF, "$MARVIN_LetsTrade");
    B_GIVETRADEINV(SELF);
    if ((TENGRAL_TRADE_CHECKINFO) == (FALSE)) {
        TENGRAL_TRADE_CHECKINFO = TRUE;
        LOG_CREATETOPIC(TOPIC_CITYTRADER, LOG_NOTE);
        AI_LOGENTRY(TOPIC_CITYTRADER, LOG_TRADER_CITY_TENGRAL);
    };
}

instance DIA_TENGRAL_BUSYCHURH(C_INFO) {
    NPC = 55422;
    NR = 1;
    CONDITION = DIA_TENGRAL_BUSYCHURH_CONDITION;
    INFORMATION = DIA_TENGRAL_BUSYCHURH_INFO;
    PERMANENT = TRUE;
    IMPORTANT = TRUE;
}

func int DIA_TENGRAL_BUSYCHURH_CONDITION() {
    if (((NPC_ISINSTATE(SELF, 61599)) && ((NPC_GETDISTTOWP(SELF, "PARTM8_PATH_PREACH")) <= (500))) && (WLD_ISTIME(13, 0, 14, 0))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_TENGRAL_BUSYCHURH_INFO() {
    DIA_IMBUSY_CALM();
}

instance DIA_TENGRAL_PICKPOCKET(C_INFO) {
    NPC = 55422;
    NR = 900;
    CONDITION = DIA_TENGRAL_PICKPOCKET_CONDITION;
    INFORMATION = DIA_TENGRAL_PICKPOCKET_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = PICKPOCKET_80;
}

func int DIA_TENGRAL_PICKPOCKET_CONDITION() {
    if (((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_PICKPOCKET)) >= (1)) && ((SELF.AIVAR[6]) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_TENGRAL_PICKPOCKET_INFO() {
    INFO_CLEARCHOICES(65486);
    INFO_ADDCHOICE(65486, DIALOG_BACK, 65490);
    INFO_ADDCHOICE(65486, DIALOG_PICKPOCKET, 65489);
}

func void DIA_TENGRAL_PICKPOCKET_DOIT() {
    if ((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_PICKPOCKET)) >= (2)) {
        CREATEINVITEMS(SELF, 38248, 1);
        B_GIVEINVITEMS(SELF, OTHER, 38248, 1);
        B_PICKPOCKET_AMBIENT_TIER_2();
        SELF.AIVAR[6] = TRUE;
        INFO_CLEARCHOICES(65486);
    };
    AI_PLAYANI(HERO, T_CANNOTTAKE);
    PRINTSCREEN(PRINT_CANTPICKPOCKETTHISPERSON, -(1), -(1), FONT_SCREEN, 4);
    INFO_CLEARCHOICES(65486);
}

func void DIA_TENGRAL_PICKPOCKET_BACK() {
    INFO_CLEARCHOICES(65486);
}

