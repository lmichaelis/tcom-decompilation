func void SQ416_ALLANCORPSE_S1() {
    var C_NPC HER;
    HER = HLP_GETNPC(50091);
    if ((HLP_GETINSTANCEID(SELF)) == (HLP_GETINSTANCEID(HER))) {
        if ((LOG_GETSTATUS(MIS_CQ002)) == (LOG_RUNNING)) {
            LOG_SETSTATUS(_@(MIS_CQ002), TOPIC_CQ002, LOG_FAILED);
            B_LOGENTRY(TOPIC_CQ002, LOG_CQ002_ALLANISDEAD);
        };
        SELF.AIVAR[4] = TRUE;
        PLAYER_MOBSI_PRODUCTION = MOBSI_ALLANCORPSE;
        AI_PROCESSINFOS(HER);
    };
}

func int PC_SQ416_ALLANCORPSE_CONDITION() {
    if ((PLAYER_MOBSI_PRODUCTION) == (MOBSI_ALLANCORPSE)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func int PC_SQ416_ALLANCORPSE_CHECK_CONDITION() {
    if (((PLAYER_MOBSI_PRODUCTION) == (MOBSI_ALLANCORPSE)) && ((SQ416_CHECKEDALLANCORPSE) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

instance PC_SQ416_ALLANCORPSE_END(C_INFO) {
    NPC = 50091;
    NR = 999;
    CONDITION = PC_SQ416_ALLANCORPSE_CONDITION;
    INFORMATION = PC_SQ416_ALLANCORPSE_END_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func void PC_SQ416_ALLANCORPSE_END_INFO() {
    AI_STOPPROCESSINFOS(SELF);
    SELF.AIVAR[4] = FALSE;
    PLAYER_MOBSI_PRODUCTION = MOBSI_NONE;
}

instance PC_SQ416_ALLANCORPSE_CHECKSCAR(C_INFO) {
    NPC = 50091;
    CONDITION = PC_SQ416_ALLANCORPSE_CHECK_CONDITION;
    INFORMATION = PC_SQ416_ALLANCORPSE_CHECKSCAR_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = DIALOG_CHECKWOUNDS;
}

func void PC_SQ416_ALLANCORPSE_CHECKSCAR_INFO() {
    SQ416_CHECKEDALLANCORPSE = TRUE;
    AI_PLAYANI(OTHER, "T_CHESTSMALL_S0_2_STAND");
    AI_PLAYANI(OTHER, T_PLUNDER);
    AI_PLAYANI(OTHER, "T_CHESTSMALL_STAND_2_S0");
    AI_OUTPUT(OTHER, SELF, "DIA_SQ416_AllanCorpse_CheckScar_15_01");
    SQ416_DETLOWSUSPECT_COUNT();
    AI_STOPPROCESSINFOS(SELF);
    SELF.AIVAR[4] = FALSE;
    PLAYER_MOBSI_PRODUCTION = MOBSI_NONE;
    AI_FUNCTION(SELF, 63560);
}

instance PC_SQ416_ALLANCORPSE_CHECKHORN(C_INFO) {
    NPC = 50091;
    CONDITION = PC_SQ416_ALLANCORPSE_CHECK_CONDITION;
    INFORMATION = PC_SQ416_ALLANCORPSE_CHECKHORN_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = DIALOG_CHECKHORN;
}

func void PC_SQ416_ALLANCORPSE_CHECKHORN_INFO() {
    SQ416_CHECKEDALLANCORPSE = TRUE;
    AI_PLAYANI(OTHER, "T_CHESTSMALL_S0_2_STAND");
    AI_PLAYANI(OTHER, T_PLUNDER);
    AI_PLAYANI(OTHER, "T_CHESTSMALL_STAND_2_S0");
    AI_OUTPUT(OTHER, SELF, "DIA_SQ416_AllanCorpse_CheckHorn_15_01");
    AI_STOPPROCESSINFOS(SELF);
    SELF.AIVAR[4] = FALSE;
    PLAYER_MOBSI_PRODUCTION = MOBSI_NONE;
    AI_FUNCTION(SELF, 63560);
}

