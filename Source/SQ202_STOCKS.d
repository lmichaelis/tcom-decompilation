instance SQ202_STOCKS(CUTSCENE) {
    ONSTART = FUNCTION(92884);
}

func void SQ202_STOCKS_START() {
    TELEPORTNPCTOWP(1819, "VILLAGE_PATH_147");
    if ((NPC_HASEQUIPPEDARMOR(HERO)) == (TRUE)) {
        AI_UNEQUIPARMOR(HERO);
    };
    if ((!(C_BODYSTATECONTAINS(HERO, BS_SIT))) && (WLD_ISMOBAVAILABLE(HERO, "IMPRISONED"))) {
        AI_USEMOB(HERO, "IMPRISONED", 1);
    };
    B_STARTOTHERROUTINE(NONE_11048_HENKER, "SQ202");
    B_STARTOTHERROUTINE(BAU_11028_FARMER, "SQ202");
    B_STARTOTHERROUTINE(BAU_11035_FARMER, "SQ202");
    B_STARTOTHERROUTINE(BAU_11015_FARMER, "SQ202");
    B_STARTOTHERROUTINE(BAU_11032_FARMER, "SQ202");
    B_STARTOTHERROUTINE(BAU_11019_FARMER, "SQ202");
    B_STARTOTHERROUTINE(BAU_724_PAULUS, "SQ202");
    NPC_REFRESH(NONE_11048_HENKER);
    NPC_REFRESH(BAU_11028_FARMER);
    NPC_REFRESH(BAU_11035_FARMER);
    NPC_REFRESH(BAU_11015_FARMER);
    NPC_REFRESH(BAU_11032_FARMER);
    NPC_REFRESH(BAU_11019_FARMER);
    NPC_REFRESH(BAU_724_PAULUS);
    if ((SQ202_HARRYBUSTED) == (TRUE)) {
        B_STARTOTHERROUTINE(MIL_707_HARRY, "STOCKS");
        NPC_REFRESH(MIL_707_HARRY);
    };
    B_PASSTIME(1);
    FF_APPLYONCEEXT(92885, 1000, 17);
}

func void SQ202_CUTSCENE_TIMER() {
    var int SQ202CUTSCENECOUNT;
    SQ202CUTSCENECOUNT = (SQ202CUTSCENECOUNT) + (1);
    PRINTD(INTTOSTRING(SQ202CUTSCENECOUNT));
    if ((SQ202CUTSCENECOUNT) == (1)) {
        WLD_SENDTRIGGER("KM_STOCKS_01");
    };
    if ((SQ202CUTSCENECOUNT) == (2)) {
        HERO.AIVAR[4] = FALSE;
        FADESCREENFROMBLACK(2);
    };
    if ((SQ202CUTSCENECOUNT) == (6)) {
        if ((SQ202_HARRYBUSTED) == (TRUE)) {
            NPC_REFRESH(MIL_707_HARRY);
        };
        WLD_SENDUNTRIGGER("KM_STOCKS_01");
        WLD_SENDTRIGGER("KM_STOCKS_02");
    };
    if ((SQ202CUTSCENECOUNT) == (11)) {
        if ((SQ202_HARRYBUSTED) == (TRUE)) {
            AI_STARTFACEANI(MIL_707_HARRY, S_SMUG, 1, -(1));
        };
        WLD_SENDUNTRIGGER("KM_STOCKS_02");
        WLD_SENDTRIGGER("KM_STOCKS_03");
    };
    if ((SQ202CUTSCENECOUNT) == (15)) {
        AI_FUNCTION(HERO, 92887);
    };
}

func void SQ202_CUTSCENE_END() {
    SQ202_CANUSESTOCKS = FALSE;
    FADESCREENTOBLACKF(2, 92888, 1000);
}

func void SQ202_CUTSCENE_END_FADESCREEN() {
    FF_APPLYONCEEXT(62712, 75, 4);
}

