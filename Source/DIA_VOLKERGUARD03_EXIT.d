instance DIA_VOLKERGUARD03_EXIT(C_INFO) {
    NPC = 53197;
    NR = 999;
    CONDITION = DIA_VOLKERGUARD03_EXIT_CONDITION;
    INFORMATION = DIA_VOLKERGUARD03_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_VOLKERGUARD03_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_VOLKERGUARD03_EXIT_INFO() {
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_VOLKERGUARD03_INTRUDER(C_INFO) {
    NPC = 53197;
    NR = 1;
    CONDITION = DIA_VOLKERGUARD03_INTRUDER_CONDITION;
    INFORMATION = DIA_VOLKERGUARD03_INTRUDER_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_VOLKERGUARD03_INTRUDER_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_Q405)) == (LOG_RUNNING)) && ((Q405_VOLKERGUARDSATTACK) == (0))) && ((Q405_DIALOGUEWITHVOLKERGUARDS) == (0))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_VOLKERGUARD03_INTRUDER_INFO() {
    INFO_CLEARCHOICES(69173);
    INFO_ADDCHOICE(69173, "Who are you?", 69177);
    INFO_ADDCHOICE(69173, "What are you doing here?", 69178);
    INFO_ADDCHOICE(69173, "I work for Volker, too.", 69179);
}

func void DIA_VOLKERGUARD03_BADCHOICE() {
    AI_PLAYANI(SELF, T_SEARCH);
    AI_OUTPUT(SELF, OTHER, "DIA_VolkerGuard03_Intruder_Works_03_04");
    INFO_CLEARCHOICES(69173);
    AI_STOPPROCESSINFOS(SELF);
    AI_FUNCTION(SELF, 63825);
    AI_FUNCTION(SELF, 63826);
}

func void DIA_VOLKERGUARD03_INTRUDER_WHO() {
    AI_OUTPUT(OTHER, SELF, "DIA_VolkerGuard03_Intruder_Who_15_01");
    DIA_VOLKERGUARD03_BADCHOICE();
}

func void DIA_VOLKERGUARD03_INTRUDER_WHAT() {
    AI_OUTPUT(OTHER, SELF, "DIA_VolkerGuard03_Intruder_What_15_01");
    DIA_VOLKERGUARD03_BADCHOICE();
}

func void DIA_VOLKERGUARD03_INTRUDER_WORKS() {
    var C_ITEM ITM;
    AI_OUTPUT(OTHER, SELF, "DIA_VolkerGuard03_Intruder_Works_15_01");
    if ((NPC_HASEQUIPPEDARMOR(OTHER)) == (TRUE)) {
        ITM = NPC_GETEQUIPPEDARMOR(OTHER);
        if (((HLP_ISITEM(ITM, 35479)) == (TRUE)) || ((HLP_ISITEM(ITM, 35478)) == (TRUE))) {
            Q405_DIALOGUEWITHVOLKERGUARDS = 1;
            AI_OUTPUT(SELF, OTHER, "DIA_VolkerGuard03_Intruder_Works_03_02");
            AI_OUTPUT(SELF, OTHER, "DIA_VolkerGuard03_Intruder_Works_03_03");
            AI_LOGENTRY(TOPIC_Q405, LOG_Q405_VOLKERGUARDSNOATTACK);
            INFO_CLEARCHOICES(69173);
            AI_STOPPROCESSINFOS(SELF);
        } else {
            DIA_VOLKERGUARD03_BADCHOICE();
        };
    };
    DIA_VOLKERGUARD03_BADCHOICE();
}

