instance Q514_VOLFZACKETREASURYENTERCUTSCENE(CUTSCENE) {
    ONSTART = FUNCTION(92701);
}

func void Q514_VOLFZACKETREASURYENTERCUTSCENE_START() {
    if ((NPC_ISDEAD(GARGOYLE_STORY_02)) == (FALSE)) {
        B_REMOVENPC(50423);
    };
    if ((NPC_ISDEAD(GARGOYLE_STORY_03)) == (FALSE)) {
        B_REMOVENPC(50424);
    };
    Q514_CATACOMBS_FINISH = 1;
    DIACAM_DISABLE();
    WLD_SENDTRIGGER("VZ_TREASURY_CAMERA_01");
    WLD_SENDTRIGGER("VZ_TREASURY_DOOR_ENTRY_MOVER");
    WLD_PLAYEFFECT("FX_EarthQuake", HERO, HERO, 0, 0, 0, FALSE);
    SND_PLAY("MFX_EarthQuake");
    B_LOGENTRY(TOPIC_Q514, LOG_Q514_CATACOMBS_FINISH);
    TELEPORTNPCTOWP(1819, "VOLFZACK_CATACOMBS_67");
    AI_WAIT(HERO, 1067030938);
    AI_PLAYANI(HERO, R_SCRATCHLSHOULDER);
    FF_APPLYONCEEXT(92703, 1000, 17);
}

func void Q514_VOLFZACKETREASURYENTERCUTSCENE_WAIT() {
    AI_WAITTILLEND(NONE_202_KESSEL_VZ, HERO);
    AI_WAITTILLEND(NONE_202_KESSEL_VZ, NONE_11037_MARKUS_VZ);
    AI_WAITTILLEND(NONE_202_KESSEL_VZ, MIL_63710_DUSTER_VZ);
    AI_WAITTILLEND(NONE_11037_MARKUS_VZ, HERO);
    AI_WAITTILLEND(NONE_11037_MARKUS_VZ, NONE_202_KESSEL_VZ);
    AI_WAITTILLEND(NONE_11037_MARKUS_VZ, MIL_63710_DUSTER_VZ);
    AI_WAITTILLEND(MIL_63710_DUSTER_VZ, HERO);
    AI_WAITTILLEND(MIL_63710_DUSTER_VZ, NONE_202_KESSEL_VZ);
    AI_WAITTILLEND(MIL_63710_DUSTER_VZ, NONE_11037_MARKUS_VZ);
    AI_WAITTILLEND(HERO, NONE_11037_MARKUS_VZ);
    AI_WAITTILLEND(HERO, MIL_63710_DUSTER_VZ);
    AI_WAITTILLEND(HERO, NONE_202_KESSEL_VZ);
}

func void Q514_VOLFZACKETREASURYENTERCUTSCENE_TIMER() {
    var int Q514_VOLFZACKETREASURYENTERCUTSCENE_TIMER_COUNT;
    Q514_VOLFZACKETREASURYENTERCUTSCENE_TIMER_COUNT = (Q514_VOLFZACKETREASURYENTERCUTSCENE_TIMER_COUNT) + (1);
    if ((Q514_VOLFZACKETREASURYENTERCUTSCENE_TIMER_COUNT) == (5)) {
        WLD_SENDTRIGGER("VZ_TREASURY_CAMERA_02");
        WLD_SENDUNTRIGGER("VZ_TREASURY_CAMERA_01");
        B_STARTOTHERROUTINE(NONE_202_KESSEL_VZ, "TREASURYFOLLOW");
        NPC_REFRESH(NONE_202_KESSEL_VZ);
        TELEPORTNPCTOWP(59259, NONE_202_KESSEL_VZ.WP);
        B_STARTOTHERROUTINE(NONE_11037_MARKUS_VZ, "TREASURYFOLLOW");
        NPC_REFRESH(NONE_11037_MARKUS_VZ);
        TELEPORTNPCTOWP(59206, NONE_11037_MARKUS_VZ.WP);
        B_STARTOTHERROUTINE(MIL_63710_DUSTER_VZ, "TREASURYFOLLOW");
        NPC_REFRESH(MIL_63710_DUSTER_VZ);
        TELEPORTNPCTOWP(59184, MIL_63710_DUSTER_VZ.WP);
        TELEPORTNPCTOWP(1819, "VOLFZACK_TREASURY_01");
        AI_SETWALKMODE(HERO, NPC_WALK);
        AI_SETWALKMODE(NONE_202_KESSEL_VZ, NPC_RUN);
        AI_SETWALKMODE(NONE_11037_MARKUS_VZ, NPC_RUN);
        AI_SETWALKMODE(MIL_63710_DUSTER_VZ, NPC_RUN);
        AI_GOTOWP(HERO, "VOLFZACK_TREASURY_HERO_01");
        AI_PLAYANI(HERO, T_SEARCH);
    };
    if ((Q514_VOLFZACKETREASURYENTERCUTSCENE_TIMER_COUNT) == (16)) {
        TELEPORTNPCTOWP(59259, NONE_202_KESSEL_VZ.WP);
        TELEPORTNPCTOWP(59206, NONE_11037_MARKUS_VZ.WP);
        TELEPORTNPCTOWP(59184, MIL_63710_DUSTER_VZ.WP);
        NPC_CLEARAIQUEUE(NONE_202_KESSEL_VZ);
        NPC_CLEARAIQUEUE(NONE_11037_MARKUS_VZ);
        NPC_CLEARAIQUEUE(MIL_63710_DUSTER_VZ);
        AI_SETWALKMODE(NONE_202_KESSEL_VZ, NPC_RUN);
        AI_SETWALKMODE(NONE_11037_MARKUS_VZ, NPC_RUN);
        AI_SETWALKMODE(MIL_63710_DUSTER_VZ, NPC_RUN);
        AI_GOTOWP(NONE_202_KESSEL_VZ, "VOLFZACK_TREASURY_KESSEL_CUTSCENE_01");
        AI_GOTOWP(NONE_11037_MARKUS_VZ, "VOLFZACK_TREASURY_MARKUS_CUTSCENE_01");
        AI_GOTOWP(MIL_63710_DUSTER_VZ, "VOLFZACK_TREASURY_DACK_CUTSCENE_01");
    };
    if ((Q514_VOLFZACKETREASURYENTERCUTSCENE_TIMER_COUNT) == (17)) {
        WLD_SENDTRIGGER("VZ_TREASURY_CAMERA_03");
        WLD_SENDUNTRIGGER("VZ_TREASURY_CAMERA_02");
        TELEPORTNPCTOWP(1819, "VOLFZACK_TREASURY_HERO_01");
        AI_TURNTONPC(HERO, NONE_202_KESSEL_VZ);
        AI_PLAYANI(HERO, R_SCRATCHHEAD);
        Q514_VOLFZACKETREASURYENTERCUTSCENE_WAIT();
    };
}

