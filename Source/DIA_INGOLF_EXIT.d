instance DIA_INGOLF_EXIT(C_INFO) {
    NPC = 56676;
    NR = 999;
    CONDITION = DIA_INGOLF_EXIT_CONDITION;
    INFORMATION = DIA_INGOLF_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_INGOLF_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_INGOLF_EXIT_INFO() {
    AI_STOPPROCESSINFOS(SELF);
    RUNESTRADE_CHECKBOUGHTRUNES();
}

instance DIA_INGOLF_Q601_PEACEKEEPER(C_INFO) {
    NPC = 56676;
    NR = 1;
    CONDITION = DIA_INGOLF_Q601_PEACEKEEPER_CONDITION;
    INFORMATION = DIA_INGOLF_Q601_PEACEKEEPER_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_INGOLF_Q601_PEACEKEEPER_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_Q601)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 79910))) && ((NPC_GETDISTTOWP(SELF, "PART8_MONASTERY_MAGEROOM2_06")) <= (300))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_INGOLF_Q601_PEACEKEEPER_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_Q601_PeaceKeeper_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_Q601_PeaceKeeper_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_Q601_PeaceKeeper_03_03");
    AI_LOGENTRY(TOPIC_Q601, LOG_Q601_INGOLF_SEARCH);
    AI_STOPPROCESSINFOS(SELF);
    RUNESTRADE_CHECKBOUGHTRUNES();
    NPC_EXCHANGEROUTINE(SELF, "Q601_SEARCH");
    WLD_INSERTITEM(37624, "FP_Q601_INGOLFBOOK");
}

instance DIA_INGOLF_Q601_FOUNDBOOK(C_INFO) {
    NPC = 56676;
    NR = 1;
    CONDITION = DIA_INGOLF_Q601_FOUNDBOOK_CONDITION;
    INFORMATION = DIA_INGOLF_Q601_FOUNDBOOK_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_INGOLF_Q601_FOUNDBOOK_CONDITION() {
    if ((((NPC_KNOWSINFO(OTHER, 79950)) && ((LOG_GETSTATUS(MIS_Q601)) == (LOG_RUNNING))) && ((NPC_HASITEMS(OTHER, 37624)) >= (1))) && (NPC_ISINSTATE(SELF, 61599))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_INGOLF_Q601_FOUNDBOOK_INFO() {
    AI_FUNCTION(SELF, 79956);
    AI_OUTPUT(OTHER, SELF, "DIA_Ingolf_Q601_FoundBook_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_Q601_FoundBook_03_02");
    B_USEFAKESCROLL();
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_Q601_FoundBook_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_Q601_FoundBook_03_04");
    AI_FUNCTION(SELF, 79957);
    AI_STOPPROCESSINFOS(SELF);
    RUNESTRADE_CHECKBOUGHTRUNES();
    NPC_EXCHANGEROUTINE(SELF, "Q601_INGOLFHOUSE");
}

func void INGOLF_Q601_TELEPORTNOTGER() {
    TELEPORTNPCTOWP(56669, "PART8_MONASTERY_112");
    B_STARTOTHERROUTINE(KDW_215_NOTGER, "Q601_WAIT");
    NPC_REFRESH(KDW_215_NOTGER);
    TELEPORTNPCTOWP(56744, "PART8_MONASTERY_113");
    B_STARTOTHERROUTINE(NOV_203_NOVIZE, "Q601_SWEEPING");
    NPC_REFRESH(NOV_203_NOVIZE);
}

func void INGOLF_Q601_CHANGERTNNOTGER() {
    Q601_CHANGERTNNOTGER = 1;
}

instance DIA_INGOLF_SQ510_HELLO(C_INFO) {
    NPC = 56676;
    NR = 1;
    CONDITION = DIA_INGOLF_SQ510_HELLO_CONDITION;
    INFORMATION = DIA_INGOLF_SQ510_HELLO_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_INGOLF_SQ510_HELLO_CONDITION() {
    if (NPC_ISINSTATE(SELF, 61599)) {
        if (((Q501_MARVINGOTOSLEEP) == (4)) || ((Q501_MARVINGOTOSLEEP) == (5))) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_INGOLF_SQ510_HELLO_INFO() {
    AI_STARTFACEANI(SELF, S_SERIOUS, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Hello_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Hello_03_02");
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Hello_03_03");
    INFO_CLEARCHOICES(79958);
    INFO_ADDCHOICE(79958, "I just want to stop a dangerous man!", 79962);
    INFO_ADDCHOICE(79958, "What do you mean?", 79961);
}

func void DIA_INGOLF_SQ510_HELLO_WHAT() {
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Ingolf_SQ510_Hello_What_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Hello_What_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Hello_What_03_03");
    AI_RESETFACEANI(OTHER);
}

func void DIA_INGOLF_SQ510_HELLO_VOLKER() {
    AI_STARTFACEANI(OTHER, S_ANGRY, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Ingolf_SQ510_Hello_Volker_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Hello_Volker_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Hello_Volker_03_03");
    AI_RESETFACEANI(OTHER);
    INFO_CLEARCHOICES(79958);
    INFO_ADDCHOICE(79958, "You're wrong. You don't know anything about me.", 79964);
    INFO_ADDCHOICE(79958, "Maybe you're right...", 79965);
}

func void DIA_INGOLF_SQ510_HELLO_NEXT() {
    AI_RESETFACEANI(OTHER);
    AI_RESETFACEANI(SELF);
    B_STANDUP();
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Hello_Next_03_01");
    AI_STOPPROCESSINFOS(SELF);
    RUNESTRADE_CHECKBOUGHTRUNES();
    INFO_CLEARCHOICES(79958);
    AI_FUNCTION(SELF, 63361);
}

func void DIA_INGOLF_SQ510_HELLO_VOLKER_NO() {
    AI_STARTFACEANI(OTHER, S_ANGRY, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Ingolf_SQ510_Hello_No_15_01");
    AI_STARTFACEANI(SELF, S_SERIOUS, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Hello_No_03_02");
    DIA_INGOLF_SQ510_HELLO_NEXT();
}

func void DIA_INGOLF_SQ510_HELLO_VOLKER_YES() {
    AI_STARTFACEANI(OTHER, S_TIRED, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Ingolf_SQ510_Hello_Yes_15_01");
    AI_RESETFACEANI(SELF);
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Hello_Yes_03_02");
    DIA_INGOLF_SQ510_HELLO_NEXT();
}

instance DIA_INGOLF_SQ510_FINISH(C_INFO) {
    NPC = 56676;
    NR = 1;
    CONDITION = DIA_INGOLF_SQ510_FINISH_CONDITION;
    INFORMATION = DIA_INGOLF_SQ510_FINISH_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_INGOLF_SQ510_FINISH_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_SQ510)) == (LOG_RUNNING)) && ((SQ510_FINISHSTAGE) == (TRUE))) && ((LOG_GETSTATUS(MIS_Q514)) != (LOG_SUCCESS))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_INGOLF_SQ510_FINISH_INFO() {
    INFO_CLEARCHOICES(79966);
    INFO_ADDCHOICE(79966, "What was that supposed to teach me?", 79974);
    INFO_ADDCHOICE(79966, "You could have killed me!", 79973);
}

var int INGOLF_SQ510_FINISH_MISTAKE;
var int INGOLF_SQ510_FINISH_NOTHING;
func void DIA_INGOLF_SQ510_FINISH_CHOICES() {
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
    INFO_CLEARCHOICES(79966);
    if (((INGOLF_SQ510_FINISH_MISTAKE) == (TRUE)) || ((INGOLF_SQ510_FINISH_NOTHING) == (TRUE))) {
        INFO_ADDCHOICE(79966, "I've had enough of this nonsense.", 79979);
        INFO_ADDCHOICE(79966, "Thank you for your advice.", 79978);
    };
    if ((INGOLF_SQ510_FINISH_MISTAKE) == (FALSE)) {
        INFO_ADDCHOICE(79966, "Do you think I'm making a mistake doing what I'm doing?", 79976);
    };
    if ((INGOLF_SQ510_FINISH_NOTHING) == (FALSE)) {
        INFO_ADDCHOICE(79966, "So it's best to do nothing?", 79975);
    };
}

func void DIA_INGOLF_SQ510_FINISH_NEXT() {
    AI_STARTFACEANI(SELF, S_TIRED, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Finish_Next_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Finish_Next_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Finish_Next_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Finish_Next_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Finish_Next_03_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Finish_Next_03_06");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Finish_Next_03_07");
    DIA_INGOLF_SQ510_FINISH_CHOICES();
}

func void DIA_INGOLF_SQ510_FINISH_KILL() {
    AI_STARTFACEANI(OTHER, S_ANGRY, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Ingolf_SQ510_Finish_Kill_15_01");
    AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Finish_Kill_03_02");
    DIA_INGOLF_SQ510_FINISH_NEXT();
}

func void DIA_INGOLF_SQ510_FINISH_TEACH() {
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Ingolf_SQ510_Finish_Teach_15_01");
    AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Finish_Teach_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Finish_Teach_03_03");
    DIA_INGOLF_SQ510_FINISH_NEXT();
}

func void DIA_INGOLF_SQ510_FINISH_TEACH_NEXT_NOTHING() {
    INGOLF_SQ510_FINISH_NOTHING = TRUE;
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Ingolf_SQ510_Finish_Nothing_15_01");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Finish_Nothing_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Finish_Nothing_03_03");
    AI_STARTFACEANI(SELF, S_SERIOUS, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Finish_Nothing_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Finish_Nothing_03_05");
    DIA_INGOLF_SQ510_FINISH_CHOICES();
}

func void DIA_INGOLF_SQ510_FINISH_TEACH_NEXT_MISTAKE() {
    INGOLF_SQ510_FINISH_MISTAKE = TRUE;
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Ingolf_SQ510_Finish_Mistake_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Finish_Mistake_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Finish_Mistake_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Finish_Mistake_03_04");
    DIA_INGOLF_SQ510_FINISH_CHOICES();
}

func void DIA_INGOLF_SQ510_FINISHQUEST() {
    AI_RESETFACEANI(OTHER);
    AI_RESETFACEANI(SELF);
    INFO_CLEARCHOICES(79966);
    AI_LOGENTRY(TOPIC_SQ510, LOG_SQ510_FINISH);
    LOG_SETSTATUS(_@(MIS_SQ510), TOPIC_SQ510, LOG_SUCCESS);
    B_GIVEPLAYERXP(XP_SQ510_FINISH);
}

func void DIA_INGOLF_SQ510_FINISH_TEACH_NEXT_THANKS() {
    AI_STARTFACEANI(OTHER, S_SMILE, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Ingolf_SQ510_Finish_Thanks_15_01");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Finish_Thanks_03_02");
    DIA_INGOLF_SQ510_FINISHQUEST();
}

func void DIA_INGOLF_SQ510_FINISH_TEACH_NEXT_ENOUGH() {
    AI_STARTFACEANI(OTHER, S_ANGRY, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Ingolf_SQ510_Finish_Enough_15_01");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_SQ510_Finish_Enough_03_02");
    DIA_INGOLF_SQ510_FINISHQUEST();
}

instance DIA_INGOLF_AMBIENT(C_INFO) {
    NPC = 56676;
    NR = 990;
    CONDITION = DIA_INGOLF_AMBIENT_CONDITION;
    INFORMATION = DIA_INGOLF_AMBIENT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "How are you doing?";
}

func int DIA_INGOLF_AMBIENT_CONDITION() {
    if ((!(NPC_KNOWSINFO(OTHER, 79950))) && ((LOG_GETSTATUS(MIS_Q514)) != (LOG_SUCCESS))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_INGOLF_AMBIENT_INFO() {
    B_SAY(OTHER, SELF, "$MARVIN_WhatNew2");
    if ((LOG_GETSTATUS(MIS_SQ510)) != (LOG_SUCCESS)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_Ambient_03_01");
    };
    if ((LOG_GETSTATUS(MIS_SQ510)) == (LOG_SUCCESS)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_Ambient_03_02");
    };
}

instance DIA_INGOLF_WHATCANIFINDHERE(C_INFO) {
    NPC = 56676;
    NR = 2;
    CONDITION = DIA_INGOLF_WHATCANIFINDHERE_CONDITION;
    INFORMATION = DIA_INGOLF_WHATCANIFINDHERE_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "What can I find here?";
}

func int DIA_INGOLF_WHATCANIFINDHERE_CONDITION() {
    if ((!(NPC_KNOWSINFO(OTHER, 79950))) && ((LOG_GETSTATUS(MIS_Q514)) != (LOG_SUCCESS))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_INGOLF_WHATCANIFINDHERE_INFO() {
    B_SAY(OTHER, SELF, "$MARVIN_WhatCanIFindHere");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_WhatCanIFindHere_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_WhatCanIFindHere_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_WhatCanIFindHere_03_03");
}

instance DIA_INGOLF_CANSELL(C_INFO) {
    NPC = 56676;
    NR = 1;
    CONDITION = DIA_INGOLF_CANSELL_CONDITION;
    INFORMATION = DIA_INGOLF_CANSELL_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Could you sell me some magic items?";
}

func int DIA_INGOLF_CANSELL_CONDITION() {
    if (((NPC_KNOWSINFO(OTHER, 79540)) && (!(NPC_KNOWSINFO(OTHER, 79950)))) && ((LOG_GETSTATUS(MIS_Q514)) != (LOG_SUCCESS))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_INGOLF_CANSELL_INFO() {
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Ingolf_CanSell_15_01");
    AI_STARTFACEANI(SELF, S_THINK, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_CanSell_03_02");
    AI_STARTFACEANI(SELF, S_SERIOUS, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_CanSell_03_03");
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
    LOG_CREATETOPIC(TOPIC_MONASTERYTRADER, LOG_NOTE);
    AI_LOGENTRY(TOPIC_MONASTERYTRADER, LOG_TRADER_INGOLF);
}

instance DIA_INGOLF_TRADE(C_INFO) {
    NPC = 56676;
    NR = 100;
    CONDITION = DIA_INGOLF_TRADE_CONDITION;
    INFORMATION = DIA_INGOLF_TRADE_INFO;
    PERMANENT = TRUE;
    TRADE = TRUE;
    DESCRIPTION = "Let's trade!";
}

func int DIA_INGOLF_TRADE_CONDITION() {
    if (((NPC_KNOWSINFO(OTHER, 79986)) && (!(NPC_KNOWSINFO(OTHER, 79950)))) && ((LOG_GETSTATUS(MIS_Q514)) != (LOG_SUCCESS))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_INGOLF_TRADE_INFO() {
    B_SAY(OTHER, SELF, "$MARVIN_LetsTrade");
    B_GIVETRADEINV(SELF);
}

instance DIA_INGOLF_CANYOUTEACH(C_INFO) {
    NPC = 56676;
    NR = 1;
    CONDITION = DIA_INGOLF_CANYOUTEACH_CONDITION;
    INFORMATION = DIA_INGOLF_CANYOUTEACH_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Could you teach me something about magic?";
}

func int DIA_INGOLF_CANYOUTEACH_CONDITION() {
    if ((((NPC_KNOWSINFO(OTHER, 79540)) && (!(NPC_KNOWSINFO(OTHER, 79950)))) && ((LOG_GETSTATUS(MIS_Q514)) != (LOG_SUCCESS))) && (!(NPC_KNOWSINFO(OTHER, 79995)))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_INGOLF_CANYOUTEACH_INFO() {
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Ingolf_CanYouTeach_15_01");
    AI_STARTFACEANI(SELF, S_SERIOUS, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_CanYouTeach_03_02");
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
}

instance DIA_INGOLF_ONEOFUS(C_INFO) {
    NPC = 56676;
    NR = 1;
    CONDITION = DIA_INGOLF_ONEOFUS_CONDITION;
    INFORMATION = DIA_INGOLF_ONEOFUS_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_INGOLF_ONEOFUS_CONDITION() {
    if ((!(NPC_KNOWSINFO(OTHER, 79950))) && ((LOG_GETSTATUS(MIS_Q514)) != (LOG_SUCCESS))) {
        if ((((LOG_GETSTATUS(MIS_Q601)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 79910))) && ((NPC_GETDISTTOWP(SELF, "PART8_MONASTERY_MAGEROOM2_06")) <= (300))) {
            return FALSE;
        };
        if (((SQ504_JOINEDWATERCIRCLE) == (TRUE)) && ((SQ504_WEARINGRING) == (TRUE))) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_INGOLF_ONEOFUS_INFO() {
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_OneOfUs_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_OneOfUs_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_OneOfUs_03_03");
    CREATEINVITEMS(SELF, 37710, 1);
    B_GIVEINVITEMS(SELF, OTHER, 37710, 1);
    CREATEINVITEMS(SELF, 37714, 1);
    B_GIVEINVITEMS(SELF, OTHER, 37714, 1);
    CREATEINVITEMS(SELF, 37718, 1);
    B_GIVEINVITEMS(SELF, OTHER, 37718, 1);
    CREATEINVITEMS(SELF, 37702, 1);
    B_GIVEINVITEMS(SELF, OTHER, 37702, 1);
    CREATEINVITEMS(SELF, 37706, 1);
    B_GIVEINVITEMS(SELF, OTHER, 37706, 1);
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_OneOfUs_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Ingolf_OneOfUs_03_05");
    AI_RESETFACEANI(SELF);
    LOG_CREATETOPIC(TOPIC_MONASTERYTEACHER, LOG_NOTE);
    AI_LOGENTRY(TOPIC_MONASTERYTEACHER, LOG_TEACHMONASTERY_INGOLF);
}

instance DIA_INGOLF_TEACHMANA(C_INFO) {
    NPC = 56676;
    NR = 50;
    CONDITION = DIA_INGOLF_TEACHMANA_CONDITION;
    INFORMATION = DIA_INGOLF_TEACHMANA_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "Pass me some of your knowledge.";
}

var int INGOLF_CANTEACH;
func int DIA_INGOLF_TEACHMANA_CONDITION() {
    if ((((NPC_KNOWSINFO(OTHER, 79995)) && (!(NPC_KNOWSINFO(OTHER, 79950)))) && ((INGOLF_CANTEACH) == (FALSE))) && ((LOG_GETSTATUS(MIS_Q514)) != (LOG_SUCCESS))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_INGOLF_TEACHMANA_CHOICES() {
    var int INGOLF_GOLDCOST;
    INGOLF_GOLDCOST = 0;
    INFO_CLEARCHOICES(79998);
    INFO_ADDCHOICE(79998, DIALOG_BACK, 80005);
    INFO_ADDCHOICE(79998, B_BUILDLEARNSTRING2(PRINT_LEARNMANA1, B_GETLEARNCOSTATTRIBUTE(OTHER, ATR_MANA_MAX, 1), INGOLF_GOLDCOST), 80006);
    INFO_ADDCHOICE(79998, B_BUILDLEARNSTRING2(PRINT_LEARNMANA5, B_GETLEARNCOSTATTRIBUTE(OTHER, ATR_MANA_MAX, 5), (INGOLF_GOLDCOST) * (5)), 80007);
}

func void DIA_INGOLF_TEACHMANA_CHECKLEVEL() {
    if ((HERO.AIVAR[83]) >= (200)) {
        INGOLF_CANTEACH = TRUE;
        INFO_CLEARCHOICES(79998);
    };
    DIA_INGOLF_TEACHMANA_CHOICES();
}

func void DIA_INGOLF_TEACHMANA_INFO() {
    B_SAY(OTHER, SELF, "$MARVIN_TeachMeMystic");
    DIA_INGOLF_TEACHMANA_CHOICES();
}

func void DIA_INGOLF_TEACHMANA_BACK() {
    INFO_CLEARCHOICES(79998);
}

func void DIA_INGOLF_TEACHMANA1() {
    B_TEACHATTRIBUTEPOINTS(SELF, OTHER, ATR_MANA_MAX, 1, 200);
    DIA_INGOLF_TEACHMANA_CHECKLEVEL();
}

func void DIA_INGOLF_TEACHMANA5() {
    B_TEACHATTRIBUTEPOINTS(SELF, OTHER, ATR_MANA_MAX, 5, 200);
    DIA_INGOLF_TEACHMANA_CHECKLEVEL();
}

instance DIA_INGOLF_PICKPOCKET(C_INFO) {
    NPC = 56676;
    NR = 900;
    CONDITION = DIA_INGOLF_PICKPOCKET_CONDITION;
    INFORMATION = DIA_INGOLF_PICKPOCKET_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = PICKPOCKET_80;
}

func int DIA_INGOLF_PICKPOCKET_CONDITION() {
    if ((((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_PICKPOCKET)) >= (1)) && ((SELF.AIVAR[6]) == (FALSE))) && ((LOG_GETSTATUS(MIS_Q514)) != (LOG_SUCCESS))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_INGOLF_PICKPOCKET_INFO() {
    INFO_CLEARCHOICES(80008);
    INFO_ADDCHOICE(80008, DIALOG_BACK, 80012);
    INFO_ADDCHOICE(80008, DIALOG_PICKPOCKET, 80011);
}

func void DIA_INGOLF_PICKPOCKET_DOIT() {
    if ((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_PICKPOCKET)) >= (2)) {
        CREATEINVITEMS(SELF, 34701, 1);
        B_GIVEINVITEMS(SELF, OTHER, 34701, 1);
        B_PICKPOCKET_AMBIENT_TIER_2();
        SELF.AIVAR[6] = TRUE;
        INFO_CLEARCHOICES(80008);
    };
    AI_PLAYANI(HERO, T_CANNOTTAKE);
    PRINTSCREEN(PRINT_CANTPICKPOCKETTHISPERSON, -(1), -(1), FONT_SCREEN, 4);
    INFO_CLEARCHOICES(80008);
}

func void DIA_INGOLF_PICKPOCKET_BACK() {
    INFO_CLEARCHOICES(80008);
}

instance DIA_INGOLF_Q601_LETSGO(C_INFO) {
    NPC = 56676;
    NR = 1;
    CONDITION = DIA_INGOLF_Q601_LETSGO_CONDITION;
    INFORMATION = DIA_INGOLF_Q601_LETSGO_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Then let's go.";
}

func int DIA_INGOLF_Q601_LETSGO_CONDITION() {
    if ((NPC_KNOWSINFO(OTHER, 79925)) && ((LOG_GETSTATUS(MIS_Q601)) == (LOG_RUNNING))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_INGOLF_Q601_LETSGO_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Notger_Q601_WhatHappend_Finally_15_06");
    AI_WAITTILLEND(SELF, OTHER);
    AI_STOPPROCESSINFOS(SELF);
    RUNESTRADE_CHECKBOUGHTRUNES();
    AI_FUNCTION(SELF, 80016);
}

func void NOTGER_Q601_TELEPORTMARVIN() {
    FADESCREENTOBLACKF(2, 80017, 1000);
}

func void NOTGER_Q601_TELEPORTMARVIN_FADESCREEN() {
    Q601_MARVINTELEPORT = 1;
    WLD_SETTIME(19, 0);
    NPC_EXCHANGEROUTINE(KDW_215_NOTGER, START);
    NPC_EXCHANGEROUTINE(KDW_216_INGOLF, "Q601_TOWER_WAIT");
    NPC_EXCHANGEROUTINE(NOV_203_NOVIZE, START);
    TELEPORTNPCTOWP(1819, "PART15_PATH_57");
    TELEPORTNPCTOWP(56676, "PART15_PATH_58");
    Q601_SPAWNWOLFSSON();
    Q601_REMOVEMONSTERS();
    WLD_SENDTRIGGER("KM_Q601_TOWER");
    HERO.AIVAR[4] = FALSE;
    FADESCREENFROMBLACK(2);
}

instance DIA_NOTGER_Q601_TOWER(C_INFO) {
    NPC = 56676;
    NR = 1;
    CONDITION = DIA_NOTGER_Q601_TOWER_CONDITION;
    INFORMATION = DIA_NOTGER_Q601_TOWER_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_NOTGER_Q601_TOWER_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_Q601)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 79925))) && ((NPC_GETDISTTOWP(SELF, "PART15_PATH_58")) <= (2000))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_NOTGER_Q601_TOWER_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_Tower_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_Tower_03_02");
    AI_STOPPROCESSINFOS(SELF);
    RUNESTRADE_CHECKBOUGHTRUNES();
    SELF.AIVAR[15] = TRUE;
    NPC_EXCHANGEROUTINE(SELF, "Q601_TOWER_GUIDE");
}

instance DIA_NOTGER_Q601_AFTERFIGHT(C_INFO) {
    NPC = 56676;
    NR = 1;
    CONDITION = DIA_NOTGER_Q601_AFTERFIGHT_CONDITION;
    INFORMATION = DIA_NOTGER_Q601_AFTERFIGHT_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_NOTGER_Q601_AFTERFIGHT_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_Q601)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 80018))) && ((NPC_GETDISTTOWP(SELF, "PART15_PATH_75")) <= (300))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_NOTGER_Q601_AFTERFIGHT_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_AfterFight_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_AfterFight_03_02");
    AI_STOPPROCESSINFOS(SELF);
    RUNESTRADE_CHECKBOUGHTRUNES();
    NPC_EXCHANGEROUTINE(SELF, "Q601_TOWER_GUIDE2");
}

instance DIA_NOTGER_Q601_VILLAGE(C_INFO) {
    NPC = 56676;
    NR = 1;
    CONDITION = DIA_NOTGER_Q601_VILLAGE_CONDITION;
    INFORMATION = DIA_NOTGER_Q601_VILLAGE_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_NOTGER_Q601_VILLAGE_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_Q601)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 80021))) && ((NPC_GETDISTTOWP(SELF, "PART15_TOWER_LOOKOUT01")) <= (450))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_NOTGER_Q601_VILLAGE_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_Village_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_Village_03_02");
    AI_STOPPROCESSINFOS(SELF);
    RUNESTRADE_CHECKBOUGHTRUNES();
    NPC_EXCHANGEROUTINE(SELF, "Q601_TOWER_GUIDE3");
}

instance DIA_NOTGER_Q601_DECISION(C_INFO) {
    NPC = 56676;
    NR = 1;
    CONDITION = DIA_NOTGER_Q601_DECISION_CONDITION;
    INFORMATION = DIA_NOTGER_Q601_DECISION_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_NOTGER_Q601_DECISION_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_Q601)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 80024))) && ((NPC_GETDISTTOWP(SELF, "PART15_TOWER_06")) <= (300))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_NOTGER_Q601_DECISION_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_Decision_03_01");
    INFO_CLEARCHOICES(80027);
    INFO_ADDCHOICE(80027, "What thing?", 80030);
}

func void DIA_NOTGER_Q601_DECISION_STEP() {
    AI_OUTPUT(OTHER, SELF, "DIA_Notger_Q601_Decision_Step_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_Decision_03_01_A");
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_Decision_03_01_B");
    INFO_CLEARCHOICES(80027);
    INFO_ADDCHOICE(80027, "Ulryk attacked the city?", 80034);
}

var int NOTGER_Q601_DECISION_WHY;
var int NOTGER_Q601_DECISION_ARMY;
func void DIA_NOTGER_Q601_DECISION_CHOICES() {
    INFO_CLEARCHOICES(80027);
    if (((NOTGER_Q601_DECISION_WHY) == (TRUE)) && ((NOTGER_Q601_DECISION_ARMY) == (TRUE))) {
        if (((LOG_GETSTATUS(MIS_SQ503)) == (0)) && ((Q509_CORTEZVOLFZACKE) == (0))) {
            INFO_ADDCHOICE(80027, "This is not my city. I have no one here. (Escape from the island)", 80041);
        };
        INFO_ADDCHOICE(80027, "I'm sick of fighting and killing. (Wait it out)", 80040);
        INFO_ADDCHOICE(80027, "I know a lot of people from the city. We have to help them somehow!", 80039);
        INFO_ADDCHOICE(80027, "This is the perfect time to bring the Usurer to justice.", 80037);
    };
    if ((NOTGER_Q601_DECISION_WHY) == (FALSE)) {
        INFO_ADDCHOICE(80027, "Why would Ulryk commit treason?", 80035);
    };
    if ((NOTGER_Q601_DECISION_ARMY) == (FALSE)) {
        INFO_ADDCHOICE(80027, "He set off somewhere with most of his unit.", 80036);
    };
}

func void DIA_NOTGER_Q601_DECISION_STEP_ULRYK() {
    AI_OUTPUT(OTHER, SELF, "DIA_Notger_Q601_Decision_Ulryk_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_Decision_Ulryk_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_Decision_Ulryk_03_03");
    DIA_NOTGER_Q601_DECISION_CHOICES();
}

func void DIA_NOTGER_Q601_DECISION_STEP_ULRYK_WHY() {
    NOTGER_Q601_DECISION_WHY = TRUE;
    AI_OUTPUT(OTHER, SELF, "DIA_Notger_Q601_Decision_Why_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_Decision_Why_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_Decision_Why_03_03");
    DIA_NOTGER_Q601_DECISION_CHOICES();
}

func void DIA_NOTGER_Q601_DECISION_STEP_ULRYK_ARMY() {
    NOTGER_Q601_DECISION_ARMY = TRUE;
    AI_OUTPUT(OTHER, SELF, "DIA_Notger_Q601_Decision_Army_15_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Notger_Q601_Decision_Army_15_02");
    DIA_NOTGER_Q601_DECISION_CHOICES();
}

func void DIA_NOTGER_Q601_DECISION_STEP_ULRYK_ARMY_VOLKER() {
    Q601_VOLKERMUSTDIE = TRUE;
    AI_OUTPUT(OTHER, SELF, "DIA_Notger_Q601_Decision_Volker_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_Decision_Volker_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_Decision_Volker_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_Decision_Volker_03_04");
    AI_OUTPUT(OTHER, SELF, "DIA_Notger_Q601_Decision_Volker_15_05");
    AI_OUTPUT(OTHER, SELF, "DIA_Notger_Q601_Decision_Volker_15_06");
    INFO_CLEARCHOICES(80027);
    AI_STOPPROCESSINFOS(SELF);
    RUNESTRADE_CHECKBOUGHTRUNES();
    AI_FUNCTION(SELF, 80038);
}

func void NOTGER_Q601_TELEPORTCITY() {
    FADESCREENTOBLACKCHANGEWORLD(1, "ARCHOLOS_ENDGAME.ZEN", "Q602_START");
}

func void DIA_NOTGER_Q601_DECISION_STEP_ULRYK_ARMY_HELP() {
    AI_OUTPUT(OTHER, SELF, "DIA_Notger_Q601_Decision_Help_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_Decision_Help_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Notger_Q601_Decision_Help_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_Decision_Help_03_04");
    AI_OUTPUT(OTHER, SELF, "DIA_Notger_Q601_Decision_Help_15_05");
    AI_OUTPUT(OTHER, SELF, "DIA_Notger_Q601_Decision_Help_15_06");
    INFO_CLEARCHOICES(80027);
    AI_STOPPROCESSINFOS(SELF);
    RUNESTRADE_CHECKBOUGHTRUNES();
    AI_FUNCTION(SELF, 80038);
}

func void DIA_NOTGER_Q601_DECISION_STEP_ULRYK_ARMY_LEAVE() {
    if ((Q305_JAVAD_WENTTONEWHOME) != (2)) {
        Q602_LORENZOISDEAD = TRUE;
    };
    Q601_HIDEENDING = TRUE;
    AI_OUTPUT(OTHER, SELF, "DIA_Notger_Q601_Decision_Leave_15_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Notger_Q601_Decision_Leave_15_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Notger_Q601_Decision_Leave_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_Decision_Leave_03_04");
    AI_OUTPUT(OTHER, SELF, "DIA_Notger_Q601_Decision_Leave_15_05");
    AI_OUTPUT(OTHER, SELF, "DIA_Notger_Q601_Decision_Leave_15_06");
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_Decision_Leave_03_07");
    AI_OUTPUT(OTHER, SELF, "DIA_Notger_Q601_Decision_Leave_15_08");
    INFO_CLEARCHOICES(80027);
    AI_STOPPROCESSINFOS(SELF);
    RUNESTRADE_CHECKBOUGHTRUNES();
    AI_FUNCTION(SELF, 93955);
}

func void DIA_NOTGER_Q601_DECISION_STEP_ULRYK_ARMY_FLEE() {
    if ((Q305_JAVAD_WENTTONEWHOME) != (2)) {
        Q602_LORENZOISDEAD = TRUE;
    };
    Q601_FLEEHAVENENDING = TRUE;
    AI_OUTPUT(OTHER, SELF, "DIA_Notger_Q601_Decision_Flee_15_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Notger_Q601_Decision_Flee_15_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_Decision_Flee_03_03");
    AI_OUTPUT(OTHER, SELF, "DIA_Notger_Q601_Decision_Flee_15_04");
    AI_OUTPUT(OTHER, SELF, "DIA_Notger_Q601_Decision_Flee_15_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_Decision_Flee_03_06");
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_Decision_Flee_03_07");
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_Decision_Flee_03_08");
    AI_OUTPUT(SELF, OTHER, "DIA_Notger_Q601_Decision_Flee_03_09");
    INFO_CLEARCHOICES(80027);
    AI_STOPPROCESSINFOS(SELF);
    RUNESTRADE_CHECKBOUGHTRUNES();
    AI_FUNCTION(SELF, 93955);
}

