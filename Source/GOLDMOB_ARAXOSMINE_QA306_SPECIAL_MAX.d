const int GOLDMOB_ARAXOSMINE_QA306_SPECIAL_MAX = 7;
var int GOLDMOB_ARAXOSMINE_QA306_SPECIAL_AMOUNT;
func int B_MINE_QA306_CHECKWP() {
    if ((HLP_STRCMP(NPC_GETNEARESTWP(SELF), "PART7_MINE_QA306_GOLDMOB_HERO")) && ((GOLDMOB_ARAXOSMINE_QA306_SPECIAL_MAX) > (GOLDMOB_ARAXOSMINE_QA306_SPECIAL_AMOUNT))) {
        GOLDMOB_ARAXOSMINE_QA306_SPECIAL_AMOUNT = (GOLDMOB_ARAXOSMINE_QA306_SPECIAL_AMOUNT) + (1);
        return TRUE;
    };
    return FALSE;
}

func void QA306_GOLDMOB_S1() {
    var C_NPC HER;
    HER = HLP_GETNPC(50091);
    if ((HLP_GETINSTANCEID(SELF)) == (HLP_GETINSTANCEID(HER))) {
        if ((SQ119_NEEDTOREST) == (FALSE)) {
            SELF.AIVAR[4] = TRUE;
            PLAYER_MOBSI_PRODUCTION = MOBSI_QA306_GOLDMOB;
            AI_PROCESSINFOS(HER);
        } else {
            AI_USEMOB(HERO, NPC_GETDETECTEDMOB(HERO), -(1));
        };
    };
}

func void QA306_GOLDMOB_CHANGENAME() {
    if ((HLP_STRCMP(NPC_GETNEARESTWP(SELF), "PART7_MINE_QA306_GOLDMOB_HERO")) && ((GOLDMOB_ARAXOSMINE_QA306_SPECIAL_AMOUNT) == (GOLDMOB_ARAXOSMINE_QA306_SPECIAL_MAX))) {
        QA306_HELPTOLLEK = 2;
        WLD_PLAYEFFECT("FX_EarthQuake", HERO, HERO, 0, 0, 0, FALSE);
        SND_PLAY("MFX_EarthQuake");
        MOB_CHANGEFOCUSNAME("GOLDMOB_ARAXOSMINE_QA306_03", "MOBNAME_GOLDMOB_EMPTY");
        MOB_CHANGEFOCUSNAME("GOLDMOB_ARAXOSMINE_QA306_04", "MOBNAME_GOLDMOB_EMPTY");
    };
}

instance PC_QA306_GOLDMOB_END(C_INFO) {
    NPC = 50091;
    NR = 999;
    CONDITION = PC_QA306_GOLDMOB_END_CONDITION;
    INFORMATION = PC_QA306_GOLDMOB_END_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int PC_QA306_GOLDMOB_END_CONDITION() {
    if ((PLAYER_MOBSI_PRODUCTION) == (MOBSI_QA306_GOLDMOB)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void PC_QA306_GOLDMOB_END_INFO() {
    B_ENDPRODUCTIONDIALOG();
}

instance PC_QA306_GOLDMOB_ADDON_HOUR(C_INFO) {
    NPC = 50091;
    NR = 2;
    CONDITION = PC_QA306_GOLDMOB_ADDON_HOUR_CONDITION;
    INFORMATION = PC_QA306_GOLDMOB_ADDON_HOUR_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_DIGALITTLE;
}

func int PC_QA306_GOLDMOB_ADDON_HOUR_CONDITION() {
    if ((PLAYER_MOBSI_PRODUCTION) == (MOBSI_QA306_GOLDMOB)) {
        if ((SQ119_NEEDTOREST) == (FALSE)) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void PC_QA306_GOLDMOB_ADDON_HOUR_INFO() {
    var int MULTINUGGET;
    var int CURRENTCHANCE;
    if ((GOLDCOUNTER_PICKAXEBROKE) == (25)) {
        SND_PLAY3D(SELF, "PickAxeBroke");
        B_SAY(HERO, HERO, "$PickBroke");
        AI_USEMOB(HERO, NPC_GETDETECTEDMOB(HERO), -(1));
        AI_FUNCTION(HERO, 47336);
    };
    GOLDCOUNTER_PICKAXEBROKE = (GOLDCOUNTER_PICKAXEBROKE) + (1);
    if ((GOLDCOUNTER_NEEDTOTAKEBREAK) == (50)) {
        GOLDCOUNTER_NEEDTOTAKEBREAK = 0;
        PRINTSCREEN(PRINT_ARAXOSMINE_TAKEABREAK, -(1), -(1), FONT_SCREEN, 6);
        SQ119_NEEDTOREST = TRUE;
        B_ENDPRODUCTIONDIALOG();
    };
    GOLDCOUNTER_NEEDTOTAKEBREAK = (GOLDCOUNTER_NEEDTOTAKEBREAK) + (1);
    if ((HERO.ATTRIBUTE[0]) > (((HERO.ATTRIBUTE[1]) / (70)) + (2))) {
        HERO.ATTRIBUTE[0] -= (HERO.ATTRIBUTE[1]) / (70);
    };
    HERO.ATTRIBUTE[0] = 2;
    CURRENTCHANCE = HLP_RANDOM(100);
    MULTINUGGET = HLP_RANDOM(10);
    if ((B_MINE_QA306_CHECKWP()) == (TRUE)) {
        if ((CURRENTCHANCE) <= (HERO_HACKCHANCE)) {
            if (((GOLDCOUNTER_ARAXOSMINE) >= (20)) && ((MULTINUGGET) >= (8))) {
                CREATEINVITEMS(HERO, 33660, 7);
                PRINTSCREENS(PRINT_GOLDDIGV5, -(1), -(1), FONT_SCREENSMALL, 2);
                GOLDCOUNTER_ARAXOSMINE = 0;
            } else if (((GOLDCOUNTER_ARAXOSMINE) >= (7)) && ((MULTINUGGET) >= (5))) {
                CREATEINVITEMS(HERO, 33660, 5);
                PRINTSCREENS(PRINT_GOLDDIGV4, -(1), -(1), FONT_SCREENSMALL, 2);
                GOLDCOUNTER_ARAXOSMINE = (GOLDCOUNTER_ARAXOSMINE) + (1);
            } else {
                CREATEINVITEMS(HERO, 33660, 3);
                PRINTSCREENS(PRINT_GOLDDIGV3, -(1), -(1), FONT_SCREENSMALL, 2);
                GOLDCOUNTER_ARAXOSMINE = (GOLDCOUNTER_ARAXOSMINE) + (1);
            };
            ACH_16_GOLD = TRUE;
        } else {
            PRINTSCREENS(PRINT_GOLDDIGGING, -(1), -(1), FONT_SCREENSMALL, 2);
        };
    };
    QA306_GOLDMOB_CHANGENAME();
    PRINTSCREENS(PRINT_NOTHINGLEFT, -(1), -(1), FONT_SCREENSMALL, 2);
    B_ENDPRODUCTIONDIALOG();
}

