var int MARVIN_MAGELEARNING_TIER1;
var int MARVIN_MAGELEARNING_TIER2;
var int MARVIN_MAGELEARNING_TIER3;
var int MARVIN_MAGELEARNING_TIER4;
const int VALUE_BOOK_SCROLL = 50;
const int VALUE_MAGICBOOK_CIRCLE1 = 100;
const int VALUE_MAGICBOOK_CIRCLE2 = 125;
const int VALUE_MAGICBOOK_CIRCLE3 = 150;
const int VALUE_MAGICBOOK_CIRCLE4 = 200;
const int VALUE_BOOK_ALCHEMY = 50;
const int VALUE_BOOK_PICKPOCKETING = 50;
const int VALUE_MAGICBOOK_CIRCLE1_GOOD = 400;
const int VALUE_MAGICBOOK_CIRCLE2_GOOD = 750;
const int VALUE_MAGICBOOK_CIRCLE3_GOOD = 1000;
const int VALUE_MAGICBOOK_CIRCLE4_GOOD = 1500;
const int VALUE_TALENTBOOK_TIER1 = 750;
const int VALUE_TALENTBOOK_TIER2 = 1250;
const int VALUE_TALENTBOOK_TIER3 = 2000;
const int VALUE_TROPHYHEALING = 1000;
instance MAGICTESTPACKET(C_ITEM) {
    NAME = "Magic Starter Pack";
    MAINFLAG = ITEM_KAT_NONE;
    VISUAL = "ItMi_Packet.3ds";
    SCEMENAME = SCEME_MAPSEALED;
    ON_STATE[0] = USE_MAGICTESTPACKET;
    MATERIAL = MAT_LEATHER;
    DESCRIPTION = NAME;
}

func void USE_MAGICTESTPACKET() {
    CREATEINVITEMS(HERO, 40834, 1);
    CREATEINVITEMS(HERO, 40845, 1);
    CREATEINVITEMS(HERO, 40856, 1);
    CREATEINVITEMS(HERO, 40867, 1);
    CREATEINVITEMS(HERO, 40878, 1);
    CREATEINVITEMS(HERO, 40889, 1);
    CREATEINVITEMS(HERO, 40900, 1);
    CREATEINVITEMS(HERO, 40911, 1);
    CREATEINVITEMS(HERO, 40922, 1);
    CREATEINVITEMS(HERO, 40933, 1);
    CREATEINVITEMS(HERO, 40944, 1);
    CREATEINVITEMS(HERO, 40955, 1);
    CREATEINVITEMS(HERO, 40966, 1);
    CREATEINVITEMS(HERO, 40977, 1);
    CREATEINVITEMS(HERO, 40835, 1);
    CREATEINVITEMS(HERO, 40846, 1);
    CREATEINVITEMS(HERO, 40857, 1);
    CREATEINVITEMS(HERO, 40868, 1);
    CREATEINVITEMS(HERO, 40879, 1);
    CREATEINVITEMS(HERO, 40890, 1);
    CREATEINVITEMS(HERO, 40901, 1);
    CREATEINVITEMS(HERO, 40912, 1);
    CREATEINVITEMS(HERO, 40923, 1);
    CREATEINVITEMS(HERO, 40934, 1);
    CREATEINVITEMS(HERO, 40945, 1);
    CREATEINVITEMS(HERO, 40956, 1);
    CREATEINVITEMS(HERO, 40967, 1);
    CREATEINVITEMS(HERO, 40978, 1);
    SND_PLAY(GELDBEUTEL);
}

instance TALENTBOOKTESTPACKET(C_ITEM) {
    NAME = "TalentBook Starter Pack";
    MAINFLAG = ITEM_KAT_NONE;
    VISUAL = "ItMi_Packet.3ds";
    SCEMENAME = SCEME_MAPSEALED;
    ON_STATE[0] = USE_TALENTBOOKTESTPACKET;
    MATERIAL = MAT_LEATHER;
    DESCRIPTION = NAME;
}

func void USE_TALENTBOOKTESTPACKET() {
    CREATEINVITEMS(HERO, 41072, 1);
    CREATEINVITEMS(HERO, 41075, 1);
    CREATEINVITEMS(HERO, 41078, 1);
    CREATEINVITEMS(HERO, 41063, 1);
    CREATEINVITEMS(HERO, 41066, 1);
    CREATEINVITEMS(HERO, 41069, 1);
    CREATEINVITEMS(HERO, 41054, 1);
    CREATEINVITEMS(HERO, 41057, 1);
    CREATEINVITEMS(HERO, 41060, 1);
    CREATEINVITEMS(HERO, 41045, 1);
    CREATEINVITEMS(HERO, 41048, 1);
    CREATEINVITEMS(HERO, 41051, 1);
    CREATEINVITEMS(HERO, 41027, 1);
    CREATEINVITEMS(HERO, 41030, 1);
    CREATEINVITEMS(HERO, 41033, 1);
    CREATEINVITEMS(HERO, 41081, 1);
    CREATEINVITEMS(HERO, 41084, 1);
    CREATEINVITEMS(HERO, 41087, 1);
    CREATEINVITEMS(HERO, 41036, 1);
    CREATEINVITEMS(HERO, 41039, 1);
    CREATEINVITEMS(HERO, 41042, 1);
    CREATEINVITEMS(HERO, 40998, 1);
    CREATEINVITEMS(HERO, 41091, 1);
    SND_PLAY(GELDBEUTEL);
}

func void CIRCLEBOOK_TIER1_LEARNPLAYER() {
    MARVIN_MAGELEARNING_TIER1 = (MARVIN_MAGELEARNING_TIER1) + (1);
    if ((MARVIN_MAGELEARNING_TIER1) == (1)) {
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER1_MISSING1);
    };
    if ((MARVIN_MAGELEARNING_TIER1) == (2)) {
        NPC_SETTALENTSKILL(HERO, NPC_TALENT_MAGE, 1);
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER1_LEARNPLAYER);
        PRINTSCREEN(PRINT_LEARNCIRCLE_1, -(1), -(1), FONT_SCREEN, 2);
    };
}

func void CIRCLEBOOK_TIER2_LEARNPLAYER() {
    MARVIN_MAGELEARNING_TIER2 = (MARVIN_MAGELEARNING_TIER2) + (1);
    if ((MARVIN_MAGELEARNING_TIER2) == (1)) {
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER2_MISSING2);
    };
    if ((MARVIN_MAGELEARNING_TIER2) == (2)) {
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER1_MISSING1);
    };
    if ((MARVIN_MAGELEARNING_TIER2) == (3)) {
        NPC_SETTALENTSKILL(HERO, NPC_TALENT_MAGE, 2);
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER2_LEARNPLAYER);
        PRINTSCREEN(PRINT_LEARNCIRCLE_2, -(1), -(1), FONT_SCREEN, 2);
    };
}

func void CIRCLEBOOK_TIER3_LEARNPLAYER() {
    MARVIN_MAGELEARNING_TIER3 = (MARVIN_MAGELEARNING_TIER3) + (1);
    if ((MARVIN_MAGELEARNING_TIER3) == (1)) {
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER3_MISSING3);
    };
    if ((MARVIN_MAGELEARNING_TIER3) == (2)) {
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER2_MISSING2);
    };
    if ((MARVIN_MAGELEARNING_TIER3) == (3)) {
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER1_MISSING1);
    };
    if ((MARVIN_MAGELEARNING_TIER3) == (4)) {
        NPC_SETTALENTSKILL(HERO, NPC_TALENT_MAGE, 3);
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER3_LEARNPLAYER);
        PRINTSCREEN(PRINT_LEARNCIRCLE_3, -(1), -(1), FONT_SCREEN, 2);
    };
}

func void CIRCLEBOOK_TIER4_LEARNPLAYER() {
    MARVIN_MAGELEARNING_TIER4 = (MARVIN_MAGELEARNING_TIER4) + (1);
    if ((MARVIN_MAGELEARNING_TIER4) == (1)) {
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER4_MISSING4);
    };
    if ((MARVIN_MAGELEARNING_TIER4) == (2)) {
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER3_MISSING3);
    };
    if ((MARVIN_MAGELEARNING_TIER4) == (3)) {
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER2_MISSING2);
    };
    if ((MARVIN_MAGELEARNING_TIER4) == (4)) {
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER1_MISSING1);
    };
    if ((MARVIN_MAGELEARNING_TIER4) == (5)) {
        BUFF_APPLYORREFRESH(HERO, 32525);
        NPC_SETTALENTSKILL(HERO, NPC_TALENT_MAGE, 4);
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER4_LEARNPLAYER);
        PRINTSCREEN(PRINT_LEARNCIRCLE_4, -(1), -(1), FONT_SCREEN, 2);
    };
}

instance ITWR_SCROLLBOOK_01(C_ITEM) {
    NAME = WRITTENNAME_SCROLLBOOK_01;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_BOOK_SCROLL;
    VISUAL = "KM_item_book_10.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_SCROLLBOOK_01_1;
    TEXT[2] = ITEMDESC_ITWR_SCROLLBOOK_01_2;
    TEXT[3] = ITEMDESC_ITWR_SCROLLBOOK_01_3;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_SCROLLBOOK_01;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

var int SCROLLBOOK_STARTDIALOGUE;
func void USE_SCROLLBOOK_01() {
    if (((LOG_GETSTATUS(MIS_SQ121)) == (LOG_SUCCESS)) || ((KAPITEL) >= (2))) {
        if ((NPC_GETTALENTSKILL(HERO, NPC_TALENT_SCROLLWRITING)) == (TRUE)) {
        } else {
            SCROLLBOOK_STARTDIALOGUE = 1;
            AI_PROCESSINFOS(HERO);
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK, -(1), -(1), FONT_SCREEN, 4);
}

instance SCROLLBOOK_END(C_INFO) {
    NPC = 50091;
    NR = 999;
    CONDITION = SCROLLBOOK_CONDITION;
    INFORMATION = SCROLLBOOK_EXIT;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int SCROLLBOOK_CONDITION() {
    return SCROLLBOOK_STARTDIALOGUE;
}

func void SCROLLBOOK_EXIT() {
    AI_STOPPROCESSINFOS(SELF);
    SCROLLBOOK_STARTDIALOGUE = FALSE;
}

instance SCROLLBOOK_LEARN(C_INFO) {
    NPC = 50091;
    NR = 1;
    CONDITION = SCROLLBOOK_LEARN_CONDITION;
    INFORMATION = SCROLLBOOK_LEARN_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = B_BUILDLEARNSTRING2(PRINT_LEARN_MAGICSCROLL, 5, 0);
}

func int SCROLLBOOK_LEARN_CONDITION() {
    if (((SCROLLBOOK_STARTDIALOGUE) == (TRUE)) && ((NPC_GETTALENTSKILL(HERO, NPC_TALENT_SCROLLWRITING)) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void SCROLLBOOK_LEARN_INFO() {
    if ((HERO.LP) >= (5)) {
        HERO.LP = (HERO.LP) - (5);
        NPC_SETTALENTSKILL(HERO, NPC_TALENT_SCROLLWRITING, 1);
        PRINTSCREEN(PRINT_LEARNMAGICSCROLL, -(1), -(1), FONT_SCREEN, 2);
        SND_PLAY("LEVELUP");
        LOG_CREATETOPIC(TOPIC_SCROLLS, LOG_NOTE);
        if ((LOG_GETSTATUS(MIS_SQ121)) == (LOG_SUCCESS)) {
            B_LOGENTRY(TOPIC_SCROLLS, LOG_MAGIC_LEARNEDSCROLLS);
        } else {
            B_LOGENTRY(TOPIC_SCROLLS, LOG_MAGIC_LEARNEDSCROLLS_V2);
        };
        AI_STOPPROCESSINFOS(SELF);
        SCROLLBOOK_STARTDIALOGUE = FALSE;
    };
    PRINTSCREEN(PRINT_NOTENOUGHLEARNPOINTS, -(1), -(1), FONT_SCREEN, 2);
}

var int CIRCLEBOOK_TIER1_01_STARTDIALOGUE;
var int CIRCLEBOOK_TIER1_01_LEARNED;
instance ITWR_MAGICBOOK_CIRCLE1_01(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE1_01;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE1;
    VISUAL = "KM_item_book_05.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_01_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_01_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE1_01;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

instance ITWR_MAGICBOOK_CIRCLE1_01_GOOD(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE1_01;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE1_GOOD;
    VISUAL = "KM_item_book_01.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_01_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_01_GOOD_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE1_01;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_MAGICBOOK_CIRCLE1_01() {
    if ((((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) == (1)) || ((MARVIN_MAGELEARNING_TIER1) == (2))) || ((CIRCLEBOOK_TIER1_01_LEARNED) == (TRUE))) {
    };
    CIRCLEBOOK_TIER1_01_STARTDIALOGUE = 1;
    AI_PROCESSINFOS(HERO);
}

instance CIRCLEBOOK_TIER1_01_END(C_INFO) {
    NPC = 50091;
    NR = 999;
    CONDITION = CIRCLEBOOK_TIER1_01_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER1_01_EXIT;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int CIRCLEBOOK_TIER1_01_CONDITION() {
    return CIRCLEBOOK_TIER1_01_STARTDIALOGUE;
}

func void CIRCLEBOOK_TIER1_01_EXIT() {
    AI_STOPPROCESSINFOS(SELF);
    CIRCLEBOOK_TIER1_01_STARTDIALOGUE = FALSE;
}

instance CIRCLEBOOK_TIER1_01_LEARN(C_INFO) {
    NPC = 50091;
    NR = 1;
    CONDITION = CIRCLEBOOK_TIER1_01_LEARN_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER1_01_LEARN_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = B_BUILDLEARNSTRING2(PRINT_LEARN_CIRCLE1_BOOK1, 10, 0);
}

func int CIRCLEBOOK_TIER1_01_LEARN_CONDITION() {
    if (((CIRCLEBOOK_TIER1_01_STARTDIALOGUE) == (TRUE)) && ((CIRCLEBOOK_TIER1_01_LEARNED) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void CIRCLEBOOK_TIER1_01_LEARN_INFO() {
    if ((HERO.LP) >= (10)) {
        HERO.LP = (HERO.LP) - (10);
        CIRCLEBOOK_TIER1_01_LEARNED = TRUE;
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER1_PART1);
        CIRCLEBOOK_TIER1_LEARNPLAYER();
        SND_PLAY("LEVELUP");
        AI_STOPPROCESSINFOS(SELF);
        CIRCLEBOOK_TIER1_01_STARTDIALOGUE = FALSE;
    };
    PRINTSCREEN(PRINT_NOTENOUGHLEARNPOINTS, -(1), -(1), FONT_SCREEN, 2);
}

var int CIRCLEBOOK_TIER1_02_STARTDIALOGUE;
var int CIRCLEBOOK_TIER1_02_LEARNED;
instance ITWR_MAGICBOOK_CIRCLE1_02(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE1_02;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE1;
    VISUAL = "KM_item_book_05.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_02_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_02_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE1_02;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

instance ITWR_MAGICBOOK_CIRCLE1_02_GOOD(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE1_02;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE1_GOOD;
    VISUAL = "KM_item_book_01.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_02_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_01_GOOD_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE1_02;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_MAGICBOOK_CIRCLE1_02() {
    if ((((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) == (1)) || ((MARVIN_MAGELEARNING_TIER1) == (2))) || ((CIRCLEBOOK_TIER1_02_LEARNED) == (TRUE))) {
    };
    CIRCLEBOOK_TIER1_02_STARTDIALOGUE = 1;
    AI_PROCESSINFOS(HERO);
}

instance CIRCLEBOOK_TIER1_02_END(C_INFO) {
    NPC = 50091;
    NR = 999;
    CONDITION = CIRCLEBOOK_TIER1_02_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER1_02_EXIT;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int CIRCLEBOOK_TIER1_02_CONDITION() {
    return CIRCLEBOOK_TIER1_02_STARTDIALOGUE;
}

func void CIRCLEBOOK_TIER1_02_EXIT() {
    AI_STOPPROCESSINFOS(SELF);
    CIRCLEBOOK_TIER1_02_STARTDIALOGUE = FALSE;
}

instance CIRCLEBOOK_TIER1_02_LEARN(C_INFO) {
    NPC = 50091;
    NR = 1;
    CONDITION = CIRCLEBOOK_TIER1_02_LEARN_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER1_02_LEARN_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = B_BUILDLEARNSTRING2(PRINT_LEARN_CIRCLE1_BOOK2, 10, 0);
}

func int CIRCLEBOOK_TIER1_02_LEARN_CONDITION() {
    if (((CIRCLEBOOK_TIER1_02_STARTDIALOGUE) == (TRUE)) && ((CIRCLEBOOK_TIER1_02_LEARNED) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void CIRCLEBOOK_TIER1_02_LEARN_INFO() {
    if ((HERO.LP) >= (10)) {
        HERO.LP = (HERO.LP) - (10);
        CIRCLEBOOK_TIER1_02_LEARNED = TRUE;
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER1_PART2);
        CIRCLEBOOK_TIER1_LEARNPLAYER();
        SND_PLAY("LEVELUP");
        AI_STOPPROCESSINFOS(SELF);
        CIRCLEBOOK_TIER1_02_STARTDIALOGUE = FALSE;
    };
    PRINTSCREEN(PRINT_NOTENOUGHLEARNPOINTS, -(1), -(1), FONT_SCREEN, 2);
}

var int CIRCLEBOOK_TIER2_01_STARTDIALOGUE;
var int CIRCLEBOOK_TIER2_01_LEARNED;
instance ITWR_MAGICBOOK_CIRCLE2_01(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE2_01;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE2;
    VISUAL = "KM_item_book_06.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE2_01_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_02_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE2_01;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

instance ITWR_MAGICBOOK_CIRCLE2_01_GOOD(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE2_01;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE2_GOOD;
    VISUAL = "KM_item_book_02.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE2_01_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_01_GOOD_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE2_01;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_MAGICBOOK_CIRCLE2_01() {
    if ((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) >= (1)) {
        if ((((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) == (2)) || ((MARVIN_MAGELEARNING_TIER2) == (3))) || ((CIRCLEBOOK_TIER2_01_LEARNED) == (TRUE))) {
        } else {
            CIRCLEBOOK_TIER2_01_STARTDIALOGUE = 1;
            AI_PROCESSINFOS(HERO);
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_CIRCLE, -(1), -(1), FONT_SCREEN, 4);
}

instance CIRCLEBOOK_TIER2_01_END(C_INFO) {
    NPC = 50091;
    NR = 999;
    CONDITION = CIRCLEBOOK_TIER2_01_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER2_01_EXIT;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int CIRCLEBOOK_TIER2_01_CONDITION() {
    return CIRCLEBOOK_TIER2_01_STARTDIALOGUE;
}

func void CIRCLEBOOK_TIER2_01_EXIT() {
    AI_STOPPROCESSINFOS(SELF);
    CIRCLEBOOK_TIER2_01_STARTDIALOGUE = FALSE;
}

instance CIRCLEBOOK_TIER2_01_LEARN(C_INFO) {
    NPC = 50091;
    NR = 1;
    CONDITION = CIRCLEBOOK_TIER2_01_LEARN_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER2_01_LEARN_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = B_BUILDLEARNSTRING2(PRINT_LEARN_CIRCLE2_BOOK1, 10, 0);
}

func int CIRCLEBOOK_TIER2_01_LEARN_CONDITION() {
    if (((CIRCLEBOOK_TIER2_01_STARTDIALOGUE) == (TRUE)) && ((CIRCLEBOOK_TIER2_01_LEARNED) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void CIRCLEBOOK_TIER2_01_LEARN_INFO() {
    if ((HERO.LP) >= (10)) {
        HERO.LP = (HERO.LP) - (10);
        CIRCLEBOOK_TIER2_01_LEARNED = TRUE;
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER2_PART1);
        CIRCLEBOOK_TIER2_LEARNPLAYER();
        SND_PLAY("LEVELUP");
        AI_STOPPROCESSINFOS(SELF);
        CIRCLEBOOK_TIER2_01_STARTDIALOGUE = FALSE;
    };
    PRINTSCREEN(PRINT_NOTENOUGHLEARNPOINTS, -(1), -(1), FONT_SCREEN, 2);
}

var int CIRCLEBOOK_TIER2_02_STARTDIALOGUE;
var int CIRCLEBOOK_TIER2_02_LEARNED;
instance ITWR_MAGICBOOK_CIRCLE2_02(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE2_02;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE2;
    VISUAL = "KM_item_book_06.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE2_02_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_02_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE2_02;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

instance ITWR_MAGICBOOK_CIRCLE2_02_GOOD(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE2_02;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE2_GOOD;
    VISUAL = "KM_item_book_02.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE2_02_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_01_GOOD_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE2_02;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_MAGICBOOK_CIRCLE2_02() {
    if ((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) >= (1)) {
        if ((((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) == (2)) || ((MARVIN_MAGELEARNING_TIER2) == (3))) || ((CIRCLEBOOK_TIER2_02_LEARNED) == (TRUE))) {
        } else {
            CIRCLEBOOK_TIER2_02_STARTDIALOGUE = 1;
            AI_PROCESSINFOS(HERO);
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_CIRCLE, -(1), -(1), FONT_SCREEN, 4);
}

instance CIRCLEBOOK_TIER2_02_END(C_INFO) {
    NPC = 50091;
    NR = 999;
    CONDITION = CIRCLEBOOK_TIER2_02_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER2_02_EXIT;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int CIRCLEBOOK_TIER2_02_CONDITION() {
    return CIRCLEBOOK_TIER2_02_STARTDIALOGUE;
}

func void CIRCLEBOOK_TIER2_02_EXIT() {
    AI_STOPPROCESSINFOS(SELF);
    CIRCLEBOOK_TIER2_02_STARTDIALOGUE = FALSE;
}

instance CIRCLEBOOK_TIER2_02_LEARN(C_INFO) {
    NPC = 50091;
    NR = 1;
    CONDITION = CIRCLEBOOK_TIER2_02_LEARN_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER2_02_LEARN_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = B_BUILDLEARNSTRING2(PRINT_LEARN_CIRCLE2_BOOK2, 10, 0);
}

func int CIRCLEBOOK_TIER2_02_LEARN_CONDITION() {
    if (((CIRCLEBOOK_TIER2_02_STARTDIALOGUE) == (TRUE)) && ((CIRCLEBOOK_TIER2_02_LEARNED) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void CIRCLEBOOK_TIER2_02_LEARN_INFO() {
    if ((HERO.LP) >= (10)) {
        HERO.LP = (HERO.LP) - (10);
        CIRCLEBOOK_TIER2_02_LEARNED = TRUE;
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER2_PART2);
        CIRCLEBOOK_TIER2_LEARNPLAYER();
        SND_PLAY("LEVELUP");
        AI_STOPPROCESSINFOS(SELF);
        CIRCLEBOOK_TIER2_02_STARTDIALOGUE = FALSE;
    };
    PRINTSCREEN(PRINT_NOTENOUGHLEARNPOINTS, -(1), -(1), FONT_SCREEN, 2);
}

var int CIRCLEBOOK_TIER2_03_STARTDIALOGUE;
var int CIRCLEBOOK_TIER2_03_LEARNED;
instance ITWR_MAGICBOOK_CIRCLE2_03(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE2_03;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE2;
    VISUAL = "KM_item_book_06.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE2_03_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_02_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE2_03;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

instance ITWR_MAGICBOOK_CIRCLE2_03_GOOD(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE2_03;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE2_GOOD;
    VISUAL = "KM_item_book_02.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE2_03_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_01_GOOD_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE2_03;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_MAGICBOOK_CIRCLE2_03() {
    if ((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) >= (1)) {
        if ((((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) == (2)) || ((MARVIN_MAGELEARNING_TIER2) == (3))) || ((CIRCLEBOOK_TIER2_03_LEARNED) == (TRUE))) {
        } else {
            CIRCLEBOOK_TIER2_03_STARTDIALOGUE = 1;
            AI_PROCESSINFOS(HERO);
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_CIRCLE, -(1), -(1), FONT_SCREEN, 4);
}

instance CIRCLEBOOK_TIER2_03_END(C_INFO) {
    NPC = 50091;
    NR = 999;
    CONDITION = CIRCLEBOOK_TIER2_03_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER2_03_EXIT;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int CIRCLEBOOK_TIER2_03_CONDITION() {
    return CIRCLEBOOK_TIER2_03_STARTDIALOGUE;
}

func void CIRCLEBOOK_TIER2_03_EXIT() {
    AI_STOPPROCESSINFOS(SELF);
    CIRCLEBOOK_TIER2_03_STARTDIALOGUE = FALSE;
}

instance CIRCLEBOOK_TIER2_03_LEARN(C_INFO) {
    NPC = 50091;
    NR = 1;
    CONDITION = CIRCLEBOOK_TIER2_03_LEARN_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER2_03_LEARN_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = B_BUILDLEARNSTRING2(PRINT_LEARN_CIRCLE2_BOOK3, 10, 0);
}

func int CIRCLEBOOK_TIER2_03_LEARN_CONDITION() {
    if (((CIRCLEBOOK_TIER2_03_STARTDIALOGUE) == (TRUE)) && ((CIRCLEBOOK_TIER2_03_LEARNED) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void CIRCLEBOOK_TIER2_03_LEARN_INFO() {
    if ((HERO.LP) >= (10)) {
        HERO.LP = (HERO.LP) - (10);
        CIRCLEBOOK_TIER2_03_LEARNED = TRUE;
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER2_PART3);
        CIRCLEBOOK_TIER2_LEARNPLAYER();
        SND_PLAY("LEVELUP");
        AI_STOPPROCESSINFOS(SELF);
        CIRCLEBOOK_TIER2_03_STARTDIALOGUE = FALSE;
    };
    PRINTSCREEN(PRINT_NOTENOUGHLEARNPOINTS, -(1), -(1), FONT_SCREEN, 2);
}

var int CIRCLEBOOK_TIER3_01_STARTDIALOGUE;
var int CIRCLEBOOK_TIER3_01_LEARNED;
instance ITWR_MAGICBOOK_CIRCLE3_01(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE3_01;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE3;
    VISUAL = "KM_item_book_07.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE3_01_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_02_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE3_01;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

instance ITWR_MAGICBOOK_CIRCLE3_01_GOOD(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE3_01;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE3_GOOD;
    VISUAL = "KM_item_book_03.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE3_01_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_01_GOOD_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE3_01;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_MAGICBOOK_CIRCLE3_01() {
    if ((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) >= (2)) {
        if ((((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) == (3)) || ((MARVIN_MAGELEARNING_TIER3) == (4))) || ((CIRCLEBOOK_TIER3_01_LEARNED) == (TRUE))) {
        } else {
            CIRCLEBOOK_TIER3_01_STARTDIALOGUE = 1;
            AI_PROCESSINFOS(HERO);
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_CIRCLE, -(1), -(1), FONT_SCREEN, 4);
}

instance CIRCLEBOOK_TIER3_01_END(C_INFO) {
    NPC = 50091;
    NR = 999;
    CONDITION = CIRCLEBOOK_TIER3_01_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER3_01_EXIT;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int CIRCLEBOOK_TIER3_01_CONDITION() {
    return CIRCLEBOOK_TIER3_01_STARTDIALOGUE;
}

func void CIRCLEBOOK_TIER3_01_EXIT() {
    AI_STOPPROCESSINFOS(SELF);
    CIRCLEBOOK_TIER3_01_STARTDIALOGUE = FALSE;
}

instance CIRCLEBOOK_TIER3_01_LEARN(C_INFO) {
    NPC = 50091;
    NR = 1;
    CONDITION = CIRCLEBOOK_TIER3_01_LEARN_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER3_01_LEARN_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = B_BUILDLEARNSTRING2(PRINT_LEARN_CIRCLE3_BOOK1, 10, 0);
}

func int CIRCLEBOOK_TIER3_01_LEARN_CONDITION() {
    if (((CIRCLEBOOK_TIER3_01_STARTDIALOGUE) == (TRUE)) && ((CIRCLEBOOK_TIER3_01_LEARNED) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void CIRCLEBOOK_TIER3_01_LEARN_INFO() {
    if ((HERO.LP) >= (10)) {
        HERO.LP = (HERO.LP) - (10);
        CIRCLEBOOK_TIER3_01_LEARNED = TRUE;
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER3_PART1);
        CIRCLEBOOK_TIER3_LEARNPLAYER();
        SND_PLAY("LEVELUP");
        AI_STOPPROCESSINFOS(SELF);
        CIRCLEBOOK_TIER3_01_STARTDIALOGUE = FALSE;
    };
    PRINTSCREEN(PRINT_NOTENOUGHLEARNPOINTS, -(1), -(1), FONT_SCREEN, 2);
}

var int CIRCLEBOOK_TIER3_02_STARTDIALOGUE;
var int CIRCLEBOOK_TIER3_02_LEARNED;
instance ITWR_MAGICBOOK_CIRCLE3_02(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE3_02;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE3;
    VISUAL = "KM_item_book_07.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE3_02_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_02_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE3_02;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

instance ITWR_MAGICBOOK_CIRCLE3_02_GOOD(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE3_02;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE3_GOOD;
    VISUAL = "KM_item_book_03.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE3_02_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_01_GOOD_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE3_02;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_MAGICBOOK_CIRCLE3_02() {
    if ((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) >= (2)) {
        if ((((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) == (3)) || ((MARVIN_MAGELEARNING_TIER3) == (4))) || ((CIRCLEBOOK_TIER3_02_LEARNED) == (TRUE))) {
        } else {
            CIRCLEBOOK_TIER3_02_STARTDIALOGUE = 1;
            AI_PROCESSINFOS(HERO);
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_CIRCLE, -(1), -(1), FONT_SCREEN, 4);
}

instance CIRCLEBOOK_TIER3_02_END(C_INFO) {
    NPC = 50091;
    NR = 999;
    CONDITION = CIRCLEBOOK_TIER3_02_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER3_02_EXIT;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int CIRCLEBOOK_TIER3_02_CONDITION() {
    return CIRCLEBOOK_TIER3_02_STARTDIALOGUE;
}

func void CIRCLEBOOK_TIER3_02_EXIT() {
    AI_STOPPROCESSINFOS(SELF);
    CIRCLEBOOK_TIER3_02_STARTDIALOGUE = FALSE;
}

instance CIRCLEBOOK_TIER3_02_LEARN(C_INFO) {
    NPC = 50091;
    NR = 1;
    CONDITION = CIRCLEBOOK_TIER3_02_LEARN_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER3_02_LEARN_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = B_BUILDLEARNSTRING2(PRINT_LEARN_CIRCLE3_BOOK2, 10, 0);
}

func int CIRCLEBOOK_TIER3_02_LEARN_CONDITION() {
    if (((CIRCLEBOOK_TIER3_02_STARTDIALOGUE) == (TRUE)) && ((CIRCLEBOOK_TIER3_02_LEARNED) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void CIRCLEBOOK_TIER3_02_LEARN_INFO() {
    if ((HERO.LP) >= (10)) {
        HERO.LP = (HERO.LP) - (10);
        CIRCLEBOOK_TIER3_02_LEARNED = TRUE;
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER3_PART2);
        CIRCLEBOOK_TIER3_LEARNPLAYER();
        SND_PLAY("LEVELUP");
        AI_STOPPROCESSINFOS(SELF);
        CIRCLEBOOK_TIER3_02_STARTDIALOGUE = FALSE;
    };
    PRINTSCREEN(PRINT_NOTENOUGHLEARNPOINTS, -(1), -(1), FONT_SCREEN, 2);
}

var int CIRCLEBOOK_TIER3_03_STARTDIALOGUE;
var int CIRCLEBOOK_TIER3_03_LEARNED;
instance ITWR_MAGICBOOK_CIRCLE3_03(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE3_03;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE3;
    VISUAL = "KM_item_book_07.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE3_03_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_02_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE3_03;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

instance ITWR_MAGICBOOK_CIRCLE3_03_GOOD(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE3_03;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE3_GOOD;
    VISUAL = "KM_item_book_03.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE3_03_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_01_GOOD_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE3_03;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_MAGICBOOK_CIRCLE3_03() {
    if ((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) >= (2)) {
        if ((((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) == (3)) || ((MARVIN_MAGELEARNING_TIER3) == (4))) || ((CIRCLEBOOK_TIER3_03_LEARNED) == (TRUE))) {
        } else {
            CIRCLEBOOK_TIER3_03_STARTDIALOGUE = 1;
            AI_PROCESSINFOS(HERO);
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_CIRCLE, -(1), -(1), FONT_SCREEN, 4);
}

instance CIRCLEBOOK_TIER3_03_END(C_INFO) {
    NPC = 50091;
    NR = 999;
    CONDITION = CIRCLEBOOK_TIER3_03_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER3_03_EXIT;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int CIRCLEBOOK_TIER3_03_CONDITION() {
    return CIRCLEBOOK_TIER3_03_STARTDIALOGUE;
}

func void CIRCLEBOOK_TIER3_03_EXIT() {
    AI_STOPPROCESSINFOS(SELF);
    CIRCLEBOOK_TIER3_03_STARTDIALOGUE = FALSE;
}

instance CIRCLEBOOK_TIER3_03_LEARN(C_INFO) {
    NPC = 50091;
    NR = 1;
    CONDITION = CIRCLEBOOK_TIER3_03_LEARN_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER3_03_LEARN_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = B_BUILDLEARNSTRING2(PRINT_LEARN_CIRCLE3_BOOK3, 10, 0);
}

func int CIRCLEBOOK_TIER3_03_LEARN_CONDITION() {
    if (((CIRCLEBOOK_TIER3_03_STARTDIALOGUE) == (TRUE)) && ((CIRCLEBOOK_TIER3_03_LEARNED) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void CIRCLEBOOK_TIER3_03_LEARN_INFO() {
    if ((HERO.LP) >= (10)) {
        HERO.LP = (HERO.LP) - (10);
        CIRCLEBOOK_TIER3_03_LEARNED = TRUE;
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER3_PART3);
        CIRCLEBOOK_TIER3_LEARNPLAYER();
        SND_PLAY("LEVELUP");
        AI_STOPPROCESSINFOS(SELF);
        CIRCLEBOOK_TIER3_03_STARTDIALOGUE = FALSE;
    };
    PRINTSCREEN(PRINT_NOTENOUGHLEARNPOINTS, -(1), -(1), FONT_SCREEN, 2);
}

var int CIRCLEBOOK_TIER3_04_STARTDIALOGUE;
var int CIRCLEBOOK_TIER3_04_LEARNED;
instance ITWR_MAGICBOOK_CIRCLE3_04(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE3_04;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE3;
    VISUAL = "KM_item_book_07.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE3_04_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_02_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE3_04;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

instance ITWR_MAGICBOOK_CIRCLE3_04_GOOD(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE3_04;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE3_GOOD;
    VISUAL = "KM_item_book_03.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE3_04_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_01_GOOD_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE3_04;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_MAGICBOOK_CIRCLE3_04() {
    if ((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) >= (2)) {
        if ((((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) == (3)) || ((MARVIN_MAGELEARNING_TIER3) == (4))) || ((CIRCLEBOOK_TIER3_04_LEARNED) == (TRUE))) {
        } else {
            CIRCLEBOOK_TIER3_04_STARTDIALOGUE = 1;
            AI_PROCESSINFOS(HERO);
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_CIRCLE, -(1), -(1), FONT_SCREEN, 4);
}

instance CIRCLEBOOK_TIER3_04_END(C_INFO) {
    NPC = 50091;
    NR = 999;
    CONDITION = CIRCLEBOOK_TIER3_04_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER3_04_EXIT;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int CIRCLEBOOK_TIER3_04_CONDITION() {
    return CIRCLEBOOK_TIER3_04_STARTDIALOGUE;
}

func void CIRCLEBOOK_TIER3_04_EXIT() {
    AI_STOPPROCESSINFOS(SELF);
    CIRCLEBOOK_TIER3_04_STARTDIALOGUE = FALSE;
}

instance CIRCLEBOOK_TIER3_04_LEARN(C_INFO) {
    NPC = 50091;
    NR = 1;
    CONDITION = CIRCLEBOOK_TIER3_04_LEARN_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER3_04_LEARN_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = B_BUILDLEARNSTRING2(PRINT_LEARN_CIRCLE3_BOOK4, 10, 0);
}

func int CIRCLEBOOK_TIER3_04_LEARN_CONDITION() {
    if (((CIRCLEBOOK_TIER3_04_STARTDIALOGUE) == (TRUE)) && ((CIRCLEBOOK_TIER3_04_LEARNED) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void CIRCLEBOOK_TIER3_04_LEARN_INFO() {
    if ((HERO.LP) >= (10)) {
        HERO.LP = (HERO.LP) - (10);
        CIRCLEBOOK_TIER3_04_LEARNED = TRUE;
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER3_PART4);
        CIRCLEBOOK_TIER3_LEARNPLAYER();
        SND_PLAY("LEVELUP");
        AI_STOPPROCESSINFOS(SELF);
        CIRCLEBOOK_TIER3_04_STARTDIALOGUE = FALSE;
    };
    PRINTSCREEN(PRINT_NOTENOUGHLEARNPOINTS, -(1), -(1), FONT_SCREEN, 2);
}

var int CIRCLEBOOK_TIER4_01_STARTDIALOGUE;
var int CIRCLEBOOK_TIER4_01_LEARNED;
instance ITWR_MAGICBOOK_CIRCLE4_01(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE4_01;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE4;
    VISUAL = "KM_item_book_08.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE4_01_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_02_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE4_01;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

instance ITWR_MAGICBOOK_CIRCLE4_01_GOOD(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE4_01;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE4_GOOD;
    VISUAL = "KM_item_book_04.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE4_01_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_01_GOOD_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE4_01;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_MAGICBOOK_CIRCLE4_01() {
    if ((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) >= (3)) {
        if ((((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) == (4)) || ((MARVIN_MAGELEARNING_TIER4) == (5))) || ((CIRCLEBOOK_TIER4_01_LEARNED) == (TRUE))) {
        } else {
            CIRCLEBOOK_TIER4_01_STARTDIALOGUE = 1;
            AI_PROCESSINFOS(HERO);
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_CIRCLE, -(1), -(1), FONT_SCREEN, 4);
}

instance CIRCLEBOOK_TIER4_01_END(C_INFO) {
    NPC = 50091;
    NR = 999;
    CONDITION = CIRCLEBOOK_TIER4_01_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER4_01_EXIT;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int CIRCLEBOOK_TIER4_01_CONDITION() {
    return CIRCLEBOOK_TIER4_01_STARTDIALOGUE;
}

func void CIRCLEBOOK_TIER4_01_EXIT() {
    AI_STOPPROCESSINFOS(SELF);
    CIRCLEBOOK_TIER4_01_STARTDIALOGUE = FALSE;
}

instance CIRCLEBOOK_TIER4_01_LEARN(C_INFO) {
    NPC = 50091;
    NR = 1;
    CONDITION = CIRCLEBOOK_TIER4_01_LEARN_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER4_01_LEARN_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = B_BUILDLEARNSTRING2(PRINT_LEARN_CIRCLE4_BOOK1, 10, 0);
}

func int CIRCLEBOOK_TIER4_01_LEARN_CONDITION() {
    if (((CIRCLEBOOK_TIER4_01_STARTDIALOGUE) == (TRUE)) && ((CIRCLEBOOK_TIER4_01_LEARNED) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void CIRCLEBOOK_TIER4_01_LEARN_INFO() {
    if ((HERO.LP) >= (10)) {
        HERO.LP = (HERO.LP) - (10);
        CIRCLEBOOK_TIER4_01_LEARNED = TRUE;
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER4_PART1);
        CIRCLEBOOK_TIER4_LEARNPLAYER();
        SND_PLAY("LEVELUP");
        AI_STOPPROCESSINFOS(SELF);
        CIRCLEBOOK_TIER4_01_STARTDIALOGUE = FALSE;
    };
    PRINTSCREEN(PRINT_NOTENOUGHLEARNPOINTS, -(1), -(1), FONT_SCREEN, 2);
}

var int CIRCLEBOOK_TIER4_02_STARTDIALOGUE;
var int CIRCLEBOOK_TIER4_02_LEARNED;
instance ITWR_MAGICBOOK_CIRCLE4_02(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE4_02;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE4;
    VISUAL = "KM_item_book_08.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE4_02_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_02_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE4_02;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

instance ITWR_MAGICBOOK_CIRCLE4_02_GOOD(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE4_02;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE4_GOOD;
    VISUAL = "KM_item_book_04.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE4_02_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_01_GOOD_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE4_02;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_MAGICBOOK_CIRCLE4_02() {
    if ((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) >= (3)) {
        if ((((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) == (4)) || ((MARVIN_MAGELEARNING_TIER4) == (5))) || ((CIRCLEBOOK_TIER4_02_LEARNED) == (TRUE))) {
        } else {
            CIRCLEBOOK_TIER4_02_STARTDIALOGUE = 1;
            AI_PROCESSINFOS(HERO);
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_CIRCLE, -(1), -(1), FONT_SCREEN, 4);
}

instance CIRCLEBOOK_TIER4_02_END(C_INFO) {
    NPC = 50091;
    NR = 999;
    CONDITION = CIRCLEBOOK_TIER4_02_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER4_02_EXIT;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int CIRCLEBOOK_TIER4_02_CONDITION() {
    return CIRCLEBOOK_TIER4_02_STARTDIALOGUE;
}

func void CIRCLEBOOK_TIER4_02_EXIT() {
    AI_STOPPROCESSINFOS(SELF);
    CIRCLEBOOK_TIER4_02_STARTDIALOGUE = FALSE;
}

instance CIRCLEBOOK_TIER4_02_LEARN(C_INFO) {
    NPC = 50091;
    NR = 1;
    CONDITION = CIRCLEBOOK_TIER4_02_LEARN_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER4_02_LEARN_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = B_BUILDLEARNSTRING2(PRINT_LEARN_CIRCLE4_BOOK2, 10, 0);
}

func int CIRCLEBOOK_TIER4_02_LEARN_CONDITION() {
    if (((CIRCLEBOOK_TIER4_02_STARTDIALOGUE) == (TRUE)) && ((CIRCLEBOOK_TIER4_02_LEARNED) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void CIRCLEBOOK_TIER4_02_LEARN_INFO() {
    if ((HERO.LP) >= (10)) {
        HERO.LP = (HERO.LP) - (10);
        CIRCLEBOOK_TIER4_02_LEARNED = TRUE;
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER4_PART2);
        CIRCLEBOOK_TIER4_LEARNPLAYER();
        SND_PLAY("LEVELUP");
        AI_STOPPROCESSINFOS(SELF);
        CIRCLEBOOK_TIER4_02_STARTDIALOGUE = FALSE;
    };
    PRINTSCREEN(PRINT_NOTENOUGHLEARNPOINTS, -(1), -(1), FONT_SCREEN, 2);
}

var int CIRCLEBOOK_TIER4_03_STARTDIALOGUE;
var int CIRCLEBOOK_TIER4_03_LEARNED;
instance ITWR_MAGICBOOK_CIRCLE4_03(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE4_03;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE4;
    VISUAL = "KM_item_book_08.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE4_03_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_02_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE4_03;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

instance ITWR_MAGICBOOK_CIRCLE4_03_GOOD(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE4_03;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE4_GOOD;
    VISUAL = "KM_item_book_04.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE4_03_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_01_GOOD_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE4_03;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_MAGICBOOK_CIRCLE4_03() {
    if ((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) >= (3)) {
        if ((((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) == (4)) || ((MARVIN_MAGELEARNING_TIER4) == (5))) || ((CIRCLEBOOK_TIER4_03_LEARNED) == (TRUE))) {
        } else {
            CIRCLEBOOK_TIER4_03_STARTDIALOGUE = 1;
            AI_PROCESSINFOS(HERO);
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_CIRCLE, -(1), -(1), FONT_SCREEN, 4);
}

instance CIRCLEBOOK_TIER4_03_END(C_INFO) {
    NPC = 50091;
    NR = 999;
    CONDITION = CIRCLEBOOK_TIER4_03_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER4_03_EXIT;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int CIRCLEBOOK_TIER4_03_CONDITION() {
    return CIRCLEBOOK_TIER4_03_STARTDIALOGUE;
}

func void CIRCLEBOOK_TIER4_03_EXIT() {
    AI_STOPPROCESSINFOS(SELF);
    CIRCLEBOOK_TIER4_03_STARTDIALOGUE = FALSE;
}

instance CIRCLEBOOK_TIER4_03_LEARN(C_INFO) {
    NPC = 50091;
    NR = 1;
    CONDITION = CIRCLEBOOK_TIER4_03_LEARN_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER4_03_LEARN_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = B_BUILDLEARNSTRING2(PRINT_LEARN_CIRCLE4_BOOK3, 10, 0);
}

func int CIRCLEBOOK_TIER4_03_LEARN_CONDITION() {
    if (((CIRCLEBOOK_TIER4_03_STARTDIALOGUE) == (TRUE)) && ((CIRCLEBOOK_TIER4_03_LEARNED) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void CIRCLEBOOK_TIER4_03_LEARN_INFO() {
    if ((HERO.LP) >= (10)) {
        HERO.LP = (HERO.LP) - (10);
        CIRCLEBOOK_TIER4_03_LEARNED = TRUE;
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER4_PART3);
        CIRCLEBOOK_TIER4_LEARNPLAYER();
        SND_PLAY("LEVELUP");
        AI_STOPPROCESSINFOS(SELF);
        CIRCLEBOOK_TIER4_03_STARTDIALOGUE = FALSE;
    };
    PRINTSCREEN(PRINT_NOTENOUGHLEARNPOINTS, -(1), -(1), FONT_SCREEN, 2);
}

var int CIRCLEBOOK_TIER4_04_STARTDIALOGUE;
var int CIRCLEBOOK_TIER4_04_LEARNED;
instance ITWR_MAGICBOOK_CIRCLE4_04(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE4_04;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE4;
    VISUAL = "KM_item_book_08.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE4_04_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_02_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE4_04;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

instance ITWR_MAGICBOOK_CIRCLE4_04_GOOD(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE4_04;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE4_GOOD;
    VISUAL = "KM_item_book_04.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE4_04_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_01_GOOD_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE4_04;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_MAGICBOOK_CIRCLE4_04() {
    if ((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) >= (3)) {
        if ((((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) == (4)) || ((MARVIN_MAGELEARNING_TIER4) == (5))) || ((CIRCLEBOOK_TIER4_04_LEARNED) == (TRUE))) {
        } else {
            CIRCLEBOOK_TIER4_04_STARTDIALOGUE = 1;
            AI_PROCESSINFOS(HERO);
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_CIRCLE, -(1), -(1), FONT_SCREEN, 4);
}

instance CIRCLEBOOK_TIER4_04_END(C_INFO) {
    NPC = 50091;
    NR = 999;
    CONDITION = CIRCLEBOOK_TIER4_04_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER4_04_EXIT;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int CIRCLEBOOK_TIER4_04_CONDITION() {
    return CIRCLEBOOK_TIER4_04_STARTDIALOGUE;
}

func void CIRCLEBOOK_TIER4_04_EXIT() {
    AI_STOPPROCESSINFOS(SELF);
    CIRCLEBOOK_TIER4_04_STARTDIALOGUE = FALSE;
}

instance CIRCLEBOOK_TIER4_04_LEARN(C_INFO) {
    NPC = 50091;
    NR = 1;
    CONDITION = CIRCLEBOOK_TIER4_04_LEARN_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER4_04_LEARN_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = B_BUILDLEARNSTRING2(PRINT_LEARN_CIRCLE4_BOOK4, 10, 0);
}

func int CIRCLEBOOK_TIER4_04_LEARN_CONDITION() {
    if (((CIRCLEBOOK_TIER4_04_STARTDIALOGUE) == (TRUE)) && ((CIRCLEBOOK_TIER4_04_LEARNED) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void CIRCLEBOOK_TIER4_04_LEARN_INFO() {
    if ((HERO.LP) >= (10)) {
        HERO.LP = (HERO.LP) - (10);
        CIRCLEBOOK_TIER4_04_LEARNED = TRUE;
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER4_PART4);
        CIRCLEBOOK_TIER4_LEARNPLAYER();
        SND_PLAY("LEVELUP");
        AI_STOPPROCESSINFOS(SELF);
        CIRCLEBOOK_TIER4_04_STARTDIALOGUE = FALSE;
    };
    PRINTSCREEN(PRINT_NOTENOUGHLEARNPOINTS, -(1), -(1), FONT_SCREEN, 2);
}

var int CIRCLEBOOK_TIER4_05_STARTDIALOGUE;
var int CIRCLEBOOK_TIER4_05_LEARNED;
instance ITWR_MAGICBOOK_CIRCLE4_05(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE4_05;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE4;
    VISUAL = "KM_item_book_08.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE4_05_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_02_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE4_05;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

instance ITWR_MAGICBOOK_CIRCLE4_05_GOOD(C_ITEM) {
    NAME = WRITTENNAME_MAGICBOOK_CIRCLE4_05;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_MAGICBOOK_CIRCLE4_GOOD;
    VISUAL = "KM_item_book_04.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE4_05_1;
    TEXT[2] = ITEMDESC_ITWR_MAGICBOOK_CIRCLE1_01_GOOD_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_MAGICBOOK_CIRCLE4_05;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_MAGICBOOK_CIRCLE4_05() {
    if ((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) >= (3)) {
        if ((((NPC_GETTALENTSKILL(HERO, NPC_TALENT_MAGE)) == (4)) || ((MARVIN_MAGELEARNING_TIER4) == (5))) || ((CIRCLEBOOK_TIER4_05_LEARNED) == (TRUE))) {
        } else {
            CIRCLEBOOK_TIER4_05_STARTDIALOGUE = 1;
            AI_PROCESSINFOS(HERO);
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_CIRCLE, -(1), -(1), FONT_SCREEN, 4);
}

instance CIRCLEBOOK_TIER4_05_END(C_INFO) {
    NPC = 50091;
    NR = 999;
    CONDITION = CIRCLEBOOK_TIER4_05_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER4_05_EXIT;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int CIRCLEBOOK_TIER4_05_CONDITION() {
    return CIRCLEBOOK_TIER4_05_STARTDIALOGUE;
}

func void CIRCLEBOOK_TIER4_05_EXIT() {
    AI_STOPPROCESSINFOS(SELF);
    CIRCLEBOOK_TIER4_05_STARTDIALOGUE = FALSE;
}

instance CIRCLEBOOK_TIER4_05_LEARN(C_INFO) {
    NPC = 50091;
    NR = 1;
    CONDITION = CIRCLEBOOK_TIER4_05_LEARN_CONDITION;
    INFORMATION = CIRCLEBOOK_TIER4_05_LEARN_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = B_BUILDLEARNSTRING2(PRINT_LEARN_CIRCLE4_BOOK5, 10, 0);
}

func int CIRCLEBOOK_TIER4_05_LEARN_CONDITION() {
    if (((CIRCLEBOOK_TIER4_05_STARTDIALOGUE) == (TRUE)) && ((CIRCLEBOOK_TIER4_05_LEARNED) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void CIRCLEBOOK_TIER4_05_LEARN_INFO() {
    if ((HERO.LP) >= (10)) {
        HERO.LP = (HERO.LP) - (10);
        CIRCLEBOOK_TIER4_05_LEARNED = TRUE;
        LOG_CREATETOPIC(TOPIC_MAGIC, LOG_NOTE);
        B_LOGENTRY(TOPIC_MAGIC, LOG_CIRCLEBOOKTIER4_PART5);
        CIRCLEBOOK_TIER4_LEARNPLAYER();
        SND_PLAY("LEVELUP");
        AI_STOPPROCESSINFOS(SELF);
        CIRCLEBOOK_TIER4_05_STARTDIALOGUE = FALSE;
    };
    PRINTSCREEN(PRINT_NOTENOUGHLEARNPOINTS, -(1), -(1), FONT_SCREEN, 2);
}

var int ALCHEMYBOOK_TIER1_STARTDIALOGUE;
var int ALCHEMYBOOK_TIER1_LEARNED;
instance ITWR_ALCHEMY_TIER1(C_ITEM) {
    NAME = WRITTENNAME_ALCHEMY_TIER1;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_BOOK_ALCHEMY;
    VISUAL = "KM_item_book_11.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_ALCHEMY_TIER1_1;
    TEXT[2] = ITEMDESC_ITWR_ALCHEMY_TIER1_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USEALCHEMYLOKVAR;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USEALCHEMYLOKVAR() {
    if ((NPC_GETTALENTSKILL(HERO, NPC_TALENT_ALCHEMY)) >= (0)) {
        if (((NPC_GETTALENTSKILL(HERO, NPC_TALENT_ALCHEMY)) == (1)) || ((ALCHEMYBOOK_TIER1_LEARNED) == (TRUE))) {
        } else {
            ALCHEMYBOOK_TIER1_STARTDIALOGUE = 1;
            AI_PROCESSINFOS(HERO);
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK, -(1), -(1), FONT_SCREEN, 4);
}

instance ALCHEMYBOOK_TIER1_END(C_INFO) {
    NPC = 50091;
    NR = 999;
    CONDITION = ALCHEMYBOOK_TIER1_CONDITION;
    INFORMATION = ALCHEMYBOOK_TIER1_EXIT;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int ALCHEMYBOOK_TIER1_CONDITION() {
    return ALCHEMYBOOK_TIER1_STARTDIALOGUE;
}

func void ALCHEMYBOOK_TIER1_EXIT() {
    AI_STOPPROCESSINFOS(SELF);
    ALCHEMYBOOK_TIER1_STARTDIALOGUE = FALSE;
}

instance ALCHEMYBOOK_TIER1_LEARN(C_INFO) {
    NPC = 50091;
    NR = 1;
    CONDITION = ALCHEMYBOOK_TIER1_LEARN_CONDITION;
    INFORMATION = ALCHEMYBOOK_TIER1_LEARN_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = B_BUILDLEARNSTRING2(PRINT_LEARN_ALCHEMY1, 10, 0);
}

func int ALCHEMYBOOK_TIER1_LEARN_CONDITION() {
    if (((ALCHEMYBOOK_TIER1_STARTDIALOGUE) == (TRUE)) && ((ALCHEMYBOOK_TIER1_LEARNED) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void ALCHEMYBOOK_TIER1_LEARN_INFO() {
    if ((HERO.LP) >= (10)) {
        HERO.LP = (HERO.LP) - (10);
        ALCHEMYBOOK_TIER1_LEARNED = TRUE;
        NPC_SETTALENTSKILL(HERO, NPC_TALENT_ALCHEMY, 1);
        MEM_PUSHINTPARAM(1);
        MEM_CALLBYID(MEM_GETFUNCID(61695));
        SND_PLAY("LEVELUP");
        AI_STOPPROCESSINFOS(SELF);
        ALCHEMYBOOK_TIER1_STARTDIALOGUE = FALSE;
    };
    PRINTSCREEN(PRINT_NOTENOUGHLEARNPOINTS, -(1), -(1), FONT_SCREEN, 2);
}

var int VOLFZACKE_LEARNING_STARTDIALOGUE;
var int VOLFZACKE_LEARNING_TEACHED;
instance ITWR_VOLFZACKE_LEARNING(C_ITEM) {
    NAME = WRITTENNAME_VOLFZACKE_LEARNING;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = ITEM_IMPORTANT;
    VALUE = 0;
    VISUAL = "KM_item_book_19.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_VOLFZACKE_LEARNING_1;
    TEXT[2] = ITEMDESC_ITWR_VOLFZACKE_LEARNING_2;
    ON_STATE[0] = USEVOLFZACKE_LEARNING;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USEVOLFZACKE_LEARNING() {
    VOLFZACKE_LEARNING_STARTDIALOGUE = 1;
    AI_PROCESSINFOS(HERO);
}

instance VOLFZACKE_LEARNING_TEACH(C_INFO) {
    NPC = 50091;
    NR = 1;
    CONDITION = VOLFZACKE_LEARNING_TEACH_CONDITION;
    INFORMATION = VOLFZACKE_LEARNING_TEACH_INFO;
    PERMANENT = TRUE;
    IMPORTANT = TRUE;
}

func int VOLFZACKE_LEARNING_TEACH_CONDITION() {
    if ((VOLFZACKE_LEARNING_STARTDIALOGUE) == (TRUE)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

const int VOLFZACKE_LEARNING_LIMIT_ATR = 9999;
const int VOLFZACKE_LEARNING_LIMIT_TALENT = 100;
func void VOLFZACKE_LEARNING_TEACH_CHOICES() {
    var int VOLFZACKE_GOLDCOST;
    VOLFZACKE_GOLDCOST = 0;
    INFO_CLEARCHOICES(41000);
    INFO_ADDCHOICE(41000, DIALOG_ENDE, 41022);
    INFO_ADDCHOICE(41000, B_BUILDLEARNSTRING2(PRINT_LEARNCROSSBOW1, B_GETLEARNCOSTTALENT(HERO, NPC_TALENT_CROSSBOW, 1), VOLFZACKE_GOLDCOST), 41012);
    INFO_ADDCHOICE(41000, B_BUILDLEARNSTRING2(PRINT_LEARNCROSSBOW5, B_GETLEARNCOSTTALENT(HERO, NPC_TALENT_CROSSBOW, 5), (VOLFZACKE_GOLDCOST) * (5)), 41013);
    INFO_ADDCHOICE(41000, B_BUILDLEARNSTRING2(PRINT_LEARNBOW1, B_GETLEARNCOSTTALENT(HERO, NPC_TALENT_BOW, 1), VOLFZACKE_GOLDCOST), 41014);
    INFO_ADDCHOICE(41000, B_BUILDLEARNSTRING2(PRINT_LEARNBOW5, B_GETLEARNCOSTTALENT(HERO, NPC_TALENT_BOW, 5), (VOLFZACKE_GOLDCOST) * (5)), 41015);
    INFO_ADDCHOICE(41000, B_BUILDLEARNSTRING2(PRINT_LEARN2H1, B_GETLEARNCOSTTALENT(HERO, NPC_TALENT_2H, 1), VOLFZACKE_GOLDCOST), 41018);
    INFO_ADDCHOICE(41000, B_BUILDLEARNSTRING2(PRINT_LEARN2H5, B_GETLEARNCOSTTALENT(HERO, NPC_TALENT_2H, 5), (VOLFZACKE_GOLDCOST) * (5)), 41019);
    INFO_ADDCHOICE(41000, B_BUILDLEARNSTRING2(PRINT_LEARN1H1, B_GETLEARNCOSTTALENT(HERO, NPC_TALENT_1H, 1), VOLFZACKE_GOLDCOST), 41016);
    INFO_ADDCHOICE(41000, B_BUILDLEARNSTRING2(PRINT_LEARN1H5, B_GETLEARNCOSTTALENT(HERO, NPC_TALENT_1H, 5), (VOLFZACKE_GOLDCOST) * (5)), 41017);
    INFO_ADDCHOICE(41000, B_BUILDLEARNSTRING2(PRINT_LEARNDEX1, B_GETLEARNCOSTATTRIBUTE(HERO, ATR_DEXTERITY, 1), VOLFZACKE_GOLDCOST), 41010);
    INFO_ADDCHOICE(41000, B_BUILDLEARNSTRING2(PRINT_LEARNDEX5, B_GETLEARNCOSTATTRIBUTE(HERO, ATR_DEXTERITY, 5), (VOLFZACKE_GOLDCOST) * (5)), 41011);
    INFO_ADDCHOICE(41000, B_BUILDLEARNSTRING2(PRINT_LEARNSTR1, B_GETLEARNCOSTATTRIBUTE(HERO, ATR_STRENGTH, 1), VOLFZACKE_GOLDCOST), 41008);
    INFO_ADDCHOICE(41000, B_BUILDLEARNSTRING2(PRINT_LEARNSTR5, B_GETLEARNCOSTATTRIBUTE(HERO, ATR_STRENGTH, 5), (VOLFZACKE_GOLDCOST) * (5)), 41009);
}

func void VOLFZACKE_LEARNING_TEACH_INFO() {
    var int VOLFZACKE_LEARNING_FIRSTTIME;
    if ((VOLFZACKE_LEARNING_FIRSTTIME) == (FALSE)) {
        VOLFZACKE_LEARNING_FIRSTTIME = TRUE;
        AI_OUTPUT(HERO, HERO, "DIA_MARVIN_Volfzacke_Learning_15_01");
        LOG_CREATETOPIC(TOPIC_VOLFZACKETEACHER, LOG_NOTE);
        B_LOGENTRY(TOPIC_VOLFZACKETEACHER, LOG_VOLFZACKEBOOK_GOODIDEA);
    };
    VOLFZACKE_LEARNING_TEACH_CHOICES();
}

func void VOLFZACKE_LEARNING_TEACH_STR_1() {
    B_TEACHATTRIBUTEPOINTS(HERO, HERO, ATR_STRENGTH, 1, VOLFZACKE_LEARNING_LIMIT_ATR);
    VOLFZACKE_LEARNING_TEACH_CHOICES();
}

func void VOLFZACKE_LEARNING_TEACH_STR_5() {
    B_TEACHATTRIBUTEPOINTS(HERO, HERO, ATR_STRENGTH, 5, VOLFZACKE_LEARNING_LIMIT_ATR);
    VOLFZACKE_LEARNING_TEACH_CHOICES();
}

func void VOLFZACKE_LEARNING_TEACH_DEX_1() {
    B_TEACHATTRIBUTEPOINTS(HERO, HERO, ATR_DEXTERITY, 1, VOLFZACKE_LEARNING_LIMIT_ATR);
    VOLFZACKE_LEARNING_TEACH_CHOICES();
}

func void VOLFZACKE_LEARNING_TEACH_DEX_5() {
    B_TEACHATTRIBUTEPOINTS(HERO, HERO, ATR_DEXTERITY, 5, VOLFZACKE_LEARNING_LIMIT_ATR);
    VOLFZACKE_LEARNING_TEACH_CHOICES();
}

func void VOLFZACKE_LEARNING_TEACH_CBOW_1() {
    B_TEACHFIGHTTALENTPERCENT(HERO, HERO, NPC_TALENT_CROSSBOW, 1, VOLFZACKE_LEARNING_LIMIT_TALENT);
    VOLFZACKE_LEARNING_TEACH_CHOICES();
}

func void VOLFZACKE_LEARNING_TEACH_CBOW_5() {
    B_TEACHFIGHTTALENTPERCENT(HERO, HERO, NPC_TALENT_CROSSBOW, 5, VOLFZACKE_LEARNING_LIMIT_TALENT);
    VOLFZACKE_LEARNING_TEACH_CHOICES();
}

func void VOLFZACKE_LEARNING_TEACH_BOW_1() {
    B_TEACHFIGHTTALENTPERCENT(HERO, HERO, NPC_TALENT_BOW, 1, VOLFZACKE_LEARNING_LIMIT_TALENT);
    VOLFZACKE_LEARNING_TEACH_CHOICES();
}

func void VOLFZACKE_LEARNING_TEACH_BOW_5() {
    B_TEACHFIGHTTALENTPERCENT(HERO, HERO, NPC_TALENT_BOW, 5, VOLFZACKE_LEARNING_LIMIT_TALENT);
    VOLFZACKE_LEARNING_TEACH_CHOICES();
}

func void VOLFZACKE_LEARNING_TEACH_1H_1() {
    B_TEACHFIGHTTALENTPERCENT(HERO, HERO, NPC_TALENT_1H, 1, VOLFZACKE_LEARNING_LIMIT_TALENT);
    VOLFZACKE_LEARNING_TEACH_CHOICES();
}

func void VOLFZACKE_LEARNING_TEACH_1H_5() {
    B_TEACHFIGHTTALENTPERCENT(HERO, HERO, NPC_TALENT_1H, 5, VOLFZACKE_LEARNING_LIMIT_TALENT);
    VOLFZACKE_LEARNING_TEACH_CHOICES();
}

func void VOLFZACKE_LEARNING_TEACH_2H_1() {
    B_TEACHFIGHTTALENTPERCENT(HERO, HERO, NPC_TALENT_2H, 1, VOLFZACKE_LEARNING_LIMIT_TALENT);
    VOLFZACKE_LEARNING_TEACH_CHOICES();
}

func void VOLFZACKE_LEARNING_TEACH_2H_5() {
    B_TEACHFIGHTTALENTPERCENT(HERO, HERO, NPC_TALENT_2H, 5, VOLFZACKE_LEARNING_LIMIT_TALENT);
    VOLFZACKE_LEARNING_TEACH_CHOICES();
}

instance VOLFZACKE_LEARNING_END(C_INFO) {
    NPC = 50091;
    NR = 999;
    CONDITION = VOLFZACKE_LEARNING_CONDITION;
    INFORMATION = VOLFZACKE_LEARNING_EXIT;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int VOLFZACKE_LEARNING_CONDITION() {
    return VOLFZACKE_LEARNING_STARTDIALOGUE;
}

func void VOLFZACKE_LEARNING_EXIT() {
    AI_STOPPROCESSINFOS(SELF);
    VOLFZACKE_LEARNING_STARTDIALOGUE = FALSE;
}

var string TALENTBOOK_LEARN_1;
var string TALENTBOOK_LEARN_2;
var string TALENTBOOK_LEARN_3;
var int TALENTBOOK_SOUTHERNER_TIER1_LEARNED;
instance ITWR_TALENTBOOK_SOUTHERNER_TIER1(C_ITEM) {
    NAME = WRITTENNAME_TALENTBOOK_SOUTHERNER_TIER1;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = ITEM_MULTI;
    VALUE = VALUE_TALENTBOOK_TIER1;
    VISUAL = "KM_item_book_12.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[0] = ITEMDESC_ITWR_TALENTBOOK_SOUTHERNER_TIER1_1;
    TEXT[1] = ITEMDESC_ITWR_TALENTBOOK_SOUTHERNER_TIER1_2;
    TEXT[2] = BONUS_2H;
    COUNT[2] = 1;
    TEXT[3] = NAME_BONUS_DEX;
    COUNT[3] = 1;
    TEXT[4] = NAME_BONUS_STR;
    COUNT[4] = 1;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_TALENTBOOK_SOUTHERNER_TIER1;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_TALENTBOOK_SOUTHERNER_TIER1() {
    if ((TALENTBOOK_SOUTHERNER_TIER1_LEARNED) == (FALSE)) {
        TALENTBOOK_SOUTHERNER_TIER1_LEARNED = TRUE;
        NPC_CHANGEATTRIBUTE(SELF, ATR_STRENGTH, 1);
        NPC_CHANGEATTRIBUTE(SELF, ATR_DEXTERITY, 1);
        B_RAISEFIGHTTALENT(SELF, NPC_TALENT_2H, 1);
        SND_PLAY("LevelUp");
        TALENTBOOK_LEARN_1 = CONCATSTRINGS(PRINT_LEARNSTR, INTTOSTRING(1));
        PRINTSCREEN(TALENTBOOK_LEARN_1, -(1), YPOS_LOGENTRY, FONT_SCREEN, 4);
        TALENTBOOK_LEARN_2 = CONCATSTRINGS(PRINT_LEARNDEX, INTTOSTRING(1));
        PRINTSCREEN(TALENTBOOK_LEARN_2, -(1), YPOS_ITEMTAKEN, FONT_SCREEN, 4);
        TALENTBOOK_LEARN_3 = CONCATSTRINGS(PRINT_LEARN2H_ONLY, INTTOSTRING(1));
    };
    PRINTSCREEN(PRINT_KNOWTHISALREADY, -(1), -(1), FONT_SCREEN, 4);
}

var int TALENTBOOK_SOUTHERNER_TIER2_LEARNED;
instance ITWR_TALENTBOOK_SOUTHERNER_TIER2(C_ITEM) {
    NAME = WRITTENNAME_TALENTBOOK_SOUTHERNER_TIER2;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = ITEM_MULTI;
    VALUE = VALUE_TALENTBOOK_TIER2;
    VISUAL = "KM_item_book_12.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[0] = ITEMDESC_ITWR_TALENTBOOK_SOUTHERNER_TIER2_1;
    TEXT[1] = ITEMDESC_ITWR_TALENTBOOK_SOUTHERNER_TIER1_2;
    TEXT[2] = BONUS_2H;
    COUNT[2] = 1;
    TEXT[3] = NAME_BONUS_DEX;
    COUNT[3] = 2;
    TEXT[4] = NAME_BONUS_STR;
    COUNT[4] = 2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_TALENTBOOK_SOUTHERNER_TIER2;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_TALENTBOOK_SOUTHERNER_TIER2() {
    if ((TALENTBOOK_SOUTHERNER_TIER1_LEARNED) == (TRUE)) {
        if ((TALENTBOOK_SOUTHERNER_TIER2_LEARNED) == (FALSE)) {
            TALENTBOOK_SOUTHERNER_TIER2_LEARNED = TRUE;
            NPC_CHANGEATTRIBUTE(SELF, ATR_STRENGTH, 2);
            NPC_CHANGEATTRIBUTE(SELF, ATR_DEXTERITY, 2);
            B_RAISEFIGHTTALENT(SELF, NPC_TALENT_2H, 1);
            SND_PLAY("LevelUp");
            TALENTBOOK_LEARN_1 = CONCATSTRINGS(PRINT_LEARNSTR, INTTOSTRING(2));
            PRINTSCREEN(TALENTBOOK_LEARN_1, -(1), YPOS_LOGENTRY, FONT_SCREEN, 4);
            TALENTBOOK_LEARN_2 = CONCATSTRINGS(PRINT_LEARNDEX, INTTOSTRING(2));
            PRINTSCREEN(TALENTBOOK_LEARN_2, -(1), YPOS_ITEMTAKEN, FONT_SCREEN, 4);
            TALENTBOOK_LEARN_3 = CONCATSTRINGS(PRINT_LEARN2H_ONLY, INTTOSTRING(1));
        } else {
            /* set_instance(0) */;
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_TALENT, -(1), -(1), FONT_SCREEN, 4);
}

var int TALENTBOOK_SOUTHERNER_TIER3_LEARNED;
instance ITWR_TALENTBOOK_SOUTHERNER_TIER3(C_ITEM) {
    NAME = WRITTENNAME_TALENTBOOK_SOUTHERNER_TIER3;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = ITEM_MULTI;
    VALUE = VALUE_TALENTBOOK_TIER3;
    VISUAL = "KM_item_book_12.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[0] = ITEMDESC_ITWR_TALENTBOOK_SOUTHERNER_TIER3_1;
    TEXT[1] = ITEMDESC_ITWR_TALENTBOOK_SOUTHERNER_TIER1_2;
    TEXT[2] = BONUS_2H;
    COUNT[2] = 2;
    TEXT[3] = NAME_BONUS_DEX;
    COUNT[3] = 4;
    TEXT[4] = NAME_BONUS_STR;
    COUNT[4] = 2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_TALENTBOOK_SOUTHERNER_TIER3;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_TALENTBOOK_SOUTHERNER_TIER3() {
    if ((TALENTBOOK_SOUTHERNER_TIER2_LEARNED) == (TRUE)) {
        if ((TALENTBOOK_SOUTHERNER_TIER3_LEARNED) == (FALSE)) {
            TALENTBOOK_SOUTHERNER_TIER3_LEARNED = TRUE;
            NPC_CHANGEATTRIBUTE(SELF, ATR_STRENGTH, 2);
            NPC_CHANGEATTRIBUTE(SELF, ATR_DEXTERITY, 4);
            B_RAISEFIGHTTALENT(SELF, NPC_TALENT_2H, 2);
            SND_PLAY("LevelUp");
            TALENTBOOK_LEARN_1 = CONCATSTRINGS(PRINT_LEARNSTR, INTTOSTRING(2));
            PRINTSCREEN(TALENTBOOK_LEARN_1, -(1), YPOS_LOGENTRY, FONT_SCREEN, 4);
            TALENTBOOK_LEARN_2 = CONCATSTRINGS(PRINT_LEARNDEX, INTTOSTRING(4));
            PRINTSCREEN(TALENTBOOK_LEARN_2, -(1), YPOS_ITEMTAKEN, FONT_SCREEN, 4);
            TALENTBOOK_LEARN_3 = CONCATSTRINGS(PRINT_LEARN2H_ONLY, INTTOSTRING(2));
        } else {
            /* set_instance(0) */;
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_TALENT, -(1), -(1), FONT_SCREEN, 4);
}

var int TALENTBOOK_SAILOR_TIER1_LEARNED;
instance ITWR_TALENTBOOK_SAILOR_TIER1(C_ITEM) {
    NAME = WRITTENNAME_TALENTBOOK_SAILOR_TIER1;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = ITEM_MULTI;
    VALUE = VALUE_TALENTBOOK_TIER1;
    VISUAL = "KM_item_book_13.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[0] = ITEMDESC_ITWR_TALENTBOOK_SOUTHERNER_TIER1_1;
    TEXT[1] = ITEMDESC_ITWR_TALENTBOOK_SAILOR_TIER1_2;
    TEXT[2] = BONUS_1H;
    COUNT[2] = 1;
    TEXT[3] = NAME_BONUS_DEX;
    COUNT[3] = 1;
    TEXT[4] = NAME_BONUS_STR;
    COUNT[4] = 1;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_TALENTBOOK_SAILOR_TIER1;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_TALENTBOOK_SAILOR_TIER1() {
    if ((TALENTBOOK_SAILOR_TIER1_LEARNED) == (FALSE)) {
        TALENTBOOK_SAILOR_TIER1_LEARNED = TRUE;
        NPC_CHANGEATTRIBUTE(SELF, ATR_STRENGTH, 1);
        NPC_CHANGEATTRIBUTE(SELF, ATR_DEXTERITY, 1);
        B_RAISEFIGHTTALENT(SELF, NPC_TALENT_1H, 1);
        SND_PLAY("LevelUp");
        TALENTBOOK_LEARN_1 = CONCATSTRINGS(PRINT_LEARNSTR, INTTOSTRING(1));
        PRINTSCREEN(TALENTBOOK_LEARN_1, -(1), YPOS_LOGENTRY, FONT_SCREEN, 4);
        TALENTBOOK_LEARN_2 = CONCATSTRINGS(PRINT_LEARNDEX, INTTOSTRING(1));
        PRINTSCREEN(TALENTBOOK_LEARN_2, -(1), YPOS_ITEMTAKEN, FONT_SCREEN, 4);
        TALENTBOOK_LEARN_3 = CONCATSTRINGS(PRINT_LEARN1H_ONLY, INTTOSTRING(1));
    };
    PRINTSCREEN(PRINT_KNOWTHISALREADY, -(1), -(1), FONT_SCREEN, 4);
}

var int TALENTBOOK_SAILOR_TIER2_LEARNED;
instance ITWR_TALENTBOOK_SAILOR_TIER2(C_ITEM) {
    NAME = WRITTENNAME_TALENTBOOK_SAILOR_TIER2;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = ITEM_MULTI;
    VALUE = VALUE_TALENTBOOK_TIER2;
    VISUAL = "KM_item_book_13.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[0] = ITEMDESC_ITWR_TALENTBOOK_SOUTHERNER_TIER2_1;
    TEXT[1] = ITEMDESC_ITWR_TALENTBOOK_SAILOR_TIER1_2;
    TEXT[2] = BONUS_1H;
    COUNT[2] = 1;
    TEXT[3] = NAME_BONUS_DEX;
    COUNT[3] = 2;
    TEXT[4] = NAME_BONUS_STR;
    COUNT[4] = 2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_TALENTBOOK_SAILOR_TIER2;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_TALENTBOOK_SAILOR_TIER2() {
    if ((TALENTBOOK_SAILOR_TIER1_LEARNED) == (TRUE)) {
        if ((TALENTBOOK_SAILOR_TIER2_LEARNED) == (FALSE)) {
            TALENTBOOK_SAILOR_TIER2_LEARNED = TRUE;
            NPC_CHANGEATTRIBUTE(SELF, ATR_STRENGTH, 2);
            NPC_CHANGEATTRIBUTE(SELF, ATR_DEXTERITY, 2);
            B_RAISEFIGHTTALENT(SELF, NPC_TALENT_1H, 1);
            SND_PLAY("LevelUp");
            TALENTBOOK_LEARN_1 = CONCATSTRINGS(PRINT_LEARNSTR, INTTOSTRING(2));
            PRINTSCREEN(TALENTBOOK_LEARN_1, -(1), YPOS_LOGENTRY, FONT_SCREEN, 4);
            TALENTBOOK_LEARN_2 = CONCATSTRINGS(PRINT_LEARNDEX, INTTOSTRING(2));
            PRINTSCREEN(TALENTBOOK_LEARN_2, -(1), YPOS_ITEMTAKEN, FONT_SCREEN, 4);
            TALENTBOOK_LEARN_3 = CONCATSTRINGS(PRINT_LEARN1H_ONLY, INTTOSTRING(1));
        } else {
            /* set_instance(0) */;
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_TALENT, -(1), -(1), FONT_SCREEN, 4);
}

var int TALENTBOOK_SAILOR_TIER3_LEARNED;
instance ITWR_TALENTBOOK_SAILOR_TIER3(C_ITEM) {
    NAME = WRITTENNAME_TALENTBOOK_SAILOR_TIER3;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = ITEM_MULTI;
    VALUE = VALUE_TALENTBOOK_TIER3;
    VISUAL = "KM_item_book_13.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[0] = ITEMDESC_ITWR_TALENTBOOK_SOUTHERNER_TIER3_1;
    TEXT[1] = ITEMDESC_ITWR_TALENTBOOK_SAILOR_TIER1_2;
    TEXT[2] = BONUS_1H;
    COUNT[2] = 1;
    TEXT[3] = NAME_BONUS_DEX;
    COUNT[3] = 2;
    TEXT[4] = NAME_BONUS_STR;
    COUNT[4] = 4;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_TALENTBOOK_SAILOR_TIER3;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_TALENTBOOK_SAILOR_TIER3() {
    if ((TALENTBOOK_SAILOR_TIER2_LEARNED) == (TRUE)) {
        if ((TALENTBOOK_SAILOR_TIER3_LEARNED) == (FALSE)) {
            TALENTBOOK_SAILOR_TIER3_LEARNED = TRUE;
            NPC_CHANGEATTRIBUTE(SELF, ATR_STRENGTH, 4);
            NPC_CHANGEATTRIBUTE(SELF, ATR_DEXTERITY, 2);
            B_RAISEFIGHTTALENT(SELF, NPC_TALENT_1H, 1);
            SND_PLAY("LevelUp");
            TALENTBOOK_LEARN_1 = CONCATSTRINGS(PRINT_LEARNSTR, INTTOSTRING(4));
            PRINTSCREEN(TALENTBOOK_LEARN_1, -(1), YPOS_LOGENTRY, FONT_SCREEN, 4);
            TALENTBOOK_LEARN_2 = CONCATSTRINGS(PRINT_LEARNDEX, INTTOSTRING(2));
            PRINTSCREEN(TALENTBOOK_LEARN_2, -(1), YPOS_ITEMTAKEN, FONT_SCREEN, 4);
            TALENTBOOK_LEARN_3 = CONCATSTRINGS(PRINT_LEARN1H_ONLY, INTTOSTRING(1));
        } else {
            /* set_instance(0) */;
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_TALENT, -(1), -(1), FONT_SCREEN, 4);
}

var int TALENTBOOK_NORDMAR_TIER1_LEARNED;
instance ITWR_TALENTBOOK_NORDMAR_TIER1(C_ITEM) {
    NAME = WRITTENNAME_TALENTBOOK_NORDMAR_TIER1;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = ITEM_MULTI;
    VALUE = VALUE_TALENTBOOK_TIER1;
    VISUAL = "KM_item_book_14.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[0] = ITEMDESC_ITWR_TALENTBOOK_SOUTHERNER_TIER1_1;
    TEXT[1] = ITEMDESC_ITWR_TALENTBOOK_NORDMAR_TIER1_2;
    TEXT[3] = BONUS_2H;
    COUNT[3] = 1;
    TEXT[4] = NAME_BONUS_STR;
    COUNT[4] = 2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_TALENTBOOK_NORDMAR_TIER1;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_TALENTBOOK_NORDMAR_TIER1() {
    if ((TALENTBOOK_NORDMAR_TIER1_LEARNED) == (FALSE)) {
        TALENTBOOK_NORDMAR_TIER1_LEARNED = TRUE;
        NPC_CHANGEATTRIBUTE(SELF, ATR_STRENGTH, 2);
        B_RAISEFIGHTTALENT(SELF, NPC_TALENT_2H, 1);
        SND_PLAY("LevelUp");
        TALENTBOOK_LEARN_1 = CONCATSTRINGS(PRINT_LEARNSTR, INTTOSTRING(2));
        PRINTSCREEN(TALENTBOOK_LEARN_1, -(1), YPOS_LOGENTRY, FONT_SCREEN, 4);
        TALENTBOOK_LEARN_2 = CONCATSTRINGS(PRINT_LEARN2H_ONLY, INTTOSTRING(1));
    };
    PRINTSCREEN(PRINT_KNOWTHISALREADY, -(1), -(1), FONT_SCREEN, 4);
}

var int TALENTBOOK_NORDMAR_TIER2_LEARNED;
instance ITWR_TALENTBOOK_NORDMAR_TIER2(C_ITEM) {
    NAME = WRITTENNAME_TALENTBOOK_NORDMAR_TIER2;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = ITEM_MULTI;
    VALUE = VALUE_TALENTBOOK_TIER2;
    VISUAL = "KM_item_book_14.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[0] = ITEMDESC_ITWR_TALENTBOOK_SOUTHERNER_TIER2_1;
    TEXT[1] = ITEMDESC_ITWR_TALENTBOOK_NORDMAR_TIER1_2;
    TEXT[3] = BONUS_2H;
    COUNT[3] = 1;
    TEXT[4] = NAME_BONUS_STR;
    COUNT[4] = 3;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_TALENTBOOK_NORDMAR_TIER2;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_TALENTBOOK_NORDMAR_TIER2() {
    if ((TALENTBOOK_NORDMAR_TIER1_LEARNED) == (TRUE)) {
        if ((TALENTBOOK_NORDMAR_TIER2_LEARNED) == (FALSE)) {
            TALENTBOOK_NORDMAR_TIER2_LEARNED = TRUE;
            NPC_CHANGEATTRIBUTE(SELF, ATR_STRENGTH, 3);
            B_RAISEFIGHTTALENT(SELF, NPC_TALENT_2H, 1);
            SND_PLAY("LevelUp");
            TALENTBOOK_LEARN_1 = CONCATSTRINGS(PRINT_LEARNSTR, INTTOSTRING(3));
            PRINTSCREEN(TALENTBOOK_LEARN_1, -(1), YPOS_LOGENTRY, FONT_SCREEN, 4);
            TALENTBOOK_LEARN_2 = CONCATSTRINGS(PRINT_LEARN2H_ONLY, INTTOSTRING(1));
        } else {
            /* set_instance(0) */;
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_TALENT, -(1), -(1), FONT_SCREEN, 4);
}

var int TALENTBOOK_NORDMAR_TIER3_LEARNED;
instance ITWR_TALENTBOOK_NORDMAR_TIER3(C_ITEM) {
    NAME = WRITTENNAME_TALENTBOOK_NORDMAR_TIER3;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = ITEM_MULTI;
    VALUE = VALUE_TALENTBOOK_TIER3;
    VISUAL = "KM_item_book_14.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[0] = ITEMDESC_ITWR_TALENTBOOK_SOUTHERNER_TIER3_1;
    TEXT[1] = ITEMDESC_ITWR_TALENTBOOK_NORDMAR_TIER1_2;
    TEXT[3] = BONUS_2H;
    COUNT[3] = 2;
    TEXT[4] = NAME_BONUS_STR;
    COUNT[4] = 5;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_TALENTBOOK_NORDMAR_TIER3;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_TALENTBOOK_NORDMAR_TIER3() {
    if ((TALENTBOOK_NORDMAR_TIER2_LEARNED) == (TRUE)) {
        if ((TALENTBOOK_NORDMAR_TIER3_LEARNED) == (FALSE)) {
            TALENTBOOK_NORDMAR_TIER3_LEARNED = TRUE;
            NPC_CHANGEATTRIBUTE(SELF, ATR_STRENGTH, 5);
            B_RAISEFIGHTTALENT(SELF, NPC_TALENT_2H, 2);
            SND_PLAY("LevelUp");
            TALENTBOOK_LEARN_1 = CONCATSTRINGS(PRINT_LEARNSTR, INTTOSTRING(5));
            PRINTSCREEN(TALENTBOOK_LEARN_1, -(1), YPOS_LOGENTRY, FONT_SCREEN, 4);
            TALENTBOOK_LEARN_2 = CONCATSTRINGS(PRINT_LEARN2H_ONLY, INTTOSTRING(2));
        } else {
            /* set_instance(0) */;
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_TALENT, -(1), -(1), FONT_SCREEN, 4);
}

var int TALENTBOOK_SWORDSMAN_TIER1_LEARNED;
instance ITWR_TALENTBOOK_SWORDSMAN_TIER1(C_ITEM) {
    NAME = WRITTENNAME_TALENTBOOK_SWORDSMAN_TIER1;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = ITEM_MULTI;
    VALUE = VALUE_TALENTBOOK_TIER1;
    VISUAL = "KM_item_book_15.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[0] = ITEMDESC_ITWR_TALENTBOOK_SOUTHERNER_TIER1_1;
    TEXT[1] = ITEMDESC_ITWR_TALENTBOOK_SWORDSMAN_TIER1_2;
    TEXT[3] = BONUS_1H;
    COUNT[3] = 1;
    TEXT[4] = NAME_BONUS_STR;
    COUNT[4] = 2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_TALENTBOOK_SWORDSMAN_TIER1;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_TALENTBOOK_SWORDSMAN_TIER1() {
    if ((TALENTBOOK_SWORDSMAN_TIER1_LEARNED) == (FALSE)) {
        TALENTBOOK_SWORDSMAN_TIER1_LEARNED = TRUE;
        NPC_CHANGEATTRIBUTE(SELF, ATR_STRENGTH, 2);
        B_RAISEFIGHTTALENT(SELF, NPC_TALENT_1H, 1);
        SND_PLAY("LevelUp");
        TALENTBOOK_LEARN_1 = CONCATSTRINGS(PRINT_LEARNSTR, INTTOSTRING(2));
        PRINTSCREEN(TALENTBOOK_LEARN_1, -(1), YPOS_LOGENTRY, FONT_SCREEN, 4);
        TALENTBOOK_LEARN_2 = CONCATSTRINGS(PRINT_LEARN1H_ONLY, INTTOSTRING(1));
    };
    PRINTSCREEN(PRINT_KNOWTHISALREADY, -(1), -(1), FONT_SCREEN, 4);
}

var int TALENTBOOK_SWORDSMAN_TIER2_LEARNED;
instance ITWR_TALENTBOOK_SWORDSMAN_TIER2(C_ITEM) {
    NAME = WRITTENNAME_TALENTBOOK_SWORDSMAN_TIER2;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = ITEM_MULTI;
    VALUE = VALUE_TALENTBOOK_TIER2;
    VISUAL = "KM_item_book_15.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[0] = ITEMDESC_ITWR_TALENTBOOK_SOUTHERNER_TIER2_1;
    TEXT[1] = ITEMDESC_ITWR_TALENTBOOK_SWORDSMAN_TIER1_2;
    TEXT[3] = BONUS_1H;
    COUNT[3] = 1;
    TEXT[4] = NAME_BONUS_STR;
    COUNT[4] = 4;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_TALENTBOOK_SWORDSMAN_TIER2;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_TALENTBOOK_SWORDSMAN_TIER2() {
    if ((TALENTBOOK_SWORDSMAN_TIER1_LEARNED) == (TRUE)) {
        if ((TALENTBOOK_SWORDSMAN_TIER2_LEARNED) == (FALSE)) {
            TALENTBOOK_SWORDSMAN_TIER2_LEARNED = TRUE;
            NPC_CHANGEATTRIBUTE(SELF, ATR_STRENGTH, 4);
            B_RAISEFIGHTTALENT(SELF, NPC_TALENT_1H, 1);
            SND_PLAY("LevelUp");
            TALENTBOOK_LEARN_1 = CONCATSTRINGS(PRINT_LEARNSTR, INTTOSTRING(4));
            PRINTSCREEN(TALENTBOOK_LEARN_1, -(1), YPOS_LOGENTRY, FONT_SCREEN, 4);
            TALENTBOOK_LEARN_2 = CONCATSTRINGS(PRINT_LEARN1H_ONLY, INTTOSTRING(1));
        } else {
            /* set_instance(0) */;
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_TALENT, -(1), -(1), FONT_SCREEN, 4);
}

var int TALENTBOOK_SWORDSMAN_TIER3_LEARNED;
instance ITWR_TALENTBOOK_SWORDSMAN_TIER3(C_ITEM) {
    NAME = WRITTENNAME_TALENTBOOK_SWORDSMAN_TIER3;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = ITEM_MULTI;
    VALUE = VALUE_TALENTBOOK_TIER3;
    VISUAL = "KM_item_book_15.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[0] = ITEMDESC_ITWR_TALENTBOOK_SOUTHERNER_TIER3_1;
    TEXT[1] = ITEMDESC_ITWR_TALENTBOOK_SWORDSMAN_TIER1_2;
    TEXT[3] = BONUS_1H;
    COUNT[3] = 2;
    TEXT[4] = NAME_BONUS_STR;
    COUNT[4] = 5;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_TALENTBOOK_SWORDSMAN_TIER3;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_TALENTBOOK_SWORDSMAN_TIER3() {
    if ((TALENTBOOK_SWORDSMAN_TIER2_LEARNED) == (TRUE)) {
        if ((TALENTBOOK_SWORDSMAN_TIER3_LEARNED) == (FALSE)) {
            TALENTBOOK_SWORDSMAN_TIER3_LEARNED = TRUE;
            NPC_CHANGEATTRIBUTE(SELF, ATR_STRENGTH, 5);
            B_RAISEFIGHTTALENT(SELF, NPC_TALENT_1H, 2);
            SND_PLAY("LevelUp");
            TALENTBOOK_LEARN_1 = CONCATSTRINGS(PRINT_LEARNSTR, INTTOSTRING(5));
            PRINTSCREEN(TALENTBOOK_LEARN_1, -(1), YPOS_LOGENTRY, FONT_SCREEN, 4);
            TALENTBOOK_LEARN_2 = CONCATSTRINGS(PRINT_LEARN1H_ONLY, INTTOSTRING(2));
        } else {
            /* set_instance(0) */;
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_TALENT, -(1), -(1), FONT_SCREEN, 4);
}

var int TALENTBOOK_CROSSBOW_TIER1_LEARNED;
instance ITWR_TALENTBOOK_CROSSBOW_TIER1(C_ITEM) {
    NAME = WRITTENNAME_TALENTBOOK_CROSSBOW_TIER1;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = ITEM_MULTI;
    VALUE = VALUE_TALENTBOOK_TIER1;
    VISUAL = "KM_item_book_16.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[0] = ITEMDESC_ITWR_TALENTBOOK_SOUTHERNER_TIER1_1;
    TEXT[1] = ITEMDESC_ITWR_TALENTBOOK_CROSSBOW_TIER1_2;
    TEXT[2] = NAME_BONUS_CROSSBOW;
    COUNT[2] = 1;
    TEXT[3] = NAME_BONUS_DEX;
    COUNT[3] = 1;
    TEXT[4] = NAME_BONUS_STR;
    COUNT[4] = 1;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_TALENTBOOK_CROSSBOW_TIER1;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_TALENTBOOK_CROSSBOW_TIER1() {
    if ((TALENTBOOK_CROSSBOW_TIER1_LEARNED) == (FALSE)) {
        TALENTBOOK_CROSSBOW_TIER1_LEARNED = TRUE;
        NPC_CHANGEATTRIBUTE(SELF, ATR_STRENGTH, 1);
        NPC_CHANGEATTRIBUTE(SELF, ATR_DEXTERITY, 1);
        B_RAISEFIGHTTALENT(SELF, NPC_TALENT_CROSSBOW, 1);
        SND_PLAY("LevelUp");
        TALENTBOOK_LEARN_1 = CONCATSTRINGS(PRINT_LEARNSTR, INTTOSTRING(1));
        PRINTSCREEN(TALENTBOOK_LEARN_1, -(1), YPOS_LOGENTRY, FONT_SCREEN, 4);
        TALENTBOOK_LEARN_2 = CONCATSTRINGS(PRINT_LEARNDEX, INTTOSTRING(1));
        PRINTSCREEN(TALENTBOOK_LEARN_2, -(1), YPOS_ITEMTAKEN, FONT_SCREEN, 4);
        TALENTBOOK_LEARN_3 = CONCATSTRINGS(PRINT_LEARNCROSSBOW_ONLY, INTTOSTRING(1));
    };
    PRINTSCREEN(PRINT_KNOWTHISALREADY, -(1), -(1), FONT_SCREEN, 4);
}

var int TALENTBOOK_CROSSBOW_TIER2_LEARNED;
instance ITWR_TALENTBOOK_CROSSBOW_TIER2(C_ITEM) {
    NAME = WRITTENNAME_TALENTBOOK_CROSSBOW_TIER2;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = ITEM_MULTI;
    VALUE = VALUE_TALENTBOOK_TIER2;
    VISUAL = "KM_item_book_16.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[0] = ITEMDESC_ITWR_TALENTBOOK_SOUTHERNER_TIER2_1;
    TEXT[1] = ITEMDESC_ITWR_TALENTBOOK_CROSSBOW_TIER1_2;
    TEXT[2] = NAME_BONUS_CROSSBOW;
    COUNT[2] = 1;
    TEXT[3] = NAME_BONUS_DEX;
    COUNT[3] = 1;
    TEXT[4] = NAME_BONUS_STR;
    COUNT[4] = 3;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_TALENTBOOK_CROSSBOW_TIER2;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_TALENTBOOK_CROSSBOW_TIER2() {
    if ((TALENTBOOK_CROSSBOW_TIER1_LEARNED) == (TRUE)) {
        if ((TALENTBOOK_CROSSBOW_TIER2_LEARNED) == (FALSE)) {
            TALENTBOOK_CROSSBOW_TIER2_LEARNED = TRUE;
            NPC_CHANGEATTRIBUTE(SELF, ATR_STRENGTH, 3);
            NPC_CHANGEATTRIBUTE(SELF, ATR_DEXTERITY, 1);
            B_RAISEFIGHTTALENT(SELF, NPC_TALENT_CROSSBOW, 1);
            SND_PLAY("LevelUp");
            TALENTBOOK_LEARN_1 = CONCATSTRINGS(PRINT_LEARNSTR, INTTOSTRING(3));
            PRINTSCREEN(TALENTBOOK_LEARN_1, -(1), YPOS_LOGENTRY, FONT_SCREEN, 4);
            TALENTBOOK_LEARN_2 = CONCATSTRINGS(PRINT_LEARNDEX, INTTOSTRING(1));
            PRINTSCREEN(TALENTBOOK_LEARN_2, -(1), YPOS_ITEMTAKEN, FONT_SCREEN, 4);
            TALENTBOOK_LEARN_3 = CONCATSTRINGS(PRINT_LEARNCROSSBOW_ONLY, INTTOSTRING(1));
        } else {
            /* set_instance(0) */;
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_TALENT, -(1), -(1), FONT_SCREEN, 4);
}

var int TALENTBOOK_CROSSBOW_TIER3_LEARNED;
instance ITWR_TALENTBOOK_CROSSBOW_TIER3(C_ITEM) {
    NAME = WRITTENNAME_TALENTBOOK_CROSSBOW_TIER3;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = ITEM_MULTI;
    VALUE = VALUE_TALENTBOOK_TIER3;
    VISUAL = "KM_item_book_16.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[0] = ITEMDESC_ITWR_TALENTBOOK_SOUTHERNER_TIER3_1;
    TEXT[1] = ITEMDESC_ITWR_TALENTBOOK_CROSSBOW_TIER1_2;
    TEXT[2] = NAME_BONUS_CROSSBOW;
    COUNT[2] = 2;
    TEXT[3] = NAME_BONUS_DEX;
    COUNT[3] = 2;
    TEXT[4] = NAME_BONUS_STR;
    COUNT[4] = 3;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_TALENTBOOK_CROSSBOW_TIER3;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_TALENTBOOK_CROSSBOW_TIER3() {
    if ((TALENTBOOK_CROSSBOW_TIER2_LEARNED) == (TRUE)) {
        if ((TALENTBOOK_CROSSBOW_TIER3_LEARNED) == (FALSE)) {
            TALENTBOOK_CROSSBOW_TIER3_LEARNED = TRUE;
            NPC_CHANGEATTRIBUTE(SELF, ATR_STRENGTH, 3);
            NPC_CHANGEATTRIBUTE(SELF, ATR_DEXTERITY, 2);
            B_RAISEFIGHTTALENT(SELF, NPC_TALENT_CROSSBOW, 2);
            SND_PLAY("LevelUp");
            TALENTBOOK_LEARN_1 = CONCATSTRINGS(PRINT_LEARNSTR, INTTOSTRING(3));
            PRINTSCREEN(TALENTBOOK_LEARN_1, -(1), YPOS_LOGENTRY, FONT_SCREEN, 4);
            TALENTBOOK_LEARN_2 = CONCATSTRINGS(PRINT_LEARNDEX, INTTOSTRING(2));
            PRINTSCREEN(TALENTBOOK_LEARN_2, -(1), YPOS_ITEMTAKEN, FONT_SCREEN, 4);
            TALENTBOOK_LEARN_3 = CONCATSTRINGS(PRINT_LEARNCROSSBOW_ONLY, INTTOSTRING(2));
        } else {
            /* set_instance(0) */;
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_TALENT, -(1), -(1), FONT_SCREEN, 4);
}

var int TALENTBOOK_BOW_TIER1_LEARNED;
instance ITWR_TALENTBOOK_BOW_TIER1(C_ITEM) {
    NAME = WRITTENNAME_TALENTBOOK_BOW_TIER1;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = ITEM_MULTI;
    VALUE = VALUE_TALENTBOOK_TIER1;
    VISUAL = "KM_item_book_17.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[0] = ITEMDESC_ITWR_TALENTBOOK_SOUTHERNER_TIER1_1;
    TEXT[1] = ITEMDESC_ITWR_TALENTBOOK_BOW_TIER1_2;
    TEXT[3] = NAME_BONUS_BOW;
    COUNT[3] = 1;
    TEXT[4] = NAME_BONUS_DEX;
    COUNT[4] = 2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_TALENTBOOK_BOW_TIER1;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_TALENTBOOK_BOW_TIER1() {
    if ((TALENTBOOK_BOW_TIER1_LEARNED) == (FALSE)) {
        TALENTBOOK_BOW_TIER1_LEARNED = TRUE;
        NPC_CHANGEATTRIBUTE(SELF, ATR_DEXTERITY, 2);
        B_RAISEFIGHTTALENT(SELF, NPC_TALENT_BOW, 1);
        SND_PLAY("LevelUp");
        TALENTBOOK_LEARN_2 = CONCATSTRINGS(PRINT_LEARNDEX, INTTOSTRING(2));
        PRINTSCREEN(TALENTBOOK_LEARN_2, -(1), YPOS_ITEMTAKEN, FONT_SCREEN, 4);
        TALENTBOOK_LEARN_3 = CONCATSTRINGS(PRINT_LEARNBOW_ONLY, INTTOSTRING(1));
    };
    PRINTSCREEN(PRINT_KNOWTHISALREADY, -(1), -(1), FONT_SCREEN, 4);
}

var int TALENTBOOK_BOW_TIER2_LEARNED;
instance ITWR_TALENTBOOK_BOW_TIER2(C_ITEM) {
    NAME = WRITTENNAME_TALENTBOOK_BOW_TIER2;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = ITEM_MULTI;
    VALUE = VALUE_TALENTBOOK_TIER2;
    VISUAL = "KM_item_book_17.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[0] = ITEMDESC_ITWR_TALENTBOOK_SOUTHERNER_TIER2_1;
    TEXT[1] = ITEMDESC_ITWR_TALENTBOOK_BOW_TIER1_2;
    TEXT[3] = NAME_BONUS_BOW;
    COUNT[3] = 1;
    TEXT[4] = NAME_BONUS_DEX;
    COUNT[4] = 3;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_TALENTBOOK_BOW_TIER2;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_TALENTBOOK_BOW_TIER2() {
    if ((TALENTBOOK_BOW_TIER1_LEARNED) == (TRUE)) {
        if ((TALENTBOOK_BOW_TIER2_LEARNED) == (FALSE)) {
            TALENTBOOK_BOW_TIER2_LEARNED = TRUE;
            NPC_CHANGEATTRIBUTE(SELF, ATR_DEXTERITY, 3);
            B_RAISEFIGHTTALENT(SELF, NPC_TALENT_BOW, 1);
            SND_PLAY("LevelUp");
            TALENTBOOK_LEARN_2 = CONCATSTRINGS(PRINT_LEARNDEX, INTTOSTRING(3));
            PRINTSCREEN(TALENTBOOK_LEARN_2, -(1), YPOS_ITEMTAKEN, FONT_SCREEN, 4);
            TALENTBOOK_LEARN_3 = CONCATSTRINGS(PRINT_LEARNBOW_ONLY, INTTOSTRING(1));
        } else {
            /* set_instance(0) */;
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_TALENT, -(1), -(1), FONT_SCREEN, 4);
}

var int TALENTBOOK_BOW_TIER3_LEARNED;
instance ITWR_TALENTBOOK_BOW_TIER3(C_ITEM) {
    NAME = WRITTENNAME_TALENTBOOK_BOW_TIER3;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = ITEM_MULTI;
    VALUE = VALUE_TALENTBOOK_TIER3;
    VISUAL = "KM_item_book_17.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[0] = ITEMDESC_ITWR_TALENTBOOK_SOUTHERNER_TIER3_1;
    TEXT[1] = ITEMDESC_ITWR_TALENTBOOK_BOW_TIER1_2;
    TEXT[3] = NAME_BONUS_BOW;
    COUNT[3] = 2;
    TEXT[4] = NAME_BONUS_DEX;
    COUNT[4] = 4;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_TALENTBOOK_BOW_TIER3;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_TALENTBOOK_BOW_TIER3() {
    if ((TALENTBOOK_BOW_TIER2_LEARNED) == (TRUE)) {
        if ((TALENTBOOK_BOW_TIER3_LEARNED) == (FALSE)) {
            TALENTBOOK_BOW_TIER3_LEARNED = TRUE;
            NPC_CHANGEATTRIBUTE(SELF, ATR_DEXTERITY, 4);
            B_RAISEFIGHTTALENT(SELF, NPC_TALENT_BOW, 2);
            SND_PLAY("LevelUp");
            TALENTBOOK_LEARN_2 = CONCATSTRINGS(PRINT_LEARNDEX, INTTOSTRING(4));
            PRINTSCREEN(TALENTBOOK_LEARN_2, -(1), YPOS_ITEMTAKEN, FONT_SCREEN, 4);
            TALENTBOOK_LEARN_3 = CONCATSTRINGS(PRINT_LEARNBOW_ONLY, INTTOSTRING(2));
        } else {
            /* set_instance(0) */;
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_TALENT, -(1), -(1), FONT_SCREEN, 4);
}

var int TALENTBOOK_MAGE_TIER1_LEARNED;
instance ITWR_TALENTBOOK_MAGE_TIER1(C_ITEM) {
    NAME = WRITTENNAME_TALENTBOOK_MAGE_TIER1;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = ITEM_MULTI;
    VALUE = VALUE_TALENTBOOK_TIER1;
    VISUAL = "KM_item_book_18.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[0] = ITEMDESC_ITWR_TALENTBOOK_SOUTHERNER_TIER1_1;
    TEXT[1] = ITEMDESC_ITWR_TALENTBOOK_MAGE_TIER1_2;
    TEXT[3] = NAME_BONUS_MANAMAX;
    COUNT[3] = 3;
    TEXT[4] = NAME_BONUS_HPMAX;
    COUNT[4] = 7;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_TALENTBOOK_MAGE_TIER1;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_TALENTBOOK_MAGE_TIER1() {
    if ((TALENTBOOK_MAGE_TIER1_LEARNED) == (FALSE)) {
        TALENTBOOK_MAGE_TIER1_LEARNED = TRUE;
        NPC_CHANGEATTRIBUTE(SELF, ATR_HITPOINTS_MAX, 7);
        NPC_CHANGEATTRIBUTE(SELF, ATR_MANA_MAX, 3);
        SND_PLAY("LevelUp");
        TALENTBOOK_LEARN_1 = CONCATSTRINGS(PRINT_LEARNHITPOINTS_MAX, INTTOSTRING(7));
        PRINTSCREEN(TALENTBOOK_LEARN_1, -(1), YPOS_LOGENTRY, FONT_SCREEN, 4);
        TALENTBOOK_LEARN_2 = CONCATSTRINGS(PRINT_LEARNMANA_MAX, INTTOSTRING(3));
    };
    PRINTSCREEN(PRINT_KNOWTHISALREADY, -(1), -(1), FONT_SCREEN, 4);
}

var int TALENTBOOK_MAGE_TIER2_LEARNED;
instance ITWR_TALENTBOOK_MAGE_TIER2(C_ITEM) {
    NAME = WRITTENNAME_TALENTBOOK_MAGE_TIER2;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = ITEM_MULTI;
    VALUE = VALUE_TALENTBOOK_TIER2;
    VISUAL = "KM_item_book_18.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[0] = ITEMDESC_ITWR_TALENTBOOK_SOUTHERNER_TIER2_1;
    TEXT[1] = ITEMDESC_ITWR_TALENTBOOK_MAGE_TIER1_2;
    TEXT[3] = NAME_BONUS_MANAMAX;
    COUNT[3] = 4;
    TEXT[4] = NAME_BONUS_HPMAX;
    COUNT[4] = 10;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_TALENTBOOK_MAGE_TIER2;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_TALENTBOOK_MAGE_TIER2() {
    if ((TALENTBOOK_MAGE_TIER1_LEARNED) == (TRUE)) {
        if ((TALENTBOOK_MAGE_TIER2_LEARNED) == (FALSE)) {
            TALENTBOOK_MAGE_TIER2_LEARNED = TRUE;
            NPC_CHANGEATTRIBUTE(SELF, ATR_HITPOINTS_MAX, 10);
            NPC_CHANGEATTRIBUTE(SELF, ATR_MANA_MAX, 4);
            MARVINTRANSFORMHP = (MARVINTRANSFORMHP) + (10);
            SND_PLAY("LevelUp");
            TALENTBOOK_LEARN_1 = CONCATSTRINGS(PRINT_LEARNHITPOINTS_MAX, INTTOSTRING(10));
            PRINTSCREEN(TALENTBOOK_LEARN_1, -(1), YPOS_LOGENTRY, FONT_SCREEN, 4);
            TALENTBOOK_LEARN_2 = CONCATSTRINGS(PRINT_LEARNMANA_MAX, INTTOSTRING(4));
        } else {
            /* set_instance(0) */;
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_TALENT, -(1), -(1), FONT_SCREEN, 4);
}

var int TALENTBOOK_MAGE_TIER3_LEARNED;
instance ITWR_TALENTBOOK_MAGE_TIER3(C_ITEM) {
    NAME = WRITTENNAME_TALENTBOOK_MAGE_TIER3;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = ITEM_MULTI;
    VALUE = VALUE_TALENTBOOK_TIER3;
    VISUAL = "KM_item_book_18.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[0] = ITEMDESC_ITWR_TALENTBOOK_SOUTHERNER_TIER3_1;
    TEXT[1] = ITEMDESC_ITWR_TALENTBOOK_MAGE_TIER1_2;
    TEXT[3] = NAME_BONUS_MANAMAX;
    COUNT[3] = 7;
    TEXT[4] = NAME_BONUS_HPMAX;
    COUNT[4] = 15;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USE_TALENTBOOK_MAGE_TIER3;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_TALENTBOOK_MAGE_TIER3() {
    if ((TALENTBOOK_MAGE_TIER2_LEARNED) == (TRUE)) {
        if ((TALENTBOOK_MAGE_TIER3_LEARNED) == (FALSE)) {
            TALENTBOOK_MAGE_TIER3_LEARNED = TRUE;
            NPC_CHANGEATTRIBUTE(SELF, ATR_HITPOINTS_MAX, 15);
            MARVINTRANSFORMHP = (MARVINTRANSFORMHP) + (15);
            NPC_CHANGEATTRIBUTE(SELF, ATR_MANA_MAX, 7);
            SND_PLAY("LevelUp");
            TALENTBOOK_LEARN_1 = CONCATSTRINGS(PRINT_LEARNHITPOINTS_MAX, INTTOSTRING(15));
            PRINTSCREEN(TALENTBOOK_LEARN_1, -(1), YPOS_LOGENTRY, FONT_SCREEN, 4);
            TALENTBOOK_LEARN_2 = CONCATSTRINGS(PRINT_LEARNMANA_MAX, INTTOSTRING(7));
        } else {
            /* set_instance(0) */;
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK_TALENT, -(1), -(1), FONT_SCREEN, 4);
}

var int PICKPOCKETBOOK_TIER1_STARTDIALOGUE;
var int PICKPOCKETBOOK_TIER1_LEARNED;
instance ITWR_PICKPOCKET_TIER1(C_ITEM) {
    NAME = WRITTENNAME_PICKPOCKET_TIER1;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_BOOK_PICKPOCKETING;
    VISUAL = "KM_item_book_09.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_ALCHEMY_TIER1_1;
    TEXT[2] = ITEMDESC_ITWR_PICKPOCKET_TIER1_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE;
    ON_STATE[0] = USEPICKPOCKET_TIER1;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USEPICKPOCKET_TIER1() {
    if ((NPC_GETTALENTSKILL(HERO, NPC_TALENT_PICKPOCKET)) >= (0)) {
        if (((NPC_GETTALENTSKILL(HERO, NPC_TALENT_PICKPOCKET)) >= (1)) || ((PICKPOCKETBOOK_TIER1_LEARNED) == (TRUE))) {
        } else {
            PICKPOCKETBOOK_TIER1_STARTDIALOGUE = 1;
            AI_PROCESSINFOS(HERO);
        };
    };
    PRINTSCREEN(PRINT_CANTLEARNTHISBOOK, -(1), -(1), FONT_SCREEN, 4);
}

instance PICKPOCKETBOOK_TIER1_END(C_INFO) {
    NPC = 50091;
    NR = 999;
    CONDITION = PICKPOCKETBOOK_TIER1_CONDITION;
    INFORMATION = PICKPOCKETBOOK_TIER1_EXIT;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int PICKPOCKETBOOK_TIER1_CONDITION() {
    return PICKPOCKETBOOK_TIER1_STARTDIALOGUE;
}

func void PICKPOCKETBOOK_TIER1_EXIT() {
    AI_STOPPROCESSINFOS(SELF);
    PICKPOCKETBOOK_TIER1_STARTDIALOGUE = FALSE;
}

instance PICKPOCKETBOOK_TIER1_LEARN(C_INFO) {
    NPC = 50091;
    NR = 1;
    CONDITION = PICKPOCKETBOOK_TIER1_LEARN_CONDITION;
    INFORMATION = PICKPOCKETBOOK_TIER1_LEARN_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = B_BUILDLEARNSTRING2(PRINT_LEARN_PICKPOCKET1, 5, 0);
}

func int PICKPOCKETBOOK_TIER1_LEARN_CONDITION() {
    if (((PICKPOCKETBOOK_TIER1_STARTDIALOGUE) == (TRUE)) && ((PICKPOCKETBOOK_TIER1_LEARNED) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void PICKPOCKETBOOK_TIER1_LEARN_INFO() {
    if ((HERO.LP) >= (5)) {
        HERO.LP = (HERO.LP) - (5);
        PICKPOCKETBOOK_TIER1_LEARNED = TRUE;
        NPC_SETTALENTSKILL(HERO, NPC_TALENT_PICKPOCKET, 1);
        NPC_SETTALENTSKILL(HERO, NPC_TALENT_SNEAK, 1);
        PRINTSCREEN(PRINT_LEARNPICKPOCKET, -(1), -(1), FONT_SCREEN, 4);
        SND_PLAY("LEVELUP");
        PRINTSCREEN(PRINT_LEARNSNEAK, -(1), YPOS_LEVELUP, FONT_SCREEN, 4);
        AI_STOPPROCESSINFOS(SELF);
        PICKPOCKETBOOK_TIER1_STARTDIALOGUE = FALSE;
    };
    PRINTSCREEN(PRINT_NOTENOUGHLEARNPOINTS, -(1), -(1), FONT_SCREEN, 2);
}

instance ITWR_STINGSDRINKING(C_ITEM) {
    NAME = WRITTENNAME_STINGSDRINKING;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_TROPHYHEALING;
    VISUAL = "KM_item_random_book_02.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_STINGSDRINKING_1;
    TEXT[2] = ITEMDESC_ITWR_STINGSDRINKING_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE_TROPHYHEALING;
    ON_STATE[0] = USE_STINGSDRINKING;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_STINGSDRINKING() {
    var int NDOCID;
    NDOCID = DOC_CREATE();
    DOC_SETPAGES(NDOCID, 2);
    DOC_SETPAGE(NDOCID, 0, "Book_KM_03_L.tga", 0);
    DOC_SETPAGE(NDOCID, 1, "Book_KM_03_R.tga", 0);
    DOC_SETFONT(NDOCID, -(1), FONT_BOOK);
    DOC_SETMARGINS(NDOCID, 0, 210, 15, 40, 15, 1);
    DOC_PRINTLINES(NDOCID, 0, "");
    DOC_PRINTLINES(NDOCID, 0, WRITTENTEXT_STINGSDRINKING_1);
    DOC_PRINTLINES(NDOCID, 0, "");
    DOC_PRINTLINES(NDOCID, 0, WRITTENTEXT_STINGSDRINKING_2);
    DOC_PRINTLINES(NDOCID, 0, "");
    DOC_PRINTLINES(NDOCID, 0, WRITTENTEXT_STINGSDRINKING_3);
    DOC_SETMARGINS(NDOCID, 1, 15, 15, 235, 15, 1);
    DOC_PRINTLINES(NDOCID, 1, "");
    DOC_PRINTLINES(NDOCID, 1, WRITTENTEXT_STINGSDRINKING_4);
    DOC_PRINTLINES(NDOCID, 1, "");
    DOC_PRINTLINES(NDOCID, 1, WRITTENTEXT_STINGSDRINKING_5);
    DOC_SHOW(NDOCID);
    LEARN_STINGS_DRINKING = TRUE;
}

instance ITWR_MANDIBLESDRINKING(C_ITEM) {
    NAME = WRITTENNAME_MANDIBLESDRINKING;
    MAINFLAG = ITEM_KAT_DOCS;
    FLAGS = 0;
    VALUE = VALUE_TROPHYHEALING;
    VISUAL = "KM_item_random_book_16.3ds";
    MATERIAL = MAT_LEATHER;
    SCEMENAME = SCEME_MAP;
    DESCRIPTION = NAME;
    TEXT[1] = ITEMDESC_ITWR_STINGSDRINKING_1;
    TEXT[2] = ITEMDESC_ITWR_MANDIBLESDRINKING_2;
    TEXT[5] = NAME_VALUE;
    COUNT[5] = VALUE_TROPHYHEALING;
    ON_STATE[0] = USE_MANDIBLESDRINKING;
    INV_ROTX = 90;
    INV_ROTY = 180;
    INV_ROTZ = 180;
}

func void USE_MANDIBLESDRINKING() {
    var int NDOCID;
    NDOCID = DOC_CREATE();
    DOC_SETPAGES(NDOCID, 2);
    DOC_SETPAGE(NDOCID, 0, "Book_KM_04_L.tga", 0);
    DOC_SETPAGE(NDOCID, 1, "Book_KM_04_R.tga", 0);
    DOC_SETFONT(NDOCID, -(1), FONT_BOOK);
    DOC_SETMARGINS(NDOCID, 0, 210, 15, 40, 15, 1);
    DOC_PRINTLINES(NDOCID, 0, "");
    DOC_PRINTLINES(NDOCID, 0, WRITTENTEXT_MANDIBLESDRINKING_1);
    DOC_PRINTLINES(NDOCID, 0, "");
    DOC_PRINTLINES(NDOCID, 0, WRITTENTEXT_MANDIBLESDRINKING_2);
    DOC_SETMARGINS(NDOCID, 1, 15, 15, 235, 15, 1);
    DOC_PRINTLINES(NDOCID, 1, "");
    DOC_PRINTLINES(NDOCID, 1, WRITTENTEXT_MANDIBLESDRINKING_3);
    DOC_PRINTLINES(NDOCID, 1, "");
    DOC_PRINTLINES(NDOCID, 1, WRITTENTEXT_MANDIBLESDRINKING_4);
    DOC_SHOW(NDOCID);
    LEARN_CRAWLERMANDIBLES_DRINKING = TRUE;
}

