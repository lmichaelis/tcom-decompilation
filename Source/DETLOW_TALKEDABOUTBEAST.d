var int DETLOW_TALKEDABOUTBEAST;
instance DIA_DETLOW_EXIT(C_INFO) {
    NPC = 53778;
    NR = 999;
    CONDITION = DIA_DETLOW_EXIT_CONDITION;
    INFORMATION = DIA_DETLOW_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_DETLOW_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_DETLOW_EXIT_INFO() {
    AI_STOPPROCESSINFOS(SELF);
    if ((LOG_GETSTATUS(MIS_SQ416)) == (LOG_SUCCESS)) {
        if ((NPC_KNOWSINFO(OTHER, 74007)) || (NPC_KNOWSINFO(OTHER, 74010))) {
            if ((SQ416_RAMSEYPARTY) != (2)) {
                if ((SQ416_DETLOWGOODBYE) == (FALSE)) {
                    SQ416_DETLOWGOODBYE = TRUE;
                    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
                    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_EXIT_03_01");
                };
            };
        };
    };
}

instance DIA_DETLOW_TEACH(C_INFO) {
    NPC = 53778;
    NR = 980;
    CONDITION = DIA_DETLOW_TEACH_CONDITION;
    INFORMATION = DIA_DETLOW_TEACH_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Can you teach me something about hunting?";
}

func int DIA_DETLOW_TEACH_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_SQ204)) == (LOG_SUCCESS)) || (((LOG_GETSTATUS(MIS_QM302)) == (LOG_SUCCESS)) && (NPC_KNOWSINFO(OTHER, 73979)))) || ((LOG_GETSTATUS(MIS_SQ416)) == (LOG_SUCCESS))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_TEACH_INFO() {
    B_SAY(OTHER, SELF, RESERVED_CONST_STRING_21);
    DUMMYFUNCWITHSTRINGPARAMETER("DIA_Detlow_Teach_15_01");
    DUMMYFUNCWITHSTRINGPARAMETER("DIA_Detlow_Teach_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Teach_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Teach_03_04");
    LOG_CREATETOPIC(TOPIC_TEACHER, LOG_NOTE);
    AI_LOGENTRY(TOPIC_TEACHER, LOG_TEACHER_DETLOW);
}

var int DETLOW_NOMORE;
var string DETLOW_PRINTS;
var int DETLOW_CURRENTBLEVEL;
var int DETLOW_CURRENTDEXLEVEL;
instance DIA_DETLOW_TRAINME(C_INFO) {
    NPC = 53778;
    NR = 980;
    CONDITION = DIA_DETLOW_TRAINME_CONDITION;
    INFORMATION = DIA_DETLOW_TRAINME_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "Teach me.";
}

func int DIA_DETLOW_TRAINME_CONDITION() {
    if ((NPC_KNOWSINFO(OTHER, 73886)) && ((DETLOW_NOMORE) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_TRAINME_CHOICES() {
    var int DETLOW_GOLDCOST;
    DETLOW_GOLDCOST = 30;
    DETLOW_CURRENTBLEVEL = OTHER.AIVAR[86];
    DETLOW_CURRENTDEXLEVEL = OTHER.AIVAR[82];
    INFO_CLEARCHOICES(73893);
    INFO_ADDCHOICE(73893, B_BUILDLEARNSTRING2(PRINT_LEARNBOW1, B_GETLEARNCOSTTALENT(OTHER, NPC_TALENT_BOW, 1), DETLOW_GOLDCOST), 73899);
    INFO_ADDCHOICE(73893, B_BUILDLEARNSTRING2(PRINT_LEARNBOW5, B_GETLEARNCOSTTALENT(OTHER, NPC_TALENT_BOW, 5), (DETLOW_GOLDCOST) * (5)), 73900);
    INFO_ADDCHOICE(73893, B_BUILDLEARNSTRING2(PRINT_LEARNDEX1, B_GETLEARNCOSTATTRIBUTE(OTHER, ATR_DEXTERITY, 1), DETLOW_GOLDCOST), 73901);
    INFO_ADDCHOICE(73893, B_BUILDLEARNSTRING2(PRINT_LEARNDEX5, B_GETLEARNCOSTATTRIBUTE(OTHER, ATR_DEXTERITY, 5), (DETLOW_GOLDCOST) * (5)), 73902);
    INFO_ADDCHOICE(73893, DIALOG_BACK, 73898);
}

func void DIA_DETLOW_TRAINME_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_TrainMe_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_TrainMe_03_02");
    DIA_DETLOW_TRAINME_CHOICES();
}

func void DIA_DETLOW_TRAINME_DIALOG_BACK() {
    if (((OTHER.AIVAR[86]) >= (100)) && ((OTHER.AIVAR[82]) >= (150))) {
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_TrainMeDialogBack_03_00");
        DETLOW_NOMORE = TRUE;
    };
    INFO_CLEARCHOICES(73893);
}

func void DIA_DETLOW_TRAINMEBOW1() {
    if ((NPC_HASITEMS(OTHER, 34203)) >= (DETLOW_PAYMENT1)) {
        if ((DETLOW_CURRENTBLEVEL) < (OTHER.AIVAR[86])) {
            SND_PLAY(GELDBEUTEL);
            B_GIVEINVITEMS(OTHER, SELF, 34203, DETLOW_PAYMENT1);
            NPC_REMOVEINVITEMS(SELF, 34203, DETLOW_PAYMENT1);
        };
        B_TEACHFIGHTTALENTPERCENT(SELF, OTHER, NPC_TALENT_BOW, 1, 100);
        DIA_DETLOW_TRAINME_CHOICES();
    };
    if ((NPC_HASITEMS(OTHER, 34203)) < (DETLOW_PAYMENT1)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_TrainMeBOW1_13_01");
        DETLOW_PRINTS = CONCATSTRINGS(PRINT_RGOLD, INTTOSTRING(DETLOW_PAYMENT1));
        PRINTSCREEN(DETLOW_PRINTS, -(1), -(1), FONT_SCREEN, 2);
        DIA_DETLOW_TRAINME_CHOICES();
    };
}

func void DIA_DETLOW_TRAINMEBOW5() {
    if ((NPC_HASITEMS(OTHER, 34203)) >= (DETLOW_PAYMENT5)) {
        if ((DETLOW_CURRENTBLEVEL) < (OTHER.AIVAR[86])) {
            B_GIVEINVITEMS(OTHER, SELF, 34203, DETLOW_PAYMENT5);
            SND_PLAY(GELDBEUTEL);
            NPC_REMOVEINVITEMS(SELF, 34203, DETLOW_PAYMENT5);
        };
        B_TEACHFIGHTTALENTPERCENT(SELF, OTHER, NPC_TALENT_BOW, 5, 100);
        DIA_DETLOW_TRAINME_CHOICES();
    };
    if ((NPC_HASITEMS(OTHER, 34203)) < (DETLOW_PAYMENT5)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_TrainMeBOW5_13_01");
        DETLOW_PRINTS = CONCATSTRINGS(PRINT_RGOLD, INTTOSTRING(DETLOW_PAYMENT5));
        PRINTSCREEN(DETLOW_PRINTS, -(1), -(1), FONT_SCREEN, 2);
        DIA_DETLOW_TRAINME_CHOICES();
    };
}

func void DIA_DETLOW_TRAINMEDEX1() {
    if ((NPC_HASITEMS(OTHER, 34203)) >= (DETLOW_PAYMENT1)) {
        if ((DETLOW_CURRENTDEXLEVEL) < (OTHER.AIVAR[82])) {
            SND_PLAY(GELDBEUTEL);
            B_GIVEINVITEMS(OTHER, SELF, 34203, DETLOW_PAYMENT1);
            NPC_REMOVEINVITEMS(SELF, 34203, DETLOW_PAYMENT1);
        };
        B_TEACHATTRIBUTEPOINTS(SELF, OTHER, ATR_DEXTERITY, 1, 150);
        DIA_DETLOW_TRAINME_CHOICES();
    };
    if ((NPC_HASITEMS(OTHER, 34203)) < (DETLOW_PAYMENT1)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_TrainMeDEX1_13_01");
        DETLOW_PRINTS = CONCATSTRINGS(PRINT_RGOLD, INTTOSTRING(DETLOW_PAYMENT1));
        PRINTSCREEN(DETLOW_PRINTS, -(1), -(1), FONT_SCREEN, 2);
        DIA_DETLOW_TRAINME_CHOICES();
    };
}

func void DIA_DETLOW_TRAINMEDEX5() {
    if ((NPC_HASITEMS(OTHER, 34203)) >= (DETLOW_PAYMENT5)) {
        if ((DETLOW_CURRENTDEXLEVEL) < (OTHER.AIVAR[82])) {
            SND_PLAY(GELDBEUTEL);
            B_GIVEINVITEMS(OTHER, SELF, 34203, DETLOW_PAYMENT5);
            NPC_REMOVEINVITEMS(SELF, 34203, DETLOW_PAYMENT5);
        };
        B_TEACHATTRIBUTEPOINTS(SELF, OTHER, ATR_DEXTERITY, 5, 150);
        DIA_DETLOW_TRAINME_CHOICES();
    };
    if ((NPC_HASITEMS(OTHER, 34203)) < (DETLOW_PAYMENT5)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_TrainMeDEX5_13_01");
        DETLOW_PRINTS = CONCATSTRINGS(PRINT_RGOLD, INTTOSTRING(DETLOW_PAYMENT5));
        PRINTSCREEN(DETLOW_PRINTS, -(1), -(1), FONT_SCREEN, 2);
        DIA_DETLOW_TRAINME_CHOICES();
    };
}

instance DIA_DETLOW_FLETCHERY(C_INFO) {
    NPC = 53778;
    NR = 1;
    CONDITION = DIA_DETLOW_FLETCHERY_CONDITION;
    INFORMATION = DIA_DETLOW_FLETCHERY_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = B_BUILDLEARNSTRING2(PRINT_LEARN_FLETCHERY1, B_GETLEARNCOSTTALENT(OTHER, NPC_TALENT_FLETCHERY, 1), DETLOW_FLETCHERY);
}

func int DIA_DETLOW_FLETCHERY_CONDITION() {
    if ((NPC_KNOWSINFO(OTHER, 73886)) && ((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_FLETCHERY)) == (0))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_FLETCHERY_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_Fletchery_15_01");
    if ((NPC_HASITEMS(OTHER, 34203)) >= (DETLOW_FLETCHERY)) {
        if ((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_FLETCHERY)) == (1)) {
            NPC_REMOVEINVITEMS(SELF, 34203, DETLOW_FLETCHERY);
            AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Fletchery_13_01");
            B_GIVEINVITEMS(OTHER, SELF, 34203, DETLOW_FLETCHERY);
            AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Fletchery_13_02");
        };
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Fletchery_13_03");
}

instance DIA_DETLOW_FLETCHERY2(C_INFO) {
    NPC = 53778;
    NR = 1;
    CONDITION = DIA_DETLOW_FLETCHERY2_CONDITION;
    INFORMATION = DIA_DETLOW_FLETCHERY2_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = B_BUILDLEARNSTRING2(PRINT_LEARN_FLETCHERY2, B_GETLEARNCOSTTALENT(OTHER, NPC_TALENT_FLETCHERY, 2), DETLOW_FLETCHERY2);
}

func int DIA_DETLOW_FLETCHERY2_CONDITION() {
    if ((NPC_KNOWSINFO(OTHER, 73886)) && ((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_FLETCHERY)) == (1))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_FLETCHERY2_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_Fletchery2_15_01");
    if ((NPC_HASITEMS(OTHER, 34203)) >= (DETLOW_FLETCHERY2)) {
        if ((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_FLETCHERY)) == (2)) {
            NPC_REMOVEINVITEMS(SELF, 34203, DETLOW_FLETCHERY2);
            AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Fletchery2_13_01");
            B_GIVEINVITEMS(OTHER, SELF, 34203, DETLOW_FLETCHERY2);
            AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Fletchery2_13_02");
        };
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Fletchery2_13_03");
}

instance DIA_DETLOW_HELLO(C_INFO) {
    NPC = 53778;
    NR = 1;
    CONDITION = DIA_DETLOW_HELLO_CONDITION;
    INFORMATION = DIA_DETLOW_HELLO_INFO;
    PERMANENT = TRUE;
    IMPORTANT = TRUE;
}

func int DIA_DETLOW_HELLO_CONDITION() {
    if ((NPC_ISINSTATE(SELF, 61599)) && ((NPC_GETDISTTOWP(SELF, "PARTM5_HOUSE_DETLOW_05")) <= (1500))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_HELLO_INFO() {
    if (NPC_HASGUILDARMOREQUIPPED(OTHER, GIL_MIL)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_HELLO_03_01");
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_HELLO_03_02");
}

instance DIA_DETLOW_AMBIENT(C_INFO) {
    NPC = 53778;
    NR = 998;
    CONDITION = DIA_DETLOW_AMBIENT_CONDITION;
    INFORMATION = DIA_DETLOW_AMBIENT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "What's new?";
}

func int DIA_DETLOW_AMBIENT_CONDITION() {
    if ((NPC_GETDISTTOWP(SELF, "PARTM5_HOUSE_DETLOW_05")) <= (7000)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_AMBIENT_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_Ambient_15_00");
    NPC_INITAMBIENTS(SELF, 4);
    if ((NPC_GETLASTAMBIENT(SELF)) == (1)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Ambient_03_02");
    };
    if ((NPC_GETLASTAMBIENT(SELF)) == (2)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Ambient_03_03");
    };
    if ((NPC_GETLASTAMBIENT(SELF)) == (3)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Ambient_03_04");
    };
    if ((NPC_GETLASTAMBIENT(SELF)) == (4)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Ambient_03_05");
    };
}

instance DIA_DETLOW_SQ204_STOP(C_INFO) {
    NPC = 53778;
    NR = 1;
    CONDITION = DIA_DETLOW_SQ204_STOP_CONDITION;
    INFORMATION = DIA_DETLOW_SQ204_STOP_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_DETLOW_SQ204_STOP_CONDITION() {
    if ((((NPC_GETDISTTOWP(SELF, "PART11_INNOS")) <= (600)) && ((LOG_GETSTATUS(MIS_SQ204)) == (LOG_RUNNING))) && (WLD_ISTIME(20, 0, 2, 0))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_SQ204_STOP_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_Stop_03_01");
    if ((LOG_GETSTATUS(MIS_SQ416)) != (LOG_SUCCESS)) {
        AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ204_Stop_15_02");
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_Stop_03_03");
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_Stop_03_04");
    };
}

instance DIA_DETLOW_SQ204_HELP(C_INFO) {
    NPC = 53778;
    NR = 1;
    CONDITION = DIA_DETLOW_SQ204_HELP_CONDITION;
    INFORMATION = DIA_DETLOW_SQ204_HELP_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Looks like I'm the helper.";
}

func int DIA_DETLOW_SQ204_HELP_CONDITION() {
    if ((((NPC_KNOWSINFO(OTHER, 73915)) && ((NPC_GETDISTTOWP(SELF, "PART11_INNOS")) <= (600))) && ((LOG_GETSTATUS(MIS_SQ204)) == (LOG_RUNNING))) && (WLD_ISTIME(20, 0, 2, 0))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_SQ204_HELP_INFO() {
    SQ204_CHECKTIME = 1;
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ204_Help_15_01");
    if ((LOG_GETSTATUS(MIS_SQ416)) != (LOG_SUCCESS)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_Help_03_02");
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_Help_03_03");
    };
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ204_Help_15_04");
    if ((LOG_GETSTATUS(MIS_SQ416)) != (LOG_SUCCESS)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_Help_03_05");
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_Help_03_06");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_Help_03_07");
    if ((LOG_GETSTATUS(MIS_SQ416)) != (LOG_SUCCESS)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_Help_03_08");
    };
    AI_LOGENTRY(TOPIC_SQ204, LOG_SQ204_DETLOW_ROUND01);
    NPC_EXCHANGEROUTINE(SELF, "WolfPhase01");
    SQ204_DETLOW_RTNCHECK = 2;
    VLK_3015_DETLOW.AIVAR[15] = TRUE;
    AI_STOPPROCESSINFOS(SELF);
    INFO_CLEARCHOICES(73915);
}

instance DIA_DETLOW_SQ204_FIRSTROUND(C_INFO) {
    NPC = 53778;
    NR = 1;
    CONDITION = DIA_DETLOW_SQ204_FIRSTROUND_CONDITION;
    INFORMATION = DIA_DETLOW_SQ204_FIRSTROUND_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_DETLOW_SQ204_FIRSTROUND_CONDITION() {
    if (((NPC_GETDISTTOWP(SELF, "PART11_PATH_24")) <= (500)) && ((LOG_GETSTATUS(MIS_SQ204)) == (LOG_RUNNING))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_SQ204_FIRSTROUND_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_FirstRound_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_FirstRound_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_FirstRound_03_03");
    INFO_CLEARCHOICES(73921);
    INFO_ADDCHOICE(73921, "Do what you want. You're the boss here.", 73925);
    INFO_ADDCHOICE(73921, "I'll do it.", 73926);
    SQ204_FIRSTROUND_SPAWNWOLFES();
}

var int DETLOW_SQ204_SHOWWHOSTHEBOSS;
func void DIA_DETLOW_SQ204_FIRSTROUND_ALRIGHT() {
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ204_FirstRound_Alright_15_01");
    if ((LOG_GETSTATUS(MIS_SQ416)) != (LOG_SUCCESS)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_FirstRound_Alright_03_02");
    };
    AI_WAITTILLEND(SELF, OTHER);
    INFO_CLEARCHOICES(73921);
    NPC_EXCHANGEROUTINE(VLK_3015_DETLOW, "RUNTOWOLFPHASE01");
    SQ204_DETLOW_RTNCHECK = 4;
    AI_STOPPROCESSINFOS(SELF);
}

func void DIA_DETLOW_SQ204_FIRSTROUND_IWILLDOIT() {
    DETLOW_SQ204_SHOWWHOSTHEBOSS = TRUE;
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ204_FirstRound_IWillDoIt_15_01");
    if ((LOG_GETSTATUS(MIS_SQ416)) != (LOG_SUCCESS)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_FirstRound_IWillDoIt_03_02");
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_FirstRound_IWillDoIt_03_03");
    INFO_CLEARCHOICES(73921);
    AI_STOPPROCESSINFOS(SELF);
    NPC_EXCHANGEROUTINE(VLK_3015_DETLOW, FOLLOW);
}

instance DIA_DETLOW_SQ204_COWARD(C_INFO) {
    NPC = 53778;
    NR = 1;
    CONDITION = DIA_DETLOW_SQ204_COWARD_CONDITION;
    INFORMATION = DIA_DETLOW_SQ204_COWARD_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_DETLOW_SQ204_COWARD_CONDITION() {
    if ((((DETLOW_SQ204_SHOWWHOSTHEBOSS) == (TRUE)) && ((NPC_GETDISTTOWP(SELF, "PART11_INNOS")) <= (2500))) && ((LOG_GETSTATUS(MIS_SQ204)) == (LOG_RUNNING))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_SQ204_COWARD_INFO() {
    DETLOW_SQ204_SHOWWHOSTHEBOSS = 0;
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_Coward_03_01");
    AI_STOPPROCESSINFOS(SELF);
    NPC_EXCHANGEROUTINE(SELF, "RUNTOWOLFPHASE01");
    SQ204_DETLOW_RTNCHECK = 4;
}

instance DIA_DETLOW_SQ204_AFTERROUND01(C_INFO) {
    NPC = 53778;
    NR = 2;
    CONDITION = DIA_DETLOW_SQ204_AFTERROUND01_CONDITION;
    INFORMATION = DIA_DETLOW_SQ204_AFTERROUND01_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_DETLOW_SQ204_AFTERROUND01_CONDITION() {
    if ((LOG_GETSTATUS(MIS_SQ204)) == (LOG_RUNNING)) {
        if ((SQ204_DETLOWATTACKWOLF) == (2)) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_SQ204_AFTERROUND01_INFO() {
    if ((DETLOW_SQ204_SHOWWHOSTHEBOSS) == (TRUE)) {
        if ((LOG_GETSTATUS(MIS_SQ416)) != (LOG_SUCCESS)) {
            AI_STARTFACEANI(SELF, S_SURPRISE, 1, -(1));
            AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_AfterRound01_03_02");
        };
        B_GIVEPLAYERXP(XP_SQ204_DETLOWSUPRISED);
    };
    AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_AfterRound01_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_AfterRound01_03_03");
    AI_STOPPROCESSINFOS(SELF);
    NPC_EXCHANGEROUTINE(SELF, "WOLFPHASE02");
    SQ204_DETLOW_RTNCHECK = 5;
    AI_RESETFACEANI(SELF);
    AI_LOGENTRY(TOPIC_SQ204, LOG_SQ204_DETLOW_AFTERROUND01);
    SQ204_SPAWNHURTEDWOLF();
}

instance DIA_DETLOW_SQ204_HURTWOLF(C_INFO) {
    NPC = 53778;
    NR = 3;
    CONDITION = DIA_DETLOW_SQ204_HURTWOLF_CONDITION;
    INFORMATION = DIA_DETLOW_SQ204_HURTWOLF_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_DETLOW_SQ204_HURTWOLF_CONDITION() {
    if ((LOG_GETSTATUS(MIS_SQ204)) == (LOG_RUNNING)) {
        if (((NPC_GETDISTTOWP(SELF, "PART11_WOLFDETLOWA_HURT")) <= (400)) || (((NPC_GETDISTTOWP(SELF, "PART11_WOLFDETLOWA_HURT")) <= (650)) && (NPC_ISINSTATE(SELF, 61599)))) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_SQ204_HURTWOLF_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_HurtWolf_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_HurtWolf_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ204_HurtWolf_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_HurtWolf_03_04");
    INFO_CLEARCHOICES(73933);
    INFO_ADDCHOICE(73933, "You're right. (Kill the wolf)", 73941);
    INFO_ADDCHOICE(73933, "Perhaps he could be helped in some way? (Spare the wolf)", 73943);
}

func void DIA_DETLOW_KILLHURTEDWOLF_END() {
    INFO_CLEARCHOICES(73933);
    AI_STOPPROCESSINFOS(VLK_3015_DETLOW);
    AI_STOPLOOKAT(HERO);
    NPC_EXCHANGEROUTINE(VLK_3015_DETLOW, "InnosWait");
    SQ204_DETLOW_RTNCHECK = 1;
    HERO.AIVAR[4] = TRUE;
    FF_APPLYONCEEXT(63481, 75, 4);
}

func void SQ204_GOWITHDETLOW() {
    HERO.AIVAR[4] = TRUE;
    FF_APPLYONCEEXT(63483, 75, 4);
}

func void DIA_DETLOW_KILLHURTEDWOLF_NEXTPHASE() {
    if ((NPC_ISDEAD(WOLF_DETLOW_HURT)) == (FALSE)) {
        WOLF_DETLOW_HURT.FLAGS = 0;
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_HurtWolf_Right_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_HurtWolf_Right_03_04");
    INFO_CLEARCHOICES(73933);
    INFO_ADDCHOICE(73933, "That wasn't the deal. I'm coming with you.", 73940);
    INFO_ADDCHOICE(73933, "Okay, but hurry up.", 73939);
}

func void DIA_DETLOW_SQ204_HURTWOLF_ALLRIGHT() {
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ204_HurtWolf_Right_15_05");
    AI_WAITTILLEND(SELF, OTHER);
    AI_FUNCTION(SELF, 73936);
}

func void DIA_DETLOW_SQ204_HURTWOLF_NOWAY() {
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ204_HurtWolf_NoWay_15_01");
    if ((LOG_GETSTATUS(MIS_SQ416)) != (LOG_SUCCESS)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_HurtWolf_NoWay_03_02");
        AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ204_HurtWolf_NoWay_15_03");
    };
    if ((DETLOW_SQ204_SHOWWHOSTHEBOSS) == (FALSE)) {
        if ((LOG_GETSTATUS(MIS_SQ416)) != (LOG_SUCCESS)) {
            AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_HurtWolf_NoWay_03_04");
        };
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_HurtWolf_NoWay_03_05");
    AI_STOPPROCESSINFOS(SELF);
    AI_FUNCTION(SELF, 73937);
    NPC_EXCHANGEROUTINE(SELF, "WOLFPHASE03");
    SQ204_DETLOW_RTNCHECK = 8;
}

func void DIA_DETLOW_SQ204_HURTWOLF_RIGHT() {
    DIACAM_DISABLE();
    WLD_SENDTRIGGER("KM_SQ204_01");
    TELEPORTNPCTOWP(53778, "PART11_PATH_115");
    TELEPORTNPCTOWP(50091, "PART11_MOB_12");
    AI_TURNTONPC(SELF, HERO);
    AI_TURNTONPC(HERO, SELF);
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ204_HurtWolf_Right_15_01");
    AI_WAITTILLEND(SELF, OTHER);
    AI_DRAWWEAPON(SELF);
    AI_TURNTONPC(SELF, WOLF_DETLOW_HURT);
    AI_SETWALKMODE(SELF, NPC_WALK);
    AI_GOTONPC(SELF, WOLF_DETLOW_HURT);
    AI_TURNTONPC(OTHER, SELF);
    AI_LOOKATNPC(OTHER, SELF);
    AI_WAITTILLEND(OTHER, SELF);
    AI_WAITTILLEND(SELF, OTHER);
    AI_PLAYANI(SELF, "T_1HSFINISH");
    AI_WAIT(OTHER, 1065353216);
    AI_FUNCTION(OTHER, 63479);
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_HurtWolf_Right_03_02");
    AI_LOGENTRY(TOPIC_SQ204, LOG_SQ204_DETLOW_AFTERROUND02_DEADWOLF);
    AI_FUNCTION(SELF, 73942);
    AI_REMOVEWEAPON(SELF);
    AI_TURNTONPC(SELF, OTHER);
    AI_SETWALKMODE(SELF, NPC_RUN);
    AI_GOTONPC(SELF, OTHER);
    DIA_DETLOW_KILLHURTEDWOLF_NEXTPHASE();
}

func void DETLOW_SQ204_KILLHURTWOLF_CHANGECAMERA_01() {
    WLD_SENDTRIGGER("KM_SQ204_02");
    WLD_SENDUNTRIGGER("KM_SQ204_01");
}

func void DIA_DETLOW_SQ204_HURTWOLF_HELP() {
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ204_HurtWolf_Help_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_HurtWolf_Help_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ204_HurtWolf_Help_15_03");
    if ((LOG_GETSTATUS(MIS_SQ416)) != (LOG_SUCCESS)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_HurtWolf_Help_03_04");
    };
    AI_LOGENTRY(TOPIC_SQ204, LOG_SQ204_DETLOW_AFTERROUND02_ALIVEWOLF);
    DIA_DETLOW_KILLHURTEDWOLF_NEXTPHASE();
}

instance DIA_DETLOW_SQ204_AFTERSECONDROUND(C_INFO) {
    NPC = 53778;
    NR = 1;
    CONDITION = DIA_DETLOW_SQ204_AFTERSECONDROUND_CONDITION;
    INFORMATION = DIA_DETLOW_SQ204_AFTERSECONDROUND_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_DETLOW_SQ204_AFTERSECONDROUND_CONDITION() {
    if (((SQ204_STARTCUTSCENE) == (3)) && ((LOG_GETSTATUS(MIS_SQ204)) == (LOG_RUNNING))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_SQ204_AFTERSECONDROUND_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_AfterSecondRound_03_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ204_AfterSecondRound_15_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_AfterSecondRound_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_AfterSecondRound_03_04");
    AI_LOGENTRY(TOPIC_SQ204, LOG_SQ204_DETLOW_AFTERROUND02_AFTERCUTSCENE);
    AI_STOPPROCESSINFOS(SELF);
    NPC_EXCHANGEROUTINE(SELF, "WOLFPHASE03");
    SQ204_DETLOW_RTNCHECK = 9;
}

instance DIA_DETLOW_SQ204_FIREPLACE(C_INFO) {
    NPC = 53778;
    NR = 2;
    CONDITION = DIA_DETLOW_SQ204_FIREPLACE_CONDITION;
    INFORMATION = DIA_DETLOW_SQ204_FIREPLACE_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_DETLOW_SQ204_FIREPLACE_CONDITION() {
    if (((LOG_GETSTATUS(MIS_SQ204)) == (LOG_RUNNING)) && ((NPC_GETDISTTOWP(SELF, "PART10_PATH2_94")) <= (500))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_SQ204_FIREPLACE_INFO() {
    if (!(NPC_ISDEAD(WOLF_DETLOW_HURT))) {
        B_REMOVENPC(57262);
        PRINTD("Ranny wilk polecia³ do psiego raju!");
    };
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ204_FirePlace_15_01");
    AI_STARTFACEANI(SELF, S_SERIOUS, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_FirePlace_03_02");
    AI_FUNCTION(SELF, 73950);
    AI_WAITTILLEND(SELF, OTHER);
    AI_WAITTILLEND(OTHER, SELF);
    AI_LOOKATNPC(OTHER, SELF);
    AI_TURNAWAY(SELF, OTHER);
    AI_PLAYANI(SELF, T_PLUNDER);
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_FirePlace_03_03");
    AI_TURNTONPC(SELF, OTHER);
    AI_RESETFACEANI(SELF);
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_FirePlace_03_04");
    if ((LOG_GETSTATUS(MIS_SQ416)) != (LOG_SUCCESS)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_FirePlace_03_05");
    };
    AI_FUNCTION_S(SELF, 777, "KM_SQ204_08");
    AI_WAITTILLEND(SELF, OTHER);
    AI_WAITTILLEND(OTHER, SELF);
    AI_SETWALKMODE(SELF, NPC_RUN);
    AI_SETWALKMODE(HERO, NPC_WALK);
    AI_GOTOWP(SELF, "PART10_SQ204_DETLOW_FIREPLACE");
    AI_GOTOWP(HERO, "PART10_CUTSCENE_HERO");
    AI_PLAYANI(OTHER, T_SEARCH);
    AI_PLAYANI(SELF, T_PLUNDER);
    AI_FUNCTION_S(SELF, 777, "KM_SQ204_MOVER");
    AI_WAIT(SELF, 1058642330);
    AI_FUNCTION(SELF, 73951);
}

func void SQ204_THIRDPHASE_CAMERA01() {
    DIACAM_DISABLE();
    WLD_SENDTRIGGER("KM_SQ204_07");
    HERO.AIVAR[4] = FALSE;
    TELEPORTNPCTOWP(53778, "PART10_PATH2_94");
    TELEPORTNPCTOWP(1819, "PART10_CUTSCENE_HERO_2");
}

func void SQ204_THIRDPHASE_ENDDIALOGE() {
    HERO.AIVAR[4] = FALSE;
    AI_STOPLOOKAT(HERO);
    AI_STOPPROCESSINFOS(VLK_3015_DETLOW);
    NPC_EXCHANGEROUTINE(VLK_3015_DETLOW, "WOLFPHASE03WAIT");
    FF_APPLYONCEEXT(63485, 75, 4);
    AI_FUNCTION(VLK_3015_DETLOW, 63473);
}

instance DIA_DETLOW_SQ204_ROUNDTHREE(C_INFO) {
    NPC = 53778;
    NR = 3;
    CONDITION = DIA_DETLOW_SQ204_ROUNDTHREE_CONDITION;
    INFORMATION = DIA_DETLOW_SQ204_ROUNDTHREE_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_DETLOW_SQ204_ROUNDTHREE_CONDITION() {
    if (((NPC_KNOWSINFO(OTHER, 73947)) && ((LOG_GETSTATUS(MIS_SQ204)) == (LOG_RUNNING))) && ((NPC_GETDISTTOWP(SELF, "PART10_SQ204_DETLOW_FIREPLACE")) <= (750))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_SQ204_ROUNDTHREE_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_RoundThree_03_01");
    AI_STOPPROCESSINFOS(SELF);
    AI_FUNCTION(SELF, 63474);
}

instance DIA_DETLOW_SQ204_FINISH(C_INFO) {
    NPC = 53778;
    NR = 4;
    CONDITION = DIA_DETLOW_SQ204_FINISH_CONDITION;
    INFORMATION = DIA_DETLOW_SQ204_FINISH_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_DETLOW_SQ204_FINISH_CONDITION() {
    if (((LOG_GETSTATUS(MIS_SQ204)) == (LOG_RUNNING)) && ((SQ204_FINALWOLFATTACK) == (3))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_SQ204_FINISH_RESULT() {
    if ((SQ204_CHECKTIME) == (2)) {
        SETHOLDTIME(FALSE);
        CHANGETIMESPEED(100);
    };
    SQ204_CHECKTIME = 0;
    VLK_3015_DETLOW.AIVAR[15] = FALSE;
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_Finish_03_07");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_Finish_03_08");
    if ((DETLOW_TALKEDABOUTBEAST) == (TRUE)) {
        AI_LOGENTRY(TOPIC_SQ204, LOG_SQ204_DETLOW_AFTERROUND03_BEAST);
    };
    AI_LOGENTRY(TOPIC_SQ204, LOG_SQ204_DETLOW_AFTERROUND03);
    AI_RESETFACEANI(OTHER);
    AI_RESETFACEANI(SELF);
    AI_STOPPROCESSINFOS(SELF);
    RESTOREROUTINE_DETLOW();
}

func void DIA_DETLOW_SQ204_FINISH_INFO() {
    SQ204_DETLOW_RTNCHECK = 11;
    AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_Finish_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_Finish_03_02");
    if ((NPC_KNOWSINFO(OTHER, 85411)) && ((LOG_GETSTATUS(MIS_SQ416)) != (LOG_SUCCESS))) {
        AI_STARTFACEANI(OTHER, S_SMILE, 1, -(1));
        AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ204_Finish_15_03");
        AI_RESETFACEANI(SELF);
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_Finish_03_04");
        AI_RESETFACEANI(OTHER);
        AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ204_Finish_15_05");
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_Finish_03_06");
        INFO_CLEARCHOICES(73955);
        INFO_ADDCHOICE(73955, "I thought slaughtering a pack of wolves was quite a challenge.", 73959);
    };
    DIA_DETLOW_SQ204_FINISH_RESULT();
}

func void DIA_DETLOW_SQ204_FINISH_HARD() {
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ204_Finish_Hard_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_Finish_Hard_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_Finish_Hard_03_03");
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ204_Finish_Hard_15_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ204_Finish_Hard_03_05");
    DETLOW_TALKEDABOUTBEAST = TRUE;
    DIA_DETLOW_SQ204_FINISH_RESULT();
}

instance DIA_DETLOW_QM302_QUIET(C_INFO) {
    NPC = 53778;
    NR = 1;
    CONDITION = DIA_DETLOW_QM302_QUIET_CONDITION;
    INFORMATION = DIA_DETLOW_QM302_QUIET_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_DETLOW_QM302_QUIET_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_QM302)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 71115))) && ((NPC_GETDISTTOWP(SELF, "PART2_PATH_65")) <= (500))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_QM302_QUIET_INFO() {
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_QM302_Quiet_03_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_QM302_Quiet_15_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_QM302_Quiet_03_03");
}

instance DIA_DETLOW_QM302_BEAST(C_INFO) {
    NPC = 53778;
    NR = 1;
    CONDITION = DIA_DETLOW_QM302_BEAST_CONDITION;
    INFORMATION = DIA_DETLOW_QM302_BEAST_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "A victim of what?";
}

func int DIA_DETLOW_QM302_BEAST_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_QM302)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 73960))) && ((LOG_GETSTATUS(MIS_SQ416)) != (LOG_SUCCESS))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_QM302_BEAST_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_QM302_Beast_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_QM302_Beast_03_02");
    if ((DETLOW_TALKEDABOUTBEAST) == (FALSE)) {
        DETLOW_TALKEDABOUTBEAST = TRUE;
        AI_STARTFACEANI(SELF, S_SURPRISE, 1, -(1));
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_QM302_Beast_03_03");
        AI_OUTPUT(OTHER, SELF, "DIA_Detlow_QM302_Beast_15_04");
        AI_RESETFACEANI(SELF);
    };
    AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_QM302_Beast_03_05");
}

instance DIA_DETLOW_QM302_GUILD(C_INFO) {
    NPC = 53778;
    NR = 1;
    CONDITION = DIA_DETLOW_QM302_GUILD_CONDITION;
    INFORMATION = DIA_DETLOW_QM302_GUILD_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "The Merchant's Guild has a matter for you.";
}

func int DIA_DETLOW_QM302_GUILD_CONDITION() {
    if (((LOG_GETSTATUS(MIS_QM302)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 73960))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

var int QM302_GUILD_TARGETS;
var int QM302_GUILD_TEACHER;
var int QM302_GUILD_REPAIR;
func void DIA_DETLOW_QM302_GUILD_NEXT() {
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_QM302_Guild_Next_03_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_QM302_Guild_Next_15_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_QM302_Guild_Next_03_03");
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_QM302_Guild_Next_15_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_QM302_Guild_Next_03_05");
    INFO_CLEARCHOICES(73966);
    INFO_ADDCHOICE(73966, "That Bodowin again...", 73977);
    INFO_ADDCHOICE(73966, "I'll go get the herbs.", 73978);
}

func void DIA_DETLOW_QM302_GUILD_CHOICES() {
    if (((QM302_GUILD_TEACHER) == (FALSE)) || ((QM302_GUILD_REPAIR) == (FALSE))) {
        INFO_CLEARCHOICES(73966);
        if ((QM302_GUILD_REPAIR) == (FALSE)) {
            INFO_ADDCHOICE(73966, "Take care of crossbow maintenance.", 73976);
        };
        if ((QM302_GUILD_TEACHER) == (FALSE)) {
            INFO_ADDCHOICE(73966, "A teacher.", 73974);
        };
        if ((QM302_GUILD_TARGETS) == (FALSE)) {
            INFO_ADDCHOICE(73966, "Targets.", 73975);
        };
    };
    DIA_DETLOW_QM302_GUILD_NEXT();
}

func void DIA_DETLOW_QM302_GUILD_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_QM302_Guild_15_01");
    AI_PLAYANI(SELF, T_STAND_2_LGUARD);
    AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_QM302_Guild_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_QM302_Guild_15_03");
    AI_STARTFACEANI(SELF, S_WHAT, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_QM302_Guild_03_04");
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_QM302_Guild_15_05");
    AI_WAITTILLEND(SELF, OTHER);
    AI_PLAYANI(SELF, T_LGUARD_2_STAND);
    AI_RESETFACEANI(SELF);
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_QM302_Guild_03_06");
    DIA_DETLOW_QM302_GUILD_CHOICES();
}

func void DIA_DETLOW_QM302_GUILD_TEACHER() {
    QM302_GUILD_TEACHER = TRUE;
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_QM302_Guild_Teacher_15_01");
    AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_QM302_Guild_Teacher_03_02");
    DIA_DETLOW_QM302_GUILD_CHOICES();
}

func void DIA_DETLOW_QM302_GUILD_TARGETS() {
    QM302_GUILD_TARGETS = TRUE;
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_QM302_Guild_Targets_15_01");
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_QM302_Guild_Targets_03_02");
    DIA_DETLOW_QM302_GUILD_CHOICES();
}

func void DIA_DETLOW_QM302_GUILD_REPAIR() {
    QM302_GUILD_REPAIR = TRUE;
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_QM302_Guild_Repair_15_01");
    AI_STARTFACEANI(SELF, S_THINK, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_QM302_Guild_Repair_03_02");
    DIA_DETLOW_QM302_GUILD_CHOICES();
}

func void DIA_DETLOW_QM302_GUILD_REPAIR_NEXT_BODOWIN() {
    AI_STARTFACEANI(OTHER, S_DISGUST, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_QM302_Guild_Bodowin_15_01");
    AI_STARTFACEANI(SELF, S_DISGUST, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_QM302_Guild_Bodowin_03_02");
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
}

func void DIA_DETLOW_QM302_GUILD_REPAIR_NEXT_PLANTS() {
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_QM302_Guild_Plants_15_01");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_QM302_Guild_Plants_03_02");
    INFO_CLEARCHOICES(73966);
    AI_STOPPROCESSINFOS(SELF);
    NPC_EXCHANGEROUTINE(SELF, "QM302_BARRACK");
    QM302_DETLOW_RTNCHECK = 2;
    AI_LOGENTRY(TOPIC_QM302, LOG_QM302_DETLOW_NEEDPLANTS);
}

instance DIA_DETLOW_QM302_GOTPLANTS(C_INFO) {
    NPC = 53778;
    NR = 1;
    CONDITION = DIA_DETLOW_QM302_GOTPLANTS_CONDITION;
    INFORMATION = DIA_DETLOW_QM302_GOTPLANTS_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "I have the herbs you asked for.";
}

func int DIA_DETLOW_QM302_GOTPLANTS_CONDITION() {
    if (((LOG_GETSTATUS(MIS_QM302)) == (LOG_RUNNING)) && ((NPC_HASITEMS(OTHER, 37228)) >= (1))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_QM302_GOTPLANTS_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_QM302_GotPlants_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_QM302_GotPlants_03_02");
    B_GIVEINVITEMS(OTHER, SELF, 37228, 1);
    B_STANDUP();
    B_USEFAKEPACKET();
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_QM302_GotPlants_03_03");
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_QM302_GotPlants_15_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_QM302_GotPlants_03_05");
    AI_LOGENTRY(TOPIC_QM302, LOG_QM302_DETLOW_GOTPLANTS);
    AI_STOPPROCESSINFOS(SELF);
    NPC_REMOVEINVITEM(SELF, 37228);
}

instance DIA_DETLOW_SQ416_GOODLUCK(C_INFO) {
    NPC = 53778;
    NR = 1;
    CONDITION = DIA_DETLOW_SQ416_GOODLUCK_CONDITION;
    INFORMATION = DIA_DETLOW_SQ416_GOODLUCK_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_DETLOW_SQ416_GOODLUCK_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_SQ416)) == (LOG_RUNNING)) && ((LOG_GETSTATUS(MIS_SQ204)) == (LOG_SUCCESS))) && ((SQ416_RAMSEYHOUSEMEETING) == (4))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_SQ416_GOODLUCK_INFO() {
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_GoodLuck_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_GoodLuck_03_02");
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_DETLOW_SQ416_ALLAN(C_INFO) {
    NPC = 53778;
    NR = 1;
    CONDITION = DIA_DETLOW_SQ416_ALLAN_CONDITION;
    INFORMATION = DIA_DETLOW_SQ416_ALLAN_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_DETLOW_SQ416_ALLAN_CONDITION() {
    if (((LOG_GETSTATUS(MIS_SQ416)) == (LOG_RUNNING)) && ((SQ416_CHECKEDALLANCORPSE) == (TRUE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_SQ416_ALLAN_INFO() {
    AI_STARTFACEANI(SELF, S_WHAT, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_Allan_03_01");
    INFO_CLEARCHOICES(73985);
    INFO_ADDCHOICE(73985, "Looks like we're the only ones left.", 73990);
    INFO_ADDCHOICE(73985, "Unfortunately, Allan is dead.", 73989);
}

func void DIA_DETLOW_SQ416_ALLAN_NEXT() {
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_RESETFACEANI(OTHER);
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_Allan_Next_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_Allan_Next_03_02");
    AI_PLAYANI(SELF, T_SEARCH);
    AI_RESETFACEANI(SELF);
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_Allan_Next_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_Allan_Next_03_04");
    INFO_CLEARCHOICES(73985);
    INFO_ADDCHOICE(73985, "How are we supposed to get there?", 73992);
    INFO_ADDCHOICE(73985, "Maybe we can go back for some reinforcements?", 73991);
}

func void DIA_DETLOW_SQ416_ALLAN_NO() {
    AI_STARTFACEANI(OTHER, S_SAD, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ416_Allan_No_15_01");
    DIA_DETLOW_SQ416_ALLAN_NEXT();
}

func void DIA_DETLOW_SQ416_ALLAN_ALONE() {
    AI_STARTFACEANI(OTHER, S_TIRED, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ416_Allan_Alone_15_01");
    DIA_DETLOW_SQ416_ALLAN_NEXT();
}

func void DIA_DETLOW_SQ416_ALLAN_ALONE_NEXT_HELP() {
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ416_Allan_Help_15_01");
    AI_STARTFACEANI(SELF, S_WHAT, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_Allan_Help_03_02");
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
}

func void DIA_DETLOW_SQ416_ALLAN_ALONE_NEXT_HOW() {
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ416_Allan_How_15_01");
    AI_RESETFACEANI(OTHER);
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_Allan_How_03_02");
    INFO_CLEARCHOICES(73985);
    INFO_ADDCHOICE(73985, "Let's go.", 73994);
    INFO_ADDCHOICE(73985, "What about the reward?", 73993);
}

func void DIA_DETLOW_SQ416_ALLAN_ALONE_NEXT_HOW_REWARD() {
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ416_Allan_Reward_15_01");
    AI_STARTFACEANI(SELF, S_SERIOUS, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_Allan_Reward_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_Allan_Reward_03_03");
    SQ416_DETLOWSUSPECT_COUNT();
}

func void DIA_DETLOW_SQ416_ALLAN_ALONE_NEXT_HOW_GO() {
    AI_RESETFACEANI(OTHER);
    AI_RESETFACEANI(SELF);
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ416_Allan_Go_15_01");
    AI_WAITTILLEND(SELF, OTHER);
    INFO_CLEARCHOICES(73985);
    AI_STOPPROCESSINFOS(SELF);
    AI_FUNCTION(SELF, 73995);
}

func void DETLOW_SQ416_GOTOCAVE() {
    FADESCREENTOBLACKF(1, 73996, 1000);
}

func void DETLOW_SQ416_GOTOCAVE_FADESCREEN() {
    FF_APPLYONCEEXT(73997, 1000, 4);
}

func void DETLOW_SQ416_GOTOCAVE_FADESCREEN_APPLY() {
    var int DETLOW_SQ416_GOTOCAVE_FADESCREEN_COUNT;
    DETLOW_SQ416_GOTOCAVE_FADESCREEN_COUNT = (DETLOW_SQ416_GOTOCAVE_FADESCREEN_COUNT) + (1);
    if ((DETLOW_SQ416_GOTOCAVE_FADESCREEN_COUNT) == (1)) {
        SND_PLAY("Rocks_Fall_Small_01");
        SND_PLAY("Run_Stone");
    };
    if ((DETLOW_SQ416_GOTOCAVE_FADESCREEN_COUNT) == (2)) {
        SND_PLAY("Rocks_Fall_Small_02");
        SND_PLAY("Run_Stone");
    };
    if ((DETLOW_SQ416_GOTOCAVE_FADESCREEN_COUNT) == (3)) {
        SQ416_STARTBOSSFIGHT = 1;
        TELEPORTNPCTOWP(1819, "PART12_SQ416_CAVE_01");
        TELEPORTNPCTOWP(53778, "PART12_SQ416_CAVE_02");
        B_TURNTONPC(HERO, VLK_3015_DETLOW);
        B_TURNTONPC(VLK_3015_DETLOW, HERO);
        B_STARTOTHERROUTINE(VLK_3015_DETLOW, "SQ416_CAVE_FOLLOW");
        NPC_REFRESH(VLK_3015_DETLOW);
        SQ416_DETLOW_RTNCHECK = 6;
        NPC_REMOVEINVITEMS(VLK_3015_DETLOW, 39512, NPC_HASITEMS(VLK_3015_DETLOW, 39512));
        CREATEINVITEMS(VLK_3015_DETLOW, 39549, 1);
        HERO.AIVAR[4] = FALSE;
        FADESCREENFROMBLACK(1);
        WLD_SENDTRIGGER("SQ416_ALPHAWALL_CAVE");
    };
}

instance DIA_DETLOW_SQ416_AFTERFIGHT(C_INFO) {
    NPC = 53778;
    NR = 1;
    CONDITION = DIA_DETLOW_SQ416_AFTERFIGHT_CONDITION;
    INFORMATION = DIA_DETLOW_SQ416_AFTERFIGHT_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_DETLOW_SQ416_AFTERFIGHT_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_SQ416)) == (LOG_RUNNING)) && ((SQ416_STARTBOSSFIGHT) == (3))) && (NPC_ISINSTATE(SELF, 61599))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_SQ416_AFTERFIGHT_INFO() {
    WLD_SENDTRIGGER("SQ416_ALPHAWALL_CAVE");
    SQ416_CANTLEAVEFOREST = 4;
    SELF.AIVAR[15] = FALSE;
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ416_AfterFight_15_01");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_AfterFight_03_02");
    AI_RESETFACEANI(SELF);
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_AfterFight_03_03");
    INFO_CLEARCHOICES(73999);
    INFO_ADDCHOICE(73999, "Why was this beast wearing some bits of armor?", 74002);
    INFO_ADDCHOICE(73999, "I'll run to the village for help.", 74003);
}

func void DIA_DETLOW_SQ416_AFTERFIGHT_WHY() {
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ416_AfterFight_Why_15_01");
    AI_STARTFACEANI(SELF, S_SURPRISE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_AfterFight_Why_03_02");
    AI_STARTFACEANI(SELF, S_THINK, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_AfterFight_Why_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_AfterFight_Why_03_04");
    AI_RESETFACEANI(SELF);
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_AfterFight_Why_03_05");
    AI_LOGENTRY(TOPIC_SQ416, LOG_SQ416_DETLOW_THINK);
    SQ416_DETLOWSUSPECT_COUNT();
}

func void DIA_DETLOW_SQ416_AFTERFIGHT_HELP() {
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ416_AfterFight_Help_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_AfterFight_Help_03_02");
    INFO_CLEARCHOICES(73999);
    AI_STOPPROCESSINFOS(SELF);
    AI_LOGENTRY(TOPIC_SQ416, LOG_SQ416_DETLOW_HELP);
}

instance DIA_DETLOW_SQ416_TRUTH(C_INFO) {
    NPC = 53778;
    NR = 1;
    CONDITION = DIA_DETLOW_SQ416_TRUTH_CONDITION;
    INFORMATION = DIA_DETLOW_SQ416_TRUTH_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "We must tell everyone the truth about the Beast.";
}

func int DIA_DETLOW_SQ416_TRUTH_CONDITION() {
    if ((LOG_GETSTATUS(MIS_SQ416)) == (LOG_SUCCESS)) {
        if ((SQ416_RAMSEYPARTY) != (2)) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_SQ416_TRUTH_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ416_Truth_15_01");
    AI_STARTFACEANI(SELF, S_SERIOUS, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_Truth_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_Truth_03_03");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_Truth_03_04");
    SQ416_DETLOWSUSPECT_COUNT();
}

instance DIA_DETLOW_SQ416_WHAT(C_INFO) {
    NPC = 53778;
    NR = 1;
    CONDITION = DIA_DETLOW_SQ416_WHAT_CONDITION;
    INFORMATION = DIA_DETLOW_SQ416_WHAT_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "What happened this morning?";
}

func int DIA_DETLOW_SQ416_WHAT_CONDITION() {
    if ((LOG_GETSTATUS(MIS_SQ416)) == (LOG_SUCCESS)) {
        if ((SQ416_RAMSEYPARTY) != (2)) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_SQ416_WHAT_INFO() {
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ416_What_15_01");
    AI_RESETFACEANI(OTHER);
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_What_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_What_03_03");
}

instance DIA_DETLOW_SQ416_WHO(C_INFO) {
    NPC = 53778;
    NR = 1;
    CONDITION = DIA_DETLOW_SQ416_WHO_CONDITION;
    INFORMATION = DIA_DETLOW_SQ416_WHO_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Any idea who might have tried to put me down before the hunt?";
}

func int DIA_DETLOW_SQ416_WHO_CONDITION() {
    if (((LOG_GETSTATUS(MIS_SQ416)) == (LOG_SUCCESS)) && (NPC_KNOWSINFO(OTHER, 74007))) {
        if ((SQ416_RAMSEYPARTY) != (2)) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_SQ416_WHO_INFO() {
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ416_Who_15_01");
    AI_STARTFACEANI(SELF, S_TIRED, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_Who_03_02");
    AI_STARTFACEANI(SELF, S_SERIOUS, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_Who_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_Who_03_04");
    AI_RESETFACEANI(SELF);
    SQ416_DETLOWSUSPECT_COUNT();
}

instance DIA_DETLOW_SQ416_BEAST(C_INFO) {
    NPC = 53778;
    NR = 1;
    CONDITION = DIA_DETLOW_SQ416_BEAST_CONDITION;
    INFORMATION = DIA_DETLOW_SQ416_BEAST_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "I wanted to talk about this Beast...";
}

func int DIA_DETLOW_SQ416_BEAST_CONDITION() {
    if (((LOG_GETSTATUS(MIS_SQ416)) == (LOG_SUCCESS)) && ((SQ416_RAMSEYPARTY) == (2))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_SQ416_BEAST_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ416_Beast_15_01");
    AI_STARTFACEANI(SELF, S_TIRED, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_Beast_03_02");
    AI_RESETFACEANI(SELF);
}

instance DIA_DETLOW_SQ416_REALBEAST(C_INFO) {
    NPC = 53778;
    NR = 1;
    CONDITION = DIA_DETLOW_SQ416_REALBEAST_CONDITION;
    INFORMATION = DIA_DETLOW_SQ416_REALBEAST_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Too many things don't fit here...";
}

func int DIA_DETLOW_SQ416_REALBEAST_CONDITION() {
    if (((((LOG_GETSTATUS(MIS_SQ416)) == (LOG_SUCCESS)) && ((SQ416_RAMSEYPARTY) == (2))) && (NPC_KNOWSINFO(OTHER, 74013))) && ((SQ416_REALMONSTER_COUNT) >= (6))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void SQ416_CHECKIFDETLOWDEAD_APPLY() {
    if ((CURRENTLEVEL) == (ARCHOLOS_ZEN)) {
        if (NPC_ISDEAD(VLK_3015_DETLOW)) {
            FINALBOARDS_DETLOWISDEAD = TRUE;
            FF_REMOVE(74018);
        };
    };
}

func void DETLOW_SQ416_FINALFIGHT() {
    FF_APPLYONCEEXTGT(74018, 0, -(1));
    AI_WAITTILLEND(SELF, OTHER);
    NPC_REMOVEINVITEMS(VLK_3015_DETLOW, 39549, NPC_HASITEMS(VLK_3015_DETLOW, 39549));
    VLK_3015_DETLOW.AIVAR[52] = TRUE;
    NPC_REMOVEINVITEMS(VLK_3015_DETLOW, 39512, NPC_HASITEMS(VLK_3015_DETLOW, 39512));
    VLK_3015_DETLOW.GUILD = GIL_NONE;
    NPC_SETTRUEGUILD(VLK_3015_DETLOW, GIL_NONE);
    VLK_3015_DETLOW.FLAGS = 0;
    NPC_SETTRUEGUILD(HERO, HERO.GUILD);
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
    AI_STOPPROCESSINFOS(SELF);
    INFO_CLEARCHOICES(74016);
    SQ416_GIVEDETLOWSCROLLS();
    B_IMMEDIATEATTACKPLAYER(VLK_3015_DETLOW, AR_KILL);
}

func void DIA_DETLOW_SQ416_REALBEAST_INFO() {
    AI_STARTFACEANI(OTHER, S_SERIOUS, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ416_RealBeast_15_01");
    AI_WAITTILLEND(SELF, OTHER);
    B_STANDUP();
    AI_PLAYANI(SELF, T_STAND_2_LGUARD);
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ416_RealBeast_15_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ416_RealBeast_15_03");
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ416_RealBeast_15_04");
    AI_RESETFACEANI(OTHER);
    AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_RealBeast_03_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_RealBeast_03_06");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_RealBeast_03_07");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_RealBeast_03_08");
    INFO_CLEARCHOICES(74016);
    INFO_ADDCHOICE(74016, "What's all this for?", 74021);
}

func void DIA_DETLOW_SQ416_REALBEAST_WHY() {
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ416_RealBeast_Why_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_RealBeast_Why_03_02");
    INFO_CLEARCHOICES(74016);
    INFO_ADDCHOICE(74016, "Then who did the killing?", 74022);
}

func void DIA_DETLOW_SQ416_REALBEAST_WHY_WHO() {
    GAMESERVICES_UNLOCKACHIEVEMENT(ACH_33);
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ416_RealBeast_Who_15_01");
    AI_RESETFACEANI(OTHER);
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_RealBeast_Who_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_RealBeast_Who_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_RealBeast_Who_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_RealBeast_Who_03_05");
    AI_PLAYANI(SELF, T_LGUARD_2_STAND);
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_RealBeast_Who_03_06");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_RealBeast_Who_03_07");
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_RealBeast_Who_03_08");
    INFO_CLEARCHOICES(74016);
    INFO_ADDCHOICE(74016, "There is a lot of truth in what you say...", 74029);
    INFO_ADDCHOICE(74016, "You're crazy!", 74028);
    INFO_ADDCHOICE(74016, DIALOG_BESILENT, 74027);
}

func void DIA_DETLOW_SQ416_REALBEAST_NEXT2() {
    AI_STARTFACEANI(SELF, S_SERIOUS, 1, -(1));
    AI_DRAWWEAPON(SELF);
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_RealBeast_Next2_03_01");
    INFO_CLEARCHOICES(74016);
    INFO_ADDCHOICE(74016, "I promised to kill the Beast and I intend to fulfill the contract.", 74024);
    INFO_ADDCHOICE(74016, "(Say nothing and draw your weapon)", 74025);
}

func void DIA_DETLOW_SQ416_REALBEAST_WHY_WHO_SILENCE_NEXT_NEXT2_PROMISE() {
    AI_DRAWWEAPON(OTHER);
    AI_STARTFACEANI(OTHER, S_SERIOUS, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ416_RealBeast_Promise_15_01");
    DETLOW_SQ416_FINALFIGHT();
}

func void DIA_DETLOW_SQ416_REALBEAST_WHY_WHO_SILENCE_NEXT_NEXT2_SILENCE2() {
    AI_DRAWWEAPON(OTHER);
    DETLOW_SQ416_FINALFIGHT();
}

func void DIA_DETLOW_SQ416_REALBEAST_NEXT() {
    AI_WAITTILLEND(SELF, OTHER);
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_RealBeast_Next_03_01");
    DIA_DETLOW_SQ416_REALBEAST_NEXT2();
}

func void DIA_DETLOW_SQ416_REALBEAST_WHY_WHO_SILENCE() {
    AI_WAIT(HERO, 1061997773);
    DIA_DETLOW_SQ416_REALBEAST_NEXT();
}

func void DIA_DETLOW_SQ416_REALBEAST_WHY_WHO_MAD() {
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ416_RealBeast_Mad_15_01");
    DIA_DETLOW_SQ416_REALBEAST_NEXT();
}

func void DIA_DETLOW_SQ416_REALBEAST_WHY_WHO_RIGHT() {
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_SQ416_RealBeast_Right_15_01");
    AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Detlow_SQ416_RealBeast_Right_03_02");
    DIA_DETLOW_SQ416_REALBEAST_NEXT2();
}

var int DETLOW_ALLHUNT;
instance DIA_DETLOW_HUNTING_SPECIAL(C_INFO) {
    NPC = 53778;
    NR = 1;
    CONDITION = DIA_DETLOW_HUNTING_SPECIAL_CONDITION;
    INFORMATION = DIA_DETLOW_HUNTING_SPECIAL_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "Can you teach me something about hunting?";
}

func int DIA_DETLOW_HUNTING_SPECIAL_CONDITION() {
    if (((NPC_KNOWSINFO(OTHER, 73886)) && ((PLAYER_TALENT_TAKEANIMALTROPHY[2]) == (TRUE))) && ((DETLOW_ALLHUNT) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_HUNTING_SPECIAL_CHOICES() {
    INFO_CLEARCHOICES(74031);
    INFO_ADDCHOICE(74031, DIALOG_BACK, 74035);
    if ((PLAYER_TALENT_TAKEANIMALTROPHY[17]) == (FALSE)) {
        INFO_ADDCHOICE(74031, B_BUILDLEARNSTRING2(PRINT_TEACHSHELLS, B_GETLEARNCOSTTALENT(OTHER, NPC_TALENT_TAKEANIMALTROPHY, TROPHY_SHELLS), DETLOW_SHELLSTROPHY), 74036);
    };
    if ((PLAYER_TALENT_TAKEANIMALTROPHY[4]) == (FALSE)) {
        INFO_ADDCHOICE(74031, B_BUILDLEARNSTRING2(PRINT_TEACHSHADOWHORN, B_GETLEARNCOSTTALENT(OTHER, NPC_TALENT_TAKEANIMALTROPHY, TROPHY_SHADOWHORN), DETLOW_SHADOWHORNTROPHY), 74037);
    };
    if ((PLAYER_TALENT_TAKEANIMALTROPHY[13]) == (FALSE)) {
        INFO_ADDCHOICE(74031, B_BUILDLEARNSTRING2(PRINT_TEACHREPTILESKIN, B_GETLEARNCOSTTALENT(OTHER, NPC_TALENT_TAKEANIMALTROPHY, TROPHY_REPTILESKIN), DETLOW_REPTILESKINTROPHY), 74038);
    };
    if ((PLAYER_TALENT_TAKEANIMALTROPHY[1]) == (FALSE)) {
        INFO_ADDCHOICE(74031, B_BUILDLEARNSTRING2(PRINT_TEACHCLAWS, B_GETLEARNCOSTTALENT(OTHER, NPC_TALENT_TAKEANIMALTROPHY, TROPHY_CLAWS), DETLOW_CLAWSTROPHY), 74039);
    };
    if ((PLAYER_TALENT_TAKEANIMALTROPHY[0]) == (FALSE)) {
        INFO_ADDCHOICE(74031, B_BUILDLEARNSTRING2(PRINT_TEACHTEETH, B_GETLEARNCOSTTALENT(OTHER, NPC_TALENT_TAKEANIMALTROPHY, TROPHY_TEETH), DETLOW_TEETHTROPHY), 74040);
    };
    if ((PLAYER_TALENT_TAKEANIMALTROPHY[5]) == (FALSE)) {
        INFO_ADDCHOICE(74031, B_BUILDLEARNSTRING2(PRINT_TEACHFIRETONGUE, B_GETLEARNCOSTTALENT(OTHER, NPC_TALENT_TAKEANIMALTROPHY, TROPHY_FIRETONGUE), DETLOW_FIRETONGUETROPHY), 74041);
    };
}

func void DIA_DETLOW_HUNTING_SPECIAL_INFO() {
    B_SAY(OTHER, SELF, "$MARVIN_CanYouTeachMeHunting");
    DIA_DETLOW_HUNTING_SPECIAL_CHOICES();
}

func void DIA_DETLOW_HUNTING_SPECIAL_BACK() {
    INFO_CLEARCHOICES(74031);
    if (((((((PLAYER_TALENT_TAKEANIMALTROPHY[17]) == (TRUE)) && ((PLAYER_TALENT_TAKEANIMALTROPHY[4]) == (TRUE))) && ((PLAYER_TALENT_TAKEANIMALTROPHY[13]) == (TRUE))) && ((PLAYER_TALENT_TAKEANIMALTROPHY[1]) == (TRUE))) && ((PLAYER_TALENT_TAKEANIMALTROPHY[0]) == (TRUE))) && ((PLAYER_TALENT_TAKEANIMALTROPHY[5]) == (TRUE))) {
        DETLOW_ALLHUNT = TRUE;
        B_SAY(SELF, OTHER, "$YouLearnedSomething");
    };
}

func void DIA_DETLOW_HUNTING_SPECIAL_SHELLS() {
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_Hunting_Special_Shells_15_01");
    if ((NPC_HASITEMS(OTHER, 34203)) >= (DETLOW_SHELLSTROPHY)) {
        if ((PLAYER_TALENT_TAKEANIMALTROPHY[17]) == (TRUE)) {
            NPC_REMOVEINVITEMS(SELF, 34203, DETLOW_SHELLSTROPHY);
            AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Hunting_Special_Shells_03_02");
            B_GIVEINVITEMS(OTHER, SELF, 34203, DETLOW_SHELLSTROPHY);
            AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Hunting_Special_Shells_03_03");
            PRINTSCREEN(PRINT_LEARNTAKEANIMALTROPHYSHELLS, -(1), -(1), FONT_SCREEN, 2);
        };
    };
    if ((NPC_HASITEMS(OTHER, 34203)) < (DETLOW_SHELLSTROPHY)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Hunting_Special_Shells_03_04");
    };
    DIA_DETLOW_HUNTING_SPECIAL_CHOICES();
}

func void DIA_DETLOW_HUNTING_SPECIAL_SHADOWHORN() {
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_Hunting_Special_ShadowHorn_15_01");
    if ((NPC_HASITEMS(OTHER, 34203)) >= (DETLOW_SHADOWHORNTROPHY)) {
        if ((PLAYER_TALENT_TAKEANIMALTROPHY[4]) == (TRUE)) {
            NPC_REMOVEINVITEMS(SELF, 34203, DETLOW_SHADOWHORNTROPHY);
            AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Hunting_Special_ShadowHorn_03_02");
            B_GIVEINVITEMS(OTHER, SELF, 34203, DETLOW_SHADOWHORNTROPHY);
            AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Hunting_Special_ShadowHorn_03_03");
            PRINTSCREEN(PRINT_LEARNTAKEANIMALTROPHYHORN, -(1), -(1), FONT_SCREEN, 2);
        };
    };
    if ((NPC_HASITEMS(OTHER, 34203)) < (DETLOW_SHADOWHORNTROPHY)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Hunting_Special_ShadowHorn_03_04");
    };
    DIA_DETLOW_HUNTING_SPECIAL_CHOICES();
}

func void DIA_DETLOW_HUNTING_SPECIAL_REPTILESKIN() {
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_Hunting_Special_ReptileSkin_15_01");
    if ((NPC_HASITEMS(OTHER, 34203)) >= (DETLOW_REPTILESKINTROPHY)) {
        if ((PLAYER_TALENT_TAKEANIMALTROPHY[13]) == (TRUE)) {
            NPC_REMOVEINVITEMS(SELF, 34203, DETLOW_REPTILESKINTROPHY);
            AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Hunting_Special_ReptileSkin_03_02");
            B_GIVEINVITEMS(OTHER, SELF, 34203, DETLOW_REPTILESKINTROPHY);
            AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Hunting_Special_ReptileSkin_03_03");
            PRINTSCREEN(PRINT_LEARNTAKEANIMALTROPHYREPTILESKIN, -(1), -(1), FONT_SCREEN, 2);
        };
    };
    if ((NPC_HASITEMS(OTHER, 34203)) < (DETLOW_REPTILESKINTROPHY)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Hunting_Special_ReptileSkin_03_04");
    };
    DIA_DETLOW_HUNTING_SPECIAL_CHOICES();
}

func void DIA_DETLOW_HUNTING_SPECIAL_CLAWS() {
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_Hunting_Special_Claws_15_01");
    if ((NPC_HASITEMS(OTHER, 34203)) >= (DETLOW_CLAWSTROPHY)) {
        if ((PLAYER_TALENT_TAKEANIMALTROPHY[1]) == (TRUE)) {
            NPC_REMOVEINVITEMS(SELF, 34203, DETLOW_CLAWSTROPHY);
            AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Hunting_Special_Claws_03_02");
            B_GIVEINVITEMS(OTHER, SELF, 34203, DETLOW_CLAWSTROPHY);
            AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Hunting_Special_Claws_03_03");
            PRINTSCREEN(PRINT_LEARNTAKEANIMALTROPHYCLAWS, -(1), -(1), FONT_SCREEN, 2);
        };
    };
    if ((NPC_HASITEMS(OTHER, 34203)) < (DETLOW_CLAWSTROPHY)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Hunting_Special_Claws_03_04");
    };
    DIA_DETLOW_HUNTING_SPECIAL_CHOICES();
}

func void DIA_DETLOW_HUNTING_SPECIAL_TEETH() {
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_Hunting_Special_Teeth_15_01");
    if ((NPC_HASITEMS(OTHER, 34203)) >= (DETLOW_TEETHTROPHY)) {
        if ((PLAYER_TALENT_TAKEANIMALTROPHY[0]) == (TRUE)) {
            NPC_REMOVEINVITEMS(SELF, 34203, DETLOW_TEETHTROPHY);
            AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Hunting_Special_Teeth_03_02");
            B_GIVEINVITEMS(OTHER, SELF, 34203, DETLOW_TEETHTROPHY);
            PRINTSCREEN(PRINT_LEARNTAKEANIMALTROPHYTEETH, -(1), -(1), FONT_SCREEN, 2);
        };
    };
    if ((NPC_HASITEMS(OTHER, 34203)) < (DETLOW_TEETHTROPHY)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Hunting_Special_Teeth_03_03");
    };
    DIA_DETLOW_HUNTING_SPECIAL_CHOICES();
}

func void DIA_DETLOW_HUNTING_SPECIAL_FIRETONGUE() {
    AI_OUTPUT(OTHER, SELF, "DIA_Detlow_Hunting_Special_FireTongue_15_01");
    if ((NPC_HASITEMS(OTHER, 34203)) >= (DETLOW_FIRETONGUETROPHY)) {
        if ((PLAYER_TALENT_TAKEANIMALTROPHY[5]) == (TRUE)) {
            NPC_REMOVEINVITEMS(SELF, 34203, DETLOW_FIRETONGUETROPHY);
            AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Hunting_Special_FireTongue_03_02");
            B_GIVEINVITEMS(OTHER, SELF, 34203, DETLOW_FIRETONGUETROPHY);
            AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Hunting_Special_FireTongue_03_03");
            PRINTSCREEN(PRINT_LEARNTAKEANIMALTROPHYFIRETONGUE, -(1), -(1), FONT_SCREEN, 2);
        };
    };
    if ((NPC_HASITEMS(OTHER, 34203)) < (DETLOW_FIRETONGUETROPHY)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Detlow_Hunting_Special_FireTongue_03_04");
    };
    DIA_DETLOW_HUNTING_SPECIAL_CHOICES();
}

instance DIA_DETLOW_PICKPOCKET(C_INFO) {
    NPC = 53778;
    NR = 900;
    CONDITION = DIA_DETLOW_PICKPOCKET_CONDITION;
    INFORMATION = DIA_DETLOW_PICKPOCKET_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = PICKPOCKET_120;
}

func int DIA_DETLOW_PICKPOCKET_CONDITION() {
    if (((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_PICKPOCKET)) >= (1)) && ((SELF.AIVAR[6]) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DETLOW_PICKPOCKET_INFO() {
    INFO_CLEARCHOICES(74042);
    INFO_ADDCHOICE(74042, DIALOG_BACK, 74046);
    INFO_ADDCHOICE(74042, DIALOG_PICKPOCKET, 74045);
}

func void DIA_DETLOW_PICKPOCKET_DOIT() {
    if ((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_PICKPOCKET)) >= (3)) {
        CREATEINVITEMS(SELF, 33870, 1);
        B_GIVEINVITEMS(SELF, OTHER, 33870, 1);
        B_PICKPOCKET_AMBIENT_TIER_3();
        SELF.AIVAR[6] = TRUE;
        INFO_CLEARCHOICES(74042);
    };
    AI_PLAYANI(HERO, T_CANNOTTAKE);
    PRINTSCREEN(PRINT_CANTPICKPOCKETTHISPERSON, -(1), -(1), FONT_SCREEN, 4);
    INFO_CLEARCHOICES(74042);
}

func void DIA_DETLOW_PICKPOCKET_BACK() {
    INFO_CLEARCHOICES(74042);
}

