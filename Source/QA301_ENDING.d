instance QA301_ENDING(CUTSCENE) {
    ONSTART = FUNCTION(92776);
}

func void QA301_ENDING_WAIT() {
    AI_WAITTILLEND(BAU_11051_FARMER_QA301_CUTSCENE, SLD_11056_GRIZ);
    AI_WAITTILLEND(BAU_11052_FARMER_QA301_CUTSCENE, SLD_11056_GRIZ);
    AI_WAITTILLEND(BAU_11053_FARMER_QA301_CUTSCENE, SLD_11056_GRIZ);
}

func void QA301_ENDING_START() {
    WLD_SENDTRIGGER("KM_QA301_01");
    HERO.AIVAR[4] = TRUE;
    TELEPORTNPCTOWP(1819, "PART12_QA301_FIREPLACE");
    TELEPORTNPCTOWP(57706, "PART12_QA301_GRIZWAIT");
    NPC_CLEARAIQUEUE(SLD_11056_GRIZ);
    AI_TURNTONPC(SLD_11056_GRIZ, HERO);
    AI_PLAYANI(SLD_11056_GRIZ, "T_COMEOVERHERE");
    AI_FUNCTION(SLD_11056_GRIZ, 92777);
    AI_FUNCTION(SLD_11056_GRIZ, 92780);
}

func void QA301_ENDING_CHANGECAMERA_01() {
    QA301_FINALCUTSCENE = 3;
    WLD_SENDTRIGGER("KM_QA301_02");
    WLD_SENDUNTRIGGER("KM_QA301_01");
}

func void QA301_ENDING_CHANGECAMERA_02() {
    var int QA301_ENDING_CHANGECAMERA_02_COUNT;
    QA301_ENDING_CHANGECAMERA_02_COUNT = (QA301_ENDING_CHANGECAMERA_02_COUNT) + (1);
    if ((QA301_ENDING_CHANGECAMERA_02_COUNT) == (7)) {
        WLD_SENDTRIGGER("KM_QA301_03");
        WLD_SENDUNTRIGGER("KM_QA301_02");
    };
}

func void QA301_ENDING_END() {
    FF_APPLYONCEEXT(92778, 1000, 7);
    FADESCREENTOBLACKF(12, 92781, 1000);
}

func void QA301_ENDING_END_FADESCREEN() {
    WLD_SENDUNTRIGGER("KM_QA301_03");
    QA301_FINALCUTSCENE = 5;
    B_REMOVENPC(57309);
    B_REMOVENPC(57316);
    B_REMOVENPC(57323);
    QA301_LASTMOVER();
}

