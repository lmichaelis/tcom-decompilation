instance SQ503_FINALHAVENFIGHT(CUTSCENE) {
    ONSTART = FUNCTION(93012);
}

func void SQ503_FINALHAVENFIGHT_START() {
    MUSIC_OVERRIDETRACK(21947);
    WLD_SENDTRIGGER("SQ503_FINALFIGHT_01");
    TELEPORTNPCTOWP(58677, PIR_1306_RODRIGO.WP);
    TELEPORTNPCTOWP(58703, PIR_1308_SIMON.WP);
    TELEPORTNPCTOWP(58743, PIR_1311_THIAGO.WP);
    TELEPORTNPCTOWP(58768, PIR_1313_GETTER.WP);
    TELEPORTNPCTOWP(58657, PIR_1304_IVAN.WP);
    TELEPORTNPCTOWP(1819, "P17_HAVEN_ARENA_SQ503_HERO");
    PIR_1306_RODRIGO.FLAGS = 2;
    PIR_1308_SIMON.FLAGS = 2;
    PIR_1311_THIAGO.FLAGS = 2;
    PIR_1313_GETTER.FLAGS = 2;
    PIR_1304_IVAN.FLAGS = 2;
    B_TURNTONPC(PIR_1306_RODRIGO, HERO);
    B_TURNTONPC(PIR_1308_SIMON, HERO);
    B_TURNTONPC(PIR_1311_THIAGO, HERO);
    B_TURNTONPC(PIR_1313_GETTER, HERO);
    B_TURNTONPC(PIR_1304_IVAN, HERO);
    AI_WAIT(PIR_1306_RODRIGO, 1036831949);
    AI_WAIT(PIR_1308_SIMON, 1045220557);
    AI_WAIT(PIR_1311_THIAGO, 1050253722);
    AI_WAIT(PIR_1313_GETTER, 1045220557);
    AI_WAIT(PIR_1304_IVAN, 1050253722);
    FF_APPLYONCEEXT(93013, 1000, 10);
}

func void SQ503_FINALHAVENFIGHT_START_APPLY() {
    var int SQ503_FINALHAVENFIGHT_START_COUNT;
    SQ503_FINALHAVENFIGHT_START_COUNT = (SQ503_FINALHAVENFIGHT_START_COUNT) + (1);
    if ((SQ503_FINALHAVENFIGHT_START_COUNT) == (1)) {
        AI_DRAWWEAPON(PIR_1306_RODRIGO);
        AI_DRAWWEAPON(PIR_1308_SIMON);
        AI_DRAWWEAPON(PIR_1311_THIAGO);
        AI_DRAWWEAPON(PIR_1313_GETTER);
        AI_DRAWWEAPON(PIR_1304_IVAN);
        AI_WAIT(PIR_1306_RODRIGO, 1036831949);
        AI_WAIT(PIR_1308_SIMON, 1045220557);
        AI_WAIT(PIR_1311_THIAGO, 1050253722);
        AI_WAIT(PIR_1313_GETTER, 1045220557);
        AI_WAIT(PIR_1304_IVAN, 1050253722);
        AI_PLAYANI(PIR_1306_RODRIGO, "T_CUTSCENEJUMP_START");
        AI_PLAYANI(PIR_1308_SIMON, "T_CUTSCENEJUMP_START");
        AI_PLAYANI(PIR_1311_THIAGO, "T_CUTSCENEJUMP_START");
        AI_PLAYANI(PIR_1313_GETTER, "T_CUTSCENEJUMP_START");
        AI_PLAYANI(PIR_1304_IVAN, "T_CUTSCENEJUMP_START");
    };
    if ((SQ503_FINALHAVENFIGHT_START_COUNT) == (3)) {
        WLD_SENDTRIGGER("SQ503_FINALFIGHT_02");
        WLD_SENDUNTRIGGER("SQ503_FINALFIGHT_01");
        AI_WAIT(HERO, 1058642330);
        AI_FUNCTION(HERO, 93015);
    };
}

func void SQ503_FINALHAVENFIGHT_END() {
    FF_APPLYONCEEXT(63912, 75, 4);
}

