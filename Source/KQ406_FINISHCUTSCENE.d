instance KQ406_FINISHCUTSCENE(CUTSCENE) {
    ONSTART = FUNCTION(92373);
}

func void KQ406_FINISHCUTSCENE_WAIT() {
    AI_WAITTILLEND(HERO, NONE_11068_GRAYSON);
    AI_WAITTILLEND(HERO, MIL_13680_ANSKAR);
    AI_WAITTILLEND(NONE_11068_GRAYSON, HERO);
    AI_WAITTILLEND(NONE_11068_GRAYSON, MIL_13680_ANSKAR);
    AI_WAITTILLEND(MIL_13680_ANSKAR, HERO);
    AI_WAITTILLEND(MIL_13680_ANSKAR, NONE_11068_GRAYSON);
}

func void KQ406_FINISHCUTSCENE_START() {
    WLD_SENDTRIGGER("KQ406_FINISH_01");
    NPC_CLEARAIQUEUE(NONE_11068_GRAYSON);
    NPC_CLEARAIQUEUE(MIL_13680_ANSKAR);
    NONE_11068_GRAYSON.AIVAR[92] = TRUE;
    MIL_13680_ANSKAR.AIVAR[92] = TRUE;
    TELEPORTNPCTOWP(53744, NONE_11068_GRAYSON.WP);
    TELEPORTNPCTOWP(54595, MIL_13680_ANSKAR.WP);
    TELEPORTNPCTOWP(53719, MIL_13382_HUXLAY.WP);
    TELEPORTNPCTOWP(1819, "PARTM5_CITYHALL_38");
    B_TURNTONPC(NONE_11068_GRAYSON, MIL_13680_ANSKAR);
    B_TURNTONPC(MIL_13680_ANSKAR, NONE_11068_GRAYSON);
    B_TURNTONPC(HERO, NONE_11068_GRAYSON);
    AI_OUTPUT(MIL_13680_ANSKAR, HERO, "DIA_Anskar_KQ406_Cutscene_03_01");
    KQ406_FINISHCUTSCENE_WAIT();
    AI_OUTPUT(NONE_11068_GRAYSON, HERO, "DIA_Grayson_KQ406_Cutscene_03_02");
    AI_OUTPUT(NONE_11068_GRAYSON, HERO, "DIA_Grayson_KQ406_Cutscene_03_03");
    KQ406_FINISHCUTSCENE_WAIT();
    AI_FUNCTION(NONE_11068_GRAYSON, 92375);
    KQ406_FINISHCUTSCENE_WAIT();
    AI_OUTPUT(MIL_13680_ANSKAR, HERO, "DIA_Anskar_KQ406_Cutscene_03_04");
    KQ406_FINISHCUTSCENE_WAIT();
    AI_OUTPUT(NONE_11068_GRAYSON, HERO, "DIA_Grayson_KQ406_Cutscene_03_05");
    AI_FUNCTION(NONE_11068_GRAYSON, 92376);
    AI_OUTPUT(NONE_11068_GRAYSON, HERO, "DIA_Grayson_KQ406_Cutscene_03_06");
    KQ406_FINISHCUTSCENE_WAIT();
    AI_OUTPUT(MIL_13680_ANSKAR, HERO, "DIA_Anskar_KQ406_Cutscene_03_07");
    KQ406_FINISHCUTSCENE_WAIT();
    AI_OUTPUT(NONE_11068_GRAYSON, HERO, "DIA_Grayson_KQ406_Cutscene_03_08");
    KQ406_FINISHCUTSCENE_WAIT();
    AI_FUNCTION(NONE_11068_GRAYSON, 92377);
    AI_OUTPUT(NONE_11068_GRAYSON, HERO, "DIA_Grayson_KQ406_Cutscene_03_09");
    KQ406_FINISHCUTSCENE_WAIT();
    AI_OUTPUT(MIL_13680_ANSKAR, HERO, "DIA_Anskar_KQ406_Cutscene_03_10");
    KQ406_FINISHCUTSCENE_WAIT();
    AI_OUTPUT(NONE_11068_GRAYSON, HERO, "DIA_Grayson_KQ406_Cutscene_03_11");
    AI_FUNCTION(NONE_11068_GRAYSON, 92378);
    AI_OUTPUT(NONE_11068_GRAYSON, HERO, "DIA_Grayson_KQ406_Cutscene_03_12");
    KQ406_FINISHCUTSCENE_WAIT();
    AI_OUTPUT(MIL_13680_ANSKAR, HERO, "DIA_Anskar_KQ406_Cutscene_03_13");
    KQ406_FINISHCUTSCENE_WAIT();
    AI_OUTPUT(NONE_11068_GRAYSON, HERO, "DIA_Grayson_KQ406_Cutscene_03_14");
    AI_FUNCTION(NONE_11068_GRAYSON, 92374);
}

func void KQ406_FINISHCUTSCENE_END() {
    FF_APPLYONCEEXT(34785, 75, 4);
    HERO.AIVAR[4] = FALSE;
    NONE_11068_GRAYSON.AIVAR[92] = FALSE;
    MIL_13680_ANSKAR.AIVAR[92] = FALSE;
}

func void KQ406_FINISHCUTSCENE_CAMERA_01() {
    WLD_SENDTRIGGER("KQ406_FINISH_02");
    WLD_SENDUNTRIGGER("KQ406_FINISH_01");
}

func void KQ406_FINISHCUTSCENE_CAMERA_02() {
    WLD_SENDTRIGGER("KQ406_FINISH_03");
    WLD_SENDUNTRIGGER("KQ406_FINISH_02");
}

func void KQ406_FINISHCUTSCENE_CAMERA_03() {
    WLD_SENDTRIGGER("KQ406_FINISH_04");
    WLD_SENDUNTRIGGER("KQ406_FINISH_03");
}

func void KQ406_FINISHCUTSCENE_CAMERA_04() {
    WLD_SENDTRIGGER("KQ406_FINISH_05");
    WLD_SENDUNTRIGGER("KQ406_FINISH_04");
}

