func void SQ118_COUNTGUARDS() {
    SQ118_GUARDSCOUNT = (SQ118_GUARDSCOUNT) + (1);
    if ((SQ118_GUARDSCOUNT) == (2)) {
        B_LOGENTRY(TOPIC_SQ118, LOG_SQ118_GOTALLGUARDS);
    };
}

func void SQ118_PREPARENPC() {
    B_STARTOTHERROUTINE(MIL_707_HARRY, START);
    NPC_REFRESH(MIL_707_HARRY);
    B_STARTOTHERROUTINE(MIL_708_DICKON, START);
    NPC_REFRESH(MIL_708_DICKON);
    B_STARTOTHERROUTINE(MIL_710_FOLKARD, START);
    NPC_REFRESH(MIL_710_FOLKARD);
    B_STARTOTHERROUTINE(NONE_11037_MARKUS, START);
    NPC_REFRESH(NONE_11037_MARKUS);
    B_STARTOTHERROUTINE(NONE_3_EZEKIEL, "SQ118_CUTSCENE");
    NPC_REFRESH(NONE_3_EZEKIEL);
    B_STARTOTHERROUTINE(BAU_706_LOKVAR, "SQ118_CUTSCENE");
    NPC_REFRESH(BAU_706_LOKVAR);
    FF_APPLYONCEEXTGT(62323, 0, -(1));
}

func void SQ118_FLORAGRAVE_APPLY() {
    var ZCMOVER MOVER2;
    var int MOVPTR2;
    var ZCMOVER MOVER1;
    var int MOVPTR1;
    var int SQ118_FLORAGRAVE_COUNT;
    if ((SQ118_FLORAGRAVE_COUNT) == (0)) {
        PRINTD("Rozpoczynam - SQ118_FloraGrave_Apply");
        MOVPTR1 = MEM_SEARCHVOBBYNAME("SQ118_FLORAGRAVE");
        MOVER1 = MEM_PTRTOINST(MOVPTR1);
        MOVPTR2 = MEM_SEARCHVOBBYNAME("Q101_MOVER_FLORA_BODY");
        MOVER2 = MEM_PTRTOINST(MOVPTR2);
        CHANGEVOBCOLLISION("SQ118_FLORAGRAVE_MESH", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("Q101_FLORA_BODY", FALSE, FALSE, FALSE, TRUE);
        WLD_SENDTRIGGER("SQ118_FLORAGRAVE");
        WLD_SENDTRIGGER("Q101_MOVER_FLORA_BODY");
        SQ118_FLORAGRAVE_COUNT = 1;
    };
    if (((MOVER1.MOVERSTATE) != (MOVER_STATE_OPENING)) && ((MOVER1.MOVERSTATE) != (MOVER_STATE_CLOSING))) {
        PRINTD("Skoñczy³em - SQ118_FloraGrave_Apply");
        CHANGEVOBCOLLISION("SQ118_FLORAGRAVE_MESH", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("Q101_FLORA_BODY", TRUE, TRUE, TRUE, TRUE);
        FF_REMOVE(62323);
        SQ118_FLORAGRAVE_COUNT = 0;
    };
}

func void SQ118_SPAWNWEED() {
    WLD_INSERTITEM(34269, "FP_PART12_WEED_01");
    WLD_INSERTITEM(34269, "FP_PART12_WEED_02");
    WLD_INSERTITEM(34269, "FP_PART12_WEED_03");
    WLD_INSERTITEM(34269, "FP_PART12_WEED_04");
    WLD_INSERTITEM(34269, "FP_PART12_WEED_05");
    WLD_INSERTITEM(34269, "FP_PART12_WEED_06");
    WLD_INSERTITEM(34269, "FP_PART12_WEED_07");
    WLD_INSERTITEM(34269, "FP_PART12_WEED_08");
    WLD_INSERTITEM(34269, "FP_PART12_WEED_09");
    WLD_INSERTITEM(34269, "FP_PART12_WEED_10");
    WLD_INSERTITEM(34269, "FP_PART12_WEED_11");
    WLD_INSERTITEM(34269, "FP_PART12_WEED_12");
    WLD_INSERTITEM(34269, "FP_PART12_WEED_13");
    WLD_INSERTITEM(34269, "FP_PART12_WEED_14");
    WLD_INSERTITEM(34269, "FP_PART12_WEED_15");
}

func void SQ118_ONITEMTAKEN_HOOK(var C_ITEM ITEM) {
    if ((HLP_GETINSTANCEID(ITEM)) == (34269)) {
        NPC_REMOVEINVITEMS(HERO, 34269, 1);
        CREATEINVITEMS(HERO, 34268, 1);
        B_GIVEPLAYERXP(XP_SQ118_WEED);
        SQ118_COUNTWEED = (SQ118_COUNTWEED) + (1);
        if ((SQ118_COUNTWEED) == (12)) {
            if ((LOG_GETSTATUS(MIS_SQ118)) == (LOG_RUNNING)) {
                B_LOGENTRY(TOPIC_SQ118, LOG_SQ118_FINISHWEED);
            };
        };
    };
}

