const int CRAFTINGVIEW_DLG = 0;
const int CRAFTINGVIEW_RENDERDLG = 0;
const int CRAFTINGVIEW_RENDERITEM = 0;
const int CRAFTINGVIEW_ISOPEN = 0;
const int CRAFTINGVIEW_SELECTEDTAB = 0;
const int CV_INGREDIENTSTAB = 0;
const int CV_PROPERTIESTAB = 1;
const int CV_CURRENTITEM = 0;
const int CV_CURRENTMODE = 0;
const int CV_CURRENTAMOUNT = 0;
const int CRAFTINGVIEWREFX = 800;
const int CRAFTINGVIEWREFY = 600;
var int CRAFTINGVIEWTEXT[8];
const int MAX_WEAPONRECIPEINSTANCES = 100;
var int WEAPONRECIPEINSTANCE[100];
const int MAX_POTIONRECIPEINSTANCES = 62;
var int POTIONRECIPEINSTANCE[62];
const int MAX_MEALRECIPEINSTANCES = 63;
var int MEALRECIPEINSTANCE[63];
const int MAX_SCROLLRECIPEINSTANCES = 24;
var int SCROLLRECIPEINSTANCE[24];
func void CRAFTINGVIEW_SETUPRECIPESARRAY() {
    WEAPONRECIPEINSTANCE[0] = 37754;
    WEAPONRECIPEINSTANCE[1] = 37756;
    WEAPONRECIPEINSTANCE[2] = 37758;
    WEAPONRECIPEINSTANCE[3] = 37760;
    WEAPONRECIPEINSTANCE[4] = 37762;
    WEAPONRECIPEINSTANCE[5] = 37764;
    WEAPONRECIPEINSTANCE[6] = 37766;
    WEAPONRECIPEINSTANCE[7] = 37768;
    WEAPONRECIPEINSTANCE[8] = 37770;
    WEAPONRECIPEINSTANCE[9] = 37772;
    WEAPONRECIPEINSTANCE[10] = 37774;
    WEAPONRECIPEINSTANCE[11] = 37776;
    WEAPONRECIPEINSTANCE[12] = 37778;
    WEAPONRECIPEINSTANCE[13] = 37780;
    WEAPONRECIPEINSTANCE[14] = 37782;
    WEAPONRECIPEINSTANCE[15] = 37784;
    WEAPONRECIPEINSTANCE[16] = 37786;
    WEAPONRECIPEINSTANCE[17] = 37788;
    WEAPONRECIPEINSTANCE[18] = 37790;
    WEAPONRECIPEINSTANCE[19] = 37792;
    WEAPONRECIPEINSTANCE[20] = 37794;
    WEAPONRECIPEINSTANCE[21] = 37796;
    WEAPONRECIPEINSTANCE[22] = 37798;
    WEAPONRECIPEINSTANCE[23] = 37800;
    WEAPONRECIPEINSTANCE[24] = 37802;
    WEAPONRECIPEINSTANCE[25] = 37804;
    WEAPONRECIPEINSTANCE[26] = 37806;
    WEAPONRECIPEINSTANCE[27] = 37808;
    WEAPONRECIPEINSTANCE[28] = 37810;
    WEAPONRECIPEINSTANCE[29] = 37812;
    WEAPONRECIPEINSTANCE[30] = 37814;
    WEAPONRECIPEINSTANCE[31] = 37816;
    WEAPONRECIPEINSTANCE[32] = 37818;
    WEAPONRECIPEINSTANCE[33] = 37820;
    WEAPONRECIPEINSTANCE[34] = 37822;
    WEAPONRECIPEINSTANCE[35] = 37824;
    WEAPONRECIPEINSTANCE[36] = 37826;
    WEAPONRECIPEINSTANCE[37] = 37828;
    WEAPONRECIPEINSTANCE[38] = 37830;
    WEAPONRECIPEINSTANCE[39] = 37832;
    WEAPONRECIPEINSTANCE[40] = 37834;
    WEAPONRECIPEINSTANCE[41] = 37836;
    WEAPONRECIPEINSTANCE[42] = 37838;
    WEAPONRECIPEINSTANCE[43] = 37840;
    WEAPONRECIPEINSTANCE[44] = 37842;
    WEAPONRECIPEINSTANCE[45] = 37844;
    WEAPONRECIPEINSTANCE[46] = 37846;
    WEAPONRECIPEINSTANCE[47] = 37848;
    WEAPONRECIPEINSTANCE[48] = 37850;
    WEAPONRECIPEINSTANCE[49] = 37852;
    WEAPONRECIPEINSTANCE[50] = 37854;
    WEAPONRECIPEINSTANCE[51] = 37856;
    WEAPONRECIPEINSTANCE[52] = 37858;
    WEAPONRECIPEINSTANCE[53] = 37860;
    WEAPONRECIPEINSTANCE[54] = 37862;
    WEAPONRECIPEINSTANCE[55] = 37864;
    WEAPONRECIPEINSTANCE[56] = 37866;
    WEAPONRECIPEINSTANCE[57] = 37868;
    WEAPONRECIPEINSTANCE[58] = 37870;
    WEAPONRECIPEINSTANCE[59] = 37872;
    WEAPONRECIPEINSTANCE[60] = 37874;
    WEAPONRECIPEINSTANCE[61] = 37876;
    WEAPONRECIPEINSTANCE[62] = 37878;
    WEAPONRECIPEINSTANCE[63] = 37880;
    WEAPONRECIPEINSTANCE[64] = 37882;
    WEAPONRECIPEINSTANCE[65] = 37884;
    WEAPONRECIPEINSTANCE[66] = 37886;
    WEAPONRECIPEINSTANCE[67] = 37888;
    WEAPONRECIPEINSTANCE[68] = 37890;
    WEAPONRECIPEINSTANCE[69] = 37892;
    WEAPONRECIPEINSTANCE[70] = 37894;
    WEAPONRECIPEINSTANCE[71] = 37898;
    WEAPONRECIPEINSTANCE[72] = 37900;
    WEAPONRECIPEINSTANCE[73] = 37902;
    WEAPONRECIPEINSTANCE[74] = 37904;
    WEAPONRECIPEINSTANCE[75] = 37906;
    WEAPONRECIPEINSTANCE[76] = 37908;
    WEAPONRECIPEINSTANCE[77] = 37910;
    WEAPONRECIPEINSTANCE[78] = 37912;
    WEAPONRECIPEINSTANCE[79] = 37914;
    WEAPONRECIPEINSTANCE[80] = 37916;
    WEAPONRECIPEINSTANCE[81] = 37918;
    WEAPONRECIPEINSTANCE[82] = 37920;
    WEAPONRECIPEINSTANCE[83] = 37922;
    WEAPONRECIPEINSTANCE[84] = 37924;
    WEAPONRECIPEINSTANCE[85] = 37926;
    WEAPONRECIPEINSTANCE[86] = 37928;
    WEAPONRECIPEINSTANCE[87] = 37930;
    WEAPONRECIPEINSTANCE[88] = 37932;
    WEAPONRECIPEINSTANCE[89] = 37934;
    WEAPONRECIPEINSTANCE[90] = 37936;
    WEAPONRECIPEINSTANCE[91] = 37938;
    WEAPONRECIPEINSTANCE[92] = 37940;
    WEAPONRECIPEINSTANCE[93] = 37942;
    WEAPONRECIPEINSTANCE[94] = 37944;
    WEAPONRECIPEINSTANCE[95] = 37946;
    WEAPONRECIPEINSTANCE[96] = 37948;
    WEAPONRECIPEINSTANCE[97] = 37950;
    POTIONRECIPEINSTANCE[0] = 34971;
    POTIONRECIPEINSTANCE[1] = 34970;
    POTIONRECIPEINSTANCE[2] = 34972;
    POTIONRECIPEINSTANCE[3] = 34973;
    POTIONRECIPEINSTANCE[4] = 34975;
    POTIONRECIPEINSTANCE[5] = 34977;
    POTIONRECIPEINSTANCE[6] = 34979;
    POTIONRECIPEINSTANCE[7] = 34981;
    POTIONRECIPEINSTANCE[8] = 34983;
    POTIONRECIPEINSTANCE[9] = 34985;
    POTIONRECIPEINSTANCE[10] = 35015;
    POTIONRECIPEINSTANCE[11] = 34987;
    POTIONRECIPEINSTANCE[12] = 34988;
    POTIONRECIPEINSTANCE[13] = 35017;
    POTIONRECIPEINSTANCE[14] = 34991;
    POTIONRECIPEINSTANCE[15] = 34993;
    POTIONRECIPEINSTANCE[16] = 34995;
    POTIONRECIPEINSTANCE[17] = 34997;
    POTIONRECIPEINSTANCE[18] = 34999;
    POTIONRECIPEINSTANCE[19] = 35001;
    POTIONRECIPEINSTANCE[20] = 35003;
    POTIONRECIPEINSTANCE[21] = 35005;
    POTIONRECIPEINSTANCE[22] = 35007;
    POTIONRECIPEINSTANCE[23] = 35009;
    POTIONRECIPEINSTANCE[24] = 35011;
    POTIONRECIPEINSTANCE[25] = 35013;
    POTIONRECIPEINSTANCE[26] = 35019;
    POTIONRECIPEINSTANCE[27] = 35021;
    POTIONRECIPEINSTANCE[28] = 35023;
    POTIONRECIPEINSTANCE[29] = 35025;
    POTIONRECIPEINSTANCE[30] = 35027;
    POTIONRECIPEINSTANCE[31] = 35039;
    POTIONRECIPEINSTANCE[32] = 35041;
    POTIONRECIPEINSTANCE[33] = 35043;
    POTIONRECIPEINSTANCE[34] = 35045;
    POTIONRECIPEINSTANCE[35] = 35047;
    POTIONRECIPEINSTANCE[36] = 34968;
    POTIONRECIPEINSTANCE[37] = 34976;
    POTIONRECIPEINSTANCE[38] = 34980;
    POTIONRECIPEINSTANCE[39] = 34984;
    POTIONRECIPEINSTANCE[40] = 34990;
    POTIONRECIPEINSTANCE[41] = 34992;
    POTIONRECIPEINSTANCE[42] = 34996;
    POTIONRECIPEINSTANCE[43] = 35000;
    POTIONRECIPEINSTANCE[44] = 35004;
    POTIONRECIPEINSTANCE[45] = 34969;
    POTIONRECIPEINSTANCE[46] = 34978;
    POTIONRECIPEINSTANCE[47] = 34982;
    POTIONRECIPEINSTANCE[48] = 34986;
    POTIONRECIPEINSTANCE[49] = 34989;
    POTIONRECIPEINSTANCE[50] = 34994;
    POTIONRECIPEINSTANCE[51] = 34998;
    POTIONRECIPEINSTANCE[52] = 35002;
    POTIONRECIPEINSTANCE[53] = 35006;
    POTIONRECIPEINSTANCE[54] = 35053;
    POTIONRECIPEINSTANCE[55] = 35029;
    POTIONRECIPEINSTANCE[56] = 35031;
    POTIONRECIPEINSTANCE[57] = 35033;
    POTIONRECIPEINSTANCE[58] = 35035;
    POTIONRECIPEINSTANCE[59] = 35037;
    POTIONRECIPEINSTANCE[60] = 35049;
    POTIONRECIPEINSTANCE[61] = 35051;
    MEALRECIPEINSTANCE[0] = 35846;
    MEALRECIPEINSTANCE[1] = 35848;
    MEALRECIPEINSTANCE[2] = 35850;
    MEALRECIPEINSTANCE[3] = 35852;
    MEALRECIPEINSTANCE[4] = 35854;
    MEALRECIPEINSTANCE[5] = 35856;
    MEALRECIPEINSTANCE[6] = 35858;
    MEALRECIPEINSTANCE[7] = 35860;
    MEALRECIPEINSTANCE[8] = 35862;
    MEALRECIPEINSTANCE[9] = 35864;
    MEALRECIPEINSTANCE[10] = 35866;
    MEALRECIPEINSTANCE[11] = 35868;
    MEALRECIPEINSTANCE[12] = 35870;
    MEALRECIPEINSTANCE[13] = 35872;
    MEALRECIPEINSTANCE[14] = 35874;
    MEALRECIPEINSTANCE[15] = 35876;
    MEALRECIPEINSTANCE[16] = 35878;
    MEALRECIPEINSTANCE[17] = 35880;
    MEALRECIPEINSTANCE[18] = 35882;
    MEALRECIPEINSTANCE[19] = 35884;
    MEALRECIPEINSTANCE[20] = 35886;
    MEALRECIPEINSTANCE[21] = 35888;
    MEALRECIPEINSTANCE[22] = 35890;
    MEALRECIPEINSTANCE[23] = 35892;
    MEALRECIPEINSTANCE[25] = 35894;
    MEALRECIPEINSTANCE[26] = 35896;
    MEALRECIPEINSTANCE[27] = 35898;
    MEALRECIPEINSTANCE[28] = 35900;
    MEALRECIPEINSTANCE[29] = 35902;
    MEALRECIPEINSTANCE[30] = 35904;
    MEALRECIPEINSTANCE[31] = 35906;
    MEALRECIPEINSTANCE[32] = 35908;
    MEALRECIPEINSTANCE[33] = 35910;
    MEALRECIPEINSTANCE[34] = 35912;
    MEALRECIPEINSTANCE[35] = 35914;
    MEALRECIPEINSTANCE[36] = 35916;
    MEALRECIPEINSTANCE[37] = 35918;
    MEALRECIPEINSTANCE[39] = 35920;
    MEALRECIPEINSTANCE[40] = 35923;
    MEALRECIPEINSTANCE[41] = 35926;
    MEALRECIPEINSTANCE[42] = 35928;
    MEALRECIPEINSTANCE[43] = 35930;
    MEALRECIPEINSTANCE[45] = 35932;
    MEALRECIPEINSTANCE[46] = 35934;
    MEALRECIPEINSTANCE[47] = 35936;
    MEALRECIPEINSTANCE[48] = 35938;
    MEALRECIPEINSTANCE[49] = 35940;
    MEALRECIPEINSTANCE[50] = 35942;
    MEALRECIPEINSTANCE[51] = 35944;
    MEALRECIPEINSTANCE[52] = 35946;
    MEALRECIPEINSTANCE[53] = 35948;
    MEALRECIPEINSTANCE[54] = 35950;
    MEALRECIPEINSTANCE[55] = 35952;
    MEALRECIPEINSTANCE[56] = 35954;
    MEALRECIPEINSTANCE[57] = 35956;
    MEALRECIPEINSTANCE[58] = 35958;
    MEALRECIPEINSTANCE[59] = 35960;
    MEALRECIPEINSTANCE[60] = 35962;
    MEALRECIPEINSTANCE[61] = 35966;
    MEALRECIPEINSTANCE[62] = 35964;
    SCROLLRECIPEINSTANCE[0] = 38149;
    SCROLLRECIPEINSTANCE[1] = 38150;
    SCROLLRECIPEINSTANCE[2] = 38152;
    SCROLLRECIPEINSTANCE[3] = 38153;
    SCROLLRECIPEINSTANCE[4] = 38154;
    SCROLLRECIPEINSTANCE[5] = 38155;
    SCROLLRECIPEINSTANCE[6] = 38156;
    SCROLLRECIPEINSTANCE[7] = 38157;
    SCROLLRECIPEINSTANCE[8] = 38158;
    SCROLLRECIPEINSTANCE[9] = 38159;
    SCROLLRECIPEINSTANCE[10] = 38160;
    SCROLLRECIPEINSTANCE[11] = 38161;
    SCROLLRECIPEINSTANCE[12] = 38162;
    SCROLLRECIPEINSTANCE[13] = 38163;
    SCROLLRECIPEINSTANCE[14] = 38164;
    SCROLLRECIPEINSTANCE[15] = 38165;
    SCROLLRECIPEINSTANCE[16] = 38166;
    SCROLLRECIPEINSTANCE[17] = 38167;
    SCROLLRECIPEINSTANCE[18] = 38168;
    SCROLLRECIPEINSTANCE[19] = 38169;
    SCROLLRECIPEINSTANCE[20] = 38170;
    SCROLLRECIPEINSTANCE[21] = 38171;
    SCROLLRECIPEINSTANCE[22] = 38172;
    SCROLLRECIPEINSTANCE[23] = 38151;
}

func int RENDER_ADDITEMCENTER(var int ITEMINST, var int X, var int Y, var int W, var int H) {
    return RENDER_ADDITEM(ITEMINST, (X) - ((W) >> (1)), (Y) - ((H) >> (1)), (X) + (((W) + (1)) >> (1)), (Y) + (((H) + (1)) >> (1)));
}

func void CRAFTINGVIEW_TABSWITCHER(var int KEY) {
    if ((CRAFTINGVIEW_ISOPEN) == (TRUE)) {
        if ((CV_CURRENTMODE) != (2)) {
            if (((((((((KEY) == (MEM_GETKEY("keyLeft"))) || ((KEY) == (MEM_GETKEY("keyRight")))) || ((KEY) == (MEM_GETSECONDARYKEY("keyLeft")))) || ((KEY) == (MEM_GETSECONDARYKEY("keyRight")))) || ((KEY) == (MEM_GETKEY("keyStrafeLeft")))) || ((KEY) == (MEM_GETKEY("keyStrafeRight")))) || ((KEY) == (MEM_GETSECONDARYKEY("keyStrafeLeft")))) || ((KEY) == (MEM_GETSECONDARYKEY("keyStrafeRight")))) {
                if ((CRAFTINGVIEW_SELECTEDTAB) == (0)) {
                    CRAFTINGVIEW_SELECTEDTAB = 1;
                } else {
                    CRAFTINGVIEW_SELECTEDTAB = 0;
                };
                CRAFTINGVIEW_SHOW(CV_CURRENTITEM, CV_CURRENTMODE, CV_CURRENTAMOUNT);
            };
        };
    };
}

func void INIT_CRAFTINGVIEW_ALWAYS() {
    CRAFTINGVIEW_SETUPRECIPESARRAY();
}

const int CRAFTINGVIEWLASTCHOICE = -1;
func void CRAFTINGVIEW_UPDATE() {
    var int MAX;
    var int ARMOR_CHECK;
    var int CHOICEITEMINSTANCE;
    var int DLGNR;
    var int LIST;
    var int J;
    var ZCVIEWDIALOGCHOICE DLG;
    var int CINFO_MGR_MODE_INFO;
    var OCINFO DLGINSTANCE;
    var int CHOICEVIEW;
    var int NEXTPOSY;
    var int I;
    var ZCLIST L;
    var ZCARRAY ARR;
    var string DLGDESCRIPTION;
    var int P;
    var string DLG_ALL;
    var C_NPC HER;
    var OCINFOCHOICE DLGCHOICE;
    var C_NPC SLF;
    var int INFOPTR;
    var int CINFO_MGR_MODE_CHOICE;
    DLG = _^(MEM_INFORMATIONMAN.DLGCHOICE);
    CHOICEVIEW = MEM_INFORMATIONMAN.DLGCHOICE;
    if ((DLG.ISACTIVATED) == (1)) {
        if ((CRAFTINGVIEWLASTCHOICE) != (DLG.CHOICESELECTED)) {
            ARR = _^((CHOICEVIEW) + (172));
            if (ARR.ARRAY) {
                NEXTPOSY = 0;
                I = 0;
                P = MEM_STACKPOS.POSITION;
                if ((I) < (DLG.CHOICES)) {
                    SLF = _^(MEM_INFORMATIONMAN.NPC);
                    HER = _^(MEM_INFORMATIONMAN.PLAYER);
                    INFOPTR = 0;
                    if ((MEM_INFORMATIONMAN.MODE) == (CINFO_MGR_MODE_INFO)) {
                        INFOPTR = OCINFOMANAGER_GETINFOUNIMPORTANT(94794, 94795, I);
                    } else if ((MEM_INFORMATIONMAN.MODE) == (CINFO_MGR_MODE_CHOICE)) {
                        INFOPTR = MEM_INFORMATIONMAN.INFO;
                    };
                    if (INFOPTR) {
                        DLGINSTANCE = _^(INFOPTR);
                        DLGDESCRIPTION = DLGINSTANCE.DESCRIPTION;
                        if ((MEM_INFORMATIONMAN.MODE) == (CINFO_MGR_MODE_CHOICE)) {
                            if (DLGINSTANCE.LISTCHOICES_NEXT) {
                                J = 0;
                                LIST = DLGINSTANCE.LISTCHOICES_NEXT;
                                WHILE(LIST);
                                L = _^(LIST);
                                DLGCHOICE = MEM_PTRTOINST(L.DATA);
                                if ((I) == (J)) {
                                    DLGDESCRIPTION = DLGCHOICE.TEXT;
                                };
                                LIST = L.NEXT;
                                J += 1;
                                END;
                            };
                        };
                        DLGNR = DLGINSTANCE.NR;
                        if ((I) == (DLG.CHOICESELECTED)) {
                            ARMOR_CHECK = CRAFTINGVIEW_CHECKARMORS(DLGDESCRIPTION);
                            if ((MEM_INFORMATIONMAN.MODE) == (CINFO_MGR_MODE_CHOICE)) {
                                CHOICEITEMINSTANCE = -(1);
                                if ((POTIONALCHEMY_INSTANCE) != (-(1))) {
                                    CHOICEITEMINSTANCE = POTIONALCHEMY_INSTANCE;
                                } else if ((SCROLL_WRITING_INSTANCE) != (-(1))) {
                                    CHOICEITEMINSTANCE = SCROLL_WRITING_INSTANCE;
                                } else if ((COOKINGMEALS_INSTANCE) != (-(1))) {
                                    CHOICEITEMINSTANCE = COOKINGMEALS_INSTANCE;
                                };
                                if ((CHOICEITEMINSTANCE) != (-(1))) {
                                    MAX = PC_CRAFTRECIPEITEM_MAX(CHOICEITEMINSTANCE);
                                    DLG_ALL = CS4(DIALOG_ALL, " (", I2S(MAX), ")");
                                    if ((STR_TOINT(DLGDESCRIPTION)) > (0)) {
                                        CRAFTINGVIEW_SHOW(CHOICEITEMINSTANCE, 1, STR_TOINT(DLGDESCRIPTION));
                                    } else if ((STR_TOINT(STR_SPLIT(DLGDESCRIPTION, ".", 0))) > (0)) {
                                        CRAFTINGVIEW_SHOW(CHOICEITEMINSTANCE, 1, STR_TOINT(STR_SPLIT(DLGDESCRIPTION, ".", 0)));
                                    } else if (HLP_STRCMP(DLGDESCRIPTION, DLG_ALL)) {
                                        CRAFTINGVIEW_SHOW(CHOICEITEMINSTANCE, 1, MAX);
                                    } else {
                                        CRAFTINGVIEW_HIDE();
                                    };
                                } else if ((ARMOR_CHECK) != (-(1))) {
                                    CRAFTINGVIEW_SHOW(ARMOR_CHECK, 2, 1);
                                } else {
                                    CRAFTINGVIEW_HIDE();
                                };
                            } else if (((DLGNR) >= (10000)) && ((DLGNR) < (10100))) {
                                CRAFTINGVIEW_SHOW(MEM_READINTARRAY(_@(WEAPONRECIPEINSTANCE[0]), (DLGNR) - (10000)), 0, 1);
                            } else if (((DLGNR) >= (10100)) && ((DLGNR) < (10200))) {
                                CRAFTINGVIEW_SHOW(MEM_READINTARRAY(_@(POTIONRECIPEINSTANCE[0]), (DLGNR) - (10100)), 1, 1);
                            } else if (((DLGNR) >= (10200)) && ((DLGNR) < (10300))) {
                                CRAFTINGVIEW_SHOW(MEM_READINTARRAY(_@(MEALRECIPEINSTANCE[0]), (DLGNR) - (10200)), 1, 1);
                            } else if (((DLGNR) >= (10300)) && ((DLGNR) < (10400))) {
                                CRAFTINGVIEW_SHOW(MEM_READINTARRAY(_@(SCROLLRECIPEINSTANCE[0]), (DLGNR) - (10300)), 1, 1);
                            } else if ((ARMOR_CHECK) != (-(1))) {
                                CRAFTINGVIEW_SHOW(ARMOR_CHECK, 2, 1);
                            } else if ((CRAFTINGVIEW_ISOPEN) == (TRUE)) {
                                CRAFTINGVIEW_HIDE();
                            };
                        };
                    };
                    I += 1;
                    MEM_STACKPOS.POSITION = P;
                };
            };
        };
        CRAFTINGVIEWLASTCHOICE = DLG.CHOICESELECTED;
    };
    if ((CRAFTINGVIEW_ISOPEN) == (TRUE)) {
        CRAFTINGVIEW_HIDE();
    };
}

