var int EINAR_TEACHHEROSMITH;
instance DIA_EINAR_EXIT(C_INFO) {
    NPC = 58256;
    NR = 999;
    CONDITION = DIA_EINAR_EXIT_CONDITION;
    INFORMATION = DIA_EINAR_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_EINAR_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_EINAR_EXIT_INFO() {
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_EINAR_HELLO(C_INFO) {
    NPC = 58256;
    NR = 1;
    CONDITION = DIA_EINAR_HELLO_CONDITION;
    INFORMATION = DIA_EINAR_HELLO_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Hi! Are you a blacksmith?";
}

func int DIA_EINAR_HELLO_CONDITION() {
    return TRUE;
}

func void DIA_EINAR_HELLO_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_HELLO_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_HELLO_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_HELLO_03_03");
}

instance DIA_EINAR_JOB(C_INFO) {
    NPC = 58256;
    NR = 1;
    CONDITION = DIA_EINAR_JOB_CONDITION;
    INFORMATION = DIA_EINAR_JOB_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "How did you get a job like that?";
}

func int DIA_EINAR_JOB_CONDITION() {
    if (NPC_KNOWSINFO(OTHER, 81485)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_JOB_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_JOB_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_JOB_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_JOB_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_JOB_03_04");
}

instance DIA_EINAR_TRADEOPTION(C_INFO) {
    NPC = 58256;
    NR = 50;
    CONDITION = DIA_EINAR_TRADEOPTION_CONDITION;
    INFORMATION = DIA_EINAR_TRADEOPTION_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Do you have anything for sale?";
}

func int DIA_EINAR_TRADEOPTION_CONDITION() {
    if (NPC_KNOWSINFO(OTHER, 81485)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_TRADEOPTION_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_TRADEOPTION_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_TRADEOPTION_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_TRADEOPTION_03_03");
    LOG_CREATETOPIC(TOPIC_WOLFSDENTRADER, LOG_NOTE);
    AI_LOGENTRY(TOPIC_WOLFSDENTRADER, LOG_TRADER_EINAR);
}

var int EINAR_TEACHHEROSTR;
instance DIA_EINAR_TEACHSMITH(C_INFO) {
    NPC = 58256;
    NR = 49;
    CONDITION = DIA_EINAR_TEACHSMITH_CONDITION;
    INFORMATION = DIA_EINAR_TEACHSMITH_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "Can you teach me how to forge weapons?";
}

func int DIA_EINAR_TEACHSMITH_CONDITION() {
    if ((NPC_KNOWSINFO(OTHER, 81485)) && ((EINAR_TEACHHEROSMITH) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_TEACHSMITH_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_TEACHSMITH_15_01");
    if ((LOG_GETSTATUS(MIS_SQ419)) != (LOG_SUCCESS)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Einar_TEACHSMITH_03_02");
    };
    if ((LOG_GETSTATUS(MIS_SQ419)) == (LOG_SUCCESS)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Einar_TEACHSMITH_03_03");
        AI_OUTPUT(OTHER, SELF, "DIA_Einar_TEACHSMITH_15_04");
        AI_OUTPUT(SELF, OTHER, "DIA_Einar_TEACHSMITH_03_05");
        AI_OUTPUT(SELF, OTHER, "DIA_Einar_TEACHSMITH_03_06");
        EINAR_TEACHHEROSMITH = TRUE;
        EINAR_TEACHHEROSTR = TRUE;
        LOG_CREATETOPIC(TOPIC_WOLFSDENTEACHER, LOG_NOTE);
        AI_LOGENTRY(TOPIC_WOLFSDENTEACHER, LOG_WOLFSDENTEACHER_EINAR);
    };
}

var int EINAR_CURRENTSTRLEVEL;
var int EINAR_NOMORE;
var string EINAR_PRINTS;
instance DIA_EINAR_TRAIN(C_INFO) {
    NPC = 58256;
    NR = 7;
    CONDITION = DIA_EINAR_TRAIN_CONDITION;
    INFORMATION = DIA_EINAR_TRAIN_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "Show me how to become stronger.";
}

func int DIA_EINAR_TRAIN_CONDITION() {
    if (((EINAR_TEACHHEROSTR) == (TRUE)) && ((EINAR_NOMORE) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_TRAIN_CHOICES() {
    var int EINAR_GOLDCOST;
    EINAR_GOLDCOST = 25;
    EINAR_CURRENTSTRLEVEL = OTHER.AIVAR[81];
    INFO_CLEARCHOICES(81501);
    INFO_ADDCHOICE(81501, DIALOG_BACK, 81506);
    INFO_ADDCHOICE(81501, B_BUILDLEARNSTRING2(PRINT_LEARNSTR1, B_GETLEARNCOSTATTRIBUTE(OTHER, ATR_STRENGTH, 1), EINAR_GOLDCOST), 81507);
    INFO_ADDCHOICE(81501, B_BUILDLEARNSTRING2(PRINT_LEARNSTR5, B_GETLEARNCOSTATTRIBUTE(OTHER, ATR_STRENGTH, 5), (EINAR_GOLDCOST) * (5)), 81508);
}

func void DIA_EINAR_TRAIN_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_Train_15_00");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Train_03_01");
    DIA_EINAR_TRAIN_CHOICES();
}

func void DIA_EINAR_TRAIN_BACK() {
    if (((OTHER.AIVAR[81]) < (120)) && ((OTHER.AIVAR[81]) >= (60))) {
        AI_OUTPUT(SELF, OTHER, "DIA_Einar_Train_Back_03_00");
    };
    if ((OTHER.AIVAR[81]) >= (120)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Einar_Train_Back_03_01");
        AI_OUTPUT(SELF, OTHER, "DIA_Einar_Train_Back_03_02");
        EINAR_NOMORE = TRUE;
    };
    INFO_CLEARCHOICES(81501);
}

func void DIA_EINAR_TRAINSTR_1() {
    if ((NPC_HASITEMS(OTHER, 34203)) >= (EINAR_PAYMENT1)) {
        if ((EINAR_CURRENTSTRLEVEL) < (OTHER.AIVAR[81])) {
            SND_PLAY(GELDBEUTEL);
            B_GIVEINVITEMS(OTHER, SELF, 34203, EINAR_PAYMENT1);
            NPC_REMOVEINVITEMS(SELF, 34203, EINAR_PAYMENT1);
        };
        B_TEACHATTRIBUTEPOINTS(SELF, OTHER, ATR_STRENGTH, 1, 120);
        DIA_EINAR_TRAIN_CHOICES();
    };
    if ((NPC_HASITEMS(OTHER, 34203)) < (EINAR_PAYMENT1)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Einar_Train_STR1_13_00");
        EINAR_PRINTS = CONCATSTRINGS(PRINT_RGOLD, INTTOSTRING(EINAR_PAYMENT1));
        PRINTSCREEN(EINAR_PRINTS, -(1), -(1), FONT_SCREEN, 2);
        DIA_EINAR_TRAIN_CHOICES();
    };
}

func void DIA_EINAR_TRAINSTR_5() {
    if ((NPC_HASITEMS(OTHER, 34203)) >= (EINAR_PAYMENT5)) {
        if ((EINAR_CURRENTSTRLEVEL) < (OTHER.AIVAR[81])) {
            SND_PLAY(GELDBEUTEL);
            B_GIVEINVITEMS(OTHER, SELF, 34203, EINAR_PAYMENT5);
            NPC_REMOVEINVITEMS(SELF, 34203, EINAR_PAYMENT5);
        };
        B_TEACHATTRIBUTEPOINTS(SELF, OTHER, ATR_STRENGTH, 5, 120);
        DIA_EINAR_TRAIN_CHOICES();
    };
    if ((NPC_HASITEMS(OTHER, 34203)) < (EINAR_PAYMENT5)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Einar_Train_STR5_13_00");
        EINAR_PRINTS = CONCATSTRINGS(PRINT_RGOLD, INTTOSTRING(EINAR_PAYMENT5));
        PRINTSCREEN(EINAR_PRINTS, -(1), -(1), FONT_SCREEN, 2);
        DIA_EINAR_TRAIN_CHOICES();
    };
}

instance DIA_EINAR_PARTNERS(C_INFO) {
    NPC = 58256;
    NR = 25;
    CONDITION = DIA_EINAR_PARTNERS_CONDITION;
    INFORMATION = DIA_EINAR_PARTNERS_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Why don't we work together?";
}

func int DIA_EINAR_PARTNERS_CONDITION() {
    if ((NPC_KNOWSINFO(OTHER, 81495)) && ((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_SMITH)) > (0))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_PARTNERS_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_Partners_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Partners_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Partners_03_03");
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_Partners_15_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Partners_03_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Partners_03_06");
}

instance DIA_EINAR_TRADE(C_INFO) {
    NPC = 58256;
    NR = 950;
    CONDITION = DIA_EINAR_TRADE_CONDITION;
    INFORMATION = DIA_EINAR_TRADE_INFO;
    PERMANENT = TRUE;
    TRADE = TRUE;
    DESCRIPTION = "Show me your wares.";
}

func int DIA_EINAR_TRADE_CONDITION() {
    if (NPC_KNOWSINFO(OTHER, 81491)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_TRADE_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_TRADE_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_TRADE_03_02");
    B_GIVETRADEINV(SELF);
}

instance DIA_EINAR_AMBIENT(C_INFO) {
    NPC = 58256;
    NR = 998;
    CONDITION = DIA_EINAR_AMBIENT_CONDITION;
    INFORMATION = DIA_EINAR_AMBIENT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "How are you doing?";
}

func int DIA_EINAR_AMBIENT_CONDITION() {
    if (NPC_KNOWSINFO(OTHER, 81485)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_AMBIENT_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_AMBIENT_15_01");
    if ((Q404_MARVINFINISHEDMINE) < (1)) {
        NPC_INITAMBIENTS(SELF, 3);
        if ((NPC_GETLASTAMBIENT(SELF)) == (1)) {
            AI_OUTPUT(SELF, OTHER, "DIA_Einar_AMBIENT_03_02");
        } else if ((NPC_GETLASTAMBIENT(SELF)) == (2)) {
            AI_OUTPUT(SELF, OTHER, "DIA_Einar_AMBIENT_03_03");
        } else if ((NPC_GETLASTAMBIENT(SELF)) == (3)) {
            AI_OUTPUT(SELF, OTHER, "DIA_Einar_AMBIENT_03_04");
        };
    };
    if (((Q404_MARVINFINISHEDMINE) >= (1)) && ((KAPITEL) != (5))) {
        AI_OUTPUT(SELF, OTHER, "DIA_Einar_AMBIENT_03_05");
    };
    if (((Q404_MARVINFINISHEDMINE) >= (1)) && ((KAPITEL) == (5))) {
        AI_OUTPUT(SELF, OTHER, "DIA_Einar_AMBIENT_03_06");
    };
}

instance DIA_EINAR_BOLT(C_INFO) {
    NPC = 58256;
    NR = 1;
    CONDITION = DIA_EINAR_BOLT_CONDITION;
    INFORMATION = DIA_EINAR_BOLT_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Do you recognize this bolt?";
}

func int DIA_EINAR_BOLT_CONDITION() {
    if (((NPC_KNOWSINFO(OTHER, 81485)) && ((NPC_HASITEMS(OTHER, 37293)) >= (1))) && ((LOG_GETSTATUS(MIS_Q402)) == (LOG_RUNNING))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_BOLT_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_Bolt_15_01");
    AI_STOPLOOKAT(SELF);
    if ((NPC_HASITEMS(SELF, 36067)) == (0)) {
        AI_STOPLOOKAT(SELF);
        CREATEINVITEM(SELF, 36067);
        AI_USEITEMTOSTATE(SELF, 36067, 1);
        AI_WAIT(SELF, 1077936128);
        AI_USEITEMTOSTATE(SELF, 36067, -(1));
        AI_LOOKATNPC(SELF, OTHER);
    };
    AI_LOOKATNPC(SELF, OTHER);
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Bolt_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_Bolt_15_03");
    AI_STARTFACEANI(SELF, S_SERIOUS, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Bolt_03_04");
    INFO_CLEARCHOICES(81518);
    INFO_ADDCHOICE(81518, "I think I will ask the questions here.", 81522);
    INFO_ADDCHOICE(81518, "Why are you interested in this?", 81523);
    INFO_ADDCHOICE(81518, "No, I got it legally.", 81524);
}

func void DIA_EINAR_BOLT_LEGAL_NEXT() {
    AI_RESETFACEANI(SELF);
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_Bolt_Next_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Bolt_Next_03_02");
    INFO_CLEARCHOICES(81518);
    INFO_ADDCHOICE(81518, "Do the Wolf Sons visit the city?", 81525);
    INFO_ADDCHOICE(81518, "This bolt looks very unusual.", 81526);
    INFO_ADDCHOICE(81518, "Can you tell when you made it?", 81527);
}

func void DIA_EINAR_BOLT_CHAD() {
    AI_STARTFACEANI(OTHER, "S_SEROIUS", 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_Bolt_Chad_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Bolt_Chad_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Bolt_Chad_03_03");
    AI_RESETFACEANI(OTHER);
}

func void DIA_EINAR_BOLT_WHY() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_Bolt_Why_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Bolt_Why_03_02");
}

func void DIA_EINAR_BOLT_LEGAL() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_Bolt_Legal_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Bolt_Legal_03_02");
    DIA_EINAR_BOLT_LEGAL_NEXT();
}

func void DIA_EINAR_BOLT_LEGAL_NEXT_CITY() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_Bolt_City_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Bolt_City_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Bolt_City_03_03");
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_Bolt_City_15_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Bolt_City_03_05");
}

func void DIA_EINAR_BOLT_LEGAL_NEXT_STRANGE() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_Bolt_Strange_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Bolt_Strange_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Bolt_Strange_03_06");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Bolt_Strange_03_07");
}

func void DIA_EINAR_BOLT_LEGAL_NEXT_CANYOU() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_Bolt_CanYou_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Bolt_CanYou_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_Bolt_CanYou_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Bolt_CanYou_03_04");
}

instance DIA_EINAR_WHO(C_INFO) {
    NPC = 58256;
    NR = 1;
    CONDITION = DIA_EINAR_WHO_CONDITION;
    INFORMATION = DIA_EINAR_WHO_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Who's gotten this kind of bolts from you lately?";
}

func int DIA_EINAR_WHO_CONDITION() {
    if (((NPC_KNOWSINFO(OTHER, 81518)) && ((NPC_HASITEMS(OTHER, 37293)) >= (1))) && ((LOG_GETSTATUS(MIS_Q402)) == (LOG_RUNNING))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_WHO_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_Who_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Who_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_Who_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Who_03_04");
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_Who_15_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Who_03_06");
    AI_LOGENTRY(TOPIC_Q402, LOG_Q402_EINARINFO);
    INFO_CLEARCHOICES(81528);
    INFO_ADDCHOICE(81528, "Where can I find Arethe?", 81531);
    INFO_ADDCHOICE(81528, "Where's Gron?", 81532);
    INFO_ADDCHOICE(81528, "Henk and Legrif are some kind of friends?", 81533);
    INFO_ADDCHOICE(81528, "Thanks for telling me so much.", 81534);
}

func void DIA_EINAR_WHO_ARETHE() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_Who_Arethe_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Who_Arethe_03_02");
    AI_LOGENTRY(TOPIC_Q402, LOG_Q402_EINARARETHEINFO);
}

func void DIA_EINAR_WHO_GRON() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_Who_Gron_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Who_Gron_03_02");
    AI_LOGENTRY(TOPIC_Q402, LOG_Q402_EINARGRONINFO);
}

func void DIA_EINAR_WHO_VAHRAL() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_Who_Vahral_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Who_Vahral_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_Who_Vahral_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Who_Vahral_03_04");
    AI_LOGENTRY(TOPIC_Q402, LOG_Q402_EINARVAHRALINFO);
}

func void DIA_EINAR_WHO_THANKS() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_Who_Thanks_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Who_Thanks_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_Who_Thanks_15_03");
    INFO_CLEARCHOICES(81528);
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_EINAR_KQ403_SWORDS(C_INFO) {
    NPC = 58256;
    NR = 1;
    CONDITION = DIA_EINAR_KQ403_SWORDS_CONDITION;
    INFORMATION = DIA_EINAR_KQ403_SWORDS_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "I have a request.";
}

func int DIA_EINAR_KQ403_SWORDS_CONDITION() {
    if (((LOG_GETSTATUS(MIS_KQ403)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 70377))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_KQ403_SWORDS_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_KQ403_Swords_15_01");
    AI_STARTFACEANI(SELF, S_SERIOUS, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_KQ403_Swords_03_02");
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_KQ403_Swords_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_KQ403_Swords_03_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_KQ403_Swords_03_05");
    INFO_CLEARCHOICES(81535);
    INFO_ADDCHOICE(81535, "I worked with Ulryk.", 81538);
}

func void DIA_EINAR_KQ403_SWORDS_ULRYK() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_KQ403_Swords_Ulryk_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_KQ403_Swords_Ulryk_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_KQ403_Swords_Ulryk_15_03");
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_KQ403_Swords_Ulryk_15_04");
    AI_RESETFACEANI(SELF);
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_KQ403_Swords_Ulryk_03_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_KQ403_Swords_Ulryk_03_06");
    INFO_CLEARCHOICES(81535);
    INFO_ADDCHOICE(81535, "Even better.", 81541);
}

var int KQ403_EINAR_GOLD;
func void DIA_EINAR_KQ403_SWORDS_GOLD() {
    B_GIVEINVITEMS(OTHER, SELF, 34203, KQ403_EINAR_SWORD);
    CREATEINVITEMS(SELF, 39536, 1);
    B_GIVEINVITEMS(SELF, OTHER, 39536, 1);
    KQ403_EINAR_GOLD = 0;
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_KQ403_Swords_Yes_15_07");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_KQ403_Swords_Yes_03_08");
    AI_LOGENTRY(TOPIC_KQ403, LOG_KQ403_SWORDS);
}

func void DIA_EINAR_KQ403_SWORDS_ULRYK_YES() {
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_KQ403_Swords_Yes_15_01");
    AI_STARTFACEANI(SELF, S_WHAT, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_KQ403_Swords_Yes_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_KQ403_Swords_Yes_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_KQ403_Swords_Yes_03_04");
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_KQ403_Swords_Yes_15_05");
    AI_RESETFACEANI(SELF);
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_KQ403_Swords_Yes_03_06");
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_KQ403_Swords_Yes_15_09");
    if ((NPC_HASITEMS(OTHER, 34203)) >= (KQ403_EINAR_SWORD)) {
        DIA_EINAR_KQ403_SWORDS_GOLD();
    };
    KQ403_EINAR_GOLD = 1;
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_KQ403_Swords_Yes_03_10");
}

instance DIA_EINAR_KQ403_YOURGOLD(C_INFO) {
    NPC = 58256;
    NR = 1;
    CONDITION = DIA_EINAR_KQ403_YOURGOLD_CONDITION;
    INFORMATION = DIA_EINAR_KQ403_YOURGOLD_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "I will pay. (100 GP)";
}

func int DIA_EINAR_KQ403_YOURGOLD_CONDITION() {
    if (((((LOG_GETSTATUS(MIS_KQ403)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 81535))) && ((NPC_HASITEMS(OTHER, 34203)) >= (KQ403_EINAR_SWORD))) && ((KQ403_EINAR_GOLD) == (1))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_KQ403_YOURGOLD_INFO() {
    DIA_EINAR_KQ403_SWORDS_GOLD();
}

instance DIA_EINAR_SQ419_WOOD(C_INFO) {
    NPC = 58256;
    NR = 1;
    CONDITION = DIA_EINAR_SQ419_WOOD_CONDITION;
    INFORMATION = DIA_EINAR_SQ419_WOOD_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Apparently you ordered a delivery of wood.";
}

func int DIA_EINAR_SQ419_WOOD_CONDITION() {
    if ((LOG_GETSTATUS(MIS_SQ419)) == (LOG_RUNNING)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_SQ419_WOOD_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_SQ419_Wood_15_01");
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_Wood_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_Wood_03_03");
    AI_RESETFACEANI(SELF);
}

instance DIA_EINAR_SQ419_CREDNAR(C_INFO) {
    NPC = 58256;
    NR = 1;
    CONDITION = DIA_EINAR_SQ419_CREDNAR_CONDITION;
    INFORMATION = DIA_EINAR_SQ419_CREDNAR_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Crednar won't let the woodcutters inside.";
}

func int DIA_EINAR_SQ419_CREDNAR_CONDITION() {
    if (((LOG_GETSTATUS(MIS_SQ419)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 81545))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_SQ419_CREDNAR_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_SQ419_Crednar_15_01");
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_Crednar_03_02");
    B_STANDUP();
    B_USEFAKESCROLL();
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_Crednar_03_03");
    AI_RESETFACEANI(SELF);
    AI_LOGENTRY(TOPIC_SQ419, LOG_SQ419_EINAR_MAD);
    CREATEINVITEMS(SELF, 37411, 1);
    B_GIVEINVITEMS(SELF, OTHER, 37411, 1);
}

instance DIA_EINAR_SQ419_GOTWOOD(C_INFO) {
    NPC = 58256;
    NR = 1;
    CONDITION = DIA_EINAR_SQ419_GOTWOOD_CONDITION;
    INFORMATION = DIA_EINAR_SQ419_GOTWOOD_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_EINAR_SQ419_GOTWOOD_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_SQ419)) == (LOG_RUNNING)) && (NPC_ISINSTATE(SELF, 61599))) && (NPC_KNOWSINFO(OTHER, 82533))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_SQ419_GOTWOOD_INFO() {
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_GotWood_03_01");
    CREATEINVITEMS(SELF, 34203, SQ419_EINARTHANKSGOLD);
    B_GIVEINVITEMS(SELF, OTHER, 34203, SQ419_EINARTHANKSGOLD);
    AI_STARTFACEANI(SELF, S_TIRED, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_GotWood_03_02");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_GotWood_03_03");
    INFO_CLEARCHOICES(81551);
    INFO_ADDCHOICE(81551, "I don't have time right now...", 81556);
    INFO_ADDCHOICE(81551, "Sounds like a reasonable deal.", 81555);
}

var int EINAR_SQ419_WANTTOHELP;
func void DIA_EINAR_SQ419_GOTWOOD_YES() {
    EINAR_SQ419_WANTTOHELP = TRUE;
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_SQ419_GotWood_Yes_15_01");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    if ((LOG_GETSTATUS(MIS_Q404)) == (LOG_SUCCESS)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_GotWood_Yes_03_03");
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_GotWood_Yes_03_02");
    AI_LOGENTRY(TOPIC_SQ419, LOG_SQ419_EINAR_HELP);
    INFO_CLEARCHOICES(81551);
    AI_STOPPROCESSINFOS(SELF);
    SELF.AIVAR[15] = TRUE;
    NPC_EXCHANGEROUTINE(SELF, "SQ419_GUIDE_ARMORY");
    AI_RESETFACEANI(SELF);
}

func void DIA_EINAR_SQ419_GOTWOOD_NO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_SQ419_GotWood_No_15_01");
    AI_STARTFACEANI(SELF, S_TIRED, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_GotWood_No_03_02");
    AI_LOGENTRY(TOPIC_SQ419, LOG_SQ419_FINISH_V1);
    LOG_SETSTATUS(_@(MIS_SQ419), TOPIC_SQ419, LOG_SUCCESS);
    B_GIVEPLAYERXP((XP_SQ419_FINISH) / (3));
    INFO_CLEARCHOICES(81551);
    AI_RESETFACEANI(SELF);
}

instance DIA_EINAR_SQ419_STARTWOOD(C_INFO) {
    NPC = 58256;
    NR = 1;
    CONDITION = DIA_EINAR_SQ419_STARTWOOD_CONDITION;
    INFORMATION = DIA_EINAR_SQ419_STARTWOOD_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_EINAR_SQ419_STARTWOOD_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_SQ419)) == (LOG_RUNNING)) && ((EINAR_SQ419_WANTTOHELP) == (TRUE))) && ((NPC_GETDISTTOWP(SELF, "WOLFSDEN_CITADEL_ARMORY_14")) <= (400))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_SQ419_STARTWOOD_INFO() {
    SQ419_WOODCUTTING = 1;
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_StartWood_03_01");
    AI_STOPPROCESSINFOS(SELF);
    NPC_EXCHANGEROUTINE(SELF, "SQ419_FORGE");
    if ((NPC_KNOWSINFO(OTHER, 89265)) && ((KNUT_REGULARWORK_COUNT) >= (1))) {
        AI_LOGENTRY(TOPIC_SQ419, LOG_SQ419_EINAR_WOODKNUTUWE);
    };
    if ((NPC_KNOWSINFO(OTHER, 89265)) && ((KNUT_REGULARWORK_COUNT) < (1))) {
        AI_LOGENTRY(TOPIC_SQ419, LOG_SQ419_EINAR_WOODUWE);
    };
    if ((!(NPC_KNOWSINFO(OTHER, 89265))) && ((KNUT_REGULARWORK_COUNT) >= (1))) {
        AI_LOGENTRY(TOPIC_SQ419, LOG_SQ419_EINAR_WOODKNUT);
    };
    AI_LOGENTRY(TOPIC_SQ419, LOG_SQ419_EINAR_WOOD);
}

instance DIA_EINAR_SQ419_HISTORY(C_INFO) {
    NPC = 58256;
    NR = 1;
    CONDITION = DIA_EINAR_SQ419_HISTORY_CONDITION;
    INFORMATION = DIA_EINAR_SQ419_HISTORY_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_EINAR_SQ419_HISTORY_CONDITION() {
    if (((LOG_GETSTATUS(MIS_SQ419)) == (LOG_RUNNING)) && ((SQ419_WOODCUTTING) == (3))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_SQ419_HISTORY_INFO() {
    FF_APPLYONCEEXTGT(63945, 0, -(1));
    INFO_CLEARCHOICES(81560);
    INFO_ADDCHOICE(81560, "Let's get to work. In silence.", 81564);
    INFO_ADDCHOICE(81560, "I would love to hear stories about your nation.", 81565);
}

func void DIA_EINAR_SQ419_HISTORY_NEXT() {
    SQ419_SMITHINGTIME = TRUE;
    SQ419_COOLTIME = TRUE;
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_History_Next_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_History_Next_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_History_Next_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_History_Next_03_04");
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
    INFO_CLEARCHOICES(81560);
    AI_STOPPROCESSINFOS(SELF);
    NPC_EXCHANGEROUTINE(SELF, START);
    AI_LOGENTRY(TOPIC_SQ419, LOG_SQ419_EINAR_FINISHWOOD);
    AI_FUNCTION(SELF, 63931);
    CREATEINVITEMS(SELF, 34182, 4);
    B_GIVEINVITEMS(SELF, OTHER, 34182, 4);
}

func void DIA_EINAR_SQ419_HISTORY_WORK() {
    SQ419_SKIPEINARHISTORYLESSON = TRUE;
    WLD_SENDTRIGGER("SQ419_WOOD_06");
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_SQ419_History_Work_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_History_Work_03_02");
    DIA_EINAR_SQ419_HISTORY_NEXT();
}

func void DIA_EINAR_SQ419_HISTORY_SURE() {
    WLD_SENDTRIGGER("SQ419_WOOD_06");
    AI_STARTFACEANI(OTHER, S_SMILE, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_SQ419_History_Sure_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_History_Sure_03_02");
    DIA_EINAR_SQ419_HISTORY_NEXT();
}

instance DIA_EINAR_SQ419_AFTERSMITHING(C_INFO) {
    NPC = 58256;
    NR = 1;
    CONDITION = DIA_EINAR_SQ419_AFTERSMITHING_CONDITION;
    INFORMATION = DIA_EINAR_SQ419_AFTERSMITHING_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_EINAR_SQ419_AFTERSMITHING_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_SQ419)) == (LOG_RUNNING)) && ((NPC_HASITEMS(OTHER, 37415)) >= (4))) && ((NPC_GETDISTTONPC(SELF, OTHER)) <= (400))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_SQ419_AFTERSMITHING_INFO() {
    NPC_REMOVEINVITEMS(SELF, 37415, 4);
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    B_GIVEINVITEMS(OTHER, SELF, 37415, 4);
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_AFTERSMITHING_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_AFTERSMITHING_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_AFTERSMITHING_03_03");
    AI_RESETFACEANI(SELF);
    AI_STOPPROCESSINFOS(SELF);
    NPC_EXCHANGEROUTINE(SELF, "SQ419_GUIDE_LEATHER");
    AI_LOGENTRY(TOPIC_SQ419, LOG_SQ419_EINER_AFTERSMITHING);
}

instance DIA_EINAR_SQ419_NEXTTASK(C_INFO) {
    NPC = 58256;
    NR = 1;
    CONDITION = DIA_EINAR_SQ419_NEXTTASK_CONDITION;
    INFORMATION = DIA_EINAR_SQ419_NEXTTASK_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_EINAR_SQ419_NEXTTASK_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_SQ419)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 81566))) && ((NPC_GETDISTTOWP(SELF, "WOLFSDEN_CITADEL_ARMORY_10")) <= (400))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_SQ419_NEXTTASK_INFO() {
    SQ419_TANNING = 1;
    MOB_CHANGEFOCUSNAME("SQ419_SPECIAL_TANNING", "MOBNAME_SQ419_TANNING");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_NextTask_03_01");
    AI_STOPPROCESSINFOS(SELF);
    NPC_EXCHANGEROUTINE(SELF, "SQ419_WORKTABLE");
    AI_LOGENTRY(TOPIC_SQ419, LOG_SQ419_EINAR_NEXTTASK);
}

instance DIA_EINAR_SQ419_TANNINGDONE(C_INFO) {
    NPC = 58256;
    NR = 1;
    CONDITION = DIA_EINAR_SQ419_TANNINGDONE_CONDITION;
    INFORMATION = DIA_EINAR_SQ419_TANNINGDONE_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_EINAR_SQ419_TANNINGDONE_CONDITION() {
    if (((LOG_GETSTATUS(MIS_SQ419)) == (LOG_RUNNING)) && ((SQ419_TANNING) == (3))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_SQ419_TANNINGDONE_INFO() {
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_TanningDone_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_TanningDone_03_02");
    CREATEINVITEMS(SELF, 36906, 1);
    B_GIVEINVITEMS(SELF, OTHER, 36906, 1);
    INFO_CLEARCHOICES(81572);
    INFO_ADDCHOICE(81572, "What are we actually creating here?", 81575);
}

func void DIA_EINAR_SQ419_TANNINGDONE_WHAT() {
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_SQ419_TanningDone_What_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_TanningDone_What_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_TanningDone_What_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_TanningDone_What_03_04");
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
    INFO_CLEARCHOICES(81572);
    AI_STOPPROCESSINFOS(SELF);
    AI_LOGENTRY(TOPIC_SQ419, LOG_SQ419_EINAR_AFTERTANNING);
    AI_FUNCTION(SELF, 63935);
}

instance DIA_EINAR_SQ419_FINISH(C_INFO) {
    NPC = 58256;
    NR = 1;
    CONDITION = DIA_EINAR_SQ419_FINISH_CONDITION;
    INFORMATION = DIA_EINAR_SQ419_FINISH_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "I have casting mold.";
}

func int DIA_EINAR_SQ419_FINISH_CONDITION() {
    if (((LOG_GETSTATUS(MIS_SQ419)) == (LOG_RUNNING)) && ((NPC_HASITEMS(OTHER, 37416)) >= (1))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_SQ419_FINISH_INFO() {
    SELF.AIVAR[15] = FALSE;
    NPC_REMOVEINVITEMS(HERO, 37416, 1);
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_SQ419_Finish_15_01");
    B_GIVEINVITEMS(OTHER, SELF, 37416, 1);
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_SQ419_Finish_03_02");
    AI_RESETFACEANI(SELF);
    AI_STOPPROCESSINFOS(SELF);
    NPC_EXCHANGEROUTINE(SELF, "SQ419_WOLF");
    AI_FUNCTION(SELF, 63938);
}

instance DIA_EINAR_TEACH_SMITH2(C_INFO) {
    NPC = 58256;
    NR = 7;
    CONDITION = DIA_EINAR_TEACH_SMITH2_CONDITION;
    INFORMATION = DIA_EINAR_TEACH_SMITH2_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = B_BUILDLEARNSTRING2(PRINT_LEARN_SMITH2, B_GETLEARNCOSTTALENT(OTHER, NPC_TALENT_SMITH, 2), EINAR_SMITH2);
}

func int DIA_EINAR_TEACH_SMITH2_CONDITION() {
    if (((EINAR_TEACHHEROSMITH) == (TRUE)) && ((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_SMITH)) == (1))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_TEACH_SMITH2_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_TRAIN_Smith2_15_00");
    if ((NPC_HASITEMS(OTHER, 34203)) >= (EINAR_SMITH2)) {
        if ((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_SMITH)) == (2)) {
            B_GIVEINVITEMS(OTHER, SELF, 34203, EINAR_SMITH2);
            AI_OUTPUT(SELF, OTHER, "DIA_Einar_TRAIN_Smith2_03_01");
            AI_OUTPUT(SELF, OTHER, "DIA_Einar_TRAIN_Smith2_03_02");
            B_GIVEINVITEMS(SELF, OTHER, 34202, 1);
            NPC_REMOVEINVITEMS(SELF, 34203, EINAR_SMITH2);
        };
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_TRAIN_Smith2_03_03");
}

instance DIA_EINAR_TEACH_SMITH3(C_INFO) {
    NPC = 58256;
    NR = 7;
    CONDITION = DIA_EINAR_TEACH_SMITH3_CONDITION;
    INFORMATION = DIA_EINAR_TEACH_SMITH3_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = B_BUILDLEARNSTRING2(PRINT_LEARN_SMITH3, B_GETLEARNCOSTTALENT(OTHER, NPC_TALENT_SMITH, 3), EINAR_SMITH3);
}

func int DIA_EINAR_TEACH_SMITH3_CONDITION() {
    if (((EINAR_TEACHHEROSMITH) == (TRUE)) && ((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_SMITH)) == (2))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_TEACH_SMITH3_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_TRAIN_Smith3_15_00");
    if ((NPC_HASITEMS(OTHER, 34203)) >= (EINAR_SMITH3)) {
        SMITH_FINISHTRAIN = TRUE;
        SMITH_FINISHTRAIN_DAY = WLD_GETDAY();
        if ((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_SMITH)) == (3)) {
            B_GIVEINVITEMS(OTHER, SELF, 34203, EINAR_SMITH3);
            AI_OUTPUT(SELF, OTHER, "DIA_Einar_TRAIN_Smith3_03_01");
            AI_OUTPUT(SELF, OTHER, "DIA_Einar_TRAIN_Smith3_03_02");
            AI_OUTPUT(SELF, OTHER, "DIA_Einar_TRAIN_Smith3_03_03");
            NPC_REMOVEINVITEMS(SELF, 34203, EINAR_SMITH3);
        };
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_TRAIN_Smith3_03_04");
}

instance DIA_EINAR_ARMORS(C_INFO) {
    NPC = 58256;
    NR = 1;
    CONDITION = DIA_EINAR_ARMORS_CONDITION;
    INFORMATION = DIA_EINAR_ARMORS_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Do you do armor as well?";
}

func int DIA_EINAR_ARMORS_CONDITION() {
    if (NPC_KNOWSINFO(OTHER, 81485)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_ARMORS_INFO() {
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Einar_Armors_15_01");
    AI_STARTFACEANI(SELF, S_WHAT, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Armors_03_02");
    AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Armors_03_03");
    AI_STARTFACEANI(SELF, S_SERIOUS, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Armors_03_04");
    AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Einar_Armors_03_05");
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
}

instance DIA_EINAR_UPGRADEARMOR(C_INFO) {
    NPC = 58256;
    NR = 950;
    CONDITION = DIA_EINAR_UPGRADEARMOR_CONDITION;
    INFORMATION = DIA_EINAR_UPGRADEARMOR_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_UPGRADEARMOR;
}

func int DIA_EINAR_UPGRADEARMOR_CONDITION() {
    if (NPC_KNOWSINFO(OTHER, 81585)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_UPGRADEARMOR_INFO() {
    INFO_CLEARCHOICES(81588);
    INFO_ADDCHOICE(81588, DIALOG_BACK, 81591);
    INFO_ADDCHOICE(81588, "(Upgrade regular armor)", 81592);
    INFO_ADDCHOICE(81588, "(Upgrade to superior armor)", 81618);
}

func void DIA_EINAR_UPGRADEARMOR_BACK() {
    INFO_CLEARCHOICES(81588);
}

func void DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES() {
    ARMORSELLER_CHAIN_L_TIER2 = CS7(NAMEARMOR_CHAIN_L_TIER2, " (", I2S((VALUE_ITAR_CHAIN_L) / (2)), PRINT_SZ, " + 5x ", NAMECRAFT_IRON, ")");
    ARMORSELLER_CHAIN_M_TIER2 = CS7(NAMEARMOR_CHAIN_M_TIER2, " (", I2S((VALUE_ITAR_CHAIN_M) / (2)), PRINT_SZ, " + 6x ", NAMECRAFT_IRON, ")");
    ARMORSELLER_CRAB_TIER2 = CS7(NAMEARMOR_CRAB_TIER2, " (", I2S((VALUE_ITAR_CRAB) / (2)), PRINT_SZ, " + 4x ", THROPHYNAME_CRABSHELL, ")");
    ARMORSELLER_LEATHER_L_TIER2 = CS7(NAMEARMOR_KM_LEATHER_L_TIER2, " (", I2S((VALUE_ITAR_KM_LEATHER_L) / (2)), PRINT_SZ, " + 1x ", THROPHYNAME_TURTLESHELL, ")");
    ARMORSELLER_LEATHER_M_TIER2 = CS7(NAMEARMOR_KM_LEATHER_M_TIER2, " (", I2S((VALUE_ITAR_KM_LEATHER_M) / (2)), PRINT_SZ, " + 2x ", THROPHYNAME_TURTLESHELL, ")");
    ARMORSELLER_HUNTER_L_TIER2 = CS7(NAMEARMOR_KM_HUNTER_L_TIER2, " (", I2S((VALUE_ITAR_HUNTER_L) / (2)), PRINT_SZ, " + 1x ", THROPHYNAME_CRAWLERPLATE, ")");
    ARMORSELLER_STH_L_TIER2 = CS7(NAMEARMOR_STH_L_TIER2, " (", I2S((VALUE_ITAR_STH_L) / (2)), PRINT_SZ, " + 2x ", THROPHYNAME_CRAWLERPLATE, ")");
    ARMORSELLER_STH_H_TIER2 = CS7(NAMEARMOR_STH_H_TIER2, " (", I2S((VALUE_ITAR_STH_H) / (2)), PRINT_SZ, " + 4x ", THROPHYNAME_CRAWLERPLATE, ")");
    ARMORSELLER_NORDMAR_TIER2 = CS7(NAMEARMOR_NORDMAR_TIER2, " (", I2S((VALUE_ITAR_NORDMAR) / (2)), PRINT_SZ, " + 2x ", MISCNAME_NUGGET, ")");
    ARMORSELLER_ARX_R_TIER2 = CS7(NAMEARMOR_ARX_R_TIER2, " (", I2S((VALUE_ITAR_ARX_R) / (2)), PRINT_SZ, " + 5x ", NAMECRAFT_IRON, ")");
    ARMORSELLER_ARX_B_TIER2 = CS7(NAMEARMOR_ARX_B_TIER2, " (", I2S((VALUE_ITAR_ARX_B) / (2)), PRINT_SZ, " + 3x ", THROPHYNAME_TURTLESHELL, ")");
    ARMORSELLER_ARX_W1_TIER2 = CS7(NAMEARMOR_ARX_W1_TIER2, " (", I2S((VALUE_ITAR_ARX_W1) / (2)), PRINT_SZ, " + 20x ", NAMECRAFT_IRON, ")");
    ARMORSELLER_ARX_W2_TIER2 = CS7(NAMEARMOR_ARX_W2_TIER2, " (", I2S((VALUE_ITAR_ARX_W2) / (2)), PRINT_SZ, " + 10x ", NAMEMISC_SILVER, ")");
    ARMORSELLER_ARX_H1_TIER2 = CS7(NAMEARMOR_ARX_H1_TIER2, " (", I2S((VALUE_ITAR_ARX_H1) / (2)), PRINT_SZ, " + 4x ", THROPHYNAME_CRABSHELL, ")");
    ARMORSELLER_ARX_H2_TIER2 = CS7(NAMEARMOR_ARX_H2_TIER2, " (", I2S((VALUE_ITAR_ARX_H2) / (2)), PRINT_SZ, " + 6x ", THROPHYNAME_CRAWLERPLATE, ")");
    ARMORSELLER_MIL_R_TIER2 = CS7(NAMEARMOR_MIL_R_01_TIER2, " (", I2S((VALUE_ITAR_MIL_R) / (2)), PRINT_SZ, " + 5x ", NAMECRAFT_IRON, ")");
    ARMORSELLER_MIL_B_TIER2 = CS7(NAMEARMOR_MIL_B_TIER2, " (", I2S((VALUE_ITAR_MIL_B) / (2)), PRINT_SZ, " + 3x ", THROPHYNAME_TURTLESHELL, ")");
    ARMORSELLER_MIL_W1_TIER2 = CS7(NAMEARMOR_MIL_W1_TIER2, " (", I2S((VALUE_ITAR_MIL_W1) / (2)), PRINT_SZ, " + 20x ", NAMECRAFT_IRON, ")");
    ARMORSELLER_MIL_W2_TIER2 = CS7(NAMEARMOR_MIL_W2_TIER2, " (", I2S((VALUE_ITAR_MIL_W2) / (2)), PRINT_SZ, " + 10x ", NAMEMISC_SILVER, ")");
    ARMORSELLER_MIL_C1_TIER2 = CS7(NAMEARMOR_MIL_C1_TIER2, " (", I2S((VALUE_ITAR_MIL_C1) / (2)), PRINT_SZ, " + 4x ", THROPHYNAME_CRAWLERPLATE, ")");
    ARMORSELLER_MIL_C2_TIER2 = CS7(NAMEARMOR_MIL_C2_TIER2, " (", I2S((VALUE_ITAR_MIL_C2) / (2)), PRINT_SZ, " + 6x ", THROPHYNAME_CRABSHELL, ")");
    ARMORSELLER_USM_L_TIER2 = CS7(NAMEARMOR_USM_L_TIER2, " (", I2S((VALUE_ITAR_USM_L) / (2)), PRINT_SZ, " + 10x ", NAMECRAFT_IRON, ")");
    ARMORSELLER_WS_M_TIER2 = CS7(NAMEARMOR_WS_M_TIER2, " (", I2S((VALUE_ITAR_WS_M) / (2)), PRINT_SZ, " + 8x ", NAMEMISC_SILVER, ")");
    ARMORSELLER_GRD_M_TIER2 = CS7(NAMEARMOR_GRD_M_TIER2, " (", I2S((VALUE_ITAR_GRD_M) / (2)), PRINT_SZ, " + 20x ", MISCNAME_GOLDNUGGET_ADDON, ")");
    ARMORSELLER_KNIGHT_TIER2 = CS7(NAMEARMOR_KNIGHTARMOR_TIER2, " (", I2S((VALUE_ITAR_KNIGHTARMOR) / (5)), PRINT_SZ, " + 20x ", NAMECRAFT_IRON, ")");
    INFO_CLEARCHOICES(81588);
    if ((NPC_HASITEMS(OTHER, 35398)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_CHAIN_L_TIER2, 81593);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_CHAIN_L_TIER2, 81593);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35403)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_CHAIN_M_TIER2, 81594);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_CHAIN_M_TIER2, 81594);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35414)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_LEATHER_L_TIER2, 81596);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_KM_LEATHER_L_TIER2, 81596);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35417)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_LEATHER_M_TIER2, 81597);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_KM_LEATHER_M_TIER2, 81597);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35422)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_HUNTER_L_TIER2, 81598);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_KM_HUNTER_L_TIER2, 81598);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35430)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_STH_L_TIER2, 81599);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_STH_L_TIER2, 81599);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35435)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_STH_H_TIER2, 81600);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_STH_H_TIER2, 81600);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35407)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_CRAB_TIER2, 81595);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_CRAB_TIER2, 81595);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35479)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_USM_L_TIER2, 81602);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_USM_L_TIER2, 81602);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35444)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_NORDMAR_TIER2, 81601);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_NORDMAR_TIER2, 81601);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35515)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_WS_M_TIER2, 81603);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_WS_M_TIER2, 81603);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35617)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_GRD_M_TIER2, 81604);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_GRD_M_TIER2, 81604);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35451)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_ARX_R_TIER2, 81605);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_ARX_R_TIER2, 81605);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35465)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_ARX_B_TIER2, 81606);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_ARX_B_TIER2, 81606);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35454)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_ARX_W1_TIER2, 81607);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_ARX_W1_TIER2, 81607);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35459)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_ARX_W2_TIER2, 81608);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_ARX_W2_TIER2, 81608);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35470)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_ARX_H1_TIER2, 81609);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_ARX_H1_TIER2, 81609);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35475)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_ARX_H2_TIER2, 81610);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_ARX_H2_TIER2, 81610);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35482)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_MIL_R_TIER2, 81611);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_MIL_R_01_TIER2, 81611);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35488)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_MIL_B_TIER2, 81612);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_MIL_B_TIER2, 81612);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35501)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_MIL_W1_TIER2, 81613);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_MIL_W1_TIER2, 81613);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35506)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_MIL_W2_TIER2, 81614);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_MIL_W2_TIER2, 81614);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35493)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_MIL_C1_TIER2, 81615);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_MIL_C1_TIER2, 81615);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35498)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_MIL_C2_TIER2, 81616);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_MIL_C2_TIER2, 81616);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35525)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_KNIGHT_TIER2, 81617);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_KNIGHTARMOR_TIER2, 81617);
        };
    };
    INFO_ADDCHOICE(81588, DIALOG_BACK, 81590);
}

func void DIA_EINAR_UPGRADEARMOR_CHAIN_L_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35398)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_CHAIN_L) / (2))) && ((NPC_HASITEMS(OTHER, 35980)) >= (5))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35399, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35399, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            NPC_REMOVEINVITEMS(SELF, 35398, 1);
            AI_EQUIPARMOR(OTHER, 35399);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_CHAIN_M_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35403)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_CHAIN_M) / (2))) && ((NPC_HASITEMS(OTHER, 35980)) >= (6))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            NPC_REMOVEINVITEMS(SELF, 35403, 1);
            CREATEINVITEMS(SELF, 35404, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35404, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            B_GIVEINVITEMS(OTHER, SELF, 35403, 1);
            AI_EQUIPARMOR(OTHER, 35404);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_CRAB_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35407)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_CRAB) / (2))) && ((NPC_HASITEMS(OTHER, 35361)) >= (4))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35408, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35408, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            NPC_REMOVEINVITEMS(SELF, 35407, 1);
            AI_EQUIPARMOR(OTHER, 35408);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_LEATHER_L_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35414)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_KM_LEATHER_L) / (2))) && ((NPC_HASITEMS(OTHER, 35360)) >= (1))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35415, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35415, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            NPC_REMOVEINVITEMS(SELF, 35414, 1);
            AI_EQUIPARMOR(OTHER, 35415);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_LEATHER_M_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35417)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_KM_LEATHER_M) / (2))) && ((NPC_HASITEMS(OTHER, 35360)) >= (2))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35418, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35418, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            NPC_REMOVEINVITEMS(SELF, 35417, 1);
            AI_EQUIPARMOR(OTHER, 35418);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_HUNTER_L_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35422)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_HUNTER_L) / (2))) && ((NPC_HASITEMS(OTHER, 33862)) >= (1))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35423, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35423, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            NPC_REMOVEINVITEMS(SELF, 35422, 1);
            AI_EQUIPARMOR(OTHER, 35423);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_STH_L_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35430)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_STH_L) / (2))) && ((NPC_HASITEMS(OTHER, 33862)) >= (2))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35431, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35431, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            NPC_REMOVEINVITEMS(SELF, 35430, 1);
            AI_EQUIPARMOR(OTHER, 35431);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_STH_H_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35435)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_STH_H) / (2))) && ((NPC_HASITEMS(OTHER, 33862)) >= (4))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35436, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35436, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            NPC_REMOVEINVITEMS(SELF, 35435, 1);
            AI_EQUIPARMOR(OTHER, 35436);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_NORDMAR_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35444)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_NORDMAR) / (2))) && ((NPC_HASITEMS(OTHER, 34202)) >= (2))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35445, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35445, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            NPC_REMOVEINVITEMS(SELF, 35444, 1);
            AI_EQUIPARMOR(OTHER, 35445);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_USM_L_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35479)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_USM_L) / (2))) && ((NPC_HASITEMS(OTHER, 35980)) >= (10))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35480, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35480, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            NPC_REMOVEINVITEMS(SELF, 35479, 1);
            AI_EQUIPARMOR(OTHER, 35480);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_WS_M_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35515)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_WS_M) / (2))) && ((NPC_HASITEMS(OTHER, 36939)) >= (8))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35516, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35516, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            NPC_REMOVEINVITEMS(SELF, 35515, 1);
            AI_EQUIPARMOR(OTHER, 35516);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_GRD_M_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35617)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_GRD_M) / (2))) && ((NPC_HASITEMS(OTHER, 33660)) >= (20))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35618, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35618, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            NPC_REMOVEINVITEMS(SELF, 35617, 1);
            AI_EQUIPARMOR(OTHER, 35618);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_ARX_R_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35451)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_ARX_R) / (2))) && ((NPC_HASITEMS(OTHER, 35980)) >= (5))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35452, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35452, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            NPC_REMOVEINVITEMS(SELF, 35451, 1);
            AI_EQUIPARMOR(OTHER, 35452);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_ARX_B_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35465)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_ARX_B) / (2))) && ((NPC_HASITEMS(OTHER, 35360)) >= (3))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35466, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35466, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            NPC_REMOVEINVITEMS(SELF, 35465, 1);
            AI_EQUIPARMOR(OTHER, 35466);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_ARX_W1_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35454)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_ARX_W1) / (2))) && ((NPC_HASITEMS(OTHER, 35980)) >= (20))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35455, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35455, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            NPC_REMOVEINVITEMS(SELF, 35454, 1);
            AI_EQUIPARMOR(OTHER, 35455);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_ARX_W2_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35459)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_ARX_W2) / (2))) && ((NPC_HASITEMS(OTHER, 36939)) >= (10))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35460, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35460, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            NPC_REMOVEINVITEMS(SELF, 35459, 1);
            AI_EQUIPARMOR(OTHER, 35460);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_ARX_H1_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35470)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_ARX_H1) / (2))) && ((NPC_HASITEMS(OTHER, 35361)) >= (4))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35471, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35471, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            NPC_REMOVEINVITEMS(SELF, 35470, 1);
            AI_EQUIPARMOR(OTHER, 35471);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_ARX_H2_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35475)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_ARX_H2) / (2))) && ((NPC_HASITEMS(OTHER, 33862)) >= (6))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35476, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35476, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            NPC_REMOVEINVITEMS(SELF, 35475, 1);
            AI_EQUIPARMOR(OTHER, 35476);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_MIL_R_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35482)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_MIL_R) / (2))) && ((NPC_HASITEMS(OTHER, 35980)) >= (5))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35483, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35483, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            NPC_REMOVEINVITEMS(SELF, 35482, 1);
            AI_EQUIPARMOR(OTHER, 35483);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_MIL_B_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35488)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_MIL_B) / (2))) && ((NPC_HASITEMS(OTHER, 35360)) >= (3))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35489, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35489, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            NPC_REMOVEINVITEMS(SELF, 35488, 1);
            AI_EQUIPARMOR(OTHER, 35489);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_MIL_W1_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35501)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_MIL_W1) / (2))) && ((NPC_HASITEMS(OTHER, 35980)) >= (20))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35502, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35502, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            NPC_REMOVEINVITEMS(SELF, 35501, 1);
            AI_EQUIPARMOR(OTHER, 35502);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_MIL_W2_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35506)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_MIL_W2) / (2))) && ((NPC_HASITEMS(OTHER, 36939)) >= (10))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35507, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35507, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            NPC_REMOVEINVITEMS(SELF, 35506, 1);
            AI_EQUIPARMOR(OTHER, 35507);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_MIL_C1_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35493)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_MIL_C1) / (2))) && ((NPC_HASITEMS(OTHER, 33862)) >= (4))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35494, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35494, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            NPC_REMOVEINVITEMS(SELF, 35493, 1);
            AI_EQUIPARMOR(OTHER, 35494);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_MIL_C2_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35498)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_MIL_C2) / (2))) && ((NPC_HASITEMS(OTHER, 35361)) >= (6))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35499, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35499, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            NPC_REMOVEINVITEMS(SELF, 35498, 1);
            AI_EQUIPARMOR(OTHER, 35499);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_KNIGHT_TIER2() {
    if ((NPC_HASITEMS(OTHER, 35525)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_KNIGHTARMOR) / (5))) && ((NPC_HASITEMS(OTHER, 35980)) >= (20))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35526, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35526, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER2);
            NPC_REMOVEINVITEMS(SELF, 35525, 1);
            AI_EQUIPARMOR(OTHER, 35526);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER2_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES() {
    ARMORSELLER_CHAIN_L_TIER3 = CS7(NAMEARMOR_CHAIN_L_TIER3, " (", I2S(VALUE_ITAR_CHAIN_L), PRINT_SZ, " + 10x ", NAMECRAFT_IRON, ")");
    ARMORSELLER_CHAIN_M_TIER3 = CS7(NAMEARMOR_CHAIN_M_TIER3, " (", I2S(VALUE_ITAR_CHAIN_M), PRINT_SZ, " + 12x ", NAMECRAFT_IRON, ")");
    ARMORSELLER_CRAB_TIER3 = CS7(NAMEARMOR_CRAB_TIER3, " (", I2S(VALUE_ITAR_CRAB), PRINT_SZ, " + 8x ", THROPHYNAME_CRABSHELL, ")");
    ARMORSELLER_LEATHER_L_TIER3 = CS7(NAMEARMOR_KM_LEATHER_L_TIER3, " (", I2S(VALUE_ITAR_KM_LEATHER_L), PRINT_SZ, " + 2x ", THROPHYNAME_TURTLESHELL, ")");
    ARMORSELLER_LEATHER_M_TIER3 = CS7(NAMEARMOR_KM_LEATHER_M_TIER3, " (", I2S(VALUE_ITAR_KM_LEATHER_M), PRINT_SZ, " + 4x ", THROPHYNAME_TURTLESHELL, ")");
    ARMORSELLER_HUNTER_L_TIER3 = CS7(NAMEARMOR_KM_HUNTER_L_TIER3, " (", I2S(VALUE_ITAR_HUNTER_L), PRINT_SZ, " + 2x ", THROPHYNAME_CRAWLERPLATE, ")");
    ARMORSELLER_STH_L_TIER3 = CS7(NAMEARMOR_STH_L_TIER3, " (", I2S(VALUE_ITAR_STH_L), PRINT_SZ, " + 4x ", THROPHYNAME_CRAWLERPLATE, ")");
    ARMORSELLER_STH_H_TIER3 = CS7(NAMEARMOR_STH_H_TIER3, " (", I2S(VALUE_ITAR_STH_H), PRINT_SZ, " + 8x ", THROPHYNAME_CRAWLERPLATE, ")");
    ARMORSELLER_NORDMAR_TIER3 = CS7(NAMEARMOR_NORDMAR_TIER3, " (", I2S(VALUE_ITAR_NORDMAR), PRINT_SZ, " + 4x ", MISCNAME_NUGGET, ")");
    ARMORSELLER_ARX_R_TIER3 = CS7(NAMEARMOR_ARX_R_TIER3, " (", I2S(VALUE_ITAR_ARX_R), PRINT_SZ, " + 10x ", NAMECRAFT_IRON, ")");
    ARMORSELLER_ARX_B_TIER3 = CS7(NAMEARMOR_ARX_B_TIER3, " (", I2S(VALUE_ITAR_ARX_B), PRINT_SZ, " + 6x ", THROPHYNAME_TURTLESHELL, ")");
    ARMORSELLER_ARX_W1_TIER3 = CS7(NAMEARMOR_ARX_W1_TIER3, " (", I2S(VALUE_ITAR_ARX_W1), PRINT_SZ, " + 40x ", NAMECRAFT_IRON, ")");
    ARMORSELLER_ARX_W2_TIER3 = CS7(NAMEARMOR_ARX_W2_TIER3, " (", I2S(VALUE_ITAR_ARX_W2), PRINT_SZ, " + 20x ", NAMEMISC_SILVER, ")");
    ARMORSELLER_ARX_H1_TIER3 = CS7(NAMEARMOR_ARX_H1_TIER3, " (", I2S(VALUE_ITAR_ARX_H1), PRINT_SZ, " + 8x ", THROPHYNAME_CRABSHELL, ")");
    ARMORSELLER_ARX_H2_TIER3 = CS7(NAMEARMOR_ARX_H2_TIER3, " (", I2S(VALUE_ITAR_ARX_H2), PRINT_SZ, " + 12x ", THROPHYNAME_CRAWLERPLATE, ")");
    ARMORSELLER_MIL_R_TIER3 = CS7(NAMEARMOR_MIL_R_01_TIER3, " (", I2S(VALUE_ITAR_MIL_R), PRINT_SZ, " + 10x ", NAMECRAFT_IRON, ")");
    ARMORSELLER_MIL_B_TIER3 = CS7(NAMEARMOR_MIL_B_TIER3, " (", I2S(VALUE_ITAR_MIL_B), PRINT_SZ, " + 6x ", THROPHYNAME_TURTLESHELL, ")");
    ARMORSELLER_MIL_W1_TIER3 = CS7(NAMEARMOR_MIL_W1_TIER3, " (", I2S(VALUE_ITAR_MIL_W1), PRINT_SZ, " + 40x ", NAMECRAFT_IRON, ")");
    ARMORSELLER_MIL_W2_TIER3 = CS7(NAMEARMOR_MIL_W2_TIER3, " (", I2S(VALUE_ITAR_MIL_W2), PRINT_SZ, " + 20x ", NAMEMISC_SILVER, ")");
    ARMORSELLER_MIL_C1_TIER3 = CS7(NAMEARMOR_MIL_C1_TIER3, " (", I2S(VALUE_ITAR_MIL_C1), PRINT_SZ, " + 8x ", THROPHYNAME_CRAWLERPLATE, ")");
    ARMORSELLER_MIL_C2_TIER3 = CS7(NAMEARMOR_MIL_C2_TIER3, " (", I2S(VALUE_ITAR_MIL_C2), PRINT_SZ, " + 12x ", THROPHYNAME_CRABSHELL, ")");
    ARMORSELLER_USM_L_TIER3 = CS7(NAMEARMOR_USM_L_TIER3, " (", I2S(VALUE_ITAR_USM_L), PRINT_SZ, " + 20x ", NAMECRAFT_IRON, ")");
    ARMORSELLER_WS_M_TIER3 = CS7(NAMEARMOR_WS_M_TIER3, " (", I2S(VALUE_ITAR_WS_M), PRINT_SZ, " + 16x ", NAMEMISC_SILVER, ")");
    ARMORSELLER_GRD_M_TIER3 = CS7(NAMEARMOR_GRD_M_TIER3, " (", I2S(VALUE_ITAR_GRD_M), PRINT_SZ, " + 40x ", MISCNAME_GOLDNUGGET_ADDON, ")");
    ARMORSELLER_KNIGHT_TIER3 = CS7(NAMEARMOR_KNIGHTARMOR_TIER3, " (", I2S((VALUE_ITAR_KNIGHTARMOR) / (2)), PRINT_SZ, " + 40x ", NAMECRAFT_IRON, ")");
    INFO_CLEARCHOICES(81588);
    if ((NPC_HASITEMS(OTHER, 35399)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_CHAIN_L_TIER3, 81619);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_CHAIN_L_TIER3, 81619);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35404)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_CHAIN_M_TIER3, 81620);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_CHAIN_M_TIER3, 81620);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35415)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_LEATHER_L_TIER3, 81622);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_KM_LEATHER_L_TIER3, 81622);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35418)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_LEATHER_M_TIER3, 81623);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_KM_LEATHER_M_TIER3, 81623);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35423)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_HUNTER_L_TIER3, 81624);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_KM_HUNTER_L_TIER3, 81624);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35431)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_STH_L_TIER3, 81625);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_STH_L_TIER3, 81625);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35436)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_STH_H_TIER3, 81626);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_STH_H_TIER3, 81626);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35408)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_CRAB_TIER3, 81621);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_CRAB_TIER3, 81621);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35480)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_USM_L_TIER3, 81628);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_USM_L_TIER3, 81628);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35445)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_NORDMAR_TIER3, 81627);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_NORDMAR_TIER3, 81627);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35516)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_WS_M_TIER3, 81629);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_WS_M_TIER3, 81629);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35618)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_GRD_M_TIER3, 81630);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_GRD_M_TIER3, 81630);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35452)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_ARX_R_TIER3, 81631);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_ARX_R_TIER3, 81631);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35466)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_ARX_B_TIER3, 81632);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_ARX_B_TIER3, 81632);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35455)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_ARX_W1_TIER3, 81633);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_ARX_W1_TIER3, 81633);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35460)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_ARX_W2_TIER3, 81634);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_ARX_W2_TIER3, 81634);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35471)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_ARX_H1_TIER3, 81635);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_ARX_H1_TIER3, 81635);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35476)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_ARX_H2_TIER3, 81636);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_ARX_H2_TIER3, 81636);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35483)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_MIL_R_TIER3, 81637);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_MIL_R_01_TIER3, 81637);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35489)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_MIL_B_TIER3, 81638);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_MIL_B_TIER3, 81638);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35502)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_MIL_W1_TIER3, 81639);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_MIL_W1_TIER3, 81639);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35507)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_MIL_W2_TIER3, 81640);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_MIL_W2_TIER3, 81640);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35494)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_MIL_C1_TIER3, 81641);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_MIL_C1_TIER3, 81641);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35499)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_MIL_C2_TIER3, 81642);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_MIL_C2_TIER3, 81642);
        };
    };
    if ((NPC_HASITEMS(OTHER, 35526)) >= (1)) {
        if ((SQ419_FREEUPGRADE) == (FALSE)) {
            INFO_ADDCHOICE(81588, ARMORSELLER_KNIGHT_TIER3, 81643);
        } else {
            INFO_ADDCHOICE(81588, NAMEARMOR_KNIGHTARMOR_TIER3, 81643);
        };
    };
    INFO_ADDCHOICE(81588, DIALOG_BACK, 81590);
}

func void DIA_EINAR_UPGRADEARMOR_CHAIN_L_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35399)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= (VALUE_ITAR_CHAIN_L)) && ((NPC_HASITEMS(OTHER, 35980)) >= (10))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35400, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35400, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            NPC_REMOVEINVITEMS(SELF, 35399, 1);
            AI_EQUIPARMOR(OTHER, 35400);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_CHAIN_M_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35404)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= (VALUE_ITAR_CHAIN_M)) && ((NPC_HASITEMS(OTHER, 35980)) >= (12))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            NPC_REMOVEINVITEMS(SELF, 35404, 1);
            CREATEINVITEMS(SELF, 35405, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35405, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            B_GIVEINVITEMS(OTHER, SELF, 35404, 1);
            AI_EQUIPARMOR(OTHER, 35405);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_CRAB_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35408)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= (VALUE_ITAR_CRAB)) && ((NPC_HASITEMS(OTHER, 35361)) >= (8))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35409, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35409, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            NPC_REMOVEINVITEMS(SELF, 35408, 1);
            AI_EQUIPARMOR(OTHER, 35409);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_LEATHER_L_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35415)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= (VALUE_ITAR_KM_LEATHER_L)) && ((NPC_HASITEMS(OTHER, 35360)) >= (2))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35416, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35416, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            NPC_REMOVEINVITEMS(SELF, 35415, 1);
            AI_EQUIPARMOR(OTHER, 35416);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_LEATHER_M_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35418)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= (VALUE_ITAR_KM_LEATHER_M)) && ((NPC_HASITEMS(OTHER, 35360)) >= (4))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35419, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35419, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            NPC_REMOVEINVITEMS(SELF, 35418, 1);
            AI_EQUIPARMOR(OTHER, 35419);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_HUNTER_L_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35423)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= (VALUE_ITAR_HUNTER_L)) && ((NPC_HASITEMS(OTHER, 33862)) >= (2))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35424, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35424, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            NPC_REMOVEINVITEMS(SELF, 35423, 1);
            AI_EQUIPARMOR(OTHER, 35424);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_STH_L_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35431)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= (VALUE_ITAR_STH_L)) && ((NPC_HASITEMS(OTHER, 33862)) >= (4))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35432, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35432, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            NPC_REMOVEINVITEMS(SELF, 35431, 1);
            AI_EQUIPARMOR(OTHER, 35432);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_STH_H_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35436)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= (VALUE_ITAR_STH_H)) && ((NPC_HASITEMS(OTHER, 33862)) >= (8))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35437, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35437, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            NPC_REMOVEINVITEMS(SELF, 35436, 1);
            AI_EQUIPARMOR(OTHER, 35437);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_NORDMAR_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35445)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= (VALUE_ITAR_NORDMAR)) && ((NPC_HASITEMS(OTHER, 34202)) >= (4))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35446, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35446, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            NPC_REMOVEINVITEMS(SELF, 35445, 1);
            AI_EQUIPARMOR(OTHER, 35446);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_USM_L_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35480)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= (VALUE_ITAR_USM_L)) && ((NPC_HASITEMS(OTHER, 35980)) >= (20))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35481, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35481, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            NPC_REMOVEINVITEMS(SELF, 35480, 1);
            AI_EQUIPARMOR(OTHER, 35481);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_WS_M_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35516)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= (VALUE_ITAR_WS_M)) && ((NPC_HASITEMS(OTHER, 36939)) >= (16))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35517, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35517, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            NPC_REMOVEINVITEMS(SELF, 35516, 1);
            AI_EQUIPARMOR(OTHER, 35517);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_GRD_M_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35618)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= (VALUE_ITAR_GRD_M)) && ((NPC_HASITEMS(OTHER, 33660)) >= (40))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35619, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35619, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            NPC_REMOVEINVITEMS(SELF, 35618, 1);
            AI_EQUIPARMOR(OTHER, 35619);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_ARX_R_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35452)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= (VALUE_ITAR_ARX_R)) && ((NPC_HASITEMS(OTHER, 35980)) >= (10))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35453, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35453, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            NPC_REMOVEINVITEMS(SELF, 35452, 1);
            AI_EQUIPARMOR(OTHER, 35453);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_ARX_B_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35466)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= (VALUE_ITAR_ARX_B)) && ((NPC_HASITEMS(OTHER, 35360)) >= (6))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35467, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35467, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            NPC_REMOVEINVITEMS(SELF, 35466, 1);
            AI_EQUIPARMOR(OTHER, 35467);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_ARX_W1_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35455)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= (VALUE_ITAR_ARX_W1)) && ((NPC_HASITEMS(OTHER, 35980)) >= (40))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35456, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35456, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            NPC_REMOVEINVITEMS(SELF, 35455, 1);
            AI_EQUIPARMOR(OTHER, 35456);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_ARX_W2_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35460)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= (VALUE_ITAR_ARX_W2)) && ((NPC_HASITEMS(OTHER, 36939)) >= (10))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35461, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35461, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            NPC_REMOVEINVITEMS(SELF, 35460, 1);
            AI_EQUIPARMOR(OTHER, 35461);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_ARX_H1_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35471)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= (VALUE_ITAR_ARX_H1)) && ((NPC_HASITEMS(OTHER, 35361)) >= (8))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35472, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35472, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            NPC_REMOVEINVITEMS(SELF, 35471, 1);
            AI_EQUIPARMOR(OTHER, 35472);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_ARX_H2_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35476)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= (VALUE_ITAR_ARX_H2)) && ((NPC_HASITEMS(OTHER, 33862)) >= (12))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35477, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35477, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            NPC_REMOVEINVITEMS(SELF, 35476, 1);
            AI_EQUIPARMOR(OTHER, 35477);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_MIL_R_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35483)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= (VALUE_ITAR_MIL_R)) && ((NPC_HASITEMS(OTHER, 35980)) >= (10))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35484, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35484, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            NPC_REMOVEINVITEMS(SELF, 35483, 1);
            AI_EQUIPARMOR(OTHER, 35484);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_MIL_B_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35489)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= (VALUE_ITAR_MIL_B)) && ((NPC_HASITEMS(OTHER, 35360)) >= (6))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35490, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35490, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            NPC_REMOVEINVITEMS(SELF, 35489, 1);
            AI_EQUIPARMOR(OTHER, 35490);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_MIL_W1_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35502)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= (VALUE_ITAR_MIL_W1)) && ((NPC_HASITEMS(OTHER, 35980)) >= (40))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35503, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35503, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            NPC_REMOVEINVITEMS(SELF, 35502, 1);
            AI_EQUIPARMOR(OTHER, 35503);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_MIL_W2_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35507)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= (VALUE_ITAR_MIL_W2)) && ((NPC_HASITEMS(OTHER, 36939)) >= (20))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35508, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35508, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            NPC_REMOVEINVITEMS(SELF, 35507, 1);
            AI_EQUIPARMOR(OTHER, 35508);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_MIL_C1_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35494)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= (VALUE_ITAR_MIL_C1)) && ((NPC_HASITEMS(OTHER, 33862)) >= (8))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35495, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35495, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            NPC_REMOVEINVITEMS(SELF, 35494, 1);
            AI_EQUIPARMOR(OTHER, 35495);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_MIL_C2_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35499)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= (VALUE_ITAR_MIL_C2)) && ((NPC_HASITEMS(OTHER, 35361)) >= (12))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35500, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35500, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            NPC_REMOVEINVITEMS(SELF, 35499, 1);
            AI_EQUIPARMOR(OTHER, 35500);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

func void DIA_EINAR_UPGRADEARMOR_KNIGHT_TIER3() {
    if ((NPC_HASITEMS(OTHER, 35526)) >= (1)) {
        if ((((NPC_HASITEMS(OTHER, 34203)) >= ((VALUE_ITAR_KNIGHTARMOR) / (2))) && ((NPC_HASITEMS(OTHER, 35980)) >= (40))) || ((SQ419_FREEUPGRADE) == (TRUE))) {
            if ((SQ419_FREEUPGRADE) == (FALSE)) {
            } else {
                SQ419_FREEUPGRADE = FALSE;
            };
            PRINTSCREEN(PRINT_EINARFREE, -(1), -(1), FONT_SCREEN, 3);
            CREATEINVITEMS(SELF, 35527, 1);
            B_GIVEINVITEMS(SELF, OTHER, 35527, 1);
            B_GIVEPLAYERXP(XP_ARMORUPGRADE_TIER3);
            NPC_REMOVEINVITEMS(SELF, 35526, 1);
            AI_EQUIPARMOR(OTHER, 35527);
        } else {
            B_SAY(SELF, OTHER, "$NOITEMS");
        };
    };
    DIA_EINAR_UPGRADEARMOR_TIER3_CHOICES();
}

instance DIA_EINAR_PICKPOCKET(C_INFO) {
    NPC = 58256;
    NR = 900;
    CONDITION = DIA_EINAR_PICKPOCKET_CONDITION;
    INFORMATION = DIA_EINAR_PICKPOCKET_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = PICKPOCKET_80;
}

func int DIA_EINAR_PICKPOCKET_CONDITION() {
    if (((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_PICKPOCKET)) >= (1)) && ((SELF.AIVAR[6]) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_EINAR_PICKPOCKET_INFO() {
    INFO_CLEARCHOICES(81644);
    INFO_ADDCHOICE(81644, DIALOG_BACK, 81648);
    INFO_ADDCHOICE(81644, DIALOG_PICKPOCKET, 81647);
}

func void DIA_EINAR_PICKPOCKET_DOIT() {
    if ((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_PICKPOCKET)) >= (2)) {
        CREATEINVITEMS(SELF, 36939, 2);
        B_GIVEINVITEMS(SELF, OTHER, 36939, 2);
        B_PICKPOCKET_AMBIENT_TIER_2();
        SELF.AIVAR[6] = TRUE;
        INFO_CLEARCHOICES(81644);
    };
    AI_PLAYANI(HERO, T_CANNOTTAKE);
    PRINTSCREEN(PRINT_CANTPICKPOCKETTHISPERSON, -(1), -(1), FONT_SCREEN, 4);
    INFO_CLEARCHOICES(81644);
}

func void DIA_EINAR_PICKPOCKET_BACK() {
    INFO_CLEARCHOICES(81644);
}

instance DIA_EINAR_SELLPLATE(C_INFO) {
    NPC = 58256;
    NR = 770;
    CONDITION = DIA_EINAR_SELLPLATE_CONDITION;
    INFORMATION = DIA_EINAR_SELLPLATE_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "I have everything you need. (Sell the minecrawler armor plates)";
}

var int EINARNEEDPLATE_ENOUGH;
var int EINARNEEDPLATE_COUNT;
func int DIA_EINAR_SELLPLATE_CONDITION() {
    if (((EINARWANTSPLATE) == (TRUE)) && ((EINARNEEDPLATE_ENOUGH) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

var int EINAR_PLATEINSTANCE;
var int EINAR_PLATEVALUE;
func void DIA_EINAR_SELLPLATE_CHOICES() {
    var string ALL_STRING;
    var int MAX;
    EINAR_PLATEINSTANCE = 33862;
    EINAR_PLATEVALUE = VALUE_CRAWLERPLATE;
    INFO_CLEARCHOICES(81649);
    MAX = NPC_HASITEMS(HERO, EINAR_PLATEINSTANCE);
    ALL_STRING = CS4(DIALOG_ALL, " (", I2S(MAX), ")");
    INFO_ADDCHOICE(81649, ALL_STRING, 81660);
    INFO_ADDCHOICE(81649, CHOICE_NUMBER_5, 81662);
    INFO_ADDCHOICE(81649, CHOICE_NUMBER_1, 81664);
    INFO_ADDCHOICE(81649, DIALOG_BACK, 81659);
}

func void DIA_EINAR_SELLPLATE_INFO() {
    B_SAY(OTHER, SELF, "$MARVIN_GiveItem3");
    DIA_EINAR_SELLPLATE_CHOICES();
}

func void DIA_EINAR_SELLPLATE_BACK() {
    EINAR_PLATEINSTANCE = -(1);
    EINAR_PLATEVALUE = 0;
    INFO_CLEARCHOICES(81649);
}

func void DIA_EINAR_SELLPLATE_ALL() {
    var int MAX;
    if ((NPC_HASITEMS(OTHER, EINAR_PLATEINSTANCE)) >= (1)) {
        MAX = NPC_HASITEMS(HERO, EINAR_PLATEINSTANCE);
        B_GIVEINVITEMS(OTHER, SELF, EINAR_PLATEINSTANCE, MAX);
        CREATEINVITEMS(SELF, 34203, ((MAX) * (EINAR_PLATEVALUE)) / (2));
        B_GIVEINVITEMS(SELF, OTHER, 34203, ((MAX) * (EINAR_PLATEVALUE)) / (2));
        AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
        B_SAY(SELF, OTHER, "$REWARD_CALM");
        AI_RESETFACEANI(SELF);
        if ((EINAR_PLATEINSTANCE) == (33862)) {
            EINARNEEDPLATE_COUNT = (EINARNEEDPLATE_COUNT) + (MAX);
            if ((EINARNEEDPLATE_COUNT) >= (20)) {
                EINARNEEDPLATE_ENOUGH = TRUE;
                if ((EINARNEEDPLATE_COUNT) > (20)) {
                    AI_FUNCTION(SELF, 81665);
                };
            };
        };
        if (((EINAR_PLATEINSTANCE) == (33862)) && ((EINARNEEDPLATE_ENOUGH) == (FALSE))) {
            DIA_EINAR_SELLPLATE_CHOICES();
        } else {
            DIA_EINAR_SELLPLATE_BACK();
        };
    };
    DIA_EINAR_SELLPLATE_BACK();
    B_SAY(SELF, OTHER, "$NOITEMS");
}

func void DIA_EINAR_SELLPLATE_5() {
    var int MAX;
    if ((NPC_HASITEMS(OTHER, EINAR_PLATEINSTANCE)) >= (5)) {
        B_GIVEINVITEMS(OTHER, SELF, EINAR_PLATEINSTANCE, 5);
        AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
        B_SAY(SELF, OTHER, "$REWARD_CALM");
        AI_RESETFACEANI(SELF);
        CREATEINVITEMS(SELF, 34203, ((5) * (EINAR_PLATEVALUE)) / (2));
        if ((EINAR_PLATEINSTANCE) == (33862)) {
            EINARNEEDPLATE_COUNT = (EINARNEEDPLATE_COUNT) + (5);
            if ((EINARNEEDPLATE_COUNT) >= (20)) {
                EINARNEEDPLATE_ENOUGH = TRUE;
                if ((EINARNEEDPLATE_COUNT) > (20)) {
                    AI_FUNCTION(SELF, 81665);
                };
            };
        };
        if (((EINAR_PLATEINSTANCE) == (33862)) && ((EINARNEEDPLATE_ENOUGH) == (FALSE))) {
            DIA_EINAR_SELLPLATE_CHOICES();
        } else {
            DIA_EINAR_SELLPLATE_BACK();
        };
    };
    if (((NPC_HASITEMS(OTHER, EINAR_PLATEINSTANCE)) >= (1)) && ((NPC_HASITEMS(OTHER, EINAR_PLATEINSTANCE)) < (5))) {
        MAX = NPC_HASITEMS(HERO, EINAR_PLATEINSTANCE);
        B_GIVEINVITEMS(OTHER, SELF, EINAR_PLATEINSTANCE, MAX);
        AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
        B_SAY(SELF, OTHER, "$REWARD_CALM");
        AI_RESETFACEANI(SELF);
        CREATEINVITEMS(SELF, 34203, ((MAX) * (EINAR_PLATEVALUE)) / (2));
        if ((EINAR_PLATEINSTANCE) == (33862)) {
            EINARNEEDPLATE_COUNT = (EINARNEEDPLATE_COUNT) + (MAX);
            if ((EINARNEEDPLATE_COUNT) >= (20)) {
                EINARNEEDPLATE_ENOUGH = TRUE;
                if ((EINARNEEDPLATE_COUNT) > (20)) {
                    AI_FUNCTION(SELF, 81665);
                };
            };
        };
        if (((EINAR_PLATEINSTANCE) == (33862)) && ((EINARNEEDPLATE_ENOUGH) == (FALSE))) {
            DIA_EINAR_SELLPLATE_CHOICES();
        } else {
            DIA_EINAR_SELLPLATE_BACK();
        };
    };
    if ((NPC_HASITEMS(OTHER, EINAR_PLATEINSTANCE)) == (0)) {
        DIA_EINAR_SELLPLATE_BACK();
        B_SAY(SELF, OTHER, "$NOITEMS");
    };
}

func void DIA_EINAR_SELLPLATE_1() {
    if ((NPC_HASITEMS(OTHER, EINAR_PLATEINSTANCE)) >= (1)) {
        B_GIVEINVITEMS(OTHER, SELF, EINAR_PLATEINSTANCE, 1);
        AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
        B_SAY(SELF, OTHER, "$REWARD_CALM");
        AI_RESETFACEANI(SELF);
        CREATEINVITEMS(SELF, 34203, (EINAR_PLATEVALUE) / (2));
        if ((EINAR_PLATEINSTANCE) == (33862)) {
            EINARNEEDPLATE_COUNT = (EINARNEEDPLATE_COUNT) + (1);
            if ((EINARNEEDPLATE_COUNT) >= (20)) {
                EINARNEEDPLATE_ENOUGH = TRUE;
                if ((EINARNEEDPLATE_COUNT) > (20)) {
                    AI_FUNCTION(SELF, 81665);
                };
            };
        };
        if (((EINAR_PLATEINSTANCE) == (33862)) && ((EINARNEEDPLATE_ENOUGH) == (FALSE))) {
            DIA_EINAR_SELLPLATE_CHOICES();
        } else {
            DIA_EINAR_SELLPLATE_BACK();
        };
    };
    if ((NPC_HASITEMS(OTHER, EINAR_PLATEINSTANCE)) == (0)) {
        DIA_EINAR_SELLPLATE_BACK();
        B_SAY(SELF, OTHER, "$NOITEMS");
    };
}

func void EINAR_GIVEBACKSTUFF_PLATE() {
    NPC_REMOVEINVITEMS(DJG_10004_EINAR, 34203, ((VALUE_CRAWLERPLATE) / (2)) * ((EINARNEEDPLATE_COUNT) - (20)));
    PRINTSCREENS(PRINT_EINARPLATE, -(1), -(1), FONT_SCREENSMALL, 4);
    B_GIVEINVITEMS(HERO, DJG_10004_EINAR, 34203, ((VALUE_CRAWLERPLATE) / (2)) * ((EINARNEEDPLATE_COUNT) - (20)));
}

