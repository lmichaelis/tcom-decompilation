var int DUNCAN_SQ122_TAKEQUEST;
instance DIA_DUNCAN_EXIT(C_INFO) {
    NPC = 55531;
    NR = 999;
    CONDITION = DIA_DUNCAN_EXIT_CONDITION;
    INFORMATION = DIA_DUNCAN_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_DUNCAN_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_DUNCAN_EXIT_INFO() {
    if ((DUNCAN_SQ122_TAKEQUEST) == (TRUE)) {
        DUNCAN_SQ122_TAKEQUEST = FALSE;
        AI_OUTPUT(SELF, OTHER, "DIA_Duncan_SQ122_Help_03_01");
        AI_STARTFACEANI(SELF, S_TIRED, 1, -(1));
        AI_OUTPUT(SELF, OTHER, "DIA_Duncan_SQ122_Help_03_02");
        AI_STARTFACEANI(SELF, S_THINK, 1, -(1));
        AI_OUTPUT(SELF, OTHER, "DIA_Duncan_SQ122_Help_03_03");
        AI_RESETFACEANI(SELF);
        AI_OUTPUT(SELF, OTHER, "DIA_Duncan_SQ122_Help_03_04");
        AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
        AI_OUTPUT(SELF, OTHER, "DIA_Duncan_SQ122_Help_03_05");
        AI_RESETFACEANI(SELF);
        LOG_CREATETOPIC(TOPIC_SQ122, LOG_MISSION);
        LOG_SETSTATUS(_@(MIS_SQ122), TOPIC_SQ122, LOG_RUNNING);
        AI_LOGENTRY(TOPIC_SQ122, LOG_SQ122_START);
    };
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_DUNCAN_AMBIENT(C_INFO) {
    NPC = 55531;
    NR = 1;
    CONDITION = DIA_DUNCAN_AMBIENT_CONDITION;
    INFORMATION = DIA_DUNCAN_AMBIENT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "How are you doing?";
}

func int DIA_DUNCAN_AMBIENT_CONDITION() {
    return TRUE;
}

func void DIA_DUNCAN_AMBIENT_INFO() {
    NPC_INITAMBIENTS(SELF, 3);
    AI_OUTPUT(OTHER, SELF, "DIA_Duncan_AMBIENT_15_01");
    if ((NPC_GETLASTAMBIENT(SELF)) == (1)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Duncan_AMBIENT_03_02");
    };
    if ((NPC_GETLASTAMBIENT(SELF)) == (2)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Duncan_AMBIENT_03_03");
        AI_OUTPUT(SELF, OTHER, "DIA_Duncan_AMBIENT_03_04");
    };
    if ((NPC_GETLASTAMBIENT(SELF)) == (3)) {
        if ((LOG_GETSTATUS(MIS_Q206)) == (LOG_SUCCESS)) {
            AI_OUTPUT(SELF, OTHER, "DIA_Duncan_AMBIENT_03_05");
            AI_OUTPUT(SELF, OTHER, "DIA_Duncan_AMBIENT_03_06");
        } else {
            AI_OUTPUT(SELF, OTHER, "DIA_Duncan_AMBIENT_03_07");
            AI_OUTPUT(SELF, OTHER, "DIA_Duncan_AMBIENT_03_08");
        };
    };
}

instance DIA_DUNCAN_PQ108_QUESTION(C_INFO) {
    NPC = 55531;
    NR = 1;
    CONDITION = DIA_DUNCAN_PQ108_QUESTION_CONDITION;
    INFORMATION = DIA_DUNCAN_PQ108_QUESTION_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Have you seen a guy hunting trolls?";
}

func int DIA_DUNCAN_PQ108_QUESTION_CONDITION() {
    if ((LOG_GETSTATUS(MIS_PQ108)) == (LOG_RUNNING)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DUNCAN_PQ108_QUESTION_INFO() {
    AI_STARTFACEANI(SELF, S_TIRED, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Duncan_PQ108_Question_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Duncan_PQ108_Question_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Duncan_PQ108_Question_03_03");
    AI_LOGENTRY(TOPIC_PQ108, LOG_PQ108_WANDERER);
}

instance DIA_DUNCAN_SQ122_START(C_INFO) {
    NPC = 55531;
    NR = 1;
    CONDITION = DIA_DUNCAN_SQ122_START_CONDITION;
    INFORMATION = DIA_DUNCAN_SQ122_START_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Don't you need something?";
}

func int DIA_DUNCAN_SQ122_START_CONDITION() {
    return TRUE;
}

func void DIA_DUNCAN_SQ122_START_INFO() {
    DUNCAN_SQ122_TAKEQUEST = TRUE;
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Duncan_SQ122_Start_15_01");
    AI_STARTFACEANI(SELF, S_WHAT, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Duncan_SQ122_Start_03_02");
    AI_RESETFACEANI(OTHER);
    AI_OUTPUT(OTHER, SELF, "DIA_Duncan_SQ122_Start_15_03");
    AI_STARTFACEANI(SELF, S_DOUBT, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Duncan_SQ122_Start_03_04");
    AI_RESETFACEANI(SELF);
}

instance DIA_DUNCAN_SQ122_FINISH(C_INFO) {
    NPC = 55531;
    NR = 1;
    CONDITION = DIA_DUNCAN_SQ122_FINISH_CONDITION;
    INFORMATION = DIA_DUNCAN_SQ122_FINISH_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "I have your net.";
}

func int DIA_DUNCAN_SQ122_FINISH_CONDITION() {
    if (((LOG_GETSTATUS(MIS_SQ122)) == (LOG_RUNNING)) && ((NPC_HASITEMS(OTHER, 37010)) >= (1))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DUNCAN_SQ122_FINISH_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Duncan_SQ122_Finish_15_01");
    AI_STARTFACEANI(SELF, S_TIRED, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Duncan_SQ122_Finish_03_02");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Duncan_SQ122_Finish_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Duncan_SQ122_Finish_03_04");
    AI_RESETFACEANI(SELF);
    B_GIVEINVITEMS(OTHER, SELF, 37010, 1);
    CREATEINVITEMS(SELF, 38259, 12);
    B_GIVEINVITEMS(SELF, OTHER, 38259, 12);
    CREATEINVITEMS(SELF, 33650, 4);
    B_GIVEINVITEMS(SELF, OTHER, 33650, 4);
    CREATEINVITEMS(SELF, 33661, 1);
    B_GIVEINVITEMS(SELF, OTHER, 33661, 1);
    AI_LOGENTRY(TOPIC_SQ122, LOG_SQ122_FINISH);
    LOG_SETSTATUS(_@(MIS_SQ122), TOPIC_SQ122, LOG_SUCCESS);
    B_GIVEPLAYERXP(XP_SQ122_FINISH);
}

instance DIA_DUNCAN_SQ122_WARANS(C_INFO) {
    NPC = 55531;
    NR = 1;
    CONDITION = DIA_DUNCAN_SQ122_WARANS_CONDITION;
    INFORMATION = DIA_DUNCAN_SQ122_WARANS_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "By the way, I got rid of those red lizards.";
}

func int DIA_DUNCAN_SQ122_WARANS_CONDITION() {
    if ((LOG_GETSTATUS(MIS_SQ122)) == (LOG_SUCCESS)) {
        if ((NPC_ISDEAD(FIREWARAN_SQ122_01)) && (NPC_ISDEAD(FIREWARAN_SQ122_02))) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_DUNCAN_SQ122_WARANS_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Duncan_SQ122_Warans_15_01");
    AI_STARTFACEANI(SELF, S_SURPRISE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Duncan_SQ122_Warans_03_02");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Duncan_SQ122_Warans_03_03");
    B_GIVEPLAYERXP(XP_SQ122_BONUS);
    AI_RESETFACEANI(SELF);
}

