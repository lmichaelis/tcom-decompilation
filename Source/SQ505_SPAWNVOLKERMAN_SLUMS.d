func void SQ505_SPAWNVOLKERMAN_SLUMS() {
    WLD_INSERTNPC(55386, RNG_NS26_WAYPOINT);
    WLD_INSERTNPC(55389, "SLUMS_VOLKERSPEECH_02");
    WLD_INSERTNPC(55392, "SLUMS_VOLKERSPEECH_03");
    WLD_INSERTNPC(55395, "SLUMS_VOLKERLISTENER_01");
    WLD_INSERTNPC(55398, "SLUMS_VOLKERLISTENER_02");
    WLD_INSERTNPC(55401, "SLUMS_VOLKERLISTENER_03");
    WLD_INSERTNPC(55404, "SLUMS_VOLKERLISTENER_04");
}

func void SQ505_CHANGERTNVOLKERMAN_SLUMS() {
    B_STARTOTHERROUTINE(NONE_13383_VOLKERGUARD, START);
    B_STARTOTHERROUTINE(NONE_13384_VOLKERGUARD, START);
    B_STARTOTHERROUTINE(NONE_13385_VOLKERGUARD, START);
    B_STARTOTHERROUTINE(NONE_13387_HOBO, START);
    B_STARTOTHERROUTINE(NONE_13388_HOBO, START);
    B_STARTOTHERROUTINE(NONE_13389_HOBO, START);
    B_STARTOTHERROUTINE(NONE_13390_HOBO, START);
}

func void SQ505_REMOVEVOLKERMAN_SLUMS() {
    NPC_EXCHANGEROUTINE(NONE_13383_VOLKERGUARD, TOT);
    NPC_EXCHANGEROUTINE(NONE_13384_VOLKERGUARD, TOT);
    NPC_EXCHANGEROUTINE(NONE_13385_VOLKERGUARD, TOT);
    NPC_EXCHANGEROUTINE(NONE_13387_HOBO, TOT);
    NPC_EXCHANGEROUTINE(NONE_13388_HOBO, TOT);
    NPC_EXCHANGEROUTINE(NONE_13389_HOBO, TOT);
    NPC_EXCHANGEROUTINE(NONE_13390_HOBO, TOT);
    NPC_REFRESH(NONE_13383_VOLKERGUARD);
    NPC_REFRESH(NONE_13384_VOLKERGUARD);
    NPC_REFRESH(NONE_13385_VOLKERGUARD);
    NPC_REFRESH(NONE_13387_HOBO);
    NPC_REFRESH(NONE_13388_HOBO);
    NPC_REFRESH(NONE_13389_HOBO);
    NPC_REFRESH(NONE_13390_HOBO);
}

func void SQ505_SPAWNVOLKERMAN_M7() {
    WLD_INSERTNPC(55407, RNG_NS27_WAYPOINT);
    if ((LOG_GETSTATUS(MIS_SQ505)) != (LOG_RUNNING)) {
        WLD_INSERTNPC(55410, "SLUMS_VOLKERSPEECH02_02");
        WLD_INSERTNPC(55413, "SLUMS_VOLKERSPEECH02_03");
    };
    WLD_INSERTNPC(54922, "SLUMS_VOLKERLISTENER02_01");
    WLD_INSERTNPC(54925, "SLUMS_VOLKERLISTENER02_02");
    WLD_INSERTNPC(54928, "SLUMS_VOLKERLISTENER02_03");
    WLD_INSERTNPC(54931, "SLUMS_VOLKERLISTENER02_04");
}

func void SQ505_CHANGERTNVOLKERMAN_M7() {
    B_STARTOTHERROUTINE(NONE_13391_VOLKERGUARD, START);
    if ((LOG_GETSTATUS(MIS_SQ505)) != (LOG_RUNNING)) {
        B_STARTOTHERROUTINE(NONE_13392_VOLKERGUARD, START);
        B_STARTOTHERROUTINE(NONE_13393_VOLKERGUARD, START);
    };
    B_REMOVENPC(55410);
    B_REMOVENPC(55413);
    B_STARTOTHERROUTINE(NONE_13392_VOLKERGUARD, START);
    B_STARTOTHERROUTINE(NONE_13393_VOLKERGUARD, START);
    B_STARTOTHERROUTINE(VLK_13394_CITIZEN, START);
    B_STARTOTHERROUTINE(VLK_13395_CITIZEN, START);
    B_STARTOTHERROUTINE(VLK_13396_CITIZEN, START);
    B_STARTOTHERROUTINE(VLK_13397_CITIZEN, START);
}

func void SQ505_REMOVEVOLKERMAN_M7() {
    NPC_EXCHANGEROUTINE(NONE_13391_VOLKERGUARD, TOT);
    NPC_REFRESH(NONE_13391_VOLKERGUARD);
    if ((LOG_GETSTATUS(MIS_SQ505)) != (LOG_RUNNING)) {
        NPC_EXCHANGEROUTINE(NONE_13392_VOLKERGUARD, TOT);
        NPC_EXCHANGEROUTINE(NONE_13393_VOLKERGUARD, TOT);
        NPC_REFRESH(NONE_13392_VOLKERGUARD);
        NPC_REFRESH(NONE_13393_VOLKERGUARD);
    };
    B_REMOVENPC(55410);
    B_REMOVENPC(55413);
    if (NPC_ISINSTATE(VLK_13394_CITIZEN, 61599)) {
        NPC_EXCHANGEROUTINE(VLK_13394_CITIZEN, TOT);
    };
    B_STARTOTHERROUTINE(VLK_13394_CITIZEN, TOT);
    NPC_REFRESH(VLK_13394_CITIZEN);
    if (NPC_ISINSTATE(VLK_13395_CITIZEN, 61599)) {
        NPC_EXCHANGEROUTINE(VLK_13395_CITIZEN, TOT);
    };
    B_STARTOTHERROUTINE(VLK_13395_CITIZEN, TOT);
    NPC_REFRESH(VLK_13395_CITIZEN);
    if (NPC_ISINSTATE(VLK_13396_CITIZEN, 61599)) {
        NPC_EXCHANGEROUTINE(VLK_13396_CITIZEN, TOT);
    };
    B_STARTOTHERROUTINE(VLK_13396_CITIZEN, TOT);
    NPC_REFRESH(VLK_13396_CITIZEN);
    if (NPC_ISINSTATE(VLK_13397_CITIZEN, 61599)) {
        NPC_EXCHANGEROUTINE(VLK_13397_CITIZEN, TOT);
    };
    B_STARTOTHERROUTINE(VLK_13397_CITIZEN, TOT);
    NPC_REFRESH(VLK_13397_CITIZEN);
}

func void SQ505_SPAWNVOLKERMAN_M3() {
    WLD_INSERTNPC(53092, RNG_NS28_WAYPOINT);
    WLD_INSERTNPC(53095, "PARTM3_PATH_139");
    WLD_INSERTNPC(53098, "PARTM3_PATH_138");
    WLD_INSERTNPC(53118, "PARTM3_VOLKERLISTENER01");
    WLD_INSERTNPC(53126, "PARTM3_VOLKERLISTENER02");
    WLD_INSERTNPC(53122, "PARTM3_VOLKERLISTENER03");
    WLD_INSERTNPC(53130, "PARTM3_VOLKERLISTENER04");
}

func void SQ505_CHANGERTNVOLKERMAN_M3() {
    B_STARTOTHERROUTINE(NONE_13398_VOLKERGUARD, START);
    B_STARTOTHERROUTINE(NONE_13399_VOLKERGUARD, START);
    B_STARTOTHERROUTINE(NONE_13400_VOLKERGUARD, START);
    B_STARTOTHERROUTINE(VLK_13401_CITIZEN, START);
    B_STARTOTHERROUTINE(VLK_13402_CITIZEN, START);
    B_STARTOTHERROUTINE(VLK_13403_CITIZEN, START);
    B_STARTOTHERROUTINE(VLK_13404_CITIZEN, START);
}

func void SQ505_REMOVEVOLKERMAN_M3() {
    NPC_EXCHANGEROUTINE(NONE_13398_VOLKERGUARD, TOT);
    NPC_EXCHANGEROUTINE(NONE_13399_VOLKERGUARD, TOT);
    NPC_EXCHANGEROUTINE(NONE_13400_VOLKERGUARD, TOT);
    NPC_EXCHANGEROUTINE(VLK_13401_CITIZEN, TOT);
    NPC_EXCHANGEROUTINE(VLK_13402_CITIZEN, TOT);
    NPC_EXCHANGEROUTINE(VLK_13403_CITIZEN, TOT);
    NPC_EXCHANGEROUTINE(VLK_13404_CITIZEN, TOT);
    NPC_REFRESH(NONE_13398_VOLKERGUARD);
    NPC_REFRESH(NONE_13399_VOLKERGUARD);
    NPC_REFRESH(NONE_13400_VOLKERGUARD);
    NPC_REFRESH(VLK_13401_CITIZEN);
    NPC_REFRESH(VLK_13402_CITIZEN);
    NPC_REFRESH(VLK_13403_CITIZEN);
    NPC_REFRESH(VLK_13404_CITIZEN);
}

func void SQ505_ANGRYMOB_M3() {
    B_STARTOTHERROUTINE(VLK_13401_CITIZEN, "SQ505_ANGRYMOB");
    B_STARTOTHERROUTINE(VLK_13402_CITIZEN, "SQ505_ANGRYMOB");
    B_STARTOTHERROUTINE(VLK_13403_CITIZEN, "SQ505_ANGRYMOB");
    B_STARTOTHERROUTINE(VLK_13404_CITIZEN, "SQ505_ANGRYMOB");
}

func void SQ505_PREPARENPC() {
    PRINTD("Ludzie Volkera przybyli");
    if ((NS26_DESPAWNED) == (TRUE)) {
        SQ505_CHANGERTNVOLKERMAN_SLUMS();
    };
    if ((NS26_SPAWNED) == (FALSE)) {
        SQ505_SPAWNVOLKERMAN_SLUMS();
    };
    if ((NS27_DESPAWNED) == (TRUE)) {
        SQ505_CHANGERTNVOLKERMAN_M7();
    };
    if ((NS27_SPAWNED) == (FALSE)) {
        SQ505_SPAWNVOLKERMAN_M7();
    };
    B_REMOVENPC(55410);
    B_REMOVENPC(55413);
    if ((NS28_DESPAWNED) == (TRUE)) {
        SQ505_CHANGERTNVOLKERMAN_M3();
    };
    if ((NS28_SPAWNED) == (FALSE)) {
        SQ505_SPAWNVOLKERMAN_M3();
    };
    B_STARTOTHERROUTINE(MIL_4001_OKTAV, "SQ505_BRIDGE");
    SQ505_OKTAV_RTNCHECK = 1;
    NPC_REFRESH(MIL_4001_OKTAV);
    WLD_INSERTNPC(54826, "SLUMS_PATH_56A");
}

func void SQ505_PREPAREVOBS_APPLY() {
    var int MOVPTR4;
    var ZCMOVER MOVER2;
    var ZCMOVER MOVER4;
    var int MOVPTR2;
    var ZCMOVER MOVER3;
    var int MOVPTR3;
    var ZCMOVER MOVER1;
    var int MOVPTR1;
    var int SQ505_PREPAREVOBS_COUNT;
    if ((SQ505_PREPAREVOBS_COUNT) == (0)) {
        PRINTD("Rozpoczynam - SQ505_PrepareVobs_Apply");
        MOVPTR1 = MEM_SEARCHVOBBYNAME("SQ505_MOVER_VOLKERCHEST");
        MOVER1 = MEM_PTRTOINST(MOVPTR1);
        MOVPTR2 = MEM_SEARCHVOBBYNAME("SQ505_MOVER_BARREL_01");
        MOVER2 = MEM_PTRTOINST(MOVPTR2);
        MOVPTR3 = MEM_SEARCHVOBBYNAME("SQ505_MOVER_BARREL_02");
        MOVER3 = MEM_PTRTOINST(MOVPTR3);
        MOVPTR4 = MEM_SEARCHVOBBYNAME("SQ505_MOVER_BARREL_03");
        MOVER4 = MEM_PTRTOINST(MOVPTR4);
        CHANGEVOBCOLLISION("SQ505_VOLKERCHEST", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("SQ505_BARREL_01", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("SQ505_BARREL_02", FALSE, FALSE, FALSE, TRUE);
        CHANGEVOBCOLLISION("SQ505_BARREL_03", FALSE, FALSE, FALSE, TRUE);
        WLD_SENDTRIGGER("SQ505_MOVER_VOLKERCHEST");
        WLD_SENDTRIGGER("SQ505_MOVER_BARREL_01");
        WLD_SENDTRIGGER("SQ505_MOVER_BARREL_02");
        WLD_SENDTRIGGER("SQ505_MOVER_BARREL_03");
        SQ505_PREPAREVOBS_COUNT = 1;
    };
    if (((((((((MOVER1.MOVERSTATE) != (MOVER_STATE_OPENING)) && ((MOVER1.MOVERSTATE) != (MOVER_STATE_CLOSING))) && ((MOVER2.MOVERSTATE) != (MOVER_STATE_OPENING))) && ((MOVER2.MOVERSTATE) != (MOVER_STATE_CLOSING))) && ((MOVER3.MOVERSTATE) != (MOVER_STATE_OPENING))) && ((MOVER3.MOVERSTATE) != (MOVER_STATE_CLOSING))) && ((MOVER4.MOVERSTATE) != (MOVER_STATE_OPENING))) && ((MOVER4.MOVERSTATE) != (MOVER_STATE_CLOSING))) {
        PRINTD("Skoñczy³em - SQ505_PrepareVobs_Apply");
        CHANGEVOBCOLLISION("SQ505_VOLKERCHEST", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("SQ505_BARREL_01", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("SQ505_BARREL_02", TRUE, TRUE, TRUE, TRUE);
        CHANGEVOBCOLLISION("SQ505_BARREL_03", TRUE, TRUE, TRUE, TRUE);
        FF_REMOVE(32243);
        SQ505_PREPAREVOBS_COUNT = 0;
    };
}

func void SQ505_REMOVEVOLKERGUARDGROUP() {
    SQ505_REMOVEDVOLKERGUARDS_COUNT = (SQ505_REMOVEDVOLKERGUARDS_COUNT) + (1);
    PRINTD(CS2("Usuniête grupy: ", INTTOSTRING(SQ505_REMOVEDVOLKERGUARDS_COUNT)));
    if ((SQ505_REMOVEDVOLKERGUARDS_COUNT) == (3)) {
        B_LOGENTRY(TOPIC_SQ505, LOG_SQ505_VOLKERGUARD_ALLGONE);
    };
}

func int SQ505_VOLKERGUARDSAREDEAD() {
    if (NPC_ISDEAD(NONE_13391_VOLKERGUARD)) {
        return TRUE;
    };
    return FALSE;
}

func void SQ505_VOLKERGUARDS_M3_WAIT() {
    PRINTD("Czekanko");
    SQ505_WAITVOLKERGUARD_M3 = 1;
    SQ505_WAITVOLKERGUARD_M3_DAY = WLD_GETDAY();
}

