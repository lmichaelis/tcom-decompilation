const string BOSSUI_FONT = "font_old_20_white.tga";
instance BOSSBAR(BAR) {
    X = (PRINT_SCREEN[0]) / (2);
    Y = 20;
    BARTOP = 42;
    BARLEFT = 34;
    WIDTH = 800;
    HEIGHT = 100;
    BACKTEX = "bossbar_bg.tga";
    BARTEX = "bossbar.tga";
    VALUE = 100;
    VALUEMAX = 100;
}

var int BOSSUI;
var int BOSS_BAR;
var int BOSSNAMEPRINT;
var int BOSSUI_MODE;
instance CURRENTBOSS(C_NPC);
var int CURRENTBOSSID;
func void INIT_BOSSUI_GAMESTART() {
    HOOKENGINEF(OCGAME__UPDATESCREENRESOLUTION_END, 6, 21808);
}

func void INIT_BOSSUI_ALWAYS() {
    if (BOSSUI) {
        CURRENTBOSS = HLP_GETNPC(CURRENTBOSSID);
        FF_APPLYONCE(21813);
    };
}

func void _BOSSUI_UPDATERESOLUTION() {
    if ((HLP_ISVALIDNPC(CURRENTBOSS)) && (BOSSUI)) {
        DELETE(BOSSNAMEPRINT);
        BOSSNAMEPRINT = PRINT_EXTPXL(((PRINT_SCREEN[0]) / (2)) - ((PRINT_GETSTRINGWIDTH(CURRENTBOSS.NAME[0], BOSSUI_FONT)) / (2)), ROUNDF(MULF(MKF(64), BAR_GETINTERFACESCALING())), CURRENTBOSS.NAME[0], BOSSUI_FONT, COL_WHITE, -(1));
    };
}

func void START_BOSSUI(var C_NPC BOSS, var int MODE) {
    if (!(BOSSUI)) {
        FOCUSBAR = _^(MEM_GAME.FOCUSBAR);
        BOSSUI = TRUE;
        BOSS_BAR = BAR_CREATE(21799);
        BOSSNAMEPRINT = PRINT_EXTPXL(((PRINT_SCREEN[0]) / (2)) - ((PRINT_GETSTRINGWIDTH(BOSS.NAME[0], BOSSUI_FONT)) / (2)), ROUNDF(MULF(MKF(64), BAR_GETINTERFACESCALING())), BOSS.NAME[0], BOSSUI_FONT, COL_WHITE, -(1));
        BAR_SETMAX(BOSS_BAR, BOSS.ATTRIBUTE[1]);
        CURRENTBOSS = _^(_@(21810));
        CURRENTBOSSID = HLP_GETINSTANCEID(CURRENTBOSS);
        BOSSUI_MODE = MODE;
        FF_APPLYONCE(21813);
    };
}

