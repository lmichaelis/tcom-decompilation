instance DIA_ADDON_GIVEPOTION(C_INFO) {
    NR = 998;
    CONDITION = DIA_ADDON_GIVEPOTION_CONDITION;
    INFORMATION = DIA_ADDON_GIVEPOTION_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_GIVEHEALINGPOTION;
}

func int DIA_ADDON_GIVEPOTION_CONDITION() {
    if (((SELF.AIVAR[15]) == (TRUE)) && ((SELF.FLAGS) == (0))) {
        if (C_GOTINGRENDIENTS_ANYHEALTHPOTION(HERO)) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_ADDON_GIVEPOTION_INFO() {
    INFO_CLEARCHOICES(60909);
    INFO_ADDCHOICE(60909, DIALOG_BACK, 60914);
    if ((NPC_HASITEMS(OTHER, 37732)) >= (1)) {
        INFO_ADDCHOICE(60909, POTIONNAME_HPREGEN2, 60915);
    };
    if ((NPC_HASITEMS(OTHER, 37730)) >= (1)) {
        INFO_ADDCHOICE(60909, POTIONNAME_HPREGEN, 60916);
    };
    if ((NPC_HASITEMS(OTHER, 34369)) >= (1)) {
        INFO_ADDCHOICE(60909, POTIONNAME_HEALTH_04_VOL2, 60917);
    };
    if ((NPC_HASITEMS(OTHER, 34367)) >= (1)) {
        INFO_ADDCHOICE(60909, POTIONNAME_HEALTH_03_VOL2, 60918);
    };
    if ((NPC_HASITEMS(OTHER, 34364)) >= (1)) {
        INFO_ADDCHOICE(60909, POTIONNAME_HEALTH_02_VOL2, 60919);
    };
    if ((NPC_HASITEMS(OTHER, 34361)) >= (1)) {
        INFO_ADDCHOICE(60909, POTIONNAME_HEALTH_01_VOL2, 60920);
    };
    if ((NPC_HASITEMS(OTHER, 33678)) >= (1)) {
        INFO_ADDCHOICE(60909, POTIONNAME_HEALTH_04, 60921);
    };
    if ((NPC_HASITEMS(OTHER, 34357)) >= (1)) {
        INFO_ADDCHOICE(60909, POTIONNAME_HEALTH_03, 60922);
    };
    if ((NPC_HASITEMS(OTHER, 34354)) >= (1)) {
        INFO_ADDCHOICE(60909, POTIONNAME_HEALTH_02, 60923);
    };
    if ((NPC_HASITEMS(OTHER, 34352)) >= (1)) {
        INFO_ADDCHOICE(60909, POTIONNAME_HEALTH_01, 60924);
    };
}

func void B_ADDON_DRINKPOTION() {
    var int MARVIN_SVM_RND;
    B_STANDUP();
    MARVIN_SVM_RND = HLP_RANDOM(3);
    if ((MARVIN_SVM_RND) == (0)) {
        B_SAY(OTHER, SELF, "$MARVIN_GiveItem");
    };
    if ((MARVIN_SVM_RND) == (1)) {
        B_SAY(OTHER, SELF, "$MARVIN_GiveItem2");
    };
    if ((MARVIN_SVM_RND) == (2)) {
        B_SAY(OTHER, SELF, "$MARVIN_GiveItem4");
    };
    INFO_CLEARCHOICES(60909);
}

func void DIA_ADDON_GIVEPOTION_BACK() {
    INFO_CLEARCHOICES(60909);
}

func void DIA_ADDON_GIVEPOTION_ITPO_HPREGEN2() {
    B_ADDON_DRINKPOTION();
    if ((SELF.ATTRIBUTE[0]) < (SELF.ATTRIBUTE[1])) {
        AI_STOPLOOKAT(SELF);
        AI_USEITEM(SELF, 37732);
    };
    B_GIVEINVITEMS(OTHER, SELF, 37732, 1);
}

func void DIA_ADDON_GIVEPOTION_ITPO_HPREGEN() {
    B_ADDON_DRINKPOTION();
    if ((SELF.ATTRIBUTE[0]) < (SELF.ATTRIBUTE[1])) {
        AI_STOPLOOKAT(SELF);
        AI_USEITEM(SELF, 37730);
    };
    B_GIVEINVITEMS(OTHER, SELF, 37730, 1);
}

func void DIA_ADDON_GIVEPOTION_ITPO_HEALTH_04_VOL2() {
    B_ADDON_DRINKPOTION();
    if ((SELF.ATTRIBUTE[0]) < (SELF.ATTRIBUTE[1])) {
        AI_STOPLOOKAT(SELF);
        AI_USEITEM(SELF, 34369);
    };
    B_GIVEINVITEMS(OTHER, SELF, 34369, 1);
}

func void DIA_ADDON_GIVEPOTION_ITPO_HEALTH_03_VOL2() {
    B_ADDON_DRINKPOTION();
    if ((SELF.ATTRIBUTE[0]) < (SELF.ATTRIBUTE[1])) {
        AI_STOPLOOKAT(SELF);
        AI_USEITEM(SELF, 34367);
    };
    B_GIVEINVITEMS(OTHER, SELF, 34367, 1);
}

func void DIA_ADDON_GIVEPOTION_ITPO_HEALTH_02_VOL2() {
    B_ADDON_DRINKPOTION();
    if ((SELF.ATTRIBUTE[0]) < (SELF.ATTRIBUTE[1])) {
        AI_STOPLOOKAT(SELF);
        AI_USEITEM(SELF, 34364);
    };
    B_GIVEINVITEMS(OTHER, SELF, 34364, 1);
}

func void DIA_ADDON_GIVEPOTION_ITPO_HEALTH_01_VOL2() {
    B_ADDON_DRINKPOTION();
    if ((SELF.ATTRIBUTE[0]) < (SELF.ATTRIBUTE[1])) {
        AI_STOPLOOKAT(SELF);
        AI_USEITEM(SELF, 34361);
    };
    B_GIVEINVITEMS(OTHER, SELF, 34361, 1);
}

func void DIA_ADDON_GIVEPOTION_ITPO_HEALTH_04() {
    B_ADDON_DRINKPOTION();
    if ((SELF.ATTRIBUTE[0]) < (SELF.ATTRIBUTE[1])) {
        AI_STOPLOOKAT(SELF);
        AI_USEITEM(SELF, 33678);
    };
    B_GIVEINVITEMS(OTHER, SELF, 33678, 1);
}

func void DIA_ADDON_GIVEPOTION_ITPO_HEALTH_03() {
    B_ADDON_DRINKPOTION();
    if ((SELF.ATTRIBUTE[0]) < (SELF.ATTRIBUTE[1])) {
        AI_STOPLOOKAT(SELF);
        AI_USEITEM(SELF, 34357);
    };
    B_GIVEINVITEMS(OTHER, SELF, 34357, 1);
}

func void DIA_ADDON_GIVEPOTION_ITPO_HEALTH_02() {
    B_ADDON_DRINKPOTION();
    if ((SELF.ATTRIBUTE[0]) < (SELF.ATTRIBUTE[1])) {
        AI_STOPLOOKAT(SELF);
        AI_USEITEM(SELF, 34354);
    };
    B_GIVEINVITEMS(OTHER, SELF, 34354, 1);
}

func void DIA_ADDON_GIVEPOTION_ITPO_HEALTH_01() {
    B_ADDON_DRINKPOTION();
    if ((SELF.ATTRIBUTE[0]) < (SELF.ATTRIBUTE[1])) {
        AI_STOPLOOKAT(SELF);
        AI_USEITEM(SELF, 34352);
    };
    B_GIVEINVITEMS(OTHER, SELF, 34352, 1);
}

func void B_ADDON_GIVEPOTION(var C_NPC SLF) {
    DIA_ADDON_GIVEPOTION.NPC = HLP_GETINSTANCEID(SLF);
}

