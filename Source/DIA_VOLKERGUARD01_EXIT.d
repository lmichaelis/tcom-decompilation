instance DIA_VOLKERGUARD01_EXIT(C_INFO) {
    NPC = 53187;
    NR = 999;
    CONDITION = DIA_VOLKERGUARD01_EXIT_CONDITION;
    INFORMATION = DIA_VOLKERGUARD01_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_VOLKERGUARD01_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_VOLKERGUARD01_EXIT_INFO() {
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_VOLKERGUARD01_BUSY(C_INFO) {
    NPC = 53187;
    NR = 1;
    CONDITION = DIA_VOLKERGUARD01_BUSY_CONDITION;
    INFORMATION = DIA_VOLKERGUARD01_BUSY_INFO;
    PERMANENT = TRUE;
    IMPORTANT = TRUE;
}

func int DIA_VOLKERGUARD01_BUSY_CONDITION() {
    if (NPC_ISINSTATE(SELF, 61599)) {
        if ((((LOG_GETSTATUS(MIS_Q405)) != (LOG_RUNNING)) && ((Q405_VOLKERGUARDSATTACK) != (0))) && ((Q405_DIALOGUEWITHVOLKERGUARDS) != (0))) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_VOLKERGUARD01_BUSY_INFO() {
    DIA_IMBUSY_ANGRY();
}

instance DIA_VOLKERGUARD01_INTRUDER(C_INFO) {
    NPC = 53187;
    NR = 1;
    CONDITION = DIA_VOLKERGUARD01_INTRUDER_CONDITION;
    INFORMATION = DIA_VOLKERGUARD01_INTRUDER_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_VOLKERGUARD01_INTRUDER_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_Q405)) == (LOG_RUNNING)) && ((Q405_VOLKERGUARDSATTACK) == (0))) && ((Q405_DIALOGUEWITHVOLKERGUARDS) == (0))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_VOLKERGUARD01_INTRUDER_INFO() {
    INFO_CLEARCHOICES(69035);
    INFO_ADDCHOICE(69035, "Who are you?", 69039);
    INFO_ADDCHOICE(69035, "What are you doing here?", 69040);
    INFO_ADDCHOICE(69035, "I work for Volker, too.", 69041);
}

func void DIA_VOLKERGUARD01_BADCHOICE() {
    AI_PLAYANI(SELF, T_SEARCH);
    AI_OUTPUT(SELF, OTHER, "DIA_VolkerGuard01_Intruder_Works_03_04");
    INFO_CLEARCHOICES(69035);
    AI_STOPPROCESSINFOS(SELF);
    AI_FUNCTION(SELF, 63825);
    AI_FUNCTION(SELF, 63826);
}

func void DIA_VOLKERGUARD01_INTRUDER_WHO() {
    AI_OUTPUT(OTHER, SELF, "DIA_VolkerGuard01_Intruder_Who_15_01");
    DIA_VOLKERGUARD01_BADCHOICE();
}

func void DIA_VOLKERGUARD01_INTRUDER_WHAT() {
    AI_OUTPUT(OTHER, SELF, "DIA_VolkerGuard01_Intruder_What_15_01");
    DIA_VOLKERGUARD01_BADCHOICE();
}

func void DIA_VOLKERGUARD01_INTRUDER_WORKS() {
    var C_ITEM ITM;
    AI_OUTPUT(OTHER, SELF, "DIA_VolkerGuard01_Intruder_Works_15_01");
    if ((NPC_HASEQUIPPEDARMOR(OTHER)) == (TRUE)) {
        ITM = NPC_GETEQUIPPEDARMOR(OTHER);
        if (((HLP_ISITEM(ITM, 35479)) == (TRUE)) || ((HLP_ISITEM(ITM, 35478)) == (TRUE))) {
            Q405_DIALOGUEWITHVOLKERGUARDS = 1;
            AI_OUTPUT(SELF, OTHER, "DIA_VolkerGuard01_Intruder_Works_03_02");
            AI_OUTPUT(SELF, OTHER, "DIA_VolkerGuard01_Intruder_Works_03_03");
            AI_LOGENTRY(TOPIC_Q405, LOG_Q405_VOLKERGUARDSNOATTACK);
            INFO_CLEARCHOICES(69035);
            AI_STOPPROCESSINFOS(SELF);
        } else {
            DIA_VOLKERGUARD01_BADCHOICE();
        };
    };
    DIA_VOLKERGUARD01_BADCHOICE();
}

