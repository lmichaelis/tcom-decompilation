instance DIA_DUSTER_EXIT(C_INFO) {
    NPC = 54425;
    NR = 999;
    CONDITION = DIA_DUSTER_EXIT_CONDITION;
    INFORMATION = DIA_DUSTER_EXIT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = DIALOG_ENDE;
}

func int DIA_DUSTER_EXIT_CONDITION() {
    return TRUE;
}

func void DIA_DUSTER_EXIT_INFO() {
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_DUSTER_SQ225_HELLO(C_INFO) {
    NPC = 54425;
    NR = 1;
    CONDITION = DIA_DUSTER_SQ225_HELLO_CONDITION;
    INFORMATION = DIA_DUSTER_SQ225_HELLO_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_DUSTER_SQ225_HELLO_CONDITION() {
    if ((((((LOG_GETSTATUS(MIS_SQ225)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 76922))) && ((SQ225_VALERIOTESTAMENT) == (1))) && ((NPC_GETDISTTOWP(SELF, "PARTM1_SQ225_DUSTER")) <= (750))) && (NPC_ISINSTATE(SELF, 61599))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DUSTER_SQ225_HELLO_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_SQ225_Hello_15_01");
    AI_STARTFACEANI(SELF, S_WHAT, 1, -(1));
    if ((HERO.GUILD) == (GIL_MIL)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Duster_SQ225_Hello_03_02");
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_SQ225_Hello_03_03");
    INFO_CLEARCHOICES(67201);
    if ((HERO.GUILD) == (GIL_MIL)) {
        INFO_ADDCHOICE(67201, "Yeah, where are we?", 67205);
        INFO_ADDCHOICE(67201, "Actually, I just wanted to talk.", 67206);
    };
    INFO_ADDCHOICE(67201, "I saw you at Venzel's house. Is he a suspect?", 67207);
}

func void DIA_DUSTER_SQ225_HELLO_END() {
    DUSTER_SQ225_VENZELWAIT = 1;
    DUSTER_SQ225_VENZELWAIT_HOUR = WLD_GETHOUR();
    DUSTER_SQ225_VENZELWAIT_DAY = WLD_GETDAY();
    AI_RESETFACEANI(SELF);
    if ((HERO.GUILD) == (GIL_MIL)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Duster_SQ225_Hello_Talk_03_05");
        AI_OUTPUT(SELF, OTHER, "DIA_Duster_SQ225_Hello_Talk_03_06");
        AI_OUTPUT(SELF, OTHER, "DIA_Duster_SQ225_Hello_Talk_03_07");
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_SQ225_Hello_Next_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_SQ225_Hello_Talk_15_08");
    AI_LOGENTRY(TOPIC_SQ225, LOG_SQ225_DUSTER_VENZEL);
    AI_STOPPROCESSINFOS(SELF);
}

func void DIA_DUSTER_SQ225_HELLO_YES() {
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_SQ225_Hello_Yes_15_01");
    AI_RESETFACEANI(SELF);
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_SQ225_Hello_Yes_03_02");
    DIA_DUSTER_SQ225_HELLO_END();
}

func void DIA_DUSTER_SQ225_HELLO_TALK() {
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_SQ225_Hello_Talk_15_01");
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_SQ225_Hello_Talk_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_SQ225_Hello_Talk_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_SQ225_Hello_Talk_03_04");
    DIA_DUSTER_SQ225_HELLO_END();
}

func void DIA_DUSTER_SQ225_HELLO_VENZEL() {
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_STARTFACEANI(SELF, S_SERIOUS, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_SQ225_Hello_Venzel_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_SQ225_Hello_Venzel_03_02");
    AI_RESETFACEANI(OTHER);
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_SQ225_Hello_Venzel_15_03");
    B_STANDUP();
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_SQ225_Hello_Venzel_03_04");
    INFO_CLEARCHOICES(67201);
    INFO_ADDCHOICE(67201, "I've seen him acting suspiciously for a long time.", 67209);
    INFO_ADDCHOICE(67201, "Maybe a few coins will fall into my pocket in the process?", 67208);
}

func void DIA_DUSTER_SQ225_HELLO_VENZEL_GOLD() {
    AI_STARTFACEANI(OTHER, S_SMILE, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_SQ225_Hello_Gold_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_SQ225_Hello_Gold_03_02");
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_SQ225_Hello_Gold_03_03");
    DIA_DUSTER_SQ225_HELLO_END();
}

func void DIA_DUSTER_SQ225_HELLO_VENZEL_STRANGE() {
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_SQ225_Hello_Strange_15_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_SQ225_Hello_Strange_15_02");
    AI_RESETFACEANI(SELF);
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_SQ225_Hello_Strange_03_03");
    DIA_DUSTER_SQ225_HELLO_END();
}

instance DIA_DUSTER_SQ225_NOTHING(C_INFO) {
    NPC = 54425;
    NR = 1;
    CONDITION = DIA_DUSTER_SQ225_NOTHING_CONDITION;
    INFORMATION = DIA_DUSTER_SQ225_NOTHING_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Unfortunately, I wasn't able to find anything.";
}

func int DIA_DUSTER_SQ225_NOTHING_CONDITION() {
    if ((LOG_GETSTATUS(MIS_SQ225)) == (LOG_RUNNING)) {
        if ((DUSTER_SQ225_VENZELWAIT) == (2)) {
            if (((SQ225_VALERIOTESTAMENT) == (1)) && ((NPC_GETDISTTOWP(SELF, "PARTM1_SQ225_DUSTER")) <= (750))) {
                return TRUE;
            };
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_DUSTER_SQ225_NOTHING_INFO() {
    CHANGEVOBCOLLISION("SQ225_WAITINVENZELHOUSE_SCRIPT", FALSE, FALSE, FALSE, FALSE);
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_SQ225_Nothing_15_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_SQ225_Nothing_15_02");
    B_STANDUP();
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_SQ225_Nothing_03_03");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_SQ225_Nothing_15_04");
    AI_STARTFACEANI(SELF, S_WHAT, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_SQ225_Nothing_03_05");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_SQ225_Nothing_15_06");
    AI_STARTFACEANI(SELF, S_THINK, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_SQ225_Nothing_03_07");
    AI_RESETFACEANI(SELF);
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_SQ225_Nothing_03_08");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    if ((HERO.GUILD) == (GIL_MIL)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Duster_SQ225_Nothing_03_09");
        PRINTD(CS2("Aktualna reputacja w Gildii: ", INTTOSTRING(Q203_MILITIAGUILDREPUTATION)));
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_SQ225_Nothing_03_10");
    CREATEINVITEMS(SELF, 34203, SQ225_DUSTER_REWARD);
    B_GIVEINVITEMS(SELF, OTHER, 34203, SQ225_DUSTER_REWARD);
    AI_STOPPROCESSINFOS(SELF);
    AI_LOGENTRY(TOPIC_SQ225, LOG_SQ225_DUSTER_GONE);
    RESTOREROUTINE_DUSTER();
}

instance DIA_DUSTER_Q401HELP(C_INFO) {
    NPC = 54425;
    NR = 1;
    CONDITION = DIA_DUSTER_Q401HELP_CONDITION;
    INFORMATION = DIA_DUSTER_Q401HELP_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "I need some help with a delicate issue.";
}

func int DIA_DUSTER_Q401HELP_CONDITION() {
    if (((((LOG_GETSTATUS(MIS_Q401)) == (LOG_RUNNING)) && ((Q401_FABIOANDGANGGONE) == (0))) && (NPC_KNOWSINFO(OTHER, 81328))) && ((NPC_HASITEMS(OTHER, 37333)) >= (1))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DUSTER_Q401HELP_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q401Help_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q401Help_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q401Help_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q401Help_03_04");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q401Help_15_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q401Help_03_06");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q401Help_15_07");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q401Help_03_08");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q401Help_15_09");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q401Help_03_10");
    INFO_CLEARCHOICES(67213);
    INFO_ADDCHOICE(67213, "There's always a catch...", 67217);
    INFO_ADDCHOICE(67213, "How much do you want?", 67218);
}

func void DIA_DUSTER_Q401HELP_NEXT() {
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q401Help_Next_03_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q401Help_Next_15_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q401Help_Next_03_03");
    INFO_CLEARCHOICES(67213);
    if ((NPC_HASITEMS(OTHER, 34203)) >= (Q401_DUSTERPRICE)) {
        INFO_ADDCHOICE(67213, "Here's some gold and gunpowder. I want a nice avalanche. (100 GP)", 67220);
    };
    INFO_ADDCHOICE(67213, "Do you really want to mess with Ulryk?", 67221);
    INFO_ADDCHOICE(67213, "It will cost you Roderich's anger.", 67222);
}

func void DIA_DUSTER_Q401HELP_KEY() {
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q401Help_Key_15_01");
    DIA_DUSTER_Q401HELP_NEXT();
}

func void DIA_DUSTER_Q401HELP_HOWMANY() {
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q401Help_HowMany_15_01");
    DIA_DUSTER_Q401HELP_NEXT();
}

func void DIA_DUSTER_Q401HELP_END() {
    Q401_DUSTERBIZZAREADVENTURE = 1;
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q401Help_END_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q401Help_END_03_02");
    AI_LOGENTRY(TOPIC_Q401, LOG_Q401_DUSTER);
    INFO_CLEARCHOICES(67213);
    AI_STOPPROCESSINFOS(SELF);
    NPC_EXCHANGEROUTINE(SELF, "WOLFSDEN");
    Q401_DUSTER_RTNCHECK = 1;
    Q401_REMOVEYEZEGAN();
}

func void DIA_DUSTER_Q401HELP_HOWMANY_NEXT_PAY() {
    B_GIVEINVITEMS(OTHER, SELF, 34203, Q401_DUSTERPRICE);
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q401Help_Pay_15_01");
    B_GIVEINVITEMS(OTHER, SELF, 37333, 1);
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q401Help_Pay_03_02");
    DIA_DUSTER_Q401HELP_END();
}

func void DIA_DUSTER_Q401HELP_HOWMANY_NEXT_ULRYK() {
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q401Help_Ulryk_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q401Help_Ulryk_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q401Help_Ulryk_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q401Help_Ulryk_03_04");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q401Help_Ulryk_15_05");
    DIA_DUSTER_Q401HELP_END();
}

func void DIA_DUSTER_Q401HELP_HOWMANY_NEXT_RODERICH() {
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q401Help_Roderich_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q401Help_Roderich_03_02");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q401Help_Roderich_15_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q401Help_Roderich_03_04");
}

instance DIA_DUSTER_READY(C_INFO) {
    NPC = 54425;
    NR = 1;
    CONDITION = DIA_DUSTER_READY_CONDITION;
    INFORMATION = DIA_DUSTER_READY_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "You ready?";
}

func int DIA_DUSTER_READY_CONDITION() {
    if ((((((LOG_GETSTATUS(MIS_Q401)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 67213))) && ((NPC_GETDISTTOWP(SELF, "PART16_DUSTER")) <= (750))) && ((Q401_FABIOANDGANGGONE) == (0))) && ((Q401_DUSTERBIZZAREADVENTURE) != (2))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DUSTER_READY_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Ready_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Ready_03_02");
    if (WLD_ISTIME(5, 0, 22, 0)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Duster_Ready_03_03");
    };
    Q401_DUSTERBIZZAREADVENTURE = 2;
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Ready_03_04");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Ready_15_05");
    AI_WAITTILLEND(SELF, OTHER);
    AI_PLAYANI(SELF, T_SEARCH);
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Ready_03_06");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Ready_15_07");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Ready_03_08");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Ready_15_09");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Ready_03_10");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Ready_03_11");
    CREATEINVITEMS(SELF, 37334, 1);
    B_GIVEINVITEMS(SELF, OTHER, 37334, 1);
    WLD_SENDTRIGGER("MOVER_Q401_PLUNDER");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Ready_15_12");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Ready_03_13");
    AI_LOGENTRY(TOPIC_Q401, LOG_Q401_DUSTERPREPAREEXPLOSION);
    AI_STOPPROCESSINFOS(SELF);
    NPC_EXCHANGEROUTINE(SELF, "PREPARE");
    Q401_DUSTER_RTNCHECK = 2;
}

instance DIA_DUSTER_EXPLOSION(C_INFO) {
    NPC = 54425;
    NR = 1;
    CONDITION = DIA_DUSTER_EXPLOSION_CONDITION;
    INFORMATION = DIA_DUSTER_EXPLOSION_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_DUSTER_EXPLOSION_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_Q401)) == (LOG_RUNNING)) && ((Q401_FABIOANDGANGGONE) == (0))) && ((Q401_DUSTERBIZZAREADVENTURE) == (4))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DUSTER_EXPLOSION_INFO() {
    TELEPORTNPCTOWP(1819, "PART16_CUTSCENE_EXPLOSION_HERO");
    TELEPORTNPCTOWP(54425, "PART16_CUTSCENE_EXPLOSION_DUSTER");
    AI_TURNTONPC(MIL_6371_DUSTER, HERO);
    AI_TURNTONPC(HERO, MIL_6371_DUSTER);
    AI_FUNCTION(SELF, 67229);
    AI_STARTFACEANI(SELF, S_THINK, 1, -(1));
    AI_PLAYANI(SELF, R_SCRATCHHEAD);
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Explosion_03_01");
    AI_WAITTILLEND(OTHER, SELF);
    AI_PLAYANI(OTHER, "T_SHRUG");
    AI_WAITTILLEND(SELF, OTHER);
    AI_FUNCTION(SELF, 67232);
    AI_FUNCTION(SELF, 67231);
    AI_WAITTILLEND(OTHER, SELF);
    AI_PLAYANI(HERO, "T_EXPLOSION_SCARED_HERO");
    AI_PLAYANI(MIL_6371_DUSTER, "T_EXPLOSION_SCARED_DUSTER");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Explosion_15_02");
    AI_WAITTILLEND(SELF, OTHER);
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Explosion_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Explosion_03_04");
    AI_STOPPROCESSINFOS(SELF);
    AI_RESETFACEANI(SELF);
    NPC_EXCHANGEROUTINE(SELF, "EXPLOSION");
    Q401_DUSTER_RTNCHECK = 3;
    AI_FUNCTION(SELF, 67230);
}

func void DUSTER_STARTCAMERA() {
    DIACAM_DISABLE();
    WLD_SENDTRIGGER("KM_CAMERA_EXPLOSION_01");
}

func void DUSTER_STOPCAMERA() {
    WLD_SENDUNTRIGGER("KM_CAMERA_EXPLOSION_01");
    DIACAM_ENABLE();
}

func void DUSTER_CHANGEREFUGEERTN() {
    B_STARTOTHERROUTINE(NONE_5_FABIO, "Q401_SCARED");
    B_STARTOTHERROUTINE(NONE_6363_GALBO, "SCARED");
    B_STARTOTHERROUTINE(NONE_6364_SIGMUN, "SCARED");
    B_STARTOTHERROUTINE(NONE_6365_ESTI, "SCARED");
    B_STARTOTHERROUTINE(NONE_6374_REFUGEE, "SCARED");
    B_STARTOTHERROUTINE(NONE_6375_REFUGEE, "SCARED");
    B_STARTOTHERROUTINE(NONE_6376_REFUGEE, "SCARED");
    B_STARTOTHERROUTINE(NONE_6377_REFUGEE, "SCARED");
    B_STARTOTHERROUTINE(NONE_6378_REFUGEE, "SCARED");
    TELEPORTNPCTOWP(51512, NONE_5_FABIO.WP);
    TELEPORTNPCTOWP(58358, NONE_6363_GALBO.WP);
    TELEPORTNPCTOWP(58363, NONE_6364_SIGMUN.WP);
    TELEPORTNPCTOWP(58368, NONE_6365_ESTI.WP);
    TELEPORTNPCTOWP(58141, NONE_6374_REFUGEE.WP);
    TELEPORTNPCTOWP(58146, NONE_6375_REFUGEE.WP);
    TELEPORTNPCTOWP(58151, NONE_6376_REFUGEE.WP);
    TELEPORTNPCTOWP(58156, NONE_6377_REFUGEE.WP);
    TELEPORTNPCTOWP(58161, NONE_6378_REFUGEE.WP);
}

func void DUSTER_FUCKINGEXPLOSION() {
    WLD_PLAYEFFECT("FX_EarthQuake", HERO, HERO, 0, 0, 0, FALSE);
    SND_PLAY("Ravens_Earthquake4");
    SND_PLAY("EXPLOSION02");
    FF_APPLYONCEEXTGT(63660, 0, -(1));
}

instance DIA_DUSTER_KQ402_ARMOR(C_INFO) {
    NPC = 54425;
    NR = 1;
    CONDITION = DIA_DUSTER_KQ402_ARMOR_CONDITION;
    INFORMATION = DIA_DUSTER_KQ402_ARMOR_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "How do you like our new clothes?";
}

func int DIA_DUSTER_KQ402_ARMOR_CONDITION() {
    if (((LOG_GETSTATUS(MIS_KQ402)) == (LOG_RUNNING)) && ((KQ402_DECISION) == (1))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DUSTER_KQ402_ARMOR_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_KQ402_Armor_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_KQ402_Armor_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_KQ402_Armor_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_KQ402_Armor_03_04");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_KQ402_Armor_15_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_KQ402_Armor_03_06");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_KQ402_Armor_03_07");
    AI_LOGENTRY(TOPIC_KQ402, LOG_KQ402_DUSTER_ARMOR);
}

var int QM401_DUSTER_WEKNOWBARRELS;
instance DIA_DUSTER_QM401_CART(C_INFO) {
    NPC = 54425;
    NR = 1;
    CONDITION = DIA_DUSTER_QM401_CART_CONDITION;
    INFORMATION = DIA_DUSTER_QM401_CART_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_DUSTER_QM401_CART_CONDITION() {
    if (((LOG_GETSTATUS(MIS_QM401)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 67575))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DUSTER_QM401_CHOICES() {
    INFO_CLEARCHOICES(67237);
    if ((QM401_DUSTER_WEKNOWBARRELS) == (TRUE)) {
        INFO_ADDCHOICE(67237, "No time to talk, let's get these barrel.", 67241);
    };
    if ((QM401_DUSTER_WEKNOWBARRELS) == (FALSE)) {
        INFO_ADDCHOICE(67237, "What happened here?", 67242);
    };
}

func void DIA_DUSTER_QM401_CART_INFO() {
    AI_STARTFACEANI(SELF, S_SERIOUS, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_QM401_Cart_03_01");
    DIA_DUSTER_QM401_CHOICES();
}

func void DIA_DUSTER_QM401_CART_BARRELS() {
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_QM401_Cart_Barrels_15_01");
    INFO_CLEARCHOICES(67237);
    AI_WAITTILLEND(SELF, OTHER);
    AI_RESETFACEANI(SELF);
    AI_STOPPROCESSINFOS(SELF);
    AI_LOGENTRY(TOPIC_QM401, LOG_QM401_DUSTER_BARRLES);
}

func void DIA_DUSTER_QM401_CART_WHAT() {
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_QM401_Cart_What_15_01");
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_QM401_Cart_What_03_02");
    AI_RESETFACEANI(SELF);
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_QM401_Cart_What_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_QM401_Cart_What_03_04");
    QM401_DUSTER_WEKNOWBARRELS = TRUE;
    DIA_DUSTER_QM401_CHOICES();
}

instance DIA_DUSTER_QM401_GOTBARRELS(C_INFO) {
    NPC = 54425;
    NR = 1;
    CONDITION = DIA_DUSTER_QM401_GOTBARRELS_CONDITION;
    INFORMATION = DIA_DUSTER_QM401_GOTBARRELS_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "I have all the barrels now.";
}

func int DIA_DUSTER_QM401_GOTBARRELS_CONDITION() {
    if (((NPC_KNOWSINFO(OTHER, 67237)) && ((LOG_GETSTATUS(MIS_QM401)) == (LOG_RUNNING))) && ((NPC_HASITEMS(OTHER, 37319)) >= (4))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DUSTER_QM401_GOTBARRELS_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_QM401_GotBarrels_15_01");
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    if ((NPC_HASITEMS(OTHER, 37319)) == (4)) {
        B_GIVEINVITEMS(OTHER, SELF, 37319, 4);
        B_GIVEPLAYERXP(XP_QM401_DUSTERBARREL_V1);
        AI_OUTPUT(SELF, OTHER, "DIA_Duster_QM401_GotBarrels_03_02");
    };
    B_GIVEINVITEMS(OTHER, SELF, 37319, 5);
    B_GIVEPLAYERXP(XP_QM401_DUSTERBARREL_V2);
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_QM401_GotBarrels_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_QM401_GotBarrels_03_04");
    if ((QM401_FARNREADY_COUNT) == (3)) {
        AI_LOGENTRY(TOPIC_QM401, LOG_QM401_DUSTER_WORK_V2);
    };
    AI_LOGENTRY(TOPIC_QM401, LOG_QM401_DUSTER_WORK_V1);
    AI_STOPPROCESSINFOS(SELF);
    AI_FUNCTION(SELF, 62842);
}

instance DIA_DUSTER_QM401_CLIMBING(C_INFO) {
    NPC = 54425;
    NR = 1;
    CONDITION = DIA_DUSTER_QM401_CLIMBING_CONDITION;
    INFORMATION = DIA_DUSTER_QM401_CLIMBING_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_DUSTER_QM401_CLIMBING_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_QM401)) == (LOG_RUNNING)) && (NPC_KNOWSINFO(OTHER, 67243))) && ((QM401_FARNREADY_COUNT) == (3))) {
        if (((NPC_GETDISTTOWP(MIL_6371_DUSTER, MIL_6371_DUSTER.WP)) <= (500)) && ((NPC_GETDISTTOWP(MIL_924_WINSTAN, MIL_924_WINSTAN.WP)) <= (500))) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_DUSTER_QM401_CLIMBING_INFO() {
    TRIA_INVITE(MIL_924_WINSTAN);
    TRIA_STARTEXT(FALSE);
    AI_REMOVEWEAPON(OTHER);
    AI_LOOKATNPC(OTHER, SELF);
    AI_STOPLOOKAT(SELF);
    B_TURNTONPC(MIL_6371_DUSTER, MIL_924_WINSTAN);
    B_TURNTONPC(MIL_924_WINSTAN, MIL_6371_DUSTER);
    B_TURNTONPC(HERO, MIL_6371_DUSTER);
    TRIA_WAIT();
    TRIA_NEXT(MIL_6371_DUSTER);
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_QM401_Climbing_03_01");
    AI_TURNTONPC(SELF, OTHER);
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_QM401_Climbing_03_02");
    INFO_CLEARCHOICES(67246);
    INFO_ADDCHOICE(67246, "What is it this time?", 67250);
    INFO_ADDCHOICE(67246, DIALOG_DONOTTALK, 67251);
}

func void DIA_DUSTER_QM401_CLIMBING_NEXT() {
    AI_WAITTILLEND(SELF, OTHER);
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_QM401_Climbing_Next_03_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_QM401_Climbing_Next_03_02");
    INFO_CLEARCHOICES(67246);
    INFO_ADDCHOICE(67246, "Our informant, Berto, will be walking at the head of the renegade squad.", 67252);
}

func void DIA_DUSTER_QM401_CLIMBING_WHAT() {
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_QM401_Climbing_What_15_01");
    DIA_DUSTER_QM401_CLIMBING_NEXT();
}

func void DIA_DUSTER_QM401_CLIMBING_SILENCE() {
    AI_WAIT(HERO, 1053609165);
    DIA_DUSTER_QM401_CLIMBING_NEXT();
}

func void DIA_DUSTER_QM401_CLIMBING_WHAT_NEXT_BERTO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_QM401_Climbing_Berto_15_01");
    TRIA_WAIT();
    TRIA_NEXT(MIL_924_WINSTAN);
    AI_TURNTONPC(SELF, OTHER);
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_QM401_Climbing_Berto_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_QM401_Climbing_Berto_03_03");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_QM401_Climbing_Berto_03_04");
    TRIA_WAIT();
    TRIA_NEXT(MIL_6371_DUSTER);
    AI_TURNTONPC(SELF, MIL_924_WINSTAN);
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_QM401_Climbing_Berto_03_05");
    TRIA_FINISH();
    AI_STOPLOOKAT(SELF);
    AI_STOPLOOKAT(OTHER);
    INFO_CLEARCHOICES(67246);
    AI_STOPPROCESSINFOS(SELF);
    AI_LOGENTRY(TOPIC_QM401, LOG_QM401_DUSTER_PREPAREBARREL);
    AI_FUNCTION(SELF, 62843);
}

instance DIA_DUSTER_QM401_AFTERFIGHT(C_INFO) {
    NPC = 54425;
    NR = 1;
    CONDITION = DIA_DUSTER_QM401_AFTERFIGHT_CONDITION;
    INFORMATION = DIA_DUSTER_QM401_AFTERFIGHT_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_DUSTER_QM401_AFTERFIGHT_CONDITION() {
    if (((LOG_GETSTATUS(MIS_QM401)) == (LOG_RUNNING)) && ((QM401_FIGHTWITHRENEGADESCHECK) == (2))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DUSTER_QM401_AFTERFIGHT_INFO() {
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_QM401_AfterFight_03_01");
    if ((NPC_KNOWSINFO(OTHER, 67579)) == (FALSE)) {
        INFO_CLEARCHOICES(67253);
        INFO_ADDCHOICE(67253, "We'll have to see about the rest.", 67256);
    };
}

func void DIA_DUSTER_QM401_AFTERFIGHT_WINSTAN() {
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_QM401_AfterFight_Winstan_15_01");
    AI_STARTFACEANI(SELF, S_TIRED, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_QM401_AfterFight_Winstan_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_QM401_AfterFight_Winstan_03_03");
    AI_RESETFACEANI(SELF);
    INFO_CLEARCHOICES(67253);
    AI_STOPPROCESSINFOS(SELF);
}

instance DIA_DUSTER_AFTEREXPLOSION(C_INFO) {
    NPC = 54425;
    NR = 1;
    CONDITION = DIA_DUSTER_AFTEREXPLOSION_CONDITION;
    INFORMATION = DIA_DUSTER_AFTEREXPLOSION_INFO;
    PERMANENT = FALSE;
    IMPORTANT = TRUE;
}

func int DIA_DUSTER_AFTEREXPLOSION_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_Q401)) == (LOG_RUNNING)) && ((Q401_FABIOANDGANGGONE) == (0))) && ((Q401_DUSTERBIZZAREADVENTURE) == (4))) {
        if ((NPC_GETDISTTOWP(SELF, "PART16_DUSTER_02")) <= (500)) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_DUSTER_AFTEREXPLOSION_INFO() {
    Q401_DUSTERBIZZAREADVENTURE = 5;
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_AfterExplosion_03_01");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_AfterExplosion_15_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_AfterExplosion_03_03");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_AfterExplosion_15_04");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_AfterExplosion_03_05");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_AfterExplosion_03_06");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_AfterExplosion_15_07");
    AI_LOGENTRY(TOPIC_Q401, LOG_Q401_DUSTERAFTEREXPLOSION);
    AI_STOPPROCESSINFOS(SELF);
    RESTOREROUTINE_DUSTER();
}

instance DIA_DUSTER_Q506_HELLO(C_INFO) {
    NPC = 54425;
    NR = 1;
    CONDITION = DIA_DUSTER_Q506_HELLO_CONDITION;
    INFORMATION = DIA_DUSTER_Q506_HELLO_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "There you are! I was just looking for you.";
}

func int DIA_DUSTER_Q506_HELLO_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_Q506)) == (LOG_RUNNING)) && ((NPC_GETDISTTOWP(SELF, "PART4_PATH_Q506_DUSTER")) <= (700))) && ((Q506_DUSTERVOLFZACKE) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DUSTER_Q506_HELLO_INFO() {
    AI_STARTFACEANI(OTHER, S_SMILE, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q506_Hello_15_01");
    if ((HERO.GUILD) != (GIL_MIL)) {
        AI_STARTFACEANI(SELF, S_WHAT, 1, -(1));
        AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q506_Hello_03_02");
    };
    AI_STARTFACEANI(SELF, S_SMILE, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q506_Hello_03_03");
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
}

instance DIA_DUSTER_Q506_JOB(C_INFO) {
    NPC = 54425;
    NR = 1;
    CONDITION = DIA_DUSTER_Q506_JOB_CONDITION;
    INFORMATION = DIA_DUSTER_Q506_JOB_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "I have a job offer for you.";
}

var int Q506_DUSTERGOODPOINTS;
func int DIA_DUSTER_Q506_JOB_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_Q506)) == (LOG_RUNNING)) && ((NPC_GETDISTTOWP(SELF, "PART4_PATH_Q506_DUSTER")) <= (700))) && ((Q506_DUSTERVOLFZACKE) == (FALSE))) {
        if ((NPC_KNOWSINFO(OTHER, 67260)) && ((Q506_DUSTERGOODPOINTS) != (2))) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_DUSTER_Q506_JOB_FINISH() {
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q506_Job_Finish_15_01");
    AI_STARTFACEANI(SELF, S_TIRED, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q506_Job_Finish_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q506_Job_Finish_03_03");
    if (((Q401_DUSTERBIZZAREADVENTURE) >= (3)) || ((LOG_GETSTATUS(MIS_QM401)) == (LOG_SUCCESS))) {
        AI_STARTFACEANI(OTHER, "S_SEROIUS", 1, -(1));
        AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q506_Job_Finish_15_04");
    };
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q506_Job_Finish_03_05");
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q506_Job_Finish_03_06");
    CREATEINVITEMS(SELF, 37622, 2);
    B_GIVEINVITEMS(SELF, OTHER, 37622, 2);
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q506_Job_Finish_03_07");
    AI_LOGENTRY(TOPIC_Q506, LOG_Q506_DUSTER_NEEDHELP);
    INFO_CLEARCHOICES(67263);
    AI_STOPPROCESSINFOS(SELF);
    AI_FUNCTION(SELF, 63307);
}

var int DUSTER_Q506_JOB_GOLD;
var int DUSTER_Q506_JOB_CLIMB;
var int DUSTER_Q506_JOB_BONUS;
var int DUSTER_Q506_JOB_PAY;
func void DIA_DUSTER_Q506_JOB_CHOICES() {
    if ((Q506_DUSTERGOODPOINTS) >= (2)) {
        DIA_DUSTER_Q506_JOB_FINISH();
    };
    INFO_CLEARCHOICES(67263);
    INFO_ADDCHOICE(67263, DIALOG_BACK, 67278);
    if ((DUSTER_Q506_JOB_GOLD) == (FALSE)) {
        INFO_ADDCHOICE(67263, "You will be able to take as much gold from the vault as you can carry..", 67274);
    };
    if (((Q401_DUSTERBIZZAREADVENTURE) >= (3)) || ((LOG_GETSTATUS(MIS_QM401)) == (LOG_SUCCESS))) {
        if ((DUSTER_Q506_JOB_CLIMB) == (FALSE)) {
            INFO_ADDCHOICE(67263, "I promise you won't have to climb anywhere.", 67275);
        };
    };
    if ((DUSTER_Q506_JOB_BONUS) == (FALSE)) {
        INFO_ADDCHOICE(67263, "You will receive a special deposit for the equipment you need.", 67276);
    };
    if ((DUSTER_Q506_JOB_PAY) == (FALSE)) {
        INFO_ADDCHOICE(67263, "(Pay for the expedition equipment with 400 GP)", 67277);
    };
}

func void DIA_DUSTER_Q506_JOB_INFO() {
    var int Q506_DUSTER_FIRSTTIMEDIALOGUE;
    if ((Q506_DUSTER_FIRSTTIMEDIALOGUE) == (FALSE)) {
        Q506_DUSTER_FIRSTTIMEDIALOGUE = TRUE;
        AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q506_Job_15_01");
        AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q506_Job_15_02");
        AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q506_Job_15_03");
        AI_STARTFACEANI(SELF, S_THINK, 1, -(1));
        AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q506_Job_03_04");
        DIA_DUSTER_Q506_JOB_CHOICES();
    };
    INFO_CLEARCHOICES(67263);
    INFO_ADDCHOICE(67263, DIALOG_BACK, 67278);
    INFO_ADDCHOICE(67263, "(Persuade to work)", 67271);
}

func void DIA_DUSTER_Q506_JOB_GOLD() {
    DUSTER_Q506_JOB_GOLD = TRUE;
    Q506_DUSTERGOODPOINTS = (Q506_DUSTERGOODPOINTS) + (1);
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q506_Job_Gold_15_01");
    AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q506_Job_Gold_03_02");
    DIA_DUSTER_Q506_JOB_CHOICES();
}

func void DIA_DUSTER_Q506_JOB_CLIMB() {
    DUSTER_Q506_JOB_CLIMB = TRUE;
    Q506_DUSTERGOODPOINTS = (Q506_DUSTERGOODPOINTS) + (1);
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q506_Job_Climb_15_01");
    AI_STARTFACEANI(SELF, S_ANGRY, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q506_Job_Climb_03_02");
    DIA_DUSTER_Q506_JOB_CHOICES();
}

func void DIA_DUSTER_Q506_JOB_BONUS() {
    DUSTER_Q506_JOB_BONUS = TRUE;
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q506_Job_Bonus_15_01");
    AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q506_Job_Bonus_03_02");
    DIA_DUSTER_Q506_JOB_CHOICES();
}

func void DIA_DUSTER_Q506_JOB_BONUS_PAY() {
    if ((NPC_HASITEMS(OTHER, 34203)) >= (Q506_DUSTERGOLD)) {
        DUSTER_Q506_JOB_PAY = TRUE;
        Q506_DUSTERGOODPOINTS = (Q506_DUSTERGOODPOINTS) + (1);
        AI_STARTFACEANI(SELF, S_SMUG, 1, -(1));
        AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q506_Job_Pay_03_01");
    };
    B_SAY(SELF, OTHER, "$NOGOLD");
    DIA_DUSTER_Q506_JOB_CHOICES();
}

func void DIA_DUSTER_Q506_JOB_BACK() {
    INFO_CLEARCHOICES(67263);
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
}

instance DIA_DUSTER_Q506_FINISH(C_INFO) {
    NPC = 54425;
    NR = 1;
    CONDITION = DIA_DUSTER_Q506_FINISH_CONDITION;
    INFORMATION = DIA_DUSTER_Q506_FINISH_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Everything's ready.";
}

func int DIA_DUSTER_Q506_FINISH_CONDITION() {
    if ((((LOG_GETSTATUS(MIS_Q506)) == (LOG_RUNNING)) && ((NPC_GETDISTTOWP(SELF, "PART4_PATH_Q506_DUSTER")) <= (700))) && ((Q506_DUSTERVOLFZACKE) == (FALSE))) {
        if ((Q506_BARRELSREADY) == (2)) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DUSTER_Q506_REMOVEPATH_CHECKDAY() {
    if ((Q506_REMOVEPATHCHECK) == (TRUE)) {
        if (((Q506_REMOVEPATHCHECK_DAY) <= ((WLD_GETDAY()) - (2))) && ((NPC_GETDISTTOWP(HERO, "PART4_PATH_Q506_DUSTER")) >= (5000))) {
            FF_REMOVE(67282);
            Q506_REMOVEPATH();
        } else {
            PRINTD("Poczekaj 2 dni i oddal siê na 5000 jednostek");
        };
    };
}

func void DUSTER_Q506_REMOVEPATH() {
    if ((CURRENTLEVEL) == (ARCHOLOS_ZEN)) {
        if ((HERO.GUILD) == (GIL_SLD)) {
            if ((LOG_GETSTATUS(MIS_QA203)) >= (LOG_SUCCESS)) {
                DUSTER_Q506_REMOVEPATH_CHECKDAY();
            } else {
                PRINTD("Wykonaj zadanie PRZYCZÓ£EK POTRZEBNY OD ZARAZ");
            };
        } else {
            DUSTER_Q506_REMOVEPATH_CHECKDAY();
        };
    };
    if (((CURRENTLEVEL) == (ARCHOLOS_ENDGAME_ZEN)) || ((CURRENTLEVEL) == (ARCHOLOS_VOLFZACKE_ZEN))) {
        PRINTD("I tak nie zobaczysz efektów");
        FF_REMOVE(67282);
    };
    PRINTD("Mogê funkcjê wykonaæ tylko w zenie Archolos! - Duster_Q506_RemovePath");
}

func void DUSTER_Q506_APPLYFUNCTION() {
    var int NPCPTR;
    var C_NPC NPC;
    NPC = HLP_GETNPC(1819);
    NPCPTR = _@(67284);
    FF_APPLYEXTDATAGT(67282, 2050, -(1), NPCPTR);
}

func void DIA_DUSTER_Q506_GOTOVOLFZACKE() {
    Q506_DUSTERVOLFZACKE = TRUE;
    B_GIVEPLAYERXP(XP_VARHDAL_RECRUIT);
    MIL_6371_DUSTER.FLAGS = 2;
    NPC_EXCHANGEROUTINE(MIL_6371_DUSTER, "Q506_CAMP");
    MIL_6371_DUSTER.AIVAR[15] = TRUE;
    if ((Q506_VIRANVOLFZACKE) == (TRUE)) {
        AI_LOGENTRY(TOPIC_Q506, LOG_Q506_DUSTERTOVOLFZACKE);
    };
    AI_LOGENTRY(TOPIC_Q506, NAME_SPL_SWARM);
}

func void DIA_DUSTER_Q506_FINISH_INFO() {
    Q506_REMOVEPATHCHECK = TRUE;
    Q506_REMOVEPATHCHECK_DAY = WLD_GETDAY();
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q506_Finish_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q506_Finish_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q506_Finish_03_03");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q506_Finish_15_04");
    AI_STOPLOOKAT(SELF);
    AI_PLAYANI(SELF, T_SEARCH_SCARED);
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q506_Finish_03_05");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q506_Finish_15_06");
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q506_Finish_15_07");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q506_Finish_03_08");
    DIA_DUSTER_Q506_GOTOVOLFZACKE();
    DUSTER_Q506_APPLYFUNCTION();
}

instance DIA_DUSTER_Q506_GUARDS(C_INFO) {
    NPC = 54425;
    NR = 1;
    CONDITION = DIA_DUSTER_Q506_GUARDS_CONDITION;
    INFORMATION = DIA_DUSTER_Q506_GUARDS_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "What about the barrels and the other guards?";
}

func int DIA_DUSTER_Q506_GUARDS_CONDITION() {
    if (((Q506_DUSTERVOLFZACKE) == (TRUE)) && ((NPC_GETDISTTOWP(SELF, "PART4_PATH_Q506_DUSTER")) <= (5000))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DUSTER_Q506_GUARDS_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Q506_Guards_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q506_Guards_03_02");
}

instance DIA_DUSTER_Q506_FEEL(C_INFO) {
    NPC = 54425;
    NR = 90;
    CONDITION = DIA_DUSTER_Q506_FEEL_CONDITION;
    INFORMATION = DIA_DUSTER_Q506_FEEL_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "How's the morale?";
}

func int DIA_DUSTER_Q506_FEEL_CONDITION() {
    if (((NPC_GETDISTTOWP(SELF, "PART_WORKERSCAMP_DUSTER")) <= (2000)) && ((Q506_DUSTERVOLFZACKE) == (TRUE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DUSTER_Q506_FEEL_INFO() {
    AI_STARTFACEANI(OTHER, S_WHAT, 1, -(1));
    B_SAY(OTHER, SELF, "$MARVIN_VolfzackMorale3");
    AI_STARTFACEANI(SELF, S_THINK, 1, -(1));
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Q506_Feel_03_01");
    AI_RESETFACEANI(SELF);
    AI_RESETFACEANI(OTHER);
}

var int DUSTERCANTEACHUS;
instance DIA_DUSTER_CANYOUTRAIN(C_INFO) {
    NPC = 54425;
    NR = 1;
    CONDITION = DIA_DUSTER_CANYOUTRAIN_CONDITION;
    INFORMATION = DIA_DUSTER_CANYOUTRAIN_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Could you teach me something?";
}

func int DIA_DUSTER_CANYOUTRAIN_CONDITION() {
    if (((((LOG_GETSTATUS(MIS_Q401)) == (LOG_SUCCESS)) && ((Q401_DUSTERBIZZAREADVENTURE) >= (4))) || ((LOG_GETSTATUS(MIS_QM401)) == (LOG_SUCCESS))) || ((Q506_DUSTERVOLFZACKE) == (TRUE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DUSTER_CANYOUTRAIN_INFO() {
    AI_OUTPUT(OTHER, SELF, "DIA_Duster_Canyoutrain_15_01");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Canyoutrain_03_02");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Canyoutrain_03_03");
    LOG_CREATETOPIC(TOPIC_CITYTEACHER, LOG_NOTE);
    AI_LOGENTRY(TOPIC_CITYTEACHER, LOG_TEACHER_DUSTER_MINING);
    DUSTERCANTEACHUS = TRUE;
}

var int DUSTER_MINELEVEL;
var string DUSTER_PRINTS;
instance DIA_DUSTER_TEACH(C_INFO) {
    NPC = 54425;
    NR = 950;
    CONDITION = DIA_DUSTER_TEACH_CONDITION;
    INFORMATION = DIA_DUSTER_TEACH_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "Can you teach me something about mining?";
}

func int DIA_DUSTER_TEACH_CONDITION() {
    if ((DUSTERCANTEACHUS) == (TRUE)) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DUSTER_TEACH_CHOICES() {
    DUSTER_MINELEVEL = HERO_HACKCHANCE;
    INFO_CLEARCHOICES(67300);
    INFO_ADDCHOICE(67300, DIALOG_BACK, 67305);
    if ((HERO_HACKCHANCE) <= (95)) {
        INFO_ADDCHOICE(67300, B_BUILDLEARNSTRING2(PRINT_LEARN_MINE5, 0, DUSTER_PAYMENT5), 67307);
    };
    if ((HERO_HACKCHANCE) <= (99)) {
        INFO_ADDCHOICE(67300, B_BUILDLEARNSTRING2(PRINT_LEARN_MINE1, 0, DUSTER_PAYMENT1), 67306);
    };
}

func void DIA_DUSTER_TEACH_CHECKLEVEL() {
    if ((HERO_HACKCHANCE) >= (100)) {
        DUSTERCANTEACHUS = FALSE;
        B_SAY(SELF, OTHER, "$NoLearnYoureBetter");
        INFO_CLEARCHOICES(67300);
    };
    DIA_DUSTER_TEACH_CHOICES();
}

func void DIA_DUSTER_TEACH_INFO() {
    B_SAY(OTHER, SELF, "$MARVIN_CanYouTeachMeMining");
    DIA_DUSTER_TEACH_CHECKLEVEL();
}

func void DIA_DUSTER_TEACH_BACK() {
    INFO_CLEARCHOICES(67300);
}

func void DIA_DUSTER_TEACHMINE1() {
    if ((HERO_HACKCHANCE) == (100)) {
        B_SAY(SELF, OTHER, "$NoLearnOverPersonalMAX");
    };
    if ((NPC_HASITEMS(OTHER, 34203)) >= (DUSTER_PAYMENT1)) {
        if ((HERO_HACKCHANCE) < (100)) {
            B_UPGRADE_HERO_HACKCHANCE(1);
        };
    };
    B_SAY(SELF, OTHER, "$NOGOLD");
    DIA_DUSTER_TEACH_CHECKLEVEL();
}

func void DIA_DUSTER_TEACHMINE5() {
    if ((HERO_HACKCHANCE) == (100)) {
        B_SAY(SELF, OTHER, "$NoLearnOverPersonalMAX");
    };
    if ((NPC_HASITEMS(OTHER, 34203)) >= (DUSTER_PAYMENT5)) {
        if ((HERO_HACKCHANCE) < (95)) {
            B_UPGRADE_HERO_HACKCHANCE(5);
        } else {
            B_UPGRADE_HERO_HACKCHANCE((100) - (HERO_HACKCHANCE));
        };
    };
    B_SAY(SELF, OTHER, "$NOGOLD");
    DIA_DUSTER_TEACH_CHECKLEVEL();
}

instance DIA_DUSTER_HELLO(C_INFO) {
    NPC = 54425;
    NR = 1;
    CONDITION = DIA_DUSTER_HELLO_CONDITION;
    INFORMATION = DIA_DUSTER_HELLO_INFO;
    PERMANENT = FALSE;
    DESCRIPTION = "Who are you?";
}

func int DIA_DUSTER_HELLO_CONDITION() {
    if (!(NPC_KNOWSINFO(OTHER, 67201))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DUSTER_HELLO_INFO() {
    B_SAY(OTHER, SELF, "$MARVIN_WhoAreYou");
    AI_OUTPUT(SELF, OTHER, "DIA_Duster_Hello_03_01");
}

instance DIA_DUSTER_AMBIENT(C_INFO) {
    NPC = 54425;
    NR = 998;
    CONDITION = DIA_DUSTER_AMBIENT_CONDITION;
    INFORMATION = DIA_DUSTER_AMBIENT_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = "What's up?";
}

func int DIA_DUSTER_AMBIENT_CONDITION() {
    if ((NPC_KNOWSINFO(OTHER, 67308)) || (NPC_KNOWSINFO(OTHER, 67201))) {
        if ((NPC_GETDISTTOWP(SELF, "PART_WORKERSCAMP_DUSTER")) > (2000)) {
            return TRUE;
        };
    };
    return 0 /* !broken stack! */;
}

func void DIA_DUSTER_AMBIENT_INFO() {
    B_SAY(OTHER, SELF, "$MARVIN_HowAreYou2");
    if ((Q401_DUSTERBIZZAREADVENTURE) < (4)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Duster_Ambient_03_01");
    };
    if ((Q401_DUSTERBIZZAREADVENTURE) == (4)) {
        AI_OUTPUT(SELF, OTHER, "DIA_Duster_Ambient_03_02");
    };
}

instance DIA_DUSTER_PICKPOCKET(C_INFO) {
    NPC = 54425;
    NR = 900;
    CONDITION = DIA_DUSTER_PICKPOCKET_CONDITION;
    INFORMATION = DIA_DUSTER_PICKPOCKET_INFO;
    PERMANENT = TRUE;
    DESCRIPTION = PICKPOCKET_80;
}

func int DIA_DUSTER_PICKPOCKET_CONDITION() {
    if (((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_PICKPOCKET)) >= (1)) && ((SELF.AIVAR[6]) == (FALSE))) {
        return TRUE;
    };
    return 0 /* !broken stack! */;
}

func void DIA_DUSTER_PICKPOCKET_INFO() {
    INFO_CLEARCHOICES(67314);
    INFO_ADDCHOICE(67314, DIALOG_BACK, 67318);
    INFO_ADDCHOICE(67314, DIALOG_PICKPOCKET, 67317);
}

func void DIA_DUSTER_PICKPOCKET_DOIT() {
    if ((NPC_GETTALENTSKILL(OTHER, NPC_TALENT_PICKPOCKET)) >= (2)) {
        CREATEINVITEMS(SELF, 34384, 3);
        B_GIVEINVITEMS(SELF, OTHER, 34384, 3);
        B_PICKPOCKET_AMBIENT_TIER_2();
        SELF.AIVAR[6] = TRUE;
        INFO_CLEARCHOICES(67314);
    };
    AI_PLAYANI(HERO, T_CANNOTTAKE);
    PRINTSCREEN(PRINT_CANTPICKPOCKETTHISPERSON, -(1), -(1), FONT_SCREEN, 4);
    INFO_CLEARCHOICES(67314);
}

func void DIA_DUSTER_PICKPOCKET_BACK() {
    INFO_CLEARCHOICES(67314);
}

